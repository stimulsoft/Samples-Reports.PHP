/*
Stimulsoft.Reports.JS ES5
Version: 2020.5.2
Build date: 2020.11.26
License: https://www.stimulsoft.com/en/licensing/reports
*/
var __extends=this&&this.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),__values=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft;!function(t){var e,p,r,g,i,h,n,o;function a(){var t=null!==o&&o.apply(this,arguments)||this;return t.multipleFiles=!1,t}p=e=t.Report||(t.Report={}),g=r=p.Export||(p.Export={}),i=t.Report.Export.StiExportService,h=t.System.IO.StreamWriter,n=t.Base.Localization.StiLocalization,__extends(a,o=i),a.prototype.implements=function(){return[g.IStiCsvExportService]},Object.defineProperty(a.prototype,"defaultExtension",{get:function(){return"csv"},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"exportFormat",{get:function(){return p.StiExportFormat.Csv},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"groupCategory",{get:function(){return"Data"},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"position",{get:function(){return g.StiExportPosition.Data},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"exportNameInMenu",{get:function(){return n.get("Export","ExportTypeCsvFile")},enumerable:!1,configurable:!0}),a.prototype.exportTo=function(t,e,r){this.exportCsv(t,e,r.stimulsoft.as(g.StiDataExportSettings))},a.prototype.exportToAsync=function(t,e,r,i){var n=this;setTimeout(function(){n.exportTo(e,r,i),t()})},Object.defineProperty(a.prototype,"getFilter",{get:function(){return n.get("FileFilters","CsvFiles")},enumerable:!1,configurable:!0}),a.prototype.exportCsv=function(t,e,r){if(p.StiLogService.write(this.stimulsoft.getType(),"Export report to Csv format"),null==r)throw new Error("The 'settings' argument cannot be equal in null.");var i=r.pageRange,n=r.separator,o=r.encoding,a=r.skipColumnHeaders,r=r.dataExportMode;"\\t"==n&&(n="\t");var t=i.getSelectedPages(t.renderedPages);this.currentPassNumber=0,this.maximumPassNumber=3;var s=new g.StiMatrix(t,!1,this,null,r);if(s.scanComponentsPlacement(!1),this.isStopped)return;if(s.prepareDocument(this,r),this.writer=new h(e,o),!a){for(var l=0,m;l<s.fields.length;l++){-1==(m=s.fields[l].name.stimulsoft.replaceAll('"','""')).indexOf(n)&&-1==m.indexOf('"')&&-1==m.indexOf("\n")||(m='"'+m+'"'),this.writer.write(m),l<s.fields.length-1&&this.writer.write(n)}this.writer.writeLine("")}this.currentPassNumber=2;for(var c=0;c<s.dataArrayLength;c++){if(this.invokeExporting2(c,s.dataArrayLength-1,this.currentPassNumber,this.maximumPassNumber),this.isStopped)return;for(var l=0,m;l<s.fields.length;l++){null==(m=s.fields[l].dataArray[c])&&(m=""),""!=m&&(-1==m.indexOf(n)&&-1==m.indexOf('"')&&-1==m.indexOf("\n")||(m='"'+(m=m.stimulsoft.replaceAll('"','""'))+'"'),this.writer.write(m)),l<s.fields.length-1&&this.writer.write(n)}this.writer.writeLine("")}this.writer.flush(),null!=s&&(s.clear(),s=null)},i=a,g.StiCsvExportService=i}(Stimulsoft=Stimulsoft||{}),function(t){var e,r,i,o,n,t,a;function s(){var t=null!==a&&a.apply(this,arguments)||this;return t.multipleFiles=!1,t}r=e=t.Report||(t.Report={}),o=i=r.Export||(r.Export={}),n=t.Base.Localization.StiLocalization,a=o.StiExportService,__extends(s,a),s.prototype.implements=function(){return[o.IStiDataExportService]},Object.defineProperty(s.prototype,"defaultExtension",{get:function(){if(this.exportSettings.is(o.StiDataExportSettings)){var t=this.exportSettings.dataType;if(t==o.StiDataType.Dbf)return"dbf";if(t==o.StiDataType.Dif)return"dif";if(t==o.StiDataType.Sylk)return"slk";if(t==o.StiDataType.Xml)return"xml";if(t==o.StiDataType.Json)return"json"}return"csv"},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"exportFormat",{get:function(){if(this.exportSettings.is(o.StiCsvExportSettings))return r.StiExportFormat.Csv;if(this.exportSettings.is(o.StiDataExportSettings)){var t=this.exportSettings.dataType;if(t==o.StiDataType.Csv)return r.StiExportFormat.Csv;if(t==o.StiDataType.Dbf)return r.StiExportFormat.Dbf;if(t==o.StiDataType.Dif)return r.StiExportFormat.Dif;if(t==o.StiDataType.Sylk)return r.StiExportFormat.Sylk;if(t==o.StiDataType.Xml)return r.StiExportFormat.Xml;if(t==o.StiDataType.Json)return r.StiExportFormat.Json}return r.StiExportFormat.Data},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"groupCategory",{get:function(){return"Data"},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"position",{get:function(){return o.StiExportPosition.Data},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"exportNameInMenu",{get:function(){return n.get("Export","ExportTypeDataFile")},enumerable:!1,configurable:!0}),s.prototype.exportTo=function(t,e,r){this.exportData(t,e,r)},s.prototype.exportToAsync=function(t,e,r,i){var n=this;setTimeout(function(){n.exportTo(e,r,i),t()})},s.prototype.getFilter=function(){return n.get("FileFilters","CsvFiles")},s.prototype.exportData=function(t,e,r){var i=null!=(this.exportSettings=r)?r.dataType:o.StiDataType.Csv,n;(new o.StiCsvExportService).exportCsv(t,e,r)},t=s,o.StiDataExportService=t}(Stimulsoft=Stimulsoft||{}),function(w){var t,d,e,i,u,r,n,o,a,s;function l(){var t=s.call(this)||this;return t.renderAsDocument=!0,t.multipleFiles=!1,t.fileName="",t.htmlWriter=null,t.imageQuality=.75,t.imageResolution=96,t.compressToArchive=!1,t}d=t=w.Report||(w.Report={}),i=e=d.Export||(d.Export={}),u=w.System.StiString,r=w.System.Drawing.ColorTranslator,n=w.System.Drawing.Color,o=w.Base.Localization.StiLocalization,s=i.StiExportService,__extends(l,s),l.prototype.implements=function(){return[i.IStiHtml5ExportService]},Object.defineProperty(l.prototype,"defaultExtension",{get:function(){if(this.compressToArchive)return"zip";return"html"},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"exportFormat",{get:function(){return d.StiExportFormat.Html5},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"groupCategory",{get:function(){return"Web"},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"position",{get:function(){return i.StiExportPosition.Html5},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"exportNameInMenu",{get:function(){return o.get("Export","ExportTypeHtml5File")},enumerable:!1,configurable:!0}),l.prototype.exportTo=function(t,e,r){this.exportHtml(t,e,r)},l.prototype.exportToAsync=function(t,e,r,i){var n=this;setTimeout(function(){n.exportTo(e,r,i),t()})},l.prototype.getFilter=function(){if(this.compressToArchive)return o.get("FileFilters","ZipArchives");return o.get("FileFilters","HtmlFiles")},l.prototype.renderPage=function(t,e,r){var r=i.StiSvgHelper.saveToString(t,e,!1,!1,r,this.imageFormat,this.imageQuality,this.imageResolution);this.htmlWriter.write(r),this.htmlWriter.flush()},l.prototype.renderStartDoc=function(t,e){this.htmlWriter.write("<!DOCTYPE html>"),this.htmlWriter.writeLine(),this.htmlWriter.indent++,this.htmlWriter.writeFullBeginTag("head"),this.htmlWriter.writeLine(),this.htmlWriter.indent++,this.htmlWriter.writeFullBeginTag("title"),this.htmlWriter.write(this.report.reportAlias),this.htmlWriter.writeEndTag("title"),this.htmlWriter.writeLine(),this.htmlWriter.writeBeginTag("meta"),this.htmlWriter.writeAttribute("charset",e.webName),this.htmlWriter.writeEndTag("meta"),this.htmlWriter.writeLine(),this.htmlWriter.indent--,this.htmlWriter.writeEndTag("head"),this.htmlWriter.writeLine(),this.htmlWriter.writeBeginTag("body"),this.htmlWriter.writeAttribute("bgcolor",r.toHtml(n.lightBlue)),this.htmlWriter.writeAttribute("style","text-align:center;"),this.htmlWriter.write(">"),this.htmlWriter.indent++,this.htmlWriter.writeLine()},l.prototype.renderEndDoc=function(){this.htmlWriter.indent--,this.htmlWriter.writeEndTag("body"),this.htmlWriter.indent--,this.htmlWriter.writeLine(),this.htmlWriter.writeEndTag("html")},l.prototype.exportHtml=function(t,e,r){var i,n;if(d.StiLogService.write(this.stimulsoft.getType(),"Export report to Html format"),null==r)throw new Error("The 'settings' argument cannot be equal in null.");var o=r.pageRange;this.imageFormat=r.imageFormat,this.imageResolution=r.imageResolution,this.imageQuality=r.imageQuality,this.compressToArchive=r.compressToArchive;var a=r.continuousPages;this.htmlWriter=e;var s=r.pageRange.getSelectedPages(t.renderedPages),l;try{this.report=t,1==this.renderAsDocument&&this.renderStartDoc(s,r.encoding),w.Base.vEIvF.JlKzR.RNAxU()||(w.Base.vEIvF.JlKzR.ZHIhL()||w.Base.vEIvF.JlKzR.LuQMU())&&w.System.NodeJs.isStandaloneVersion||(l=u.format("{3}{0}{2}{4}{1}",String.fromCharCode(114),String.fromCharCode(108),String.fromCharCode(105),String.fromCharCode(84),String.fromCharCode(97)),e.write('<div style="FONT-SIZE: 10px; COLOR: red; FONT-FAMILY: Arial"'+">"+"Stimulsoft Reports - "+l+" Version</div>")),this.htmlWriter.indent=0;var m=1;try{for(var c=__values(s.list),p=c.next();!p.done;p=c.next()){var g=p.value;this.invokeExporting(g,s,0,1);var h={ref:m};this.renderPage(t,g,h),m=h.ref,a&&this.htmlWriter.write("<br/>"),this.htmlWriter.writeLine()}}catch(t){i={error:t}}finally{try{p&&!p.done&&(n=c.return)&&n.call(c)}finally{if(i)throw i.error}}1==this.renderAsDocument&&this.renderEndDoc(),this.htmlWriter.flush()}finally{t=null}},a=l,i.StiHtml5ExportService=a}(Stimulsoft=Stimulsoft||{}),function(re){var t,ie,e;ie=t=re.Report||(re.Report={}),function(kt){var Nt=re.System.StiArray,Ot=re.System.StiString,o=re.Report.Dashboard.StiDashboardExport,a=re.Report.Dashboard.IStiDashboard,E=re.System.Collections.Hashtable,Mt=re.System.Drawing.Color,Ht=re.System.Char,b=re.Report.Components.StiPagesCollection,Ut=re.System.Drawing.Size,l=re.Base.Drawing.StiTextHorAlignment,s=re.Base.Drawing.StiPenStyle,m=re.Base.Drawing.StiVertAlignment,zt=re.Report.Components.StiText,c=re.Base.Drawing.StiBrush,Xt=re.System.Text.StringBuilder,Wt=re.Report.Components.IStiExportImageExtended,Yt=re.System.Text.Encoding,p=re.Base.Drawing.StiTextRenderer,Gt=re.Report.Components.StiRichText,Vt=re.System.IO.MemoryStream,_t=re.System.Xml.XmlTextWriter,i=re.System.DateTime,jt=re.Report.Components.StiCheckBox,y=re.Base.Zip.StiZipWriter20,x=re.System.Globalization.CultureInfo,qt=re.Report.Components.StiPageOrientation,g=re.Base.Drawing.StiHtmlState,h=re.Base.Drawing.StiHtmlTagsState,t=(e=kt.StiExportService,__extends(r,e),r.prototype.implements=function(){return[kt.IStiExcel2007ExportService]},r.prototype.getDefaultExtension=function(){return"xlsx"},r.prototype.exportTo=function(t,e,r){this.exportExcel(t,e,r)},r.prototype.exportToAsync=function(t,e,r,i){var n=this;re.Report.Export.StiExportImageHelper.convertAllImages(e,re.System.Drawing.Imaging.ImageFormat.Jpeg).try(function(){if(!e.isDocument&&e.getCurrentPage().is(a))return void o.exportAsync(e,r,i).try(function(){return t()});n.exportTo(e,r,i),null!=e&&null!=e.preparedExportImages&&(e.preparedExportImages.clear(),e.preparedExportImages=null),t()})},r.prototype.getLineStyle=function(t){var e=s.None,r=0,i=1.5,n=3;switch(null!=t&&(e=t.style,r=t.size),e){case s.Solid:if(n<r)return"thick";if(i<r)return"medium";return"thin";case s.Dot:if(i<r)return"dotted";return"hair";case s.Dash:if(i<r)return"mediumDashed";return"dashed";case s.DashDot:if(i<r)return"mediumDashDot";return"dashDot";case s.DashDotDot:if(i<r)return"mediumDashDotDot";return"dashDotDot";case s.Double:return"double";default:return null}},r.prototype.getRefString=function(t,e){var r=Math.trunc(t/26),i=Math.trunc(t%26),t=new Xt;return 0<r&&t.append(this.refChars.charAt(r-1)),t.append(this.refChars.charAt(i)),t.append((e+1).toString()),t.toString()},r.prototype.getRefAbsoluteString=function(t,e){var r=Math.trunc(t/26),i=Math.trunc(t%26),t=new Xt;return t.append("$"),0<r&&t.append(this.refChars.charAt(r-1)),t.append(this.refChars.charAt(i)),t.append("$"),t.append((e+1).toString()),t.toString()},r.prototype.floatToString=function(t){var e;return t.toString().stimulsoft.replaceAll(",",".")},r.prototype.stringToUrl=function(t){for(var e=new Xt,r=0;r<t.length;r++){var i=t.charAt(r);if("'"==i)continue;i.charCodeAt(0)<32||-1!=this.wrongUrlSymbols.indexOf(i)?e.append(Ot.format("%{0:x2}",i.charCodeAt(0))):e.append(i)}return e.toString()},r.prototype.getFontNumber=function(t){if(0<this.fontList.length)for(var e=0;e<this.fontList.length;e++)if(this.fontList[e].stimulsoft.equals(t))return e;var r;return this.fontList.push(t),this.fontList.length-1},r.prototype.getFillNumber=function(t){if(0<this.fillList.length)for(var e=0;e<this.fillList.length;e++)if(this.fillList[e].stimulsoft.equals(t))return e;var r;return this.fillList.push(t),this.fillList.length-1},r.prototype.getBorderNumber=function(t){if(0<this.borderList.length)for(var e=0;e<this.borderList.length;e++)if(this.borderList[e].stimulsoft.equals(t))return e;var r;return this.borderList.push(t),this.borderList.length-1},r.prototype.getXFNumber=function(t){if(0<this.xfList.length)for(var e=0;e<this.xfList.length;e++)if(this.xfList[e].equalDataXF(t))return e;var r;return this.xfList.push(t),this.xfList.length-1},r.prototype.getSSTNumber=function(t){if(this.sstCount++,0<this.sstList.length&&this.sstHash.containsKey(t))return this.sstHash.get(t);this.sstList.push(t);var e=this.sstList.length-1;return this.sstHash.add(t,e),e},r.prototype.getFormatNumber=function(t){if(0<this.formatList.length)for(var e=0;e<this.formatList.length;e++)if(this.formatList[e]==t)return e+164;var r;return this.formatList.push(t),this.formatList.length-1+164},r.prototype.convert=function(t){return t*this.HiToTwips},r.prototype.compareExcellSheetNames=function(t,e){var t=t;null!=t&&0!=t.length||(t="");var e=e;return null!=e&&0!=e.length||(e=""),t==e},r.prototype.prepareData=function(){this.fontList=new Array,this.fillList=new Array,this.borderList=new Array,this.xfList=new Array,this.sstList=[],this.sstHash=new E,this.sstHashIsTags=new E,this.imageList=[],this.formatList=[],this.sheetNameList=[],this.sstCount=0,this.printAreasList=[],this.matrixList=[],this.firstPageIndexList=[],this.minRowList=[],this.maxRowList=[],this.imageCache=new ie.StiImageCache(re["StiOptions"].Export.Excel.AllowImageComparer,!0,ie.ImageFormat.Jpeg,this.imageQuality,!1);var t=new Kt("Arial",!1,!1,!1,!1,10,Mt.black,1,0);this.getFontNumber(t);var t=new Jt("none",Mt.transparent,Mt.black);this.getFillNumber(t),t=new Jt("gray125",Mt.transparent,Mt.black),this.getFillNumber(t);var t=new Qt(null,null,null,null);this.getBorderNumber(t);var t=new Zt(0,0,0,0,0,l.Left,m.Bottom,0,!1,!1,!1);this.getXFNumber(t)},r.prototype.writeContentTypes=function(){var t=new Vt,e=new _t(Yt.UTF8,t);e.writeStartDocument(),e.writeStartElement("Types"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/content-types"),e.writeStartElement("Default"),e.writeAttributeString("Extension","rels"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-package.relationships+xml"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","xml"),e.writeAttributeString("ContentType","application/xml"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","jpeg"),e.writeAttributeString("ContentType","image/jpeg"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","png"),e.writeAttributeString("ContentType","image/png"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","vml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.vmlDrawing"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/docProps/app.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.extended-properties+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/docProps/core.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-package.core-properties+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/xl/workbook.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"),e.writeEndElement();for(var r=0;r<this.sheetNameList.length;r++)e.writeStartElement("Override"),e.writeAttributeString("PartName",Ot.format("/xl/worksheets/sheet{0}.xml",r+1)),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"),e.writeEndElement();e.writeStartElement("Override"),e.writeAttributeString("PartName","/xl/styles.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"),e.writeEndElement();for(var r=0;r<this.sheetNameList.length;r++)e.writeStartElement("Override"),e.writeAttributeString("PartName",Ot.format("/xl/drawings/drawing{0}.xml",r+1)),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.drawing+xml"),e.writeEndElement();return 0<this.sstList.length&&(e.writeStartElement("Override"),e.writeAttributeString("PartName","/xl/sharedStrings.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"),e.writeEndElement()),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},r.prototype.writeMainRels=function(){var t=new Vt,e=new _t(Yt.UTF8,t);return e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId1"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument"),e.writeAttributeString("Target","xl/workbook.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId2"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties"),e.writeAttributeString("Target","docProps/core.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId3"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties"),e.writeAttributeString("Target","docProps/app.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},r.prototype.writeDocPropsApp=function(){var t=new Vt,e=new _t(Yt.UTF8,t);e.writeStartDocument(),e.writeStartElement("Properties"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"),e.writeAttributeString("xmlns:vt","http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"),e.writeElementString("Application","Microsoft Excel"),e.writeElementString("DocSecurity","0"),e.writeElementString("ScaleCrop","false"),e.writeElementString("Company",null==this.docCompanyString?"":this.docCompanyString),e.writeElementString("LinksUpToDate","false"),e.writeElementString("SharedDoc","false"),e.writeElementString("HyperlinksChanged","false"),e.writeElementString("AppVersion","12.0000"),e.writeStartElement("HeadingPairs"),e.writeStartElement("vt:vector"),e.writeAttributeString("size","4"),e.writeAttributeString("baseType","variant"),e.writeStartElement("vt:variant"),e.writeElementString("vt:lpstr","Worksheets"),e.writeEndElement(),e.writeStartElement("vt:variant"),e.writeElementString("vt:i4",Ot.format("{0}",this.sheetNameList.length)),e.writeEndElement(),e.writeStartElement("vt:variant"),e.writeElementString("vt:lpstr","Named Ranges"),e.writeEndElement(),e.writeStartElement("vt:variant"),e.writeElementString("vt:i4",Ot.format("{0}",this.sheetNameList.length)),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("TitlesOfParts"),e.writeStartElement("vt:vector"),e.writeAttributeString("size",Ot.format("{0}",2*this.sheetNameList.length)),e.writeAttributeString("baseType","lpstr");for(var r=0;r<this.sheetNameList.length;r++)e.writeElementString("vt:lpstr",this.sheetNameList[r]);for(var r=0;r<this.sheetNameList.length;r++)e.writeElementString("vt:lpstr",Ot.format("'{0}'!Print_Area",this.sheetNameList[r]));return e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},r.prototype.writeDocPropsCore=function(){var t=new Vt,e=new _t(Yt.UTF8,t);e.writeStartDocument(),e.writeStartElement("cp:coreProperties"),e.writeAttributeString("xmlns:cp","http://schemas.openxmlformats.org/package/2006/metadata/core-properties"),e.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),e.writeAttributeString("xmlns:dcterms","http://purl.org/dc/terms/"),e.writeAttributeString("xmlns:dcmitype","http://purl.org/dc/dcmitype/"),e.writeAttributeString("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance");var r=Ot.format("{0}{1}",i.now.toString("yyyy-MM-dd"),i.now.toString("THH:mm:ssZ"));return e.writeElementString("dc:title",null==this.report.reportName?"":this.report.reportName),e.writeElementString("dc:subject",null==this.report.reportAlias?"":this.report.reportAlias),e.writeElementString("dc:creator",null==this.report.reportAuthor?"":this.report.reportAuthor),e.writeElementString("dc:description",null==this.report.reportDescription?"":this.report.reportDescription),e.writeElementString("cp:lastModifiedBy",null==this.docLastModifiedString?"":this.docLastModifiedString),e.writeStartElement("dcterms:created"),e.writeAttributeString("xsi:type","dcterms:W3CDTF"),e.writeString(r),e.writeEndElement(),e.writeStartElement("dcterms:modified"),e.writeAttributeString("xsi:type","dcterms:W3CDTF"),e.writeString(r),e.writeEndElement(),e.writeElementString("cp:contentStatus",re.StiVersion.platform()),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},r.prototype.writeWorkbookRels=function(){var t=new Vt,e=new _t(Yt.UTF8,t);e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships");for(var r=0;r<this.sheetNameList.length;r++)e.writeStartElement("Relationship"),e.writeAttributeString("Id",Ot.format("rId{0}",r+1)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet"),e.writeAttributeString("Target",Ot.format("worksheets/sheet{0}.xml",r+1)),e.writeEndElement();return e.writeStartElement("Relationship"),e.writeAttributeString("Id",Ot.format("rId{0}",this.sheetNameList.length+2)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles"),e.writeAttributeString("Target","styles.xml"),e.writeEndElement(),0<this.sstCount&&(e.writeStartElement("Relationship"),e.writeAttributeString("Id",Ot.format("rId{0}",this.sheetNameList.length+3)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings"),e.writeAttributeString("Target","sharedStrings.xml"),e.writeEndElement()),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},r.prototype.writeWorkbook=function(){var t=new Vt,e=new _t(Yt.UTF8,t);e.writeStartDocument(),e.writeStartElement("workbook"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/spreadsheetml/2006/main"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeStartElement("fileVersion"),e.writeAttributeString("appName","xl"),e.writeAttributeString("lastEdited","4"),e.writeAttributeString("lowestEdited","4"),e.writeAttributeString("rupBuild","4505"),e.writeEndElement(),e.writeStartElement("workbookPr"),e.writeAttributeString("defaultThemeVersion","124226"),e.writeEndElement(),e.writeStartElement("bookViews"),e.writeStartElement("workbookView"),e.writeAttributeString("xWindow","120"),e.writeAttributeString("yWindow","15"),e.writeAttributeString("windowWidth","18975"),e.writeAttributeString("windowHeight","11955"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("sheets");for(var r=0;r<this.sheetNameList.length;r++)e.writeStartElement("sheet"),e.writeAttributeString("name",this.sheetNameList[r]),e.writeAttributeString("sheetId",Ot.format("{0}",r+1)),e.writeAttributeString("r:id",Ot.format("rId{0}",r+1)),e.writeEndElement();e.writeEndElement(),e.writeStartElement("definedNames");for(var r=0;r<this.sheetNameList.length;r++){var i=this.printAreasList[r];1048575<i.height&&(i.height=1048575),16383<i.width&&(i.width=16383);var i=this.getRefAbsoluteString(i.width,i.height);e.writeStartElement("definedName"),e.writeAttributeString("name","_xlnm.Print_Area"),e.writeAttributeString("localSheetId",Ot.format("{0}",r)),e.writeString(Ot.format("'{0}'!$A$1:{1}",this.sheetNameList[r],i)),e.writeEndElement()}return e.writeEndElement(),e.writeStartElement("calcPr"),e.writeAttributeString("calcId","124519"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},r.prototype.writeSheetRels=function(t){var e=new Vt,r=new _t(Yt.UTF8,e);if(r.writeStartDocument(),r.writeStartElement("Relationships"),r.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),0<this.imageList.length-this.imageListOffset&&(r.writeStartElement("Relationship"),r.writeAttributeString("Id",Ot.format("rId{0}",1)),r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing"),r.writeAttributeString("Target",Ot.format("../drawings/drawing{0}.xml",t+1)),r.writeEndElement()),0<this.hyperlinkList.length)for(var i=0;i<this.hyperlinkList.length;i++)r.writeStartElement("Relationship"),r.writeAttributeString("Id",Ot.format("rId{0}",2+i)),r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"),r.writeAttributeString("Target",this.hyperlinkList[i]),r.writeAttributeString("TargetMode","External"),r.writeEndElement();return re.Base.vEIvF.JlKzR.RNAxU()||re.Base.vEIvF.JlKzR.KqUvN()||(re.Base.vEIvF.JlKzR.ZHIhL()||re.Base.vEIvF.JlKzR.LuQMU()||re.Base.vEIvF.JlKzR.UPtPa())&&re.System.NodeJs.isStandaloneVersion||(r.writeStartElement("Relationship"),r.writeAttributeString("Id","dId1"),r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing"),r.writeAttributeString("Target","../drawings/vmlDrawingAdditional.vml"),r.writeEndElement()),r.writeFullEndElement(),r.writeEndDocument(),r.flush(),e},r.prototype.writeSheet=function(t,e){var r=new Vt,i=new _t(Yt.UTF8,r);i.writeStartDocument(),i.writeStartElement("worksheet"),i.writeAttributeString("xmlns","http://schemas.openxmlformats.org/spreadsheetml/2006/main"),i.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),re["StiOptions"].Export.Excel.FitToOnePageWide&&(i.writeStartElement("sheetPr"),i.writeStartElement("pageSetUpPr"),i.writeAttributeString("fitToPage","1"),i.writeEndElement(),i.writeEndElement()),this.matrix=this.matrixList[t];var n=this.minRowList[t],o=this.maxRowList[t],t=new Ut(this.matrix.coordX.countItems-2,o-n-1);t.width<0&&(t.width=0),t.height<0&&(t.height=0),this.printAreasList.push(t);var a=[];i.writeStartElement("dimension"),i.writeAttributeString("ref",Ot.format("{0}:{1}",this.getRefString(0,0),this.getRefString(t.width,t.height))),i.writeEndElement();var s=0,l=0;if(re["StiOptions"].Export.Excel.AllowFreezePanes)for(var m=n;m<o;m++)for(var c=0,p;c<this.matrix.coordX.countItems-1;c++){if(null!=(p=this.matrix.cells[m][c])&&null!=p.component&&(p.component.locked||null!=p.component.tagValue&&p.component.tagValue.toString().contains("excelfreezepanes"))){var g=p.component.componentPlacement;if(null!=g&&0<g.length&&(g.stimulsoft.startsWith("rt")||g.stimulsoft.startsWith("ph")||g.stimulsoft.startsWith("h"))){s=p.left,l=p.top+p.height+1;break}}}i.writeStartElement("sheetViews"),i.writeStartElement("sheetView"),re["StiOptions"].Export.Excel.ColumnsRightToLeft&&i.writeAttributeString("rightToLeft","1"),re["StiOptions"].Export.Excel.ShowGridLines||i.writeAttributeString("showGridLines","0"),i.writeAttributeString("tabSelected","1"),i.writeAttributeString("workbookViewId","0"),0==s&&0==l?(i.writeStartElement("selection"),i.writeAttributeString("activeCell","A1"),i.writeAttributeString("sqref","A1")):0==s?(i.writeStartElement("pane"),i.writeAttributeString("ySplit",l.toString()),i.writeAttributeString("topLeftCell",this.getRefString(s,l)),i.writeAttributeString("activePane","bottomLeft"),i.writeAttributeString("state","frozen"),i.writeEndElement(),i.writeStartElement("selection"),i.writeAttributeString("pane","bottomLeft"),i.writeAttributeString("activeCell",this.getRefString(0,l)),i.writeAttributeString("sqref",this.getRefString(0,l))):(i.writeStartElement("pane"),i.writeAttributeString("xSplit",s.toString()),i.writeAttributeString("ySplit",l.toString()),i.writeAttributeString("topLeftCell",this.getRefString(s,l)),i.writeAttributeString("activePane","bottomRight"),i.writeAttributeString("state","frozen"),i.writeEndElement(),i.writeStartElement("selection"),i.writeAttributeString("pane","topRight"),i.writeAttributeString("activeCell",this.getRefString(s,0)),i.writeAttributeString("sqref",this.getRefString(s,0)),i.writeEndElement(),i.writeStartElement("selection"),i.writeAttributeString("pane","bottomLeft"),i.writeAttributeString("activeCell",this.getRefString(0,l)),i.writeAttributeString("sqref",this.getRefString(0,l)),i.writeEndElement(),i.writeStartElement("selection"),i.writeAttributeString("pane","bottomRight"),i.writeAttributeString("activeCell",this.getRefString(s,l)),i.writeAttributeString("sqref",this.getRefString(s,l))),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("sheetFormatPr"),i.writeAttributeString("defaultRowHeight",Ot.format("{0}",15)),i.writeEndElement();var h=this.matrix.coordX.getKeys(),w=this.matrix.coordY.getKeys();if(this.exportObjectFormatting){i.writeStartElement("cols");for(var d=0;d<this.matrix.coordX.countItems-1;d++){var u=this.matrix.coordX.getByIndex(d+1,h),S=this.matrix.coordX.getByIndex(d,h),S=this.convert(u-S)*this.TwipsToColinfo;i.writeStartElement("col"),i.writeAttributeString("min",Ot.format("{0}",d+1)),i.writeAttributeString("max",Ot.format("{0}",d+1)),i.writeAttributeString("width",Ot.format("{0}",S)),i.writeAttributeString("customWidth","1"),i.writeEndElement()}i.writeEndElement()}var f=null,v=Nt.create2(Boolean,o+1,this.matrix.coordX.countItems),E=Nt.create2(Number,o+1,this.matrix.coordX.countItems),b=[],y=[];i.writeStartElement("sheetData");for(var m=n;m<o;m++){var x=this.matrix.coordY.getByIndex(m+1,w)-this.matrix.coordY.getByIndex(m,w);i.writeStartElement("row"),i.writeAttributeString("r",Ot.format("{0}",m+1-n)),i.writeAttributeString("spans",Ot.format("{0}:{1}",1,this.matrix.coordX.countItems-1)),this.exportObjectFormatting&&(i.writeAttributeString("ht",Ot.format("{0}",this.convert(x))),i.writeAttributeString("customHeight","1"));for(var c=0;c<this.matrix.coordX.countItems-1;c++){var p=this.matrix.cells[m][c];if(v[m]&&0==v[m][c]&&null!=p){v[m][c]=!0;var A=p.component.stimulsoft.as(Gt),T=p.component.stimulsoft.as(zt),P=p.text,L=p.component.stimulsoft.as(jt),C=!1;null!=L&&null!=L.excelDataValue&&0<L.excelDataValue.length&&(C=!0,P=L.excelDataValue);var F=null,R,I,B;null!=p.component.hyperlinkValue&&0<(F=p.component.hyperlinkValue.toString().trim()).length&&!F.stimulsoft.startsWith("javascript:")&&(null!=(R=P)&&0!=R.length||(R=F),I=new te(m-n,m-n+p.height,c,c+p.width),B=new ee(I,R,F),y.push(B));var D=!1,k=p.component.stimulsoft.as(Wt),N,O,M,O,H,U,z;null!=k&&(N=this.imageResolution,O=null,p.component.isExportAsImage(ie.StiExportFormat.Excel2007)&&(M={ref:this.imageResolution},O=k.getImage(M,ie.StiExportFormat.Excel)),null!=O&&(null!=(H=this.matrix.getRealImageData(p,O))&&(O=H),U=this.imageCache.addImageIntRaw(O,O.imageFormat),z=new $t(m-n,0,c,0,m-n+1+p.height,0,c+1+p.width,0,U,F),this.imageList.push(z),D=!0));var X=!1,W;null!=p.component&&null!=p.component.tagValue&&-1!=p.component.tagValue.toString().toLowerCase().indexOf("exceltext")&&(X=!0,a.push(this.getRefString(c,m)));var Y="";null!=T&&(Y=T.format);var G=!1,V=!1,_=!1,j=!1,q=!1,K=!1,J=!1,Q="",L=2,I=0,R=this.reportCulture.numberFormat.currencySymbol,k=0==this.reportCulture.numberFormat.currencyPositivePattern||2==this.reportCulture.numberFormat.currencyPositivePattern,M=!1,H=null!=T&&T.hideZeros,O=null,U=null,z=Y.indexOf("|"),Z,$,tt,$,Q,Z,$;if(-1!=z&&(O=kt.StiExportUtils.getPositivePattern(Y.charCodeAt(z+1)-65),U=kt.StiExportUtils.getNegativePattern(Y.charCodeAt(z+2)-65),Y=Y.substr(0,z)),null!=Y&&0<Y.length)if("C"==Y[0]?G=!0:"N"==Y[0]?V=!0:"P"==Y[0]?_=!0:"D"==Y[0]?j=!0:"T"==Y[0]?q=!0:"U"==Y[0]&&(K=!0),1==Y.length)J=!0;else if(G||V||_){var et=1;if(Ht.isDigit(Y[et])){var rt=new Xt;while(et<Y.length&&Ht.isDigit(Y[et]))rt.append(Y[et]),et++;L=parseInt(rt.toString())}et<Y.length&&"G"==Y[et]&&(et++,I=3),et<Y.length&&"("==Y[et]&&(et++,M=!0),et<Y.length&&("."==Y[et]||","==Y[et])&&et++,et<Y.length&&("+"==Y[et]||"-"==Y[et])&&("+"==Y[et]&&(k=!0),R=++et<Y.length?Y.substring(et):"")}G||V||_||(J=!0),G&&J&&(J=!1),H&&!Ot.isNullOrEmpty(Y)&&(J=!1),X&&(J=!0),J||(-1!=z?(Z=new Xt,1<I&&(Z.append("#,"),Z.appendCount("#",I-1)),Z.append("0"),0<L&&(Z.append("."),Z.appendCount("0",L)),$=Z.toString(),Q=O.stimulsoft.replaceAll("n",$).stimulsoft.replaceAll("$",'"'+R+'"')+";"+($=U.stimulsoft.replaceAll("n",$).stimulsoft.replaceAll("$",'"'+R+'"'))+(H?";":"")):(Z=new Xt,G&&1==k&&(Z.append('"'),Z.append(R),Z.append('"')),1<I&&(Z.append("#,"),Z.appendCount("#",I-1)),Z.append("0"),0<L&&(Z.append("."),Z.appendCount("0",L)),G&&0==k&&(Z.append('"'),Z.append(R),Z.append('"')),_&&Z.append("%"),$=(M?"(":"-")+(Q=Z.toString())+(M?")":""),H?Q=Q+";"+$+";":M&&(Q=Q+";"+$)));var M=0;J?(V&&(M=4),_&&(M=10),j&&(M=14),q&&(M=21),X&&(M=49)):M=this.getFormatNumber(Q);var it=0;if(this.exportObjectFormatting){var _=p.cellStyle,X=new Kt(_.font.name,_.font.bold,_.font.italic,_.font.underline,_.font.strikeout,Math.round(_.font.sizeInPoints),_.textColor,1,0);C&&(X=new Kt(re["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.name,re["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.bold,re["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.italic,re["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.underline,re["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.strikeout,Math.round(re["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.sizeInPoints),_.textColor,1,0));var Q=new Jt("solid",_.color,_.color);D&&(Q=new Jt("solid",Mt.transparent,Mt.transparent));for(var nt=!0,ot=!0,at=0;at<p.height+1;at++)null==this.matrix.bordersY[p.top+at][p.left]&&(nt=!1),null==this.matrix.bordersY[p.top+at][p.left+p.width+1]&&(ot=!1);for(var st=!0,lt=!0,at=0;at<p.width+1;at++)null==this.matrix.bordersX[p.top][p.left+at]&&(st=!1),null==this.matrix.bordersX[p.top+p.height+1][p.left+at]&&(lt=!1);var mt=new Qt(nt?this.matrix.bordersY[p.top][p.left]:null,ot?this.matrix.bordersY[p.top][p.left+p.width+1]:null,st?this.matrix.bordersX[p.top][p.left]:null,lt?this.matrix.bordersX[p.top+p.height+1][p.left]:null),ct=!1;null!=_.textOptions&&(ct=_.textOptions.rightToLeft);var pt=!1;null!=_.textOptions&&(pt=_.textOptions.wordWrap),Ot.isNullOrEmpty(P)||(-1==P.indexOf("\r")&&-1==P.indexOf("\n")||(pt=!0),null==T||!T.checkAllowHtmlTags()||-1==P.indexOf("<br")&&-1==P.indexOf("<ul")&&-1==P.indexOf("<ol")&&-1==P.indexOf("<p")||(pt=!0));var D=0,gt;null!=_.textOptions&&(0<=(gt=Math.ceil(_.textOptions.angle))&&gt<=90&&(D=gt),270<=gt&&gt<360&&(D=360-gt+90));var gt=this.restrictEditing==kt.StiExcel2007RestrictEditing.ExceptEditableFields&&null!=p.component&&p.component.is(zt)&&p.component.as(zt).editable,pt=new Zt(M,this.getFontNumber(X),this.getFillNumber(Q),this.getBorderNumber(mt),0,C?re["StiOptions"].Export.CheckBoxReplacementForExcelValue.HorAlignment:_.horAlignment,C?re["StiOptions"].Export.CheckBoxReplacementForExcelValue.VertAlignment:_.vertAlignment,D,pt,ct,gt);it=this.getXFNumber(pt)}if(i.writeStartElement("c"),i.writeAttributeString("r",this.getRefString(c,m-n)),i.writeAttributeString("s",it.toString()),this.exportObjectFormatting){for(var ht=0,wt;ht<=p.width;ht++)for(var dt=0;dt<=p.height;dt++)v[m+dt][c+ht]=!0,E[m+dt][c+ht]=it;(0<p.width||0<p.height)&&(wt=new te(m-n,m-n+p.height,c,c+p.width),b.push(wt))}else v[m][c]=!0,E[m][c]=it;if(!p.component.isExportAsImage(ie.StiExportFormat.Excel2007)&&(null!=P&&0<P.length||null!=T&&null!=T.excelDataValue)){var ct=!1,ut=!1,St=0,ft,ft,vt;if(null!=T&&null!=T.excelDataValue&&"-"!=T.excelDataValue){var gt=T.excelDataValue,Et=gt.trim().stimulsoft.replaceAll(",",".");if(null!=Et&&0<Et.length&&this.checkForNumber(Et)){ut=!0;try{j||q?ut=!1:(St=parseFloat(Et),isNaN(St)&&(ut=!1,St=0))}catch(t){re.System.StiError.showError(t,!1),ut=!1}}K&&(ut=!1),gt!=P&&gt.stimulsoft.startsWith("=")&&(ct=!0),ut||null!=P||(P=gt)}ct?(ft=T.excelDataValue.stimulsoft.replaceAll("\r","").stimulsoft.replaceAll("\t"," ").substring(1),re["StiOptions"].Export.Excel.TrimTrailingSpaces&&(ft=kt.StiExportUtils.trimEndWhiteSpace(ft)),i.writeElementString("f",ft)):1==ut?i.writeElementString("v",St.toString().stimulsoft.replaceAll(",",".")):(ft=P.stimulsoft.replaceAll("\r","").stimulsoft.replaceAll("\t"," "),re["StiOptions"].Export.Excel.TrimTrailingSpaces&&(ft=kt.StiExportUtils.trimEndWhiteSpace(ft)),vt=0,null!=T&&T.checkAllowHtmlTags()?(ft=this.convertAllowHtmlTagsToExcelString(T,ft),vt=this.getSSTNumber(ft),this.sstHashIsTags.add(vt,null)):vt=this.getSSTNumber(ft),i.writeAttributeString("t","s"),i.writeElementString("v",vt.toString()))}i.writeEndElement()}else{var it=0;v[m][c]&&(it=E[m][c]);var nt=null!=this.matrix.bordersY[m+0][c+0],ot=null!=this.matrix.bordersY[m+0][c+1],st=null!=this.matrix.bordersX[m+0][c+0],lt=void 0,mt,vt,pt,vt;try{lt=null!=this.matrix.bordersX[m+1][c+0]}catch(t){re.System.StiError.showError(t,!1)}(nt||ot||st||lt||0!=it)&&(mt=new Qt(nt?this.matrix.bordersY[m+0][c+0]:null,ot?this.matrix.bordersY[m+0][c+1]:null,st?this.matrix.bordersX[m+0][c+0]:null,lt?this.matrix.bordersX[m+1][c+0]:null),vt=this.xfList[it],pt=new Zt(vt.FormatIndex,vt.FontIndex,vt.FillIndex,this.getBorderNumber(mt),vt.XFId,vt.HorAlign,vt.VertAlign,vt.TextRotationAngle,vt.TextWrapped,vt.RightToLeft,vt.Editable),vt=this.getXFNumber(pt),this.exportObjectFormatting||(vt=0),i.writeStartElement("c"),i.writeAttributeString("r",this.getRefString(c,m-n)),i.writeAttributeString("s",vt.toString()),i.writeEndElement())}}i.writeEndElement()}if(i.writeEndElement(),this.restrictEditing!=kt.StiExcel2007RestrictEditing.No&&(i.writeStartElement("sheetProtection"),i.writeAttributeString("password","F05F"),i.writeAttributeString("sheet","1"),i.writeAttributeString("objects","1"),i.writeAttributeString("scenarios","1"),i.writeEndElement()),0<b.length&&(!this.exportDataOnly||this.exportObjectFormatting)){i.writeStartElement("mergeCells"),i.writeAttributeString("count",Ot.format("{0}",b.length));for(var at=0;at<b.length;at++){var wt=b[at];i.writeStartElement("mergeCell"),i.writeAttributeString("ref",Ot.format("{0}:{1}",this.getRefString(wt.FirstColumn,wt.FirstRow),this.getRefString(wt.LastColumn,wt.LastRow))),i.writeEndElement()}i.writeEndElement()}if(0<y.length){for(var bt=!1,yt=0,B,F;yt<y.length;yt++){if((F=(B=y[yt]).Bookmark).stimulsoft.startsWith("#")){F=F.substring(1);for(var xt=!1,At=0;At<this.matrixList.length;At++){var Tt=this.matrixList[At].bookmarksTable,Pt;if(null!=Tt)if(null!=(Pt=Tt.get(F))){var Lt=this.minRowList[At],Ct=this.maxRowList[At],Ft;if((Ft=Pt.stimulsoft.as(Ut)).height>=Lt&&Ft.height<Ct){bt=!0;break}}}}else bt=!0;if(bt)break}if(bt){i.writeStartElement("hyperlinks");for(var yt=0,B,F;yt<y.length;yt++){if((F=(B=y[yt]).Bookmark).stimulsoft.startsWith("#")){F=F.substring(1);for(var xt=!1,At=0;At<this.matrixList.length;At++){var Tt=this.matrixList[At].bookmarksTable,Pt;if(null!=Tt)if(null!=(Pt=Tt.get(F))){var Lt=this.minRowList[At],Ct=this.maxRowList[At],Ft;if((Ft=Pt.stimulsoft.as(Ut)).height>=Lt&&Ft.height<Ct){F=Ot.format("'{0}'!{1}",this.sheetNameList[At],this.getRefString(Ft.width,Ft.height-Lt)),xt=!0;break}}}xt&&(i.writeStartElement("hyperlink"),i.writeAttributeString("ref",this.getRefString(B.Range.FirstColumn,B.Range.FirstRow)),i.writeAttributeString("location",F),i.writeAttributeString("display",B.Description),i.writeEndElement())}else{var Rt=F;F.stimulsoft.startsWith("file:\\\\\\")&&(F="file:///"+(Rt=F.substring(8))),F.stimulsoft.startsWith("http:")&&(F=F.stimulsoft.replaceAll(" ","")),i.writeStartElement("hyperlink"),i.writeAttributeString("ref",this.getRefString(B.Range.FirstColumn,B.Range.FirstRow)),i.writeAttributeString("r:id",Ot.format("rId{0}",2+this.hyperlinkList.length)),i.writeAttributeString("display",Rt),i.writeEndElement(),this.hyperlinkList.push(this.stringToUrl(F))}}i.writeEndElement()}}i.writeStartElement("pageMargins"),i.writeAttributeString("left",this.floatToString(e.convertToHInches(e.unit,e.margins.left)/100)),i.writeAttributeString("right",this.floatToString(e.convertToHInches(e.unit,e.margins.right)/100)),i.writeAttributeString("top",this.floatToString(e.convertToHInches(e.unit,e.margins.top)/100)),i.writeAttributeString("bottom",this.floatToString(e.convertToHInches(e.unit,e.margins.bottom)/100)),i.writeAttributeString("header",this.floatToString(0)),i.writeAttributeString("footer",this.floatToString(0)),i.writeEndElement(),i.writeStartElement("pageSetup"),i.writeAttributeString("paperSize",Ot.format("{0}",e.paperSize)),i.writeAttributeString("orientation",e.orientation==qt.Portrait?"portrait":"landscape"),re["StiOptions"].Export.Excel.FitToOnePageWide&&i.writeAttributeString("fitToHeight","0"),i.writeEndElement(),re.Base.vEIvF.JlKzR.RNAxU()||re.Base.vEIvF.JlKzR.KqUvN()||(re.Base.vEIvF.JlKzR.ZHIhL()||re.Base.vEIvF.JlKzR.LuQMU()||re.Base.vEIvF.JlKzR.UPtPa())&&re.System.NodeJs.isStandaloneVersion||(i.writeStartElement("headerFooter"),i.writeStartElement("oddHeader"),i.writeRaw("&amp;C\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n&amp;G"),i.writeEndElement(),i.writeEndElement());var It=this.matrix.horizontalPageBreaks.length;if(this.exportHorizontalPageBreaks&&0<It){i.writeStartElement("rowBreaks"),i.writeAttributeString("count",It.toString()),i.writeAttributeString("manualBreakCount",It.toString());for(var Bt=0;Bt<It;Bt++)i.writeStartElement("brk"),i.writeAttributeString("id",Ot.format("{0}",this.matrix.horizontalPageBreaks[Bt])),i.writeAttributeString("max",0==Bt?"16383":"8"),i.writeAttributeString("man","1"),i.writeEndElement();i.writeEndElement()}if(this.imageList.length>this.imageListOffset&&(i.writeStartElement("drawing"),i.writeAttributeString("r:id",Ot.format("rId{0}",1)),i.writeEndElement()),0<a.length){for(var Dt in i.writeStartElement("ignoredErrors"),a)i.writeStartElement("ignoredError"),i.writeAttributeString("sqref",a[Dt]),i.writeAttributeString("numberStoredAsText","1"),i.writeEndElement();i.writeEndElement()}return re.Base.vEIvF.JlKzR.RNAxU()||re.Base.vEIvF.JlKzR.KqUvN()||(re.Base.vEIvF.JlKzR.ZHIhL()||re.Base.vEIvF.JlKzR.LuQMU()||re.Base.vEIvF.JlKzR.UPtPa())&&re.System.NodeJs.isStandaloneVersion||(i.writeStartElement("legacyDrawingHF"),i.writeAttributeString("r:id","dId1"),i.writeEndElement()),i.writeFullEndElement(),i.writeEndDocument(),i.flush(),r},r.prototype.checkForNumber=function(t){var e=t.match(r.regexCheckInteger1);if(null!=e)return!0;if(null!=(e=t.match(r.regexCheckFloat1)))return!0;return!1},r.prototype.prepareMatrix=function(t){var e=kt.StiDataExportMode.AllBands;if(this.exportDataOnly&&(e=kt.StiDataExportMode.Data|kt.StiDataExportMode.Headers,re["StiOptions"].Export.Excel.AllowExportFootersInDataOnlyMode&&(e|=kt.StiDataExportMode.Footers)),this.matrix=new kt.StiMatrix(t,re["StiOptions"].Export.Excel.DivideBigCells,this,null,e),this.useOnePageHeaderAndFooter){this.matrix.scanComponentsPlacement(!0,this.exportObjectFormatting);var r=0;while(this.matrix.linePlacement[r]!=kt.StiTableLineInfo.PageHeader&&r<this.matrix.coordY.countItems-1)r++;if(this.matrix.linePlacement[r]==kt.StiTableLineInfo.PageHeader){while(this.matrix.linePlacement[r]==kt.StiTableLineInfo.PageHeader&&r<this.matrix.coordY.countItems-1)r++;while(r<this.matrix.coordY.countItems-1)this.matrix.linePlacement[r]==kt.StiTableLineInfo.PageHeader&&(this.matrix.linePlacement[r]=kt.StiTableLineInfo.Trash),r++}r=this.matrix.coordY.countItems-1;while(this.matrix.linePlacement[r]!=kt.StiTableLineInfo.PageFooter&&0<r)r--;if(this.matrix.linePlacement[r]==kt.StiTableLineInfo.PageFooter){while(this.matrix.linePlacement[r]==kt.StiTableLineInfo.PageFooter&&0<r)r--;while(0<r)this.matrix.linePlacement[r]==kt.StiTableLineInfo.PageFooter&&(this.matrix.linePlacement[r]=kt.StiTableLineInfo.Trash),r--}for(var i=0,n=0;n<this.matrix.coordY.countItems-1;n++)if(this.matrix.linePlacement[n]!=kt.StiTableLineInfo.Trash){for(var o=0,a,s;o<this.matrix.coordX.countItems-1;o++){this.matrix.cells[i][o]=this.matrix.cells[n][o],null!=(a=this.matrix.cells[i][o])&&(a.top=i,null!=a.exportImage&&(s=a.component)),this.matrix.bordersX[i][o]=this.matrix.bordersX[n][o],this.matrix.bordersY[i][o]=this.matrix.bordersY[n][o],this.matrix.bookmarks[i][o]=this.matrix.bookmarks[n][o]}this.matrix.bordersY[i][this.matrix.coordX.countItems-1]=this.matrix.bordersY[n][this.matrix.coordX.countItems-1];var l=this.matrix.coordY.getKeys(),m=this.matrix.coordY.getByIndex(n+1,l)-this.matrix.coordY.getByIndex(n,l);this.matrix.coordY.setByIndex(i+1,this.matrix.coordY.getByIndex(i,l)+m),i++}for(var o=0,c;o<this.matrix.coordX.countItems-1;o++)this.matrix.bordersX[i][o]=this.matrix.bordersX[this.matrix.coordY.countItems-1][o];if(0<(c=this.matrix.coordY.countItems-1-i))for(var p=0;p<c;p++)this.matrix.coordY.removeByIndex(i+1)}if(this.exportDataOnly){this.matrix.scanComponentsPlacement(!0,this.exportObjectFormatting);for(var i=0,g=new E,h=null,w=re["StiOptions"].Export.Excel.AllowExportFootersInDataOnlyMode,n=0,c;n<this.matrix.coordY.countItems-1;n++){var d=!1,u,S,S;if(this.matrix.linePlacement[n]!=kt.StiTableLineInfo.HeaderD&&this.matrix.linePlacement[n]!=kt.StiTableLineInfo.HeaderAP||(-1==(S=(u=this.matrix.parentBandName[n]).indexOf(""))||(S=u.substring(0,S))!=h&&(h=S,g.clear()),g.containsKey(u)||(d=!0,g.add(u,u))),this.matrix.linePlacement[n]==kt.StiTableLineInfo.Data||w&&this.matrix.linePlacement[n]==kt.StiTableLineInfo.FooterD||d){for(var o=0,a,s;o<this.matrix.coordX.countItems-1;o++){this.matrix.cells[i][o]=this.matrix.cells[n][o],null!=(a=this.matrix.cells[i][o])&&(a.top=i,null!=a.exportImage&&(s=a.component)),0!=i&&null==this.matrix.bordersX[n][o]||(this.matrix.bordersX[i][o]=this.matrix.bordersX[n][o]),this.matrix.bordersX[i+1][o]=this.matrix.bordersX[n+1][o],this.matrix.bordersY[i][o]=this.matrix.bordersY[n][o],this.matrix.bookmarks[i][o]=this.matrix.bookmarks[n][o]}this.matrix.bordersY[i][this.matrix.coordX.countItems-1]=this.matrix.bordersY[n][this.matrix.coordX.countItems-1];var l=this.matrix.coordY.getKeys(),m=this.matrix.coordY.getByIndex(n+1,l)-this.matrix.coordY.getByIndex(n,l);this.matrix.coordY.setByIndex(i+1,this.matrix.coordY.getByIndex(i,l)+m),i++}}if(0<(c=this.matrix.coordY.countItems-1-i))for(var p=0;p<c;p++)this.matrix.coordY.removeByIndex(i+1)}},r.prototype.convertAllowHtmlTagsToExcelString=function(t,e){for(var r=new _t(Yt.UTF8),i=new h(t.font.bold,t.font.italic,t.font.underline,t.font.strikeout,t.font.sizeInPoints,t.font.name,c.toColor(t.textBrush),c.toColor(t.brush),!1,!1,0,0,1,t.horAlignment),i=new g(i,0),n=p.parseHtmlToStates(t.text,i),o=0;o<n.length;o++){var a=n[o];r.writeStartElement("r"),r.writeStartElement("rPr"),a.ts.bold&&r.writeElementString("b",null),a.ts.italic&&r.writeElementString("i",null),a.ts.underline&&r.writeElementString("u",null),a.ts.strikeout&&r.writeElementString("strike",null),a.ts.superscript&&(r.writeStartElement("vertAlign"),r.writeAttributeString("val","superscript"),r.writeEndElement()),a.ts.subsript&&(r.writeStartElement("vertAlign"),r.writeAttributeString("val","subscript"),r.writeEndElement()),r.writeStartElement("sz"),r.writeAttributeString("val",a.ts.fontSize.toString()),r.writeEndElement(),r.writeStartElement("color"),r.writeAttributeString("rgb",Ot.format("{0:X8}",a.ts.fontColor.toArgb())),r.writeEndElement(),r.writeStartElement("rFont"),r.writeAttributeString("val",a.ts.fontName),r.writeEndElement(),r.writeEndElement(),this.convertTextToExcelString(r,p.prepareStateText(a.text).toString()),r.writeEndElement()}return r.flush(),r.close(),r.textWriter.getStringBuilder().toString()},r.prototype.convertTextToExcelString=function(t,e){t.writeStartElement("t"),0<e.length&&(Ht.isWhitespace(e,e.length-1)||-1!=e.indexOf("\n"))&&t.writeAttributeString("xml:space","preserve"),t.writeString(e),t.writeFullEndElement()},r.prototype.writeDrawingRels=function(t){var e=new Vt,r=new _t(Yt.UTF8,e);r.writeStartDocument(),r.writeStartElement("Relationships"),r.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships");for(var i=this.imageListOffset;i<this.imageList.length;i++){var n=this.imageList[i];r.writeStartElement("Relationship"),r.writeAttributeString("Id",Ot.format("rId{0}",i-this.imageListOffset+1)),r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"),r.writeAttributeString("Target",Ot.format("../media/image{0:D5}.jpeg",n.ImageIndex+1)),r.writeEndElement(),Ot.isNullOrWhiteSpace(n.Hyperlink)||(r.writeStartElement("Relationship"),r.writeAttributeString("Id",Ot.format("hId{0}",i-this.imageListOffset+1)),r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"),r.writeAttributeString("Target",n.Hyperlink),r.writeAttributeString("TargetMode","External"),r.writeEndElement())}return r.writeFullEndElement(),r.writeEndDocument(),r.flush(),e},r.prototype.writeDrawing=function(t){var e=new Vt,r=new _t(Yt.UTF8,e);r.writeStartDocument(),r.writeStartElement("xdr:wsDr"),r.writeAttributeString("xmlns:xdr","http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing"),r.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main");for(var i=this.imageListOffset;i<this.imageList.length;i++){var n=this.imageList[i];r.writeStartElement("xdr:twoCellAnchor"),r.writeAttributeString("editAs","oneCell"),r.writeStartElement("xdr:from"),r.writeElementString("xdr:col",Ot.format("{0}",n.FirstColumnIndex)),r.writeElementString("xdr:colOff",Ot.format("{0}",n.FirstColumnOffset)),r.writeElementString("xdr:row",Ot.format("{0}",n.FirstRowIndex)),r.writeElementString("xdr:rowOff",Ot.format("{0}",n.FirstRowOffset)),r.writeEndElement(),r.writeStartElement("xdr:to"),r.writeElementString("xdr:col",Ot.format("{0}",n.LastColumnIndex)),r.writeElementString("xdr:colOff",Ot.format("{0}",n.LastColumnOffset)),r.writeElementString("xdr:row",Ot.format("{0}",n.LastRowIndex)),r.writeElementString("xdr:rowOff",Ot.format("{0}",n.LastRowOffset)),r.writeEndElement(),r.writeStartElement("xdr:pic"),r.writeStartElement("xdr:nvPicPr"),r.writeStartElement("xdr:cNvPr"),r.writeAttributeString("id",Ot.format("{0}",i-this.imageListOffset+2)),r.writeAttributeString("name",Ot.format("Picture {0}",i-this.imageListOffset+1)),r.writeAttributeString("descr",Ot.format("image{0:D5}",i+1)),Ot.isNullOrWhiteSpace(n.Hyperlink)||(r.writeStartElement("a:hlinkClick"),r.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),r.writeAttributeString("r:id",Ot.format("hId{0}",i-this.imageListOffset+1)),r.writeEndElement()),r.writeEndElement(),r.writeStartElement("xdr:cNvPicPr"),r.writeStartElement("a:picLocks"),r.writeAttributeString("noChangeAspect","1"),r.writeEndElement(),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("xdr:blipFill"),r.writeStartElement("a:blip"),r.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),r.writeAttributeString("r:embed",Ot.format("rId{0}",i-this.imageListOffset+1)),r.writeEndElement(),r.writeStartElement("a:stretch"),r.writeStartElement("a:fillRect"),r.writeEndElement(),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("xdr:spPr"),r.writeStartElement("a:xfrm"),r.writeStartElement("a:off"),r.writeAttributeString("x","1"),r.writeAttributeString("y","1"),r.writeEndElement(),r.writeStartElement("a:ext"),r.writeAttributeString("cx","2"),r.writeAttributeString("cy","2"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("a:prstGeom"),r.writeAttributeString("prst","rect"),r.writeStartElement("a:avLst"),r.writeEndElement(),r.writeEndElement(),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("xdr:clientData"),r.writeEndElement(),r.writeEndElement()}return r.writeFullEndElement(),r.writeEndDocument(),r.flush(),e},r.prototype.writeStyles=function(){var t=new Vt,e=new _t(Yt.UTF8,t);if(e.writeStartDocument(),e.writeStartElement("styleSheet"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/spreadsheetml/2006/main"),0<this.formatList.length){e.writeStartElement("numFmts"),e.writeAttributeString("count",Ot.format("{0}",this.formatList.length));for(var r=0;r<this.formatList.length;r++)e.writeStartElement("numFmt"),e.writeAttributeString("numFmtId",Ot.format("{0}",164+r)),e.writeAttributeString("formatCode",this.formatList[r]),e.writeEndElement();e.writeEndElement()}e.writeStartElement("fonts"),e.writeAttributeString("count",Ot.format("{0}",this.fontList.length));for(var r=0;r<this.fontList.length;r++){var i=this.fontList[r];e.writeStartElement("font"),i.Bold&&e.writeElementString("b",""),i.Italic&&e.writeElementString("i",""),i.Underlined&&e.writeElementString("u",""),i.Strikeout&&e.writeElementString("strike",""),e.writeStartElement("sz"),e.writeAttributeString("val",Ot.format("{0}",i.Height)),e.writeEndElement(),e.writeStartElement("color"),e.writeAttributeString("rgb",Ot.format("{0:X8}",i.Color.toArgb())),e.writeEndElement(),e.writeStartElement("name"),e.writeAttributeString("val",i.Name),e.writeEndElement(),e.writeStartElement("charset"),e.writeAttributeString("val",Ot.format("{0}",i.Charset)),e.writeEndElement(),e.writeEndElement()}e.writeEndElement(),e.writeStartElement("fills"),e.writeAttributeString("count",Ot.format("{0}",this.fillList.length));for(var r=0;r<this.fillList.length;r++){var n=this.fillList[r];e.writeStartElement("fill"),e.writeStartElement("patternFill"),e.writeAttributeString("patternType",n.Type),"solid"==n.Type&&(e.writeStartElement("fgColor"),e.writeAttributeString("rgb",Ot.format("{0:X8}",n.FgColor.toArgb())),e.writeEndElement(),e.writeStartElement("bgColor"),e.writeAttributeString("indexed",Ot.format("{0}",64)),e.writeEndElement()),e.writeEndElement(),e.writeEndElement()}e.writeEndElement(),e.writeStartElement("borders"),e.writeAttributeString("count",Ot.format("{0}",this.borderList.length));for(var r=0;r<this.borderList.length;r++){var o=this.borderList[r];e.writeStartElement("border"),this.writeBorderData(e,"left",o.BorderLeft),this.writeBorderData(e,"right",o.BorderRight),this.writeBorderData(e,"top",o.BorderTop),this.writeBorderData(e,"bottom",o.BorderBottom),this.writeBorderData(e,"diagonal",null),e.writeEndElement()}e.writeEndElement(),e.writeStartElement("cellStyleXfs"),e.writeAttributeString("count",Ot.format("{0}",1)),e.writeStartElement("xf"),e.writeAttributeString("numFmtId",Ot.format("{0}",0)),e.writeAttributeString("fontId",Ot.format("{0}",0)),e.writeAttributeString("fillId",Ot.format("{0}",0)),e.writeAttributeString("borderId",Ot.format("{0}",0)),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cellXfs"),e.writeAttributeString("count",Ot.format("{0}",this.xfList.length));for(var r=0;r<this.xfList.length;r++){var a=this.xfList[r],n=this.fillList[a.FillIndex],s=a.FillIndex;0==n.FgColor.a&&(s=0),e.writeStartElement("xf"),e.writeAttributeString("numFmtId",Ot.format("{0}",a.FormatIndex)),e.writeAttributeString("fontId",Ot.format("{0}",a.FontIndex)),e.writeAttributeString("fillId",Ot.format("{0}",s)),e.writeAttributeString("borderId",Ot.format("{0}",a.BorderIndex)),e.writeAttributeString("xfId",Ot.format("{0}",a.XFId)),0!=a.FormatIndex&&e.writeAttributeString("applyNumberFormat","1"),0!=a.FontIndex&&e.writeAttributeString("applyFont","1"),0!=a.FillIndex&&e.writeAttributeString("applyFill","1"),0!=a.BorderIndex&&e.writeAttributeString("applyBorder","1"),e.writeAttributeString("applyAlignment","1"),a.Editable&&e.writeAttributeString("applyProtection","1"),e.writeStartElement("alignment");var s="left";switch(a.HorAlign){case l.Right:s="right";break;case l.Center:s="center";break;case l.Width:s="justify";break}if(e.writeAttributeString("horizontal",s),a.VertAlign!=m.Bottom){var s="";switch(a.VertAlign){case m.Top:s="top";break;case m.Center:s="center";break}e.writeAttributeString("vertical",s)}0!=a.TextRotationAngle&&e.writeAttributeString("textRotation",a.TextRotationAngle.toString()),a.TextWrapped&&e.writeAttributeString("wrapText","1"),a.RightToLeft&&e.writeAttributeString("readingOrder","2"),e.writeEndElement(),a.Editable&&(e.writeStartElement("protection"),e.writeAttributeString("locked","0"),e.writeEndElement()),e.writeEndElement()}return e.writeEndElement(),e.writeStartElement("cellStyles"),e.writeAttributeString("count",Ot.format("{0}",1)),e.writeStartElement("cellStyle"),e.writeAttributeString("name","Normal"),e.writeAttributeString("xfId",Ot.format("{0}",0)),e.writeAttributeString("builtinId",Ot.format("{0}",0)),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("dxfs"),e.writeAttributeString("count",Ot.format("{0}",0)),e.writeEndElement(),e.writeStartElement("tableStyles"),e.writeAttributeString("count",Ot.format("{0}",0)),e.writeAttributeString("defaultTableStyle","TableStyleMedium9"),e.writeAttributeString("defaultPivotStyle","PivotStyleLight16"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},r.prototype.writeBorderData=function(t,e,r){var e,r;t.writeStartElement(e),null!=r&&(e=this.getLineStyle(r),r=r.color,""!=e&&(t.writeAttributeString("style",e),t.writeStartElement("color"),t.writeAttributeString("rgb",Ot.format("{0:X8}",r.toArgb())),t.writeEndElement())),t.writeEndElement()},r.prototype.writeSST=function(){var t=new Vt,e=new _t(Yt.UTF8,t);e.writeStartDocument(),e.writeStartElement("sst"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/spreadsheetml/2006/main"),e.writeAttributeString("count",Ot.format("{0}",this.sstCount)),e.writeAttributeString("uniqueCount",Ot.format("{0}",this.sstList.length));for(var r=0;r<this.sstList.length;r++){e.writeStartElement("si");for(var i=this.sstList[r],n=new Xt,o=0;o<i.length;o++)(32<=i.charCodeAt(o)||"\n"==i.charAt(o))&&n.append(i.charAt(o));i=n.toString(),this.sstHashIsTags.containsKey(r)?e.writeRaw(i):this.convertTextToExcelString(e,i),e.writeEndElement()}return e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},r.prototype.writeAdditionalData=function(t,e){var r=new Vt,i=null,i=e?re.System.Convert.fromBase64String(t):Yt.ASCII.getBytes(t);return r.write(i,0,i.length),r},r.prototype.writeImage=function(t){var e=new Vt,r=this.imageList[t],t=this.imageCache.imagePackedStore[t];return null!=t&&e.write(t,0,t.length),e},r.prototype.exportExcel=function(t,e,r){ie.StiLogService.write(this.stimulsoft.getType(),"Export report to Excel 2007 format");var i=r.pageRange;this.useOnePageHeaderAndFooter=r.useOnePageHeaderAndFooter,this.exportDataOnly=r.exportDataOnly,this.exportObjectFormatting=r.exportObjectFormatting,this.exportEachPageToSheet=r.exportEachPageToSheet,this.exportHorizontalPageBreaks=r.exportPageBreaks,this.imageResolution=r.imageResolution,this.imageQuality=r.imageQuality,this.docCompanyString=r.companyString,this.docLastModifiedString=r.lastModifiedString,this.restrictEditing=r.restrictEditing,this.xmlIndentation=-1,this.imageResolution<10&&(this.imageResolution=10),this.imageResolution=this.imageResolution/100,this.exportDataOnly?this.useOnePageHeaderAndFooter=!1:this.exportObjectFormatting=!0,re["StiOptions"].Export.Excel.RestrictEditing>this.restrictEditing&&(this.restrictEditing=re["StiOptions"].Export.Excel.RestrictEditing),this.report=t;try{this.reportCulture=x.currentCulture;var n=i.getSelectedPages(t.renderedPages);this.currentPassNumber=0,this.maximumPassNumber=3,this.prepareData();var o=0;while(o<n.length){var a=new b(t,t.renderedPages);a.cacheMode=t.renderedPages.cacheMode,a.addV2Internal(n.getPageWithoutCache(o));var s=o;if(!this.exportEachPageToSheet){var l=n.getPageWithoutCache(o).excelSheetValue;while(o<n.length-1&&this.compareExcellSheetNames(n.getPageWithoutCache(o+1).excelSheetValue,l))o++,a.addV2Internal(n.getPageWithoutCache(o))}var m=a.getByIndex(0).excelSheetValue;null!=m&&""!=m||(m=Ot.format("Page {0}",this.sheetNameList.length+1));var c="",p=1;this.prepareMatrix(a);var g=0;do{this.firstPageIndexList.push(s),this.matrixList.push(this.matrix);var h=this.matrix.coordY.countItems-1;h-g>re["StiOptions"].Export.Excel.MaximumSheetHeight?h=g+re["StiOptions"].Export.Excel.MaximumSheetHeight:this.matrix=null,this.minRowList.push(g),this.maxRowList.push(h),g=h,null!=this.matrix||0<c.length?(c=Ot.format(" part{0}",p++),24<m.length&&(m=m.substr(0,24))):30<m.length&&(m=m.substr(0,30)),this.sheetNameList.push(m+c)}while(null!=this.matrix);o++}for(var w=new E,d=0;d<this.sheetNameList.length;d++){var u,u=(u=this.sheetNameList[d]).stimulsoft.replaceAll("*","_").stimulsoft.replaceAll("\\","_").stimulsoft.replaceAll("/","_").stimulsoft.replaceAll("[","_").stimulsoft.replaceAll("]","_").stimulsoft.replaceAll(":","_").stimulsoft.replaceAll("?","_");if(w.contains(u)){var S=1;while(w.contains(u+"-"+S.toString()))S++;u=u+"-"+S.toString()}w.add(u,u),this.sheetNameList[d]=u}var f=new y;f.begin(e,!0),this.currentPassNumber=2;for(var v=this.imageListOffset=0;v<this.matrixList.length;v++)this.hyperlinkList=[],f.addFile(Ot.format("xl/worksheets/sheet{0}.xml",v+1),this.writeSheet(v,n.getByIndex(this.firstPageIndexList[v]))),f.addFile(Ot.format("xl/worksheets/_rels/sheet{0}.xml.rels",v+1),this.writeSheetRels(v)),0<this.imageList.length-this.imageListOffset&&(f.addFile(Ot.format("xl/drawings/_rels/drawing{0}.xml.rels",v+1),this.writeDrawingRels(v)),f.addFile(Ot.format("xl/drawings/drawing{0}.xml",v+1),this.writeDrawing(v))),this.imageListOffset=this.imageList.length;if(f.addFile("[Content_Types].xml",this.writeContentTypes()),f.addFile("_rels/.rels",this.writeMainRels()),f.addFile("docProps/app.xml",this.writeDocPropsApp()),f.addFile("docProps/core.xml",this.writeDocPropsCore()),f.addFile("xl/_rels/workbook.xml.rels",this.writeWorkbookRels()),f.addFile("xl/workbook.xml",this.writeWorkbook()),f.addFile("xl/styles.xml",this.writeStyles()),0<this.sstList.length&&f.addFile("xl/sharedStrings.xml",this.writeSST()),0<this.imageCache.imagePackedStore.length)for(var d=0;d<this.imageCache.imagePackedStore.length;d++)f.addFile(Ot.format("xl/media/image{0:D5}.jpeg",d+1),this.writeImage(d));re.Base.vEIvF.JlKzR.RNAxU()||re.Base.vEIvF.JlKzR.KqUvN()||(re.Base.vEIvF.JlKzR.ZHIhL()||re.Base.vEIvF.JlKzR.LuQMU()||re.Base.vEIvF.JlKzR.UPtPa())&&re.System.NodeJs.isStandaloneVersion||(f.addFile("xl/media/imageAdditional.png",this.writeAdditionalData(kt.StiExportUtils.additionalData,!0)),f.addFile("xl/drawings/_rels/vmlDrawingAdditional.vml.rels",this.writeAdditionalData('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="dId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image" Target="../media/imageAdditional.png"/></Relationships>',!1)),f.addFile("xl/drawings/vmlDrawingAdditional.vml",this.writeAdditionalData('<xml xmlns:v="urn:schemas-microsoft-com:vml"\r\n xmlns:o="urn:schemas-microsoft-com:office:office"\r\n xmlns:x="urn:schemas-microsoft-com:office:excel">\r\n <o:shapelayout v:ext="edit">\r\n  <o:idmap v:ext="edit" data="1"/>\r\n'+' </o:shapelayout><v:shapetype id="_x0000_t75" coordsize="21600,21600" o:spt="75"\r\n  o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f">\r\n  <v:stroke joinstyle="miter"/>\r\n  <v:formulas>'+'\r\n   <v:f eqn="if lineDrawn pixelLineWidth 0"/>\r\n   <v:f eqn="sum @0 1 0"/>\r\n   <v:f eqn="sum 0 0 @1"/>\r\n   <v:f eqn="prod @2 1 2"/>\r\n   <v:f eqn="prod @3 21600 pixelWidth"/>\r\n   <v:f eqn="prod @3 21600 pixelHeight"/>\r\n   <v:f eqn="sum @0 0 1"/>'+'\r\n   <v:f eqn="prod @6 1 2"/>\r\n   <v:f eqn="prod @7 21600 pixelWidth"/>\r\n   <v:f eqn="sum @8 21600 0"/>\r\n   <v:f eqn="prod @7 21600 pixelHeight"/>\r\n   <v:f eqn="sum @10 21600 0"/>\r\n  </v:formulas>\r\n  <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>'+'\r\n  <o:lock v:ext="edit" aspectratio="t"/>\r\n </v:shapetype><v:shape id="CH" o:spid="_x0000_s1027" type="#_x0000_t75"\r\n  style=\'position:absolute;margin-left:0;margin-top:0;width:365pt;height:298pt;\r\n  z-index:1\'>'+'\r\n  <v:imagedata o:relid="dId1" o:title="additional"/>\r\n  <o:lock v:ext="edit" rotation="t"/>\r\n </v:shape></xml>',!1))),f.end()}catch(t){re.System.StiError.showError(t,!1)}finally{null!=this.matrix&&(this.matrix.clear(),this.matrix=null),this.fontList=null,this.fillList=null,this.borderList=null,this.xfList=null,this.sstList=null,this.sstHash=null,this.sstHashIsTags=null,this.formatList=null,this.sheetNameList=null,this.imageList.stimulsoft.clear(),this.imageList=null,this.imageCache.clear(),this.printAreasList=null,this.matrixList=null,this.firstPageIndexList=null,this.hyperlinkList=null,this.minRowList=null,this.maxRowList=null}},r.regexCheckInteger1=new RegExp("^[+-]?d+$"),r.regexCheckFloat1=new RegExp("^[+-]?([0-9]+([.][0-9]*)?|[.][0-9]+)$"),r),e;function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.matrix=null,t.fontList=null,t.fillList=null,t.borderList=null,t.xfList=null,t.sstList=null,t.sstHash=null,t.sstHashIsTags=null,t.imageList=null,t.formatList=null,t.sstCount=0,t.sheetNameList=null,t.imageListOffset=0,t.printAreasList=null,t.matrixList=null,t.firstPageIndexList=null,t.hyperlinkList=null,t.minRowList=null,t.maxRowList=null,t.useOnePageHeaderAndFooter=!1,t.exportDataOnly=!1,t.exportObjectFormatting=!0,t.exportEachPageToSheet=!1,t.exportHorizontalPageBreaks=!1,t.imageResolution=1,t.imageQuality=.75,t.imageCache=null,t.restrictEditing=kt.StiExcel2007RestrictEditing.No,t.reportCulture=null,t.docCompanyString=null,t.docLastModifiedString=null,t.xmlIndentation=1,t.wrongUrlSymbols=" \"#'*,;<>[^`{|}",t.refChars="ABCDEFGHIJKLMNOPQRSTUVWXYZ",t.HiToTwips=14.4/20*1.01,t.TwipsToColinfo=2.438*.976*.075,t}kt.StiExcel2007ExportService=t;var Kt=(n.prototype.equals=function(t){return this.Name==t.Name&&this.Bold==t.Bold&&this.Italic==t.Italic&&this.Underlined==t.Underlined&&this.Strikeout==t.Strikeout&&this.Height==t.Height&&this.Color.equals(t.Color)&&this.Charset==t.Charset&&this.Family==t.Family},n);function n(t,e,r,i,n,o,a,s,l){this.Name=t,this.Bold=e,this.Italic=r,this.Underlined=i,this.Strikeout=n,this.Height=o,this.Color=a,this.Charset=s,this.Family=l}kt.DataFont=Kt;var Jt=(w.prototype.equals=function(t){return this.Type==t.Type&&this.FgColor.equals(t.FgColor)&&this.BgColor.equals(t.BgColor)},w);function w(t,e,r){this.Type=t,this.FgColor=e,this.BgColor=r}kt.DataFill=Jt;var Qt=(d.prototype.equals=function(t){return this.eq(this.BorderLeft,t.BorderLeft)&&this.eq(this.BorderRight,t.BorderRight)&&this.eq(this.BorderTop,t.BorderTop)&&this.eq(this.BorderBottom,t.BorderBottom)},d.prototype.eq=function(t,e){return null==t&&null==e||null!=t&&null!=e&&t.stimulsoft.equals(e)},d);function d(t,e,r,i){this.BorderLeft=t,this.BorderRight=e,this.BorderTop=r,this.BorderBottom=i}kt.DataBorder=Qt;var Zt=(u.prototype.equalDataXF=function(t){if(this.FormatIndex!=t.FormatIndex||this.FontIndex!=t.FontIndex||this.FillIndex!=t.FillIndex||this.BorderIndex!=t.BorderIndex||this.XFId!=t.XFId||this.HorAlign!=t.HorAlign||this.VertAlign!=t.VertAlign||this.TextRotationAngle!=t.TextRotationAngle||this.TextWrapped!=t.TextWrapped||this.RightToLeft!=t.RightToLeft||this.Editable!=t.Editable)return!1;return!0},u);function u(t,e,r,i,n,o,a,s,l,m,c){this.FormatIndex=t,this.FontIndex=e,this.FillIndex=r,this.BorderIndex=i,this.XFId=n,this.HorAlign=o,this.VertAlign=a,this.TextRotationAngle=s,this.TextWrapped=l,this.RightToLeft=m,this.Editable=c}kt.DataXF=Zt;var $t=S;function S(t,e,r,i,n,o,a,s,l,m){this.FirstRowIndex=t,this.FirstRowOffset=e,this.FirstColumnIndex=r,this.FirstColumnOffset=i,this.LastRowIndex=n,this.LastRowOffset=o,this.LastColumnIndex=a,this.LastColumnOffset=s,this.ImageIndex=l,this.Hyperlink=m}kt.ExcelImageData=$t;var te=f;function f(t,e,r,i){this.FirstRow=t,this.LastRow=e,this.FirstColumn=r,this.LastColumn=i}kt.CellRangeAddress=te;var ee=v;function v(t,e,r){this.Range=t,this.Description=e,this.Bookmark=r}kt.HlinkData=ee}(e=ie.Export||(ie.Export={}))}(Stimulsoft=Stimulsoft||{}),function(t){var e,t,r,i,n;function o(){return null!==n&&n.apply(this,arguments)||this}t=e=t.Report||(t.Report={}),i=r=t.Export||(t.Export={}),n=i.StiExportService,__extends(o,n),o.prototype.implements=function(){return[i.IStiExcelXmlExportService]},t=o,i.StiExcelXmlExportService=t}(Stimulsoft=Stimulsoft||{}),function(w){var t,m,e,r,n,l,c,p,g,i,o,h,d,u,S,f,v,E,b,y,s,x,A,T,P,L,a,C,F,R,I,B,D,k,N,O,M,H,U,z;function X(){var t=null!==z&&z.apply(this,arguments)||this;return t.imageListOffset=0,t.imageResolution=1,t.imageQuality=.75,t.imageCache=null,t.idCounter=2,t.hyperlinkList=null,t.xmlIndentation=1,t.currentCulture=null,t.newCulture=null,t.wrongUrlSymbols=" \"#'*,;<>[^`{|}",t.HiToTwips=14.4*.995,t}m=t=w.Report||(w.Report={}),r=e=m.Export||(m.Export={}),n=w.System.Drawing.Rectangle,l=w.System.Drawing.Color,c=w.Base.Drawing.StiPenStyle,p=w.Base.Zip.StiZipWriter20,g=w.Report.Components.StiImage,i=w.Base.Drawing.StiHorAlignment,o=w.Base.Drawing.StiCapStyle,h=w.Report.Components.StiVerticalLinePrimitive,d=w.Report.Components.StiHorizontalLinePrimitive,u=w.Base.Drawing.StiAdvancedBorder,S=w.Base.Drawing.StiBorderSides,f=w.Report.Components.IStiBorder,v=w.Report.Components.StiShape,E=w.Report.Components.IStiBrush,b=w.Report.Components.IStiTextOptions,y=w.Report.Components.StiLinePrimitive,s=w.Report.Components.IStiExportImageExtended,x=w.Base.Drawing.StiTextRenderer,A=w.Report.Components.StiTextQuality,T=w.Base.Drawing.StiBrush,P=w.Report.Components.StiContainer,L=w.Report.Components.StiText,a=w.System.DateTime,C=w.System.StiString,F=w.System.Text.StringBuilder,R=w.System.Globalization.CultureInfo,I=w.System.Xml.Formatting,B=w.System.Text.Encoding,D=w.System.Xml.XmlTextWriter,k=w.Report.Dashboard.StiDashboardExport,N=w.Report.Dashboard.IStiDashboard,O=w.System.IO.MemoryStream,M=w.Base.Drawing.StiTextHorAlignment,H=w.Base.Drawing.StiVertAlignment,z=r.StiExportService,__extends(X,z),X.prototype.implements=function(){return[r.IStiPpt2007ExportService]},X.prototype.getDefaultExtension=function(){return"pptx"},X.prototype.exportTo=function(t,e,r){this.exportPowerPoint(t,e,r)},X.prototype.exportToAsync=function(t,e,r,i){var n=this;w.Report.Export.StiExportImageHelper.convertAllImages(e,w["StiOptions"].Export.PowerPoint.StoreImagesAsPng?w.System.Drawing.Imaging.ImageFormat.Png:w.System.Drawing.Imaging.ImageFormat.Jpeg).try(function(){if(!e.isDocument&&e.getCurrentPage().is(N))return void k.exportAsync(e,r,i).try(function(){return t()});n.exportTo(e,r,i),null!=e&&null!=e.preparedExportImages&&(e.preparedExportImages.clear(),e.preparedExportImages=null),t()})},X.prototype.getLineStyle=function(t){switch(t){case c.Solid:return"solid";case c.Dot:return"sysDot";case c.Dash:return"sysDash";case c.DashDot:return"sysDashDot";case c.DashDotDot:return"sysDashDotDot";case c.Double:return"solid";default:return"solid"}},X.prototype.stringToUrl=function(t){var e,r,i=B.UTF8.getBytes(t),n=new F;try{for(var o=__values(i),a=o.next();!a.done;a=o.next()){var s=a.value,l=String.fromCharCode(s);s<32||127<s||-1!=this.wrongUrlSymbols.indexOf(l)?n.append(C.format("%{0:x2}",s)):n.append(l)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return n.toString()},X.prototype.convert=function(t){return 0|Math.round(t*this.HiToTwips)},X.prototype.convertTwipsToEmu=function(t){return 0|Math.round(t/this.HiToTwips/100*914400)},X.prototype.convertToEmu=function(t){return 0|Math.round(t/100*914400)},X.prototype.writeColor=function(t,e){var e;t.writeStartElement("a:srgbClr"),t.writeAttributeString("val",C.format("{0:X6}",16777215&e.toArgb())),255!=e.a&&(e=e.a/256*1e5|0,t.writeStartElement("a:alpha"),t.writeAttributeString("val",C.format("{0}",e)),t.writeEndElement()),t.writeEndElement()},X.prototype.writeContentTypes=function(t){var e=new O,r=new D(B.UTF8,e);r.indentation=this.xmlIndentation<0?0:this.xmlIndentation,r.formatting=this.xmlIndentation<0?I.None:I.Indented,r.writeStartDocument(),r.writeStartElement("Types"),r.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/content-types");for(var i=0;i<11;i++)r.writeStartElement("Override"),r.writeAttributeString("PartName",C.format("/ppt/slideLayouts/slideLayout{0}.xml",i+1)),r.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.slideLayout+xml"),r.writeEndElement();r.writeStartElement("Override"),r.writeAttributeString("PartName","/ppt/slideMasters/slideMaster1.xml"),r.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.slideMaster+xml"),r.writeEndElement(),r.writeStartElement("Override"),r.writeAttributeString("PartName","/ppt/presProps.xml"),r.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.presProps+xml"),r.writeEndElement();for(var i=0;i<t;i++)r.writeStartElement("Override"),r.writeAttributeString("PartName",C.format("/ppt/slides/slide{0}.xml",i+1)),r.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.slide+xml"),r.writeEndElement();return r.writeStartElement("Override"),r.writeAttributeString("PartName","/ppt/theme/theme1.xml"),r.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.theme+xml"),r.writeEndElement(),r.writeStartElement("Default"),r.writeAttributeString("Extension","jpeg"),r.writeAttributeString("ContentType","image/jpeg"),r.writeEndElement(),r.writeStartElement("Default"),r.writeAttributeString("Extension","png"),r.writeAttributeString("ContentType","image/png"),r.writeEndElement(),r.writeStartElement("Default"),r.writeAttributeString("Extension","rels"),r.writeAttributeString("ContentType","application/vnd.openxmlformats-package.relationships+xml"),r.writeEndElement(),r.writeStartElement("Default"),r.writeAttributeString("Extension","xml"),r.writeAttributeString("ContentType","application/xml"),r.writeEndElement(),r.writeStartElement("Override"),r.writeAttributeString("PartName","/ppt/presentation.xml"),r.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.presentation.main+xml"),r.writeEndElement(),r.writeStartElement("Override"),r.writeAttributeString("PartName","/docProps/app.xml"),r.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.extended-properties+xml"),r.writeEndElement(),r.writeStartElement("Override"),r.writeAttributeString("PartName","/ppt/tableStyles.xml"),r.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.tableStyles+xml"),r.writeEndElement(),r.writeStartElement("Override"),r.writeAttributeString("PartName","/ppt/viewProps.xml"),r.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.viewProps+xml"),r.writeEndElement(),r.writeStartElement("Override"),r.writeAttributeString("PartName","/docProps/core.xml"),r.writeAttributeString("ContentType","application/vnd.openxmlformats-package.core-properties+xml"),r.writeEndElement(),r.writeFullEndElement(),r.writeEndDocument(),r.flush(),e},X.prototype.writeMainRels=function(){var t=new O,e=new D(B.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?I.None:I.Indented,e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId1"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument"),e.writeAttributeString("Target","ppt/presentation.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId2"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties"),e.writeAttributeString("Target","docProps/core.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId3"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties"),e.writeAttributeString("Target","docProps/app.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},X.prototype.writeDocPropsApp=function(t){var e=new O,r=new D(B.UTF8,e);r.indentation=this.xmlIndentation<0?0:this.xmlIndentation,r.formatting=this.xmlIndentation<0?I.None:I.Indented,r.writeStartDocument(),r.writeStartElement("Properties"),r.writeAttributeString("xmlns","http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"),r.writeAttributeString("xmlns:vt","http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"),r.writeElementString("Application","Microsoft Office PowerPoint"),r.writeElementString("Slides",C.format("{0}",t)),r.writeElementString("PresentationFormat","On-screen Show (4:3)"),r.writeElementString("TotalTime","0"),r.writeElementString("Words","0"),r.writeElementString("Paragraphs","0"),r.writeElementString("Notes","0"),r.writeElementString("HiddenSlides","0"),r.writeElementString("MMClips","0"),r.writeElementString("ScaleCrop","false"),r.writeStartElement("HeadingPairs"),r.writeStartElement("vt:vector"),r.writeAttributeString("size","4"),r.writeAttributeString("baseType","variant"),r.writeStartElement("vt:variant"),r.writeElementString("vt:lpstr","Theme"),r.writeEndElement(),r.writeStartElement("vt:variant"),r.writeElementString("vt:i4",C.format("{0}",t)),r.writeEndElement(),r.writeStartElement("vt:variant"),r.writeElementString("vt:lpstr","Slide Titles"),r.writeEndElement(),r.writeStartElement("vt:variant"),r.writeElementString("vt:i4",C.format("{0}",t)),r.writeEndElement(),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("TitlesOfParts"),r.writeStartElement("vt:vector"),r.writeAttributeString("size",C.format("{0}",1+t)),r.writeAttributeString("baseType","lpstr"),r.writeElementString("vt:lpstr","Office Theme");for(var i=0;i<t;i++)r.writeElementString("vt:lpstr",C.format("Slide {0}",i+1));return r.writeEndElement(),r.writeEndElement(),r.writeElementString("Company","Stimulsoft"),r.writeElementString("LinksUpToDate","false"),r.writeElementString("SharedDoc","false"),r.writeElementString("HyperlinksChanged","false"),r.writeElementString("AppVersion","12.0000"),r.writeFullEndElement(),r.writeEndDocument(),r.flush(),e},X.prototype.writeDocPropsCore=function(){var t=new O,e=new D(B.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?I.None:I.Indented,e.writeStartDocument(),e.writeStartElement("cp:coreProperties"),e.writeAttributeString("xmlns:cp","http://schemas.openxmlformats.org/package/2006/metadata/core-properties"),e.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),e.writeAttributeString("xmlns:dcterms","http://purl.org/dc/terms/"),e.writeAttributeString("xmlns:dcmitype","http://purl.org/dc/dcmitype/"),e.writeAttributeString("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance");var r=C.format("{0}",a.now.toString("yyyy-MM-ddTHH:mm:ssZ"));return e.writeElementString("dc:title",""),e.writeElementString("dc:subject",""),e.writeElementString("dc:creator","Stimulsoft Reports"),e.writeElementString("cp:keywords",""),e.writeElementString("dc:description",""),e.writeElementString("cp:lastModifiedBy","Stimulsoft Reports"),e.writeElementString("cp:revision","1"),e.writeStartElement("dcterms:created"),e.writeAttributeString("xsi:type","dcterms:W3CDTF"),e.writeString(r),e.writeEndElement(),e.writeStartElement("dcterms:modified"),e.writeAttributeString("xsi:type","dcterms:W3CDTF"),e.writeString(r),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},X.prototype.writeTableStyles=function(){var t=new O,e=new D(B.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?I.None:I.Indented,e.writeStartDocument(),e.writeStartElement("a:tblStyleLst"),e.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),e.writeAttributeString("def","{5C22544A-7EE6-4342-B048-85BDC9FD1C3A}"),e.writeEndElement(),e.writeEndDocument(),e.flush(),t},X.prototype.writePresProps=function(){var t=new O,e=new D(B.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?I.None:I.Indented,e.writeStartDocument(),e.writeStartElement("p:presentationPr"),e.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeAttributeString("xmlns:p","http://schemas.openxmlformats.org/presentationml/2006/main"),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},X.prototype.writeViewProps=function(){var t=new O,e=new D(B.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?I.None:I.Indented,e.writeStartDocument(),e.writeStartElement("p:viewPr"),e.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeAttributeString("xmlns:p","http://schemas.openxmlformats.org/presentationml/2006/main"),e.writeStartElement("p:normalViewPr"),e.writeAttributeString("showOutlineIcons","0"),e.writeStartElement("p:restoredLeft"),e.writeAttributeString("sz","15591"),e.writeAttributeString("autoAdjust","0"),e.writeEndElement(),e.writeStartElement("p:restoredTop"),e.writeAttributeString("sz","94675"),e.writeAttributeString("autoAdjust","0"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("p:slideViewPr"),e.writeStartElement("p:cSldViewPr"),e.writeStartElement("p:cViewPr"),e.writeAttributeString("varScale","1"),e.writeStartElement("p:scale"),e.writeStartElement("a:sx"),e.writeAttributeString("n","107"),e.writeAttributeString("d","100"),e.writeEndElement(),e.writeStartElement("a:sy"),e.writeAttributeString("n","107"),e.writeAttributeString("d","100"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("p:origin"),e.writeAttributeString("x","-1098"),e.writeAttributeString("y","-84"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("p:guideLst"),e.writeStartElement("p:guide"),e.writeAttributeString("orient","horz"),e.writeAttributeString("pos","2160"),e.writeEndElement(),e.writeStartElement("p:guide"),e.writeAttributeString("pos","2880"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("p:notesTextViewPr"),e.writeStartElement("p:cViewPr"),e.writeStartElement("p:scale"),e.writeStartElement("a:sx"),e.writeAttributeString("n","100"),e.writeAttributeString("d","100"),e.writeEndElement(),e.writeStartElement("a:sy"),e.writeAttributeString("n","100"),e.writeAttributeString("d","100"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("p:origin"),e.writeAttributeString("x","0"),e.writeAttributeString("y","0"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("p:gridSpacing"),e.writeAttributeString("cx","73736200"),e.writeAttributeString("cy","73736200"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},X.prototype.writeTheme=function(){var t=new O,e=new D(B.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?I.None:I.Indented,e.writeStartDocument();var r='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"><a:themeElements><a:clrScheme name="Office"><a:dk1><a:sysClr val="windowText" lastClr="000000" /></a:dk1><a:lt1><a:sysClr val="window" lastClr="FFFFFF" /></a:lt1><a:dk2><a:srgbClr val="1F497D" /></a:dk2><a:lt2><a:srgbClr val="EEECE1" /></a:lt2><a:accent1><a:srgbClr val="4F81BD" /></a:accent1><a:accent2><a:srgbClr val="C0504D" /></a:accent2><a:accent3><a:srgbClr val="9BBB59" /></a:accent3><a:accent4>'+'<a:srgbClr val="8064A2" /></a:accent4><a:accent5><a:srgbClr val="4BACC6" /></a:accent5><a:accent6><a:srgbClr val="F79646" /></a:accent6><a:hlink><a:srgbClr val="0000FF" /></a:hlink><a:folHlink><a:srgbClr val="800080" /></a:folHlink></a:clrScheme><a:fontScheme name="Office"><a:majorFont><a:latin typeface="Calibri" /><a:ea typeface="" /><a:cs typeface="" /><a:font script="Jpan" typeface=" " /><a:font script="Hang" typeface=" " /><a:font script="Hans" typeface="" /><a:font script="Hant" typeface="" />'+'<a:font script="Arab" typeface="Times New Roman" /><a:font script="Hebr" typeface="Times New Roman" /><a:font script="Thai" typeface="Angsana New" /><a:font script="Ethi" typeface="Nyala" /><a:font script="Beng" typeface="Vrinda" /><a:font script="Gujr" typeface="Shruti" /><a:font script="Khmr" typeface="MoolBoran" /><a:font script="Knda" typeface="Tunga" /><a:font script="Guru" typeface="Raavi" /><a:font script="Cans" typeface="Euphemia" /><a:font script="Cher" typeface="Plantagenet Cherokee" /><a:font script="Yiii" typeface="Microsoft Yi Baiti" />'+'<a:font script="Tibt" typeface="Microsoft Himalaya" /><a:font script="Thaa" typeface="MV Boli" /><a:font script="Deva" typeface="Mangal" /><a:font script="Telu" typeface="Gautami" /><a:font script="Taml" typeface="Latha" /><a:font script="Syrc" typeface="Estrangelo Edessa" /><a:font script="Orya" typeface="Kalinga" /><a:font script="Mlym" typeface="Kartika" /><a:font script="Laoo" typeface="DokChampa" /><a:font script="Sinh" typeface="Iskoola Pota" /><a:font script="Mong" typeface="Mongolian Baiti" /><a:font script="Viet" typeface="Times New Roman" />'+'<a:font script="Uigh" typeface="Microsoft Uighur" /></a:majorFont><a:minorFont><a:latin typeface="Calibri" /><a:ea typeface="" /><a:cs typeface="" /><a:font script="Jpan" typeface=" " /><a:font script="Hang" typeface=" " /><a:font script="Hans" typeface="" /><a:font script="Hant" typeface="" /><a:font script="Arab" typeface="Arial" /><a:font script="Hebr" typeface="Arial" /><a:font script="Thai" typeface="Cordia New" /><a:font script="Ethi" typeface="Nyala" /><a:font script="Beng" typeface="Vrinda" />'+'<a:font script="Gujr" typeface="Shruti" /><a:font script="Khmr" typeface="DaunPenh" /><a:font script="Knda" typeface="Tunga" /><a:font script="Guru" typeface="Raavi" /><a:font script="Cans" typeface="Euphemia" /><a:font script="Cher" typeface="Plantagenet Cherokee" /><a:font script="Yiii" typeface="Microsoft Yi Baiti" /><a:font script="Tibt" typeface="Microsoft Himalaya" /><a:font script="Thaa" typeface="MV Boli" /><a:font script="Deva" typeface="Mangal" /><a:font script="Telu" typeface="Gautami" /><a:font script="Taml" typeface="Latha" />'+'<a:font script="Syrc" typeface="Estrangelo Edessa" /><a:font script="Orya" typeface="Kalinga" /><a:font script="Mlym" typeface="Kartika" /><a:font script="Laoo" typeface="DokChampa" /><a:font script="Sinh" typeface="Iskoola Pota" /><a:font script="Mong" typeface="Mongolian Baiti" /><a:font script="Viet" typeface="Arial" /><a:font script="Uigh" typeface="Microsoft Uighur" /></a:minorFont></a:fontScheme><a:fmtScheme name="Office"><a:fillStyleLst><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0">'+'<a:schemeClr val="phClr"><a:tint val="50000" /><a:satMod val="300000" /></a:schemeClr></a:gs><a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000" /><a:satMod val="300000" /></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000" /><a:satMod val="350000" /></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="1" /></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:shade val="51000" /><a:satMod val="130000" /></a:schemeClr></a:gs><a:gs pos="80000"><a:schemeClr val="phClr">'+'<a:shade val="93000" /><a:satMod val="130000" /></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="94000" /><a:satMod val="135000" /></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="0" /></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000" /><a:satMod val="105000" /></a:schemeClr></a:solidFill><a:prstDash val="solid" /></a:ln><a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr" /></a:solidFill>'+'<a:prstDash val="solid" /></a:ln><a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:prstDash val="solid" /></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000" /></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000" /></a:srgbClr></a:outerShdw></a:effectLst>'+'</a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000" /></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0" /></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000" /></a:lightRig></a:scene3d><a:sp3d><a:bevelT w="63500" h="25400" /></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:gradFill rotWithShape="1">'+'<a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000" /><a:satMod val="350000" /></a:schemeClr></a:gs><a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000" /><a:shade val="99000" /><a:satMod val="350000" /></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000" /><a:satMod val="255000" /></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000" /></a:path></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000" /><a:satMod val="300000" /></a:schemeClr>'+'</a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000" /><a:satMod val="200000" /></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000" /></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults /><a:extraClrSchemeLst /></a:theme>';return e.writeRaw(r),e.writeEndDocument(),e.flush(),t},X.prototype.writeSlideMasterRels=function(){var t=new O,e=new D(B.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?I.None:I.Indented,e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships");for(var r=0;r<11;r++)e.writeStartElement("Relationship"),e.writeAttributeString("Id",C.format("rId{0}",r+1)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout"),e.writeAttributeString("Target",C.format("../slideLayouts/slideLayout{0}.xml",r+1)),e.writeEndElement();return e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId12"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme"),e.writeAttributeString("Target","../theme/theme1.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},X.prototype.writeSlideMaster=function(){var t=new O,e=new D(B.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?I.None:I.Indented,e.writeStartDocument();var r='<p:sldMaster xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:p="http://schemas.openxmlformats.org/presentationml/2006/main"><p:cSld><p:bg><p:bgRef idx="1001"><a:schemeClr val="bg1" /></p:bgRef></p:bg><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" />'+'<a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title Placeholder 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="274638" /><a:ext cx="8229600" cy="1143000" /></a:xfrm><a:prstGeom prst="rect"><a:avLst /></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert="horz" lIns="91440" tIns="45720" rIns="91440" bIns="45720" rtlCol="0" anchor="ctr">'+'<a:normAutofit /></a:bodyPr><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Text Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="1600200" /><a:ext cx="8229600" cy="4525963" /></a:xfrm><a:prstGeom prst="rect">'+'<a:avLst /></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert="horz" lIns="91440" tIns="45720" rIns="91440" bIns="45720" rtlCol="0"><a:normAutofit /></a:bodyPr><a:lstStyle /><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" />'+'<a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Date Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="2" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm>'+'<a:off x="457200" y="6356350" /><a:ext cx="2133600" cy="365125" /></a:xfrm><a:prstGeom prst="rect"><a:avLst /></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert="horz" lIns="91440" tIns="45720" rIns="91440" bIns="45720" rtlCol="0" anchor="ctr" /><a:lstStyle><a:lvl1pPr algn="l"><a:defRPr sz="1200"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr></a:lstStyle><a:p>'+'<a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Footer Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="3" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="3124200" y="6356350" /><a:ext cx="2895600" cy="365125" /></a:xfrm>'+'<a:prstGeom prst="rect"><a:avLst /></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert="horz" lIns="91440" tIns="45720" rIns="91440" bIns="45720" rtlCol="0" anchor="ctr" /><a:lstStyle><a:lvl1pPr algn="ctr"><a:defRPr sz="1200"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr></a:lstStyle><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Slide Number Placeholder 5" />'+'<p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="4" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="6553200" y="6356350" /><a:ext cx="2133600" cy="365125" /></a:xfrm><a:prstGeom prst="rect"><a:avLst /></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert="horz" lIns="91440" tIns="45720" rIns="91440" bIns="45720" rtlCol="0" anchor="ctr" /><a:lstStyle><a:lvl1pPr algn="r"><a:defRPr sz="1200"><a:solidFill><a:schemeClr val="tx1">'+'<a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr></a:lstStyle><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>#</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld><p:clrMap bg1="lt1" tx1="dk1" bg2="lt2" tx2="dk2" accent1="accent1" accent2="accent2" accent3="accent3" accent4="accent4" accent5="accent5" accent6="accent6" hlink="hlink" folHlink="folHlink" />'+'<p:sldLayoutIdLst><p:sldLayoutId id="2147483649" r:id="rId1" /><p:sldLayoutId id="2147483650" r:id="rId2" /><p:sldLayoutId id="2147483651" r:id="rId3" /><p:sldLayoutId id="2147483652" r:id="rId4" /><p:sldLayoutId id="2147483653" r:id="rId5" /><p:sldLayoutId id="2147483654" r:id="rId6" /><p:sldLayoutId id="2147483655" r:id="rId7" /><p:sldLayoutId id="2147483656" r:id="rId8" /><p:sldLayoutId id="2147483657" r:id="rId9" /><p:sldLayoutId id="2147483658" r:id="rId10" />'+'<p:sldLayoutId id="2147483659" r:id="rId11" /></p:sldLayoutIdLst><p:txStyles><p:titleStyle><a:lvl1pPr algn="ctr" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="0" /></a:spcBef><a:buNone /><a:defRPr sz="4400" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mj-lt" /><a:ea typeface="+mj-ea" /><a:cs typeface="+mj-cs" /></a:defRPr></a:lvl1pPr></p:titleStyle><p:bodyStyle>'+'<a:lvl1pPr marL="342900" indent="-342900" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="" /><a:defRPr sz="3200" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl1pPr>'+'<a:lvl2pPr marL="742950" indent="-285750" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="" /><a:defRPr sz="2800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl2pPr>'+'<a:lvl3pPr marL="1143000" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="" /><a:defRPr sz="2400" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl3pPr>'+'<a:lvl4pPr marL="1600200" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="" /><a:defRPr sz="2000" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl4pPr>'+'<a:lvl5pPr marL="2057400" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="" /><a:defRPr sz="2000" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl5pPr>'+'<a:lvl6pPr marL="2514600" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="" /><a:defRPr sz="2000" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl6pPr>'+'<a:lvl7pPr marL="2971800" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="" /><a:defRPr sz="2000" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl7pPr>'+'<a:lvl8pPr marL="3429000" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="" /><a:defRPr sz="2000" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl8pPr>'+'<a:lvl9pPr marL="3886200" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="" /><a:defRPr sz="2000" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl9pPr>'+'</p:bodyStyle><p:otherStyle><a:defPPr><a:defRPr lang="ru-RU" /></a:defPPr><a:lvl1pPr marL="0" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl1pPr><a:lvl2pPr marL="457200" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1">'+'<a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl2pPr><a:lvl3pPr marL="914400" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl3pPr>'+'<a:lvl4pPr marL="1371600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl4pPr><a:lvl5pPr marL="1828800" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill>'+'<a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl5pPr><a:lvl6pPr marL="2286000" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl6pPr>'+'<a:lvl7pPr marL="2743200" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl7pPr><a:lvl8pPr marL="3200400" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill>'+'<a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl8pPr><a:lvl9pPr marL="3657600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl9pPr></p:otherStyle></p:txStyles></p:sldMaster>';return e.writeRaw(r),e.writeEndDocument(),e.flush(),t},X.prototype.writeSlideLayoutRels=function(){var t=new O,e=new D(B.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?I.None:I.Indented,e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId1"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster"),e.writeAttributeString("Target","../slideMasters/slideMaster1.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},X.prototype.writeSlideLayout=function(t,e){var r=new O,i=new D(B.UTF8,r),n,n,n,n,n,n,o,a,s,e,n,n,n,n;return i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?I.None:I.Indented,i.writeStartDocument(),i.writeStartElement("p:sldLayout"),i.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),i.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),i.writeAttributeString("xmlns:p","http://schemas.openxmlformats.org/presentationml/2006/main"),1==t&&(i.writeAttributeString("type","title"),i.writeAttributeString("preserve","1"),n='<p:cSld name="Title Slide"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ctrTitle" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="685800" y="2130425" /><a:ext cx="7772400" cy="1470025" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Subtitle 2" />'+'<p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="subTitle" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="1371600" y="3886200" /><a:ext cx="6400800" cy="1752600" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr marL="0" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" />'+'</a:schemeClr></a:solidFill></a:defRPr></a:lvl3pPr><a:lvl4pPr marL="1371600" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl5pPr><a:lvl6pPr marL="2286000" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl6pPr><a:lvl7pPr marL="2743200" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" />'+'</a:schemeClr></a:solidFill></a:defRPr></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl9pPr></a:lstStyle><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master subtitle style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Date Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr>'+'<p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Footer Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Slide Number Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr>'+'<p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>#</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>',i.writeRaw(n)),2==t&&(i.writeAttributeString("type","obj"),i.writeAttributeString("preserve","1"),n='<p:cSld name="Title and Content"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Content Placeholder 2" />'+'<p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph idx="1" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r>'+'<a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Date Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Footer Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr>'+'<p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Slide Number Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>#</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>',i.writeRaw(n)),3==t&&(i.writeAttributeString("type","secHead"),i.writeAttributeString("preserve","1"),n='<p:cSld name="Section Header"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="722313" y="4406900" /><a:ext cx="7772400" cy="1362075" /></a:xfrm></p:spPr><p:txBody><a:bodyPr anchor="t" /><a:lstStyle><a:lvl1pPr algn="l"><a:defRPr sz="4000" b="1" cap="all" /></a:lvl1pPr></a:lstStyle><a:p><a:r>'+'<a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Text Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="722313" y="2906713" /><a:ext cx="7772400" cy="1500187" /></a:xfrm></p:spPr><p:txBody><a:bodyPr anchor="b" /><a:lstStyle><a:lvl1pPr marL="0" indent="0"><a:buNone /><a:defRPr sz="2000"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0"><a:buNone />'+'<a:defRPr sz="1800"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0"><a:buNone /><a:defRPr sz="1600"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl3pPr><a:lvl4pPr marL="1371600" indent="0"><a:buNone /><a:defRPr sz="1400"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0"><a:buNone /><a:defRPr sz="1400"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl5pPr>'+'<a:lvl6pPr marL="2286000" indent="0"><a:buNone /><a:defRPr sz="1400"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl6pPr><a:lvl7pPr marL="2743200" indent="0"><a:buNone /><a:defRPr sz="1400"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0"><a:buNone /><a:defRPr sz="1400"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0"><a:buNone /><a:defRPr sz="1400"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl9pPr></a:lstStyle>'+'<a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Date Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Footer Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr>'+'<p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Slide Number Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>#</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>',i.writeRaw(n)),4==t&&(i.writeAttributeString("type","twoObj"),i.writeAttributeString("preserve","1"),n='<p:cSld name="Two Content"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Content Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr>'+'<p:nvPr><p:ph sz="half" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="1600200" /><a:ext cx="4038600" cy="4525963" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr><a:defRPr sz="2800" /></a:lvl1pPr><a:lvl2pPr><a:defRPr sz="2400" /></a:lvl2pPr><a:lvl3pPr><a:defRPr sz="2000" /></a:lvl3pPr><a:lvl4pPr><a:defRPr sz="1800" /></a:lvl4pPr><a:lvl5pPr><a:defRPr sz="1800" /></a:lvl5pPr><a:lvl6pPr><a:defRPr sz="1800" /></a:lvl6pPr><a:lvl7pPr><a:defRPr sz="1800" /></a:lvl7pPr><a:lvl8pPr><a:defRPr sz="1800" /></a:lvl8pPr><a:lvl9pPr><a:defRPr sz="1800" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" />'+'<a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Content Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph sz="half" idx="2" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="4648200" y="1600200" />'+'<a:ext cx="4038600" cy="4525963" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr><a:defRPr sz="2800" /></a:lvl1pPr><a:lvl2pPr><a:defRPr sz="2400" /></a:lvl2pPr><a:lvl3pPr><a:defRPr sz="2000" /></a:lvl3pPr><a:lvl4pPr><a:defRPr sz="1800" /></a:lvl4pPr><a:lvl5pPr><a:defRPr sz="1800" /></a:lvl5pPr><a:lvl6pPr><a:defRPr sz="1800" /></a:lvl6pPr><a:lvl7pPr><a:defRPr sz="1800" /></a:lvl7pPr><a:lvl8pPr><a:defRPr sz="1800" /></a:lvl8pPr><a:lvl9pPr><a:defRPr sz="1800" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" />'+'<a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Date Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" />'+'<a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Footer Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="7" name="Slide Number Placeholder 6" />'+'<p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>#</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>',i.writeRaw(n)),5==t&&(i.writeAttributeString("type","twoTxTwoObj"),i.writeAttributeString("preserve","1"),n='<p:cSld name="Comparison"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr><a:defRPr /></a:lvl1pPr></a:lstStyle><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Text Placeholder 2" />'+'<p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="1535113" /><a:ext cx="4040188" cy="639762" /></a:xfrm></p:spPr><p:txBody><a:bodyPr anchor="b" /><a:lstStyle><a:lvl1pPr marL="0" indent="0"><a:buNone /><a:defRPr sz="2400" b="1" /></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0"><a:buNone /><a:defRPr sz="2000" b="1" /></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0"><a:buNone /><a:defRPr sz="1800" b="1" /></a:lvl3pPr><a:lvl4pPr marL="1371600" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl5pPr>'+'<a:lvl6pPr marL="2286000" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl6pPr><a:lvl7pPr marL="2743200" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Content Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph sz="half" idx="2" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="2174875" />'+'<a:ext cx="4040188" cy="3951288" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr><a:defRPr sz="2400" /></a:lvl1pPr><a:lvl2pPr><a:defRPr sz="2000" /></a:lvl2pPr><a:lvl3pPr><a:defRPr sz="1800" /></a:lvl3pPr><a:lvl4pPr><a:defRPr sz="1600" /></a:lvl4pPr><a:lvl5pPr><a:defRPr sz="1600" /></a:lvl5pPr><a:lvl6pPr><a:defRPr sz="1600" /></a:lvl6pPr><a:lvl7pPr><a:defRPr sz="1600" /></a:lvl7pPr><a:lvl8pPr><a:defRPr sz="1600" /></a:lvl8pPr><a:lvl9pPr><a:defRPr sz="1600" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r>'+'<a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Text Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" sz="quarter" idx="3" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="4645025" y="1535113" /><a:ext cx="4041775" cy="639762" /></a:xfrm></p:spPr>'+'<p:txBody><a:bodyPr anchor="b" /><a:lstStyle><a:lvl1pPr marL="0" indent="0"><a:buNone /><a:defRPr sz="2400" b="1" /></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0"><a:buNone /><a:defRPr sz="2000" b="1" /></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0"><a:buNone /><a:defRPr sz="1800" b="1" /></a:lvl3pPr><a:lvl4pPr marL="1371600" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl5pPr><a:lvl6pPr marL="2286000" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl6pPr><a:lvl7pPr marL="2743200" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0">'+'<a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Content Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph sz="quarter" idx="4" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="4645025" y="2174875" /><a:ext cx="4041775" cy="3951288" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr><a:defRPr sz="2400" /></a:lvl1pPr><a:lvl2pPr><a:defRPr sz="2000" /></a:lvl2pPr>'+'<a:lvl3pPr><a:defRPr sz="1800" /></a:lvl3pPr><a:lvl4pPr><a:defRPr sz="1600" /></a:lvl4pPr><a:lvl5pPr><a:defRPr sz="1600" /></a:lvl5pPr><a:lvl6pPr><a:defRPr sz="1600" /></a:lvl6pPr><a:lvl7pPr><a:defRPr sz="1600" /></a:lvl7pPr><a:lvl8pPr><a:defRPr sz="1600" /></a:lvl8pPr><a:lvl9pPr><a:defRPr sz="1600" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r>'+'<a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="7" name="Date Placeholder 6" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="8" name="Footer Placeholder 7" />'+'<p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="9" name="Slide Number Placeholder 8" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>#</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>',i.writeRaw(n)),6==t&&(i.writeAttributeString("type","titleOnly"),i.writeAttributeString("preserve","1"),n='<p:cSld name="Title Only"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Date Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr>'+'<p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Footer Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Slide Number Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr>'+'<p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>#</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>',i.writeRaw(n)),7==t&&(i.writeAttributeString("type","blank"),i.writeAttributeString("preserve","1"),i.writeStartElement("p:cSld"),i.writeAttributeString("name","Blank"),i.writeStartElement("p:spTree"),i.writeStartElement("p:nvGrpSpPr"),i.writeStartElement("p:cNvPr"),i.writeAttributeString("id","1"),i.writeAttributeString("name",""),i.writeEndElement(),i.writeStartElement("p:cNvGrpSpPr"),i.writeEndElement(),i.writeStartElement("p:nvPr"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("p:grpSpPr"),i.writeStartElement("a:xfrm"),i.writeStartElement("a:off"),i.writeAttributeString("x","0"),i.writeAttributeString("y","0"),i.writeEndElement(),i.writeStartElement("a:ext"),i.writeAttributeString("cx","0"),i.writeAttributeString("cy","0"),i.writeEndElement(),i.writeStartElement("a:chOff"),i.writeAttributeString("x","0"),i.writeAttributeString("y","0"),i.writeEndElement(),i.writeStartElement("a:chExt"),i.writeAttributeString("cx","0"),i.writeAttributeString("cy","0"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeStartElement("p:sp"),i.writeStartElement("p:nvSpPr"),i.writeStartElement("p:cNvPr"),i.writeAttributeString("id","2"),i.writeAttributeString("name","Date Placeholder 1"),i.writeEndElement(),i.writeStartElement("p:cNvSpPr"),i.writeStartElement("a:spLocks"),i.writeAttributeString("noGrp","1"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("p:nvPr"),i.writeStartElement("p:ph"),i.writeAttributeString("type","dt"),i.writeAttributeString("sz","half"),i.writeAttributeString("idx","10"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeStartElement("p:spPr"),i.writeEndElement(),i.writeStartElement("p:txBody"),i.writeStartElement("a:bodyPr"),i.writeEndElement(),i.writeStartElement("a:lstStyle"),i.writeEndElement(),i.writeStartElement("a:p"),i.writeStartElement("a:fld"),i.writeAttributeString("id","{BBCD0B08-7874-4091-A11F-B0CCB138CA98}"),i.writeAttributeString("type","datetimeFigureOut"),i.writeStartElement("a:rPr"),i.writeAttributeString("lang","ru-RU"),i.writeAttributeString("smtClean","0"),i.writeEndElement(),i.writeStartElement("a:t"),i.writeString("15.04.2009"),i.writeFullEndElement(),i.writeFullEndElement(),i.writeStartElement("a:endParaRPr"),i.writeAttributeString("lang","ru-RU"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeStartElement("p:sp"),i.writeStartElement("p:nvSpPr"),i.writeStartElement("p:cNvPr"),i.writeAttributeString("id","3"),i.writeAttributeString("name","Footer Placeholder 2"),i.writeEndElement(),i.writeStartElement("p:cNvSpPr"),i.writeStartElement("a:spLocks"),i.writeAttributeString("noGrp","1"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("p:nvPr"),i.writeStartElement("p:ph"),i.writeAttributeString("type","ftr"),i.writeAttributeString("sz","quarter"),i.writeAttributeString("idx","11"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeStartElement("p:spPr"),i.writeEndElement(),i.writeStartElement("p:txBody"),i.writeStartElement("a:bodyPr"),i.writeEndElement(),i.writeStartElement("a:lstStyle"),i.writeEndElement(),i.writeStartElement("a:p"),i.writeStartElement("a:endParaRPr"),i.writeAttributeString("lang","ru-RU"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeStartElement("p:sp"),i.writeStartElement("p:nvSpPr"),i.writeStartElement("p:cNvPr"),i.writeAttributeString("id","4"),i.writeAttributeString("name","Slide Number Placeholder 3"),i.writeEndElement(),i.writeStartElement("p:cNvSpPr"),i.writeStartElement("a:spLocks"),i.writeAttributeString("noGrp","1"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("p:nvPr"),i.writeStartElement("p:ph"),i.writeAttributeString("type","sldNum"),i.writeAttributeString("sz","quarter"),i.writeAttributeString("idx","12"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeStartElement("p:spPr"),i.writeEndElement(),i.writeStartElement("p:txBody"),i.writeStartElement("a:bodyPr"),i.writeEndElement(),i.writeStartElement("a:lstStyle"),i.writeEndElement(),i.writeStartElement("a:p"),i.writeStartElement("a:fld"),i.writeAttributeString("id","{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}"),i.writeAttributeString("type","slidenum"),i.writeStartElement("a:rPr"),i.writeAttributeString("lang","ru-RU"),i.writeAttributeString("smtClean","0"),i.writeEndElement(),i.writeStartElement("a:t"),i.writeString("#"),i.writeFullEndElement(),i.writeFullEndElement(),i.writeStartElement("a:endParaRPr"),i.writeAttributeString("lang","ru-RU"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),w.Base.vEIvF.JlKzR.RNAxU()||w.Base.vEIvF.JlKzR.KqUvN()||(w.Base.vEIvF.JlKzR.ZHIhL()||w.Base.vEIvF.JlKzR.LuQMU()||w.Base.vEIvF.JlKzR.UPtPa())&&w.System.NodeJs.isStandaloneVersion||(o=e.unit.convertToHInches(e.pageWidth-e.margins.left-e.margins.right),a=e.unit.convertToHInches(e.pageHeight-e.margins.top-e.margins.bottom),s=e.unit.convertToHInches(e.margins.left),e=e.unit.convertToHInches(e.margins.top),i.writeRaw('<p:sp><p:nvSpPr><p:cNvPr id="67" name="TextBox Additional"/><p:cNvSpPr txBox="1"/><p:nvPr userDrawn="1"/></p:nvSpPr>'+'<p:spPr><a:xfrm rot="-2700000"><a:off x="'+this.convertToEmu(s)+'" y="'+this.convertToEmu(e+.45*a)+'"/><a:ext cx="'+this.convertToEmu(o)+'" cy="'+this.convertToEmu(.1*a)+'"/></a:xfrm>'+'<a:prstGeom prst="rect"><a:avLst/></a:prstGeom><a:noFill/></p:spPr>'+'<p:txBody><a:bodyPr wrap="square" rtlCol="0" anchor="ctr" anchorCtr="0"><a:spAutoFit/></a:bodyPr><a:lstStyle/><a:p><a:pPr algn="ctr"/><a:r><a:rPr lang="en-US" sz="9600" b="1" dirty="0" smtClean="0">'+'<a:solidFill><a:schemeClr val="tx1"><a:alpha val="12000"/></a:schemeClr></a:solidFill>'+'<a:latin typeface="Arial" panose="020B0604020202020204" pitchFamily="34" charset="0"/><a:cs typeface="Arial" panose="020B0604020202020204" pitchFamily="34" charset="0"/>'+"</a:rPr><a:t>Trial</a:t></a:r></a:p></p:txBody></p:sp>")),i.writeFullEndElement(),i.writeFullEndElement()),8==t&&(i.writeAttributeString("type","objTx"),i.writeAttributeString("preserve","1"),n='<p:cSld name="Content with Caption"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="273050" /><a:ext cx="3008313" cy="1162050" /></a:xfrm></p:spPr><p:txBody><a:bodyPr anchor="b" /><a:lstStyle><a:lvl1pPr algn="l"><a:defRPr sz="2000" b="1" /></a:lvl1pPr></a:lstStyle><a:p><a:r><a:rPr lang="en-US" smtClean="0" />'+'<a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Content Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="3575050" y="273050" /><a:ext cx="5111750" cy="5853113" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr><a:defRPr sz="3200" /></a:lvl1pPr><a:lvl2pPr><a:defRPr sz="2800" /></a:lvl2pPr><a:lvl3pPr><a:defRPr sz="2400" /></a:lvl3pPr><a:lvl4pPr><a:defRPr sz="2000" /></a:lvl4pPr><a:lvl5pPr><a:defRPr sz="2000" /></a:lvl5pPr><a:lvl6pPr><a:defRPr sz="2000" /></a:lvl6pPr><a:lvl7pPr>'+'<a:defRPr sz="2000" /></a:lvl7pPr><a:lvl8pPr><a:defRPr sz="2000" /></a:lvl8pPr><a:lvl9pPr><a:defRPr sz="2000" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp>'+'<p:sp><p:nvSpPr><p:cNvPr id="4" name="Text Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" sz="half" idx="2" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="1435100" /><a:ext cx="3008313" cy="4691063" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr marL="0" indent="0"><a:buNone /><a:defRPr sz="1400" /></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0"><a:buNone /><a:defRPr sz="1200" /></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0"><a:buNone /><a:defRPr sz="1000" /></a:lvl3pPr><a:lvl4pPr marL="1371600" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0">'+'<a:buNone /><a:defRPr sz="900" /></a:lvl5pPr><a:lvl6pPr marL="2286000" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl6pPr><a:lvl7pPr marL="2743200" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Date Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr />'+'<p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Footer Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="7" name="Slide Number Placeholder 6" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr />'+'<p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>#</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>',i.writeRaw(n)),9==t&&(i.writeAttributeString("type","picTx"),i.writeAttributeString("preserve","1"),n='<p:cSld name="Picture with Caption"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="1792288" y="4800600" /><a:ext cx="5486400" cy="566738" /></a:xfrm></p:spPr><p:txBody><a:bodyPr anchor="b" /><a:lstStyle><a:lvl1pPr algn="l"><a:defRPr sz="2000" b="1" /></a:lvl1pPr></a:lstStyle><a:p><a:r><a:rPr lang="en-US" smtClean="0" />'+'<a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Picture Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="pic" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="1792288" y="612775" /><a:ext cx="5486400" cy="4114800" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr marL="0" indent="0"><a:buNone /><a:defRPr sz="3200" /></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0"><a:buNone /><a:defRPr sz="2800" /></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0"><a:buNone /><a:defRPr sz="2400" /></a:lvl3pPr>'+'<a:lvl4pPr marL="1371600" indent="0"><a:buNone /><a:defRPr sz="2000" /></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0"><a:buNone /><a:defRPr sz="2000" /></a:lvl5pPr><a:lvl6pPr marL="2286000" indent="0"><a:buNone /><a:defRPr sz="2000" /></a:lvl6pPr><a:lvl7pPr marL="2743200" indent="0"><a:buNone /><a:defRPr sz="2000" /></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0"><a:buNone /><a:defRPr sz="2000" /></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0"><a:buNone /><a:defRPr sz="2000" /></a:lvl9pPr></a:lstStyle><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Text Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr>'+'<p:nvPr><p:ph type="body" sz="half" idx="2" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="1792288" y="5367338" /><a:ext cx="5486400" cy="804862" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr marL="0" indent="0"><a:buNone /><a:defRPr sz="1400" /></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0"><a:buNone /><a:defRPr sz="1200" /></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0"><a:buNone /><a:defRPr sz="1000" /></a:lvl3pPr><a:lvl4pPr marL="1371600" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl5pPr><a:lvl6pPr marL="2286000" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl6pPr>'+'<a:lvl7pPr marL="2743200" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Date Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut">'+'<a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Footer Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="7" name="Slide Number Placeholder 6" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle />'+'<a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>#</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>',i.writeRaw(n)),10==t&&(i.writeAttributeString("type","vertTx"),i.writeAttributeString("preserve","1"),n='<p:cSld name="Title and Vertical Text"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr>'+'<p:cNvPr id="3" name="Vertical Text Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" orient="vert" idx="1" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr vert="eaVert" /><a:lstStyle /><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" />'+'<a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Date Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Footer Placeholder 4" /><p:cNvSpPr>'+'<a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Slide Number Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>#</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>',i.writeRaw(n)),11==t&&(i.writeAttributeString("type","vertTitleAndTx"),i.writeAttributeString("preserve","1"),n='<p:cSld name="Vertical Title and Text"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Vertical Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" orient="vert" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="6629400" y="274638" /><a:ext cx="2057400" cy="5851525" /></a:xfrm></p:spPr><p:txBody><a:bodyPr vert="eaVert" /><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" />'+'<a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Vertical Text Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" orient="vert" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="274638" /><a:ext cx="6019800" cy="5851525" /></a:xfrm></p:spPr><p:txBody><a:bodyPr vert="eaVert" /><a:lstStyle /><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p>'+'<a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Date Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" />'+'<a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Footer Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Slide Number Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle />'+'<a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>#</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>',i.writeRaw(n)),i.writeStartElement("p:clrMapOvr"),i.writeStartElement("a:masterClrMapping"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeEndDocument(),i.flush(),r},X.prototype.writePresentationRels=function(t){var e=new O,r=new D(B.UTF8,e);r.indentation=this.xmlIndentation<0?0:this.xmlIndentation,r.formatting=this.xmlIndentation<0?I.None:I.Indented,r.writeStartDocument(),r.writeStartElement("Relationships"),r.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),r.writeStartElement("Relationship"),r.writeAttributeString("Id","rId1"),r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/tableStyles"),r.writeAttributeString("Target","tableStyles.xml"),r.writeEndElement(),r.writeStartElement("Relationship"),r.writeAttributeString("Id","rId2"),r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/viewProps"),r.writeAttributeString("Target","viewProps.xml"),r.writeEndElement(),r.writeStartElement("Relationship"),r.writeAttributeString("Id","rId3"),r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/presProps"),r.writeAttributeString("Target","presProps.xml"),r.writeEndElement(),r.writeStartElement("Relationship"),r.writeAttributeString("Id","rId4"),r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme"),r.writeAttributeString("Target","theme/theme1.xml"),r.writeEndElement(),r.writeStartElement("Relationship"),r.writeAttributeString("Id","rId5"),r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster"),r.writeAttributeString("Target","slideMasters/slideMaster1.xml"),r.writeEndElement();for(var i=0;i<t.count;i++)r.writeStartElement("Relationship"),r.writeAttributeString("Id",C.format("rId{0}",6+i)),r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slide"),r.writeAttributeString("Target",C.format("slides/slide{0}.xml",i+1)),r.writeEndElement();return r.writeFullEndElement(),r.writeEndDocument(),r.flush(),e},X.prototype.writePresentation=function(t){var e=new O,r=new D(B.UTF8,e);r.indentation=this.xmlIndentation<0?0:this.xmlIndentation,r.formatting=this.xmlIndentation<0?I.None:I.Indented,r.writeStartDocument(),r.writeStartElement("p:presentation"),r.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),r.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),r.writeAttributeString("xmlns:p","http://schemas.openxmlformats.org/presentationml/2006/main"),r.writeAttributeString("saveSubsetFonts","1"),r.writeStartElement("p:sldMasterIdLst"),r.writeStartElement("p:sldMasterId"),r.writeAttributeString("id","2147483648"),r.writeAttributeString("r:id","rId5"),r.writeEndElement(),r.writeFullEndElement(),r.writeStartElement("p:sldIdLst");for(var i=0;i<t.count;i++)r.writeStartElement("p:sldId"),r.writeAttributeString("id",C.format("{0}",256+i)),r.writeAttributeString("r:id",C.format("rId{0}",6+i)),r.writeEndElement();r.writeEndElement();var n=t.getByIndex(0);return r.writeStartElement("p:sldSz"),r.writeAttributeString("cx",this.convertToEmu(n.unit.convertToHInches(n.width+n.margins.left+n.margins.right)).toString()),r.writeAttributeString("cy",this.convertToEmu(n.unit.convertToHInches(n.height+n.margins.top+n.margins.bottom)).toString()),r.writeEndElement(),r.writeStartElement("p:notesSz"),r.writeAttributeString("cx","6858000"),r.writeAttributeString("cy","9144000"),r.writeEndElement(),r.writeStartElement("p:defaultTextStyle"),r.writeStartElement("a:defPPr"),r.writeStartElement("a:defRPr"),r.writeAttributeString("lang","ru-RU"),r.writeEndElement(),r.writeFullEndElement(),r.writeStartElement("a:lvl1pPr"),r.writeAttributeString("marL","0"),r.writeAttributeString("algn","l"),r.writeAttributeString("defTabSz","914400"),r.writeAttributeString("rtl","0"),r.writeAttributeString("eaLnBrk","1"),r.writeAttributeString("latinLnBrk","0"),r.writeAttributeString("hangingPunct","1"),r.writeStartElement("a:defRPr"),r.writeAttributeString("sz","1800"),r.writeAttributeString("kern","1200"),r.writeStartElement("a:solidFill"),r.writeStartElement("a:schemeClr"),r.writeAttributeString("val","tx1"),r.writeEndElement(),r.writeFullEndElement(),r.writeStartElement("a:latin"),r.writeAttributeString("typeface","+mn-lt"),r.writeEndElement(),r.writeStartElement("a:ea"),r.writeAttributeString("typeface","+mn-ea"),r.writeEndElement(),r.writeStartElement("a:cs"),r.writeAttributeString("typeface","+mn-cs"),r.writeEndElement(),r.writeFullEndElement(),r.writeFullEndElement(),r.writeStartElement("a:lvl2pPr"),r.writeAttributeString("marL","457200"),r.writeAttributeString("algn","l"),r.writeAttributeString("defTabSz","914400"),r.writeAttributeString("rtl","0"),r.writeAttributeString("eaLnBrk","1"),r.writeAttributeString("latinLnBrk","0"),r.writeAttributeString("hangingPunct","1"),r.writeStartElement("a:defRPr"),r.writeAttributeString("sz","1800"),r.writeAttributeString("kern","1200"),r.writeStartElement("a:solidFill"),r.writeStartElement("a:schemeClr"),r.writeAttributeString("val","tx1"),r.writeEndElement(),r.writeFullEndElement(),r.writeStartElement("a:latin"),r.writeAttributeString("typeface","+mn-lt"),r.writeEndElement(),r.writeStartElement("a:ea"),r.writeAttributeString("typeface","+mn-ea"),r.writeEndElement(),r.writeStartElement("a:cs"),r.writeAttributeString("typeface","+mn-cs"),r.writeEndElement(),r.writeFullEndElement(),r.writeFullEndElement(),r.writeStartElement("a:lvl3pPr"),r.writeAttributeString("marL","914400"),r.writeAttributeString("algn","l"),r.writeAttributeString("defTabSz","914400"),r.writeAttributeString("rtl","0"),r.writeAttributeString("eaLnBrk","1"),r.writeAttributeString("latinLnBrk","0"),r.writeAttributeString("hangingPunct","1"),r.writeStartElement("a:defRPr"),r.writeAttributeString("sz","1800"),r.writeAttributeString("kern","1200"),r.writeStartElement("a:solidFill"),r.writeStartElement("a:schemeClr"),r.writeAttributeString("val","tx1"),r.writeEndElement(),r.writeFullEndElement(),r.writeStartElement("a:latin"),r.writeAttributeString("typeface","+mn-lt"),r.writeEndElement(),r.writeStartElement("a:ea"),r.writeAttributeString("typeface","+mn-ea"),r.writeEndElement(),r.writeStartElement("a:cs"),r.writeAttributeString("typeface","+mn-cs"),r.writeEndElement(),r.writeFullEndElement(),r.writeFullEndElement(),r.writeStartElement("a:lvl4pPr"),r.writeAttributeString("marL","1371600"),r.writeAttributeString("algn","l"),r.writeAttributeString("defTabSz","914400"),r.writeAttributeString("rtl","0"),r.writeAttributeString("eaLnBrk","1"),r.writeAttributeString("latinLnBrk","0"),r.writeAttributeString("hangingPunct","1"),r.writeStartElement("a:defRPr"),r.writeAttributeString("sz","1800"),r.writeAttributeString("kern","1200"),r.writeStartElement("a:solidFill"),r.writeStartElement("a:schemeClr"),r.writeAttributeString("val","tx1"),r.writeEndElement(),r.writeFullEndElement(),r.writeStartElement("a:latin"),r.writeAttributeString("typeface","+mn-lt"),r.writeEndElement(),r.writeStartElement("a:ea"),r.writeAttributeString("typeface","+mn-ea"),r.writeEndElement(),r.writeStartElement("a:cs"),r.writeAttributeString("typeface","+mn-cs"),r.writeEndElement(),r.writeFullEndElement(),r.writeFullEndElement(),r.writeStartElement("a:lvl5pPr"),r.writeAttributeString("marL","1828800"),r.writeAttributeString("algn","l"),r.writeAttributeString("defTabSz","914400"),r.writeAttributeString("rtl","0"),r.writeAttributeString("eaLnBrk","1"),r.writeAttributeString("latinLnBrk","0"),r.writeAttributeString("hangingPunct","1"),r.writeStartElement("a:defRPr"),r.writeAttributeString("sz","1800"),r.writeAttributeString("kern","1200"),r.writeStartElement("a:solidFill"),r.writeStartElement("a:schemeClr"),r.writeAttributeString("val","tx1"),r.writeEndElement(),r.writeFullEndElement(),r.writeStartElement("a:latin"),r.writeAttributeString("typeface","+mn-lt"),r.writeEndElement(),r.writeStartElement("a:ea"),r.writeAttributeString("typeface","+mn-ea"),r.writeEndElement(),r.writeStartElement("a:cs"),r.writeAttributeString("typeface","+mn-cs"),r.writeEndElement(),r.writeFullEndElement(),r.writeFullEndElement(),r.writeStartElement("a:lvl6pPr"),r.writeAttributeString("marL","2286000"),r.writeAttributeString("algn","l"),r.writeAttributeString("defTabSz","914400"),r.writeAttributeString("rtl","0"),r.writeAttributeString("eaLnBrk","1"),r.writeAttributeString("latinLnBrk","0"),r.writeAttributeString("hangingPunct","1"),r.writeStartElement("a:defRPr"),r.writeAttributeString("sz","1800"),r.writeAttributeString("kern","1200"),r.writeStartElement("a:solidFill"),r.writeStartElement("a:schemeClr"),r.writeAttributeString("val","tx1"),r.writeEndElement(),r.writeFullEndElement(),r.writeStartElement("a:latin"),r.writeAttributeString("typeface","+mn-lt"),r.writeEndElement(),r.writeStartElement("a:ea"),r.writeAttributeString("typeface","+mn-ea"),r.writeEndElement(),r.writeStartElement("a:cs"),r.writeAttributeString("typeface","+mn-cs"),r.writeEndElement(),r.writeFullEndElement(),r.writeFullEndElement(),r.writeStartElement("a:lvl7pPr"),r.writeAttributeString("marL","2743200"),r.writeAttributeString("algn","l"),r.writeAttributeString("defTabSz","914400"),r.writeAttributeString("rtl","0"),r.writeAttributeString("eaLnBrk","1"),r.writeAttributeString("latinLnBrk","0"),r.writeAttributeString("hangingPunct","1"),r.writeStartElement("a:defRPr"),r.writeAttributeString("sz","1800"),r.writeAttributeString("kern","1200"),r.writeStartElement("a:solidFill"),r.writeStartElement("a:schemeClr"),r.writeAttributeString("val","tx1"),r.writeEndElement(),r.writeFullEndElement(),r.writeStartElement("a:latin"),r.writeAttributeString("typeface","+mn-lt"),r.writeEndElement(),r.writeStartElement("a:ea"),r.writeAttributeString("typeface","+mn-ea"),r.writeEndElement(),r.writeStartElement("a:cs"),r.writeAttributeString("typeface","+mn-cs"),r.writeEndElement(),r.writeFullEndElement(),r.writeFullEndElement(),r.writeStartElement("a:lvl8pPr"),r.writeAttributeString("marL","3200400"),r.writeAttributeString("algn","l"),r.writeAttributeString("defTabSz","914400"),r.writeAttributeString("rtl","0"),r.writeAttributeString("eaLnBrk","1"),r.writeAttributeString("latinLnBrk","0"),r.writeAttributeString("hangingPunct","1"),r.writeStartElement("a:defRPr"),r.writeAttributeString("sz","1800"),r.writeAttributeString("kern","1200"),r.writeStartElement("a:solidFill"),r.writeStartElement("a:schemeClr"),r.writeAttributeString("val","tx1"),r.writeEndElement(),r.writeFullEndElement(),r.writeStartElement("a:latin"),r.writeAttributeString("typeface","+mn-lt"),r.writeEndElement(),r.writeStartElement("a:ea"),r.writeAttributeString("typeface","+mn-ea"),r.writeEndElement(),r.writeStartElement("a:cs"),r.writeAttributeString("typeface","+mn-cs"),r.writeEndElement(),r.writeFullEndElement(),r.writeFullEndElement(),r.writeStartElement("a:lvl9pPr"),r.writeAttributeString("marL","3657600"),r.writeAttributeString("algn","l"),r.writeAttributeString("defTabSz","914400"),r.writeAttributeString("rtl","0"),r.writeAttributeString("eaLnBrk","1"),r.writeAttributeString("latinLnBrk","0"),r.writeAttributeString("hangingPunct","1"),r.writeStartElement("a:defRPr"),r.writeAttributeString("sz","1800"),r.writeAttributeString("kern","1200"),r.writeStartElement("a:solidFill"),r.writeStartElement("a:schemeClr"),r.writeAttributeString("val","tx1"),r.writeEndElement(),r.writeFullEndElement(),r.writeStartElement("a:latin"),r.writeAttributeString("typeface","+mn-lt"),r.writeEndElement(),r.writeStartElement("a:ea"),r.writeAttributeString("typeface","+mn-ea"),r.writeEndElement(),r.writeStartElement("a:cs"),r.writeAttributeString("typeface","+mn-cs"),r.writeEndElement(),r.writeFullEndElement(),r.writeFullEndElement(),r.writeEndElement(),r.writeFullEndElement(),r.writeEndDocument(),r.flush(),e},X.prototype.writeSlideRels=function(t){var e=new O,r=new D(B.UTF8,e);if(r.indentation=this.xmlIndentation<0?0:this.xmlIndentation,r.formatting=this.xmlIndentation<0?I.None:I.Indented,r.writeStartDocument(),r.writeStartElement("Relationships"),r.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),r.writeStartElement("Relationship"),r.writeAttributeString("Id","rId1"),r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout"),r.writeAttributeString("Target","../slideLayouts/slideLayout7.xml"),r.writeEndElement(),this.imageCache.imageIndex.stimulsoft.countItems>this.imageListOffset)for(var i=0;i<this.imageCache.imageIndex.stimulsoft.countItems-this.imageListOffset;i++)r.writeStartElement("Relationship"),r.writeAttributeString("Id",C.format("rId{0}",2+i)),r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"),r.writeAttributeString("Target",C.format("../media/image{0:D5}.{1}",this.imageCache.imageIndex[this.imageListOffset+i]+1,w["StiOptions"].Export.PowerPoint.StoreImagesAsPng?"png":"jpeg")),r.writeEndElement();if(0<this.hyperlinkList.stimulsoft.countItems)for(var i=0;i<this.hyperlinkList.stimulsoft.countItems;i++){r.writeStartElement("Relationship"),r.writeAttributeString("Id",C.format("hId{0}",i+1));var n=this.hyperlinkList.stimulsoft.getByIndex(i);"string"==typeof n&&(r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"),r.writeAttributeString("Target",n),r.writeAttributeString("TargetMode","External")),"number"==typeof n&&(r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slide"),r.writeAttributeString("Target",C.format("slide{0}.xml",n))),r.writeEndElement()}return r.writeFullEndElement(),r.writeEndDocument(),r.flush(),e},X.prototype.writeSlide=function(t,e){var r,i,n=new O,o=new D(B.UTF8,n);o.indentation=this.xmlIndentation<0?0:this.xmlIndentation,o.formatting=this.xmlIndentation<0?I.None:I.Indented,o.writeStartDocument(),o.writeStartElement("p:sld"),o.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),o.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),o.writeAttributeString("xmlns:p","http://schemas.openxmlformats.org/presentationml/2006/main"),o.writeStartElement("p:cSld"),o.writeStartElement("p:spTree"),o.writeStartElement("p:nvGrpSpPr"),o.writeStartElement("p:cNvPr"),o.writeAttributeString("id","1"),o.writeAttributeString("name",""),o.writeEndElement(),o.writeStartElement("p:cNvGrpSpPr"),o.writeEndElement(),o.writeStartElement("p:nvPr"),o.writeEndElement(),o.writeEndElement(),o.writeStartElement("p:grpSpPr"),o.writeStartElement("a:xfrm"),o.writeStartElement("a:off"),o.writeAttributeString("x","0"),o.writeAttributeString("y","0"),o.writeEndElement(),o.writeStartElement("a:ext"),o.writeAttributeString("cx","0"),o.writeAttributeString("cy","0"),o.writeEndElement(),o.writeStartElement("a:chOff"),o.writeAttributeString("x","0"),o.writeAttributeString("y","0"),o.writeEndElement(),o.writeStartElement("a:chExt"),o.writeAttributeString("cx","0"),o.writeAttributeString("cy","0"),o.writeEndElement(),o.writeEndElement(),o.writeEndElement(),this.idCounter=2;var a=e.getByIndex(t),s,l,t,e;e.getPage(a),this.writeWatermark(o,a,!0);try{for(var m=__values(a.components.list),c=m.next();!c.done;c=m.next()){var p=c.value,g,h,h,p;p.enabled&&0<p.width&&0<p.height&&(null==(g=p.stimulsoft.as(L))||g.checkAllowHtmlTags()?p.is(P)?((h=new L(p.clientRectangle)).page=p.page,h.border=p.stimulsoft.as(P).border,h.brush=p.stimulsoft.as(P).brush,h.hyperlinkValue=p.hyperlinkValue,this.writeStiTextbox(o,h)):this.writeStiImage(o,p):((h=g.angle%360)<0&&(h=360+h),0==h||90==h||270==h?this.writeStiTextbox(o,p):((p=g.clone(!0)).text=null,p.angle=0,this.writeStiTextbox(o,p),(p=g.clone(!0)).border=null,p.brush=null,p.horAlignment=M.Center,p.vertAlignment=H.Center,this.writeStiTextbox(o,p))),this.idCounter++)}}catch(t){r={error:t}}finally{try{c&&!c.done&&(i=m.return)&&i.call(m)}finally{if(r)throw r.error}}return this.writeWatermark(o,a,!1),w.Base.vEIvF.JlKzR.RNAxU()||w.Base.vEIvF.JlKzR.KqUvN()||(w.Base.vEIvF.JlKzR.ZHIhL()||w.Base.vEIvF.JlKzR.LuQMU()||w.Base.vEIvF.JlKzR.UPtPa())&&w.System.NodeJs.isStandaloneVersion||(s=a.unit.convertToHInches(a.pageWidth-a.margins.left-a.margins.right),l=a.unit.convertToHInches(a.pageHeight-a.margins.top-a.margins.bottom),t=a.unit.convertToHInches(a.margins.left),e=a.unit.convertToHInches(a.margins.top),o.writeRaw('<p:sp><p:nvSpPr><p:cNvPr id="67" name="TextBox Additional"/><p:cNvSpPr txBox="1"/><p:nvPr userDrawn="1"/></p:nvSpPr>'+'<p:spPr><a:xfrm rot="-2700000"><a:off x="'+this.convertToEmu(t)+'" y="'+this.convertToEmu(e+.45*l)+'"/><a:ext cx="'+this.convertToEmu(s)+'" cy="'+this.convertToEmu(.1*l)+'"/></a:xfrm>'+'<a:prstGeom prst="rect"><a:avLst/></a:prstGeom><a:noFill/></p:spPr>'+'<p:txBody><a:bodyPr wrap="square" rtlCol="0" anchor="ctr" anchorCtr="0"><a:spAutoFit/></a:bodyPr><a:lstStyle/><a:p><a:pPr algn="ctr"/><a:r><a:rPr lang="en-US" sz="9600" b="1" dirty="0" smtClean="0">'+'<a:solidFill><a:schemeClr val="tx1"><a:alpha val="12000"/></a:schemeClr></a:solidFill>'+'<a:latin typeface="Arial" panose="020B0604020202020204" pitchFamily="34" charset="0"/><a:cs typeface="Arial" panose="020B0604020202020204" pitchFamily="34" charset="0"/>'+"</a:rPr><a:t>Trial</a:t></a:r></a:p></p:txBody></p:sp>")),o.writeFullEndElement(),o.writeEndElement(),o.writeStartElement("p:clrMapOvr"),o.writeStartElement("a:masterClrMapping"),o.writeEndElement(),o.writeFullEndElement(),o.writeFullEndElement(),o.writeEndDocument(),o.flush(),n},X.prototype.writeStiTextbox=function(t,e){var r=e;t.writeStartElement("p:sp"),t.writeStartElement("p:nvSpPr"),t.writeStartElement("p:cNvPr"),t.writeAttributeString("id",C.format("{0}",this.idCounter)),t.writeAttributeString("name",C.format("TextBox {0}",this.idCounter)),this.writeHyperlinkInfo(t,e),t.writeEndElement(),t.writeStartElement("p:cNvSpPr"),t.writeAttributeString("txBox","1"),t.writeEndElement(),t.writeStartElement("p:nvPr"),t.writeEndElement(),t.writeEndElement();var i=this.writeSpPr(t,e);t.writeStartElement("p:txBody"),t.writeStartElement("a:bodyPr");var n=!1,o="",a;null!=r.textOptions&&(n=r.textOptions.wordWrap,(a=r.textOptions.angle%360)<0&&(a=360+a),90==a&&(o="vert270"),270==a&&(o="vert")),0<o.length&&t.writeAttributeString("vert",o),t.writeAttributeString("horzOverflow","clip"),t.writeAttributeString("vertOverflow","clip");var s=this.convertToEmu(r.margins.left),l=this.convertToEmu(r.margins.right),a=this.convertToEmu(r.margins.top),o=this.convertToEmu(r.margins.bottom);t.writeAttributeString("lIns",C.format("{0}",s)),t.writeAttributeString("tIns",C.format("{0}",a)),t.writeAttributeString("rIns",C.format("{0}",l)),t.writeAttributeString("bIns",C.format("{0}",o)),t.writeAttributeString("wrap",n?"square":"none"),t.writeAttributeString("rtlCol","0");var o="t";r.vertAlignment==H.Center&&(o="ctr"),r.vertAlignment==H.Bottom&&(o="b"),t.writeAttributeString("anchor",o),t.writeAttributeString("anchorCtr","0"),t.writeStartElement("a:noAutofit"),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("a:lstStyle"),t.writeEndElement(),t.writeStartElement("a:p");var n=!1;null!=r.textOptions&&(n=r.textOptions.rightToLeft),t.writeStartElement("a:pPr");var o="";r.horAlignment==M.Center&&(o="ctr"),(r.horAlignment==M.Right&&!n||r.horAlignment==M.Left&&n)&&(o="r"),r.horAlignment==M.Width&&(o="just"),0<o.length&&t.writeAttributeString("algn",o),n&&t.writeAttributeString("rtl","1"),t.writeStartElement("a:lnSpc"),t.writeStartElement("a:spcPct"),t.writeAttributeString("val",Math.round(.94*r.lineSpacing*1e5).toString()),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("a:r"),t.writeStartElement("a:rPr"),t.writeAttributeString("lang","en-US"),t.writeAttributeString("sz",(100*r.font.sizeInPoints*.984|0).toString()),r.font.bold&&t.writeAttributeString("b","1"),r.font.italic&&t.writeAttributeString("i","1"),r.font.underline&&t.writeAttributeString("u","sng"),r.font.strikeout&&t.writeAttributeString("strike","sngStrike"),t.writeAttributeString("dirty","0"),t.writeAttributeString("smtClean","0"),t.writeStartElement("a:solidFill"),this.writeColor(t,T.toColor(r.textBrush)),t.writeFullEndElement();var n="";null!=r.text&&(n=r.text.toString()),r.textQuality!=A.Wysiwyg&&r.horAlignment!=M.Width||C.isNullOrEmpty(n)||!n.stimulsoft.endsWith(x.StiForceWidthAlignTag)||(n=n.substr(0,n.length-x.StiForceWidthAlignTag.length)),t.writeStartElement("a:latin"),t.writeAttributeString("typeface",r.font.name),t.writeAttributeString("pitchFamily","18"),t.writeAttributeString("charset","0"),t.writeEndElement(),t.writeStartElement("a:cs"),t.writeAttributeString("typeface",r.font.name),t.writeAttributeString("pitchFamily","18"),t.writeAttributeString("charset","0"),t.writeEndElement(),t.writeEndElement(),t.writeElementString("a:t",n),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),i&&this.writeBorder(t,e)},X.prototype.writeStiImage=function(t,e){var r=!1,i=e.stimulsoft.as(s);if(null!=i){var n=null,o;if(e.isExportAsImage(m.StiExportFormat.Ppt2007))try{R.currentCulture=this.currentCulture;var a={ref:this.imageResolution},n=i.getImage(a,m.StiExportFormat.ImagePng)}finally{R.currentCulture=this.newCulture}null!=n&&(o=this.imageCache.addImageInt(n),n.dispose(),t.writeStartElement("p:pic"),t.writeStartElement("p:nvPicPr"),t.writeStartElement("p:cNvPr"),t.writeAttributeString("id",C.format("{0}",this.idCounter)),t.writeAttributeString("name",C.format("Picture {0}",this.idCounter+1)),t.writeAttributeString("descr",C.format("Picture {0} description",this.idCounter+1)),this.writeHyperlinkInfo(t,e),t.writeEndElement(),t.writeStartElement("p:cNvPicPr"),t.writeStartElement("a:picLocks"),t.writeAttributeString("noChangeAspect","1"),t.writeEndElement(),t.writeFullEndElement(),t.writeStartElement("p:nvPr"),t.writeEndElement(),t.writeFullEndElement(),t.writeStartElement("p:blipFill"),t.writeStartElement("a:blip"),t.writeAttributeString("r:embed",C.format("rId{0}",1+this.imageCache.imageIndex.stimulsoft.countItems-this.imageListOffset)),t.writeEndElement(),t.writeStartElement("a:stretch"),t.writeStartElement("a:fillRect"),t.writeEndElement(),t.writeFullEndElement(),t.writeFullEndElement(),r=this.writeSpPr(t,e),t.writeFullEndElement())}(r||e.is(y))&&this.writeBorder(t,e)},X.prototype.writeSpPr=function(t,e){var r=this.convertToEmu(e.report.unit.convertToHInches(e.left+e.page.margins.left)),i=this.convertToEmu(e.report.unit.convertToHInches(e.top+e.page.margins.top)),n=this.convertToEmu(e.report.unit.convertToHInches(e.right+e.page.margins.left)),o=this.convertToEmu(e.report.unit.convertToHInches(e.bottom+e.page.margins.top)),a=0,s=e.stimulsoft.as(b);null!=s&&null!=s.textOptions&&(90!=(a=s.textOptions.angle%360)&&270!=a&&-90!=a&&-270!=a||(a=0)),t.writeStartElement("p:spPr"),t.writeStartElement("a:xfrm"),0!=a&&t.writeAttributeString("rot",C.format("{0}",0|Math.round(6e4*-a))),t.writeStartElement("a:off"),t.writeAttributeString("x",C.format("{0}",r)),t.writeAttributeString("y",C.format("{0}",i)),t.writeEndElement(),t.writeStartElement("a:ext"),t.writeAttributeString("cx",C.format("{0}",n-r)),t.writeAttributeString("cy",C.format("{0}",o-i)),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("a:prstGeom"),t.writeAttributeString("prst","rect"),t.writeStartElement("a:avLst"),t.writeEndElement(),t.writeEndElement();var o=e.is(v)||e.is(g),i=l.transparent;e.is(E)&&(i=T.toColor(e.brush)),0==i.a||o?(t.writeStartElement("a:noFill"),t.writeEndElement()):(t.writeStartElement("a:solidFill"),this.writeColor(t,i),t.writeFullEndElement());var o=!1,i=null;return e.is(f)&&(i=e.border),null!=i&&i.side!=S.None&&i.style!=c.None&&(i.side!=S.All||i.is(u)?o=!0:(t.writeStartElement("a:ln"),t.writeAttributeString("w",C.format("{0}",this.convertToEmu(i.size))),t.writeStartElement("a:solidFill"),this.writeColor(t,i.color),t.writeFullEndElement(),t.writeStartElement("a:prstDash"),t.writeAttributeString("val",this.getLineStyle(i.style)),t.writeEndElement(),t.writeStartElement("a:miter"),t.writeAttributeString("lim","800000"),t.writeEndElement(),t.writeFullEndElement())),t.writeEndElement(),o},X.prototype.writeBorder=function(t,e){var r=e.as(f).border,i;r.is(u)?((i=r).isLeftBorderSidePresent&&this.writeLine(t,e,new n(e.left,e.top,0,e.height),i.leftSide.size,i.leftSide.style,i.leftSide.color),i.isRightBorderSidePresent&&this.writeLine(t,e,new n(e.right,e.top,0,e.height),i.rightSide.size,i.rightSide.style,i.rightSide.color),i.isTopBorderSidePresent&&this.writeLine(t,e,new n(e.left,e.top,e.width,0),i.topSide.size,i.topSide.style,i.topSide.color),i.isBottomBorderSidePresent&&this.writeLine(t,e,new n(e.left,e.bottom,e.width,0),i.bottomSide.size,i.bottomSide.style,i.bottomSide.color)):(r.isLeftBorderSidePresent&&this.writeLine(t,e,new n(e.left,e.top,0,e.height),r.size,r.style,r.color),r.isRightBorderSidePresent&&this.writeLine(t,e,new n(e.right,e.top,0,e.height),r.size,r.style,r.color),r.isTopBorderSidePresent&&this.writeLine(t,e,new n(e.left,e.top,e.width,0),r.size,r.style,r.color),r.isBottomBorderSidePresent&&this.writeLine(t,e,new n(e.left,e.bottom,e.width,0),r.size,r.style,r.color))},X.prototype.writeLine=function(t,e,r,i,n,o){if(n==c.None||0==o.a)return;t.writeStartElement("p:cxnSp"),t.writeStartElement("p:nvCxnSpPr"),t.writeStartElement("p:cNvPr"),t.writeAttributeString("id",C.format("{0}",this.idCounter)),t.writeAttributeString("name",C.format("Line {0}",this.idCounter)),t.writeEndElement(),t.writeStartElement("p:cNvCxnSpPr"),t.writeEndElement(),t.writeStartElement("p:nvPr"),t.writeEndElement(),t.writeEndElement();var a=this.convertToEmu(e.report.unit.convertToHInches(r.left+e.page.margins.left)),s=this.convertToEmu(e.report.unit.convertToHInches(r.top+e.page.margins.top)),l=this.convertToEmu(e.report.unit.convertToHInches(r.right+e.page.margins.left)),r=this.convertToEmu(e.report.unit.convertToHInches(r.bottom+e.page.margins.top));t.writeStartElement("p:spPr"),t.writeStartElement("a:xfrm"),t.writeStartElement("a:off"),t.writeAttributeString("x",C.format("{0}",a)),t.writeAttributeString("y",C.format("{0}",s)),t.writeEndElement(),t.writeStartElement("a:ext"),t.writeAttributeString("cx",C.format("{0}",l-a)),t.writeAttributeString("cy",C.format("{0}",r-s)),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("a:prstGeom"),t.writeAttributeString("prst","line"),t.writeStartElement("a:avLst"),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("a:ln"),t.writeAttributeString("w",C.format("{0}",this.convertToEmu(i))),t.writeStartElement("a:solidFill"),this.writeColor(t,o),t.writeFullEndElement(),t.writeStartElement("a:prstDash"),t.writeAttributeString("val",this.getLineStyle(n)),t.writeEndElement();var o=e.as(y),n,e,m,m;null!=o&&(e=n=null,o.is(d)&&(n=o.startCap,e=o.endCap),o.is(h)&&(n=o.startCap,e=o.endCap),null!=n&&(m=this.capStyleToPptStyle(n.style),C.isNullOrEmpty(m)||(t.writeStartElement("a:headEnd"),t.writeAttributeString("type",m),t.writeEndElement())),null!=e&&(m=this.capStyleToPptStyle(e.style),C.isNullOrEmpty(m)||(t.writeStartElement("a:tailEnd"),t.writeAttributeString("type",m),t.writeEndElement()))),t.writeFullEndElement(),t.writeEndElement(),t.writeEndElement()},X.prototype.capStyleToPptStyle=function(t){switch(t){case o.Arrow:return"triangle";case o.Diamond:return"diamond";case o.Square:return"diamond";case o.Open:return"arrow";case o.Oval:return"oval";case o.Stealth:return"stealth"}return null},X.prototype.writeWatermark=function(t,e,r){var r;null==e.watermark||null==e.watermark.image&&C.isNullOrWhiteSpace(e.watermark.imageHyperlink)||e.watermark.showImageBehind!=r||((r=new g).page=e,r.image=e.watermark.image,r.left=-e.margins.left,r.top=-e.margins.top,r.width=e.pageWidth,r.height=e.pageHeight,e.watermark.imageStretch&&(r.stretch=!0),r.vertAlignment=H.Center,r.horAlignment=i.Center,this.writeStiImage(t,r))},X.prototype.writeHyperlinkInfo=function(t,e){var e,r,e,r;null!=e.hyperlinkValue&&(r=void 0,0<(e=e.hyperlinkValue.toString().trim()).length&&!e.stimulsoft.startsWith("javascript:")&&(e.stimulsoft.startsWith("#")||(e=this.stringToUrl(e),-1==(r=this.hyperlinkList.indexOf(e))&&(this.hyperlinkList.push(e),r=this.hyperlinkList.stimulsoft.countItems),t.writeStartElement("a:hlinkClick"),t.writeAttributeString("r:id",C.format("hId{0}",r)),t.writeEndElement())))},X.prototype.writeImage=function(t){var e=new O,t=this.imageCache.imagePackedStore.stimulsoft.getByIndex(t);return e.write(t,0,t.length),e},X.prototype.exportPowerPoint=function(t,e,r){m.StiLogService.write(this.stimulsoft.getType(),"Export report to PowerPoint 2007 format");var i=r.pageRange;this.imageResolution=r.imageResolution,this.imageQuality=r.imageQuality,this.xmlIndentation=-1,this.imageResolution<10&&(this.imageResolution=10),this.imageResolution=this.imageResolution/100,this.currentCulture=R.currentCulture,this.newCulture=R.cultures["en-US"];try{R.currentCulture=this.newCulture;var n=i.getSelectedPages(t.renderedPages);if(this.isStopped)return;this.imageCache=new m.StiImageCache(w["StiOptions"].Export.PowerPoint.AllowImageComparer,!0,w["StiOptions"].Export.PowerPoint.StoreImagesAsPng?m.ImageFormat.Png:m.ImageFormat.Jpeg,this.imageQuality);var o=new p;o.begin(e,!0),o.addFile("[Content_Types].xml",this.writeContentTypes(n.count)),o.addFile("_rels/.rels",this.writeMainRels()),o.addFile("docProps/app.xml",this.writeDocPropsApp(n.count)),o.addFile("docProps/core.xml",this.writeDocPropsCore()),o.addFile("ppt/tableStyles.xml",this.writeTableStyles()),o.addFile("ppt/presProps.xml",this.writePresProps()),o.addFile("ppt/viewProps.xml",this.writeViewProps()),o.addFile("ppt/theme/theme1.xml",this.writeTheme()),o.addFile("ppt/slideMasters/slideMaster1.xml",this.writeSlideMaster()),o.addFile("ppt/slideMasters/_rels/slideMaster1.xml.rels",this.writeSlideMasterRels());for(var a=0;a<11;a++)o.addFile(C.format("ppt/slideLayouts/slideLayout{0}.xml",a+1),this.writeSlideLayout(a+1,n.getByIndex(0))),o.addFile(C.format("ppt/slideLayouts/_rels/slideLayout{0}.xml.rels",a+1),this.writeSlideLayoutRels());o.addFile("ppt/presentation.xml",this.writePresentation(n)),o.addFile("ppt/_rels/presentation.xml.rels",this.writePresentationRels(n)),this.imageListOffset=0,this.hyperlinkList=[];for(var s=0;s<n.count;s++){if(this.invokeExporting2(s,n.count,0,1),this.isStopped)return;var l=n.getByIndex(s);n.getPage(l),o.addFile(C.format("ppt/slides/slide{0}.xml",s+1),this.writeSlide(s,n)),o.addFile(C.format("ppt/slides/_rels/slide{0}.xml.rels",s+1),this.writeSlideRels(s)),this.imageListOffset=this.imageCache.imageIndex.stimulsoft.countItems,this.hyperlinkList.stimulsoft.clear()}if(0<this.imageCache.imagePackedStore.stimulsoft.countItems)for(var a=0;a<this.imageCache.imagePackedStore.stimulsoft.countItems;a++)o.addFile(C.format("ppt/media/image{0:D5}.{1}",a+1,w["StiOptions"].Export.PowerPoint.StoreImagesAsPng?"png":"jpeg"),this.writeImage(a));o.end()}finally{R.currentCulture=this.currentCulture,this.imageCache.clear(),this.hyperlinkList=null}},U=X,r.StiPpt2007ExportService=U}(Stimulsoft=Stimulsoft||{}),function(Q){var t,Z,e,$,tt,et,p,g,i,m,h,c,w,rt,it,nt,ot,d,G,V,u,_,a,j,s,r,S,q,n,K,f,v,J,l,o,E;function b(){}function at(){var t=null!==E&&E.apply(this,arguments)||this;return t.multipleFiles=!1,t._matrix=null,t._removeEmptySpaceAtBottom=Q["StiOptions"].Export.Word.removeEmptySpaceAtBottom,t.fontList=null,t.styleList=null,t.imageCache=null,t.bookmarkList=null,t.hyperlinkList=null,t.embedsList=null,t.xmlIndentation=1,t.imageQuality=.75,t.imageResolution=96,t.lineSpace=null,t.lineSpace2=null,t.usePageHeadersAndFooters=!1,t.restrictEditing=$.StiWord2007RestrictEditing.No,t.headersData=null,t.headersRels=null,t.footersData=null,t.footersRels=null,t.docCompanyString=null,t.docLastModifiedString=null,t.wrongUrlSymbols=" \"#'*,;<>[^`{|}",t}Z=t=Q.Report||(Q.Report={}),$=e=Z.Export||(Z.Export={}),tt=Q.System.StiArray,et=Q.System.StiString,p=Q.System.Xml.Formatting,g=Q.System.Text.Encoding,i=Q.System.DateTime,m=Q.Base.Zip.StiZipWriter20,h=Q.System.IO.MemoryStream,c=Q.Report.Components.StiPageOrientation,w=Q.Report.Components.StiPagesCollection,rt=Q.Base.Drawing.StiBorderSides,it=Q.Base.Drawing.StiVertAlignment,nt=Q.Report.Components.StiRichText,ot=Q.Report.Components.StiText,d=Q.System.Xml.XmlTextWriter,G=Q.System.Char,V=Q.System.Text.StringBuilder,u=Q.Base.Drawing.StiBrush,_=Q.Report.Components.IStiFont,a=Q.Report.Components.IStiTextBrush,j=Q.Report.Components.IStiTextHorAlignment,s=Q.Report.Components.IStiTextOptions,r=Q.Base.Drawing.StiPenStyle,S=Q.System.Collections.Hashtable,q=Q.Base.Drawing.StiTextHorAlignment,n=Q.Base.Localization.StiLocalization,K=Q.Report.Components.IStiHorAlignment,f=Q.Base.Drawing.StiHtmlTagsState,v=Q.Base.Drawing.StiHtmlState,J=Q.Report.Components.IStiExportImageExtended,l=b,E=$.StiExportService,__extends(at,E),at.prototype.implements=function(){return[$.IStiWord2007ExportService]},Object.defineProperty(at.prototype,"defaultExtension",{get:function(){return"docx"},enumerable:!1,configurable:!0}),Object.defineProperty(at.prototype,"exportFormat",{get:function(){return Z.StiExportFormat.Word2007},enumerable:!1,configurable:!0}),Object.defineProperty(at.prototype,"groupCategory",{get:function(){return"Word"},enumerable:!1,configurable:!0}),Object.defineProperty(at.prototype,"position",{get:function(){return $.StiExportPosition.Word2007},enumerable:!1,configurable:!0}),Object.defineProperty(at.prototype,"exportNameInMenu",{get:function(){return n.get("Export","ExportTypeWord2007File")},enumerable:!1,configurable:!0}),at.prototype.exportTo=function(t,e,r){this.exportWord(t,e,r)},at.prototype.exportToAsync=function(t,e,r,i){var n=this;Q.Report.Export.StiExportImageHelper.convertAllImages(e,Q.System.Drawing.Imaging.ImageFormat.Jpeg).try(function(){n.exportTo(e,r,i),null!=e&&null!=e.preparedExportImages&&(e.preparedExportImages.clear(),e.preparedExportImages=null),t()})},at.prototype.getFilter=function(){return n.get("FileFilters","Word2007Files")},Object.defineProperty(at.prototype,"matrix",{get:function(){return this._matrix},enumerable:!1,configurable:!0}),Object.defineProperty(at.prototype,"removeEmptySpaceAtBottom",{get:function(){return this._removeEmptySpaceAtBottom},enumerable:!1,configurable:!0}),at.prototype.checkFontsToCorrectHeight=function(t){return"Arial Unicode MS"==t||"Microsoft YaHei"==t},at.prototype.getLineStyle=function(t){switch(t){case r.Solid:return"single";case r.Dot:return"dotted";case r.Dash:return"dashSmallGap";case r.DashDot:return"dotDash";case r.DashDotDot:return"dotDotDash";case r.Double:return"double";default:return""}},at.prototype.getColorString=function(t){if(0==t.a)return"auto";if(t.a<32)return"FFFFFF";return et.format("{0:X8}",t.toArgb()).substr(2)},at.prototype.getStyleNumber=function(t,e){if(0<t.length)for(var r=0;r<t.length;r++){var i=t[r];if(i.alignment==e.alignment&&i.name==e.name&&i.fontName==e.fontName&&i.fontSize==e.fontSize&&i.bold==e.bold&&i.italic==e.italic&&i.underline==e.underline&&i.textColor.equals(e.textColor)&&i.rightToLeft==e.rightToLeft)return r}var n;return t.push(e),t.length-1},at.prototype.getStyleFromComponent=function(t){if(null!=t&&!et.isNullOrEmpty(t.componentStyle)){var e=t.stimulsoft.as(_),r=t.stimulsoft.as(a),i=t.stimulsoft.as(j),n=t.stimulsoft.as(s),o=new l;return o.name=t.componentStyle,null!=e&&(o.fontName=e.font.name,o.fontSize=Math.round2(2*e.font.sizeInPoints,0),o.bold=e.font.bold,o.italic=e.font.italic,o.underline=e.font.underline),null!=r&&(o.textColor=u.toColor(r.textBrush)),null!=i&&(o.alignment=i.horAlignment),null!=n&&(o.rightToLeft=n.textOptions.rightToLeft),this.getStyleNumber(this.styleList,o)}return-1},at.prototype.stringToUrl=function(t){var e,r,i,n;if(et.isNullOrEmpty(t))return"";var o=new V;if(t.stimulsoft.startsWith("file:"))try{for(var a=__values(t.split("")),s=a.next(),l;!s.done;s=a.next()){(l=s.value).charCodeAt(0)<32||'"'==l?o.append(et.format("%{0:x2}",l)):o.append(l)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}else try{for(var m=__values(t.split("")),c=m.next(),l;!c.done;c=m.next()){(l=c.value).charCodeAt(0)<32||-1!=this.wrongUrlSymbols.indexOf(l)?o.append("_"):o.append(l)}}catch(t){i={error:t}}finally{try{c&&!c.done&&(n=m.return)&&n.call(m)}finally{if(i)throw i.error}}return o.toString()},Object.defineProperty(at,"hiToTwips",{get:function(){return 14.4*.995},enumerable:!1,configurable:!0}),at.prototype.convert=function(t){return Math.round2(t*at.hiToTwips)},at.prototype.convertHiToTwips=function(t){return Math.round2(14.4*t)},at.prototype.convertTwipsToEmu=function(t){return Math.round2(t/at.hiToTwips/100*914400)},at.prototype.convertStringToBookmark=function(t){var e,r,i=new V;try{for(var n=__values(t.split("")),o=n.next();!o.done;o=n.next()){var a=o.value;G.isLetterOrDigit(a)&&i.append(a)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return 0<i.length&&null!=i.toString()[0]&&G.isDigit(i.toString()[0])&&i.insert(0,"b"),i.toString()},at.prototype.writeFromMatrix=function(t,e,r,i){for(var n,o,a=this.matrix.coordX.countItems,s=this.matrix.coordY.countItems,l=tt.create(Number,a),m=this.matrix.coordX.getKeys(),c=0;c<a;c++){var p=this.matrix.coordX.getByIndex(c,m);l[c]=this.convert(p)}for(var g=tt.create(Number,s),h=this.matrix.coordY.getKeys(),w=0;w<s;w++){var d=this.matrix.coordY.getByIndex(w,h);g[w]=this.convert(d)}var u=!1,S=0,f=tt.create2(Boolean,s,a),v=tt.create2(Boolean,s,a),E="";this.currentPassNumber=2+(Q["StiOptions"].Export.Word.divideSegmentPages?1:0);for(var w=1;w<s;w++){this.invokeExporting2(w,s,this.currentPassNumber,this.maximumPassNumber);var b=e<=w-1&&w-1<=r;0==i&&(this.matrix.linePlacement[w-1]!=$.StiTableLineInfo.PageHeader&&this.matrix.linePlacement[w-1]!=$.StiTableLineInfo.PageFooter&&this.matrix.linePlacement[w-1]!=$.StiTableLineInfo.Trash||(b=!1)),0<S&&(S--,b=!1);var y=100005,x=[],A=!1;if(b)for(var T=1;T<a;T++){var P=this.matrix.cells[w-1][T-1],L,L;0==f[w][T]&&null!=P&&null!=P.component&&(null!=P.component.tagValue&&(-1!=(L=P.component.tagValue.toString().toLowerCase()).indexOf("rtfparagraph")&&(x.push(P),b=!1),-1!=L.indexOf("rtfnewpage")&&(A=!0)),L=null,P.component.is(ot)&&(L=P.component.margins),P.component.is(nt)&&(L=P.component.margins),null!=L&&(L.top<y&&(y=L.top),0<P.height&&(y=0)))}y*=at.hiToTwips;var C=Math.round2(y),F,R,F;A&&(u&&(t.writeFullEndElement(),u=!1),t.writeStartElement("w:p"),t.writeStartElement("w:r"),t.writeStartElement("w:br"),t.writeAttributeString("w:type","page"),t.writeEndElement(),t.writeEndElement(),t.writeEndElement()),b&&(this.usePageHeadersAndFooters&&this.matrix.linePlacement[w-1]==$.StiTableLineInfo.HeaderAP&&(-1!=(R=(F=this.matrix.parentBandName[w-1]).indexOf(""))&&(F=F.substr(0,R)),F!=E&&(E=F,u&&t.writeFullEndElement(),t.writeStartElement("w:p"),t.writeEndElement(),t.writeStartElement("w:tbl"),this.writeTableInfo(t,l,a),u=!0)),u||(t.writeStartElement("w:tbl"),this.writeTableInfo(t,l,a),u=!0),t.writeStartElement("w:tr"),F=g[w]-g[w-1],t.writeStartElement("w:trPr"),this.usePageHeadersAndFooters&&!Q["StiOptions"].Export.Word.forceLineHeight||(t.writeStartElement("w:trHeight"),(!this.usePageHeadersAndFooters&&Q["StiOptions"].Export.Word.lineHeightExactly||this.usePageHeadersAndFooters&&Q["StiOptions"].Export.Word.lineHeightExactlyForPHFMode)&&t.writeAttributeString("w:hRule","exact"),t.writeAttributeString("w:val",et.format("{0}",F)),t.writeEndElement()),this.usePageHeadersAndFooters&&this.matrix.linePlacement[w-1]==$.StiTableLineInfo.HeaderAP&&(t.writeStartElement("w:tblHeader"),t.writeEndElement()),t.writeEndElement());for(var I=0,c=1;c<a;c++){var P=this.matrix.cells[w-1][c-1];if(!f[w][c]||v[w][c]){I++;var B=!0;if(v[w][c]){var D=w;while(v[D][c])D--;P=this.matrix.cells[D-1][c-1],B=!1}if(null!=P&&B){for(var k=0;k<=P.height;k++)for(var N=0;N<=P.width;N++)f[w+k][c+N]=!0;if(0<P.height)for(var k=1;k<=P.height;k++)v[w+k][c]=!0}if(b){if(t.writeStartElement("w:tc"),null!=P){t.writeStartElement("w:tcPr");for(var O=0,M=0,H,H;M<P.width+1;M++)O+=l[c+M]-l[c-1+M];t.writeStartElement("w:tcW"),t.writeAttributeString("w:w",et.format("{0}",O)),t.writeAttributeString("w:type","dxa"),t.writeEndElement(),0<P.width&&(t.writeStartElement("w:gridSpan"),t.writeAttributeString("w:val",et.format("{0}",P.width+1)),t.writeEndElement()),0<P.height&&(v[w][c]?t.writeStartElement("w:vMerge"):(t.writeStartElement("w:vMerge"),t.writeAttributeString("w:val","restart")),t.writeEndElement()),null==P.cellStyle.textOptions||""!=(H=225<(H=P.cellStyle.textOptions.angle)&&H<315?"tbRl":45<H&&H<135?"btLr":"")&&(t.writeStartElement("w:textDirection"),t.writeAttributeString("w:val",H),t.writeEndElement());var H=P.component.is(ot)&&P.component.checkAllowHtmlTags()&&!Q["StiOptions"].Export.Word.renderHtmlTagsAsImage,H,U,z,H;B&&P.component.is(ot)&&(!P.component.isExportAsImage(Z.StiExportFormat.Word2007)||H)&&(H=P.component,U=this.convert(H.margins.left),z=this.convert(H.margins.right-Q["StiOptions"].Export.Word.rightMarginCorrection),C<(H=this.convert(H.margins.top))&&(H=C),(0<U||0<z||0<H)&&(t.writeStartElement("w:tcMar"),0<H&&(t.writeStartElement("w:top"),t.writeAttributeString("w:w",et.format("{0}",H)),t.writeAttributeString("w:type","dxa"),t.writeEndElement()),0<U&&(t.writeStartElement("w:left"),t.writeAttributeString("w:w",et.format("{0}",U)),t.writeAttributeString("w:type","dxa"),t.writeEndElement()),0<z&&(t.writeStartElement("w:right"),t.writeAttributeString("w:w",et.format("{0}",z)),t.writeAttributeString("w:type","dxa"),t.writeEndElement()),t.writeEndElement()));var U="";switch(P.cellStyle.vertAlignment){case it.Center:U="center";break;case it.Bottom:U="bottom";break}""!=U&&(t.writeStartElement("w:vAlign"),t.writeAttributeString("w:val",U),t.writeEndElement()),this.writeBorders(t,P.top,P.left,P.height+1,P.width+1),P.component.isExportAsImage(Z.StiExportFormat.Word2007)||(t.writeStartElement("w:shd"),t.writeAttributeString("w:val","clear"),t.writeAttributeString("w:color","auto"),t.writeAttributeString("w:fill",this.getColorString(P.cellStyle.color)),t.writeEndElement()),t.writeEndElement();var z=this.restrictEditing==$.StiWord2007RestrictEditing.ExceptEditableFields&&null!=P.component&&P.component.is(ot)&&P.component.editable;z&&(t.writeStartElement("w:permStart"),t.writeAttributeString("w:id","0"),t.writeEndElement());var U=!0,B;B&&(B={ref:U},this.writeCellContent(t,P,B,w,c,l,g),U=B.ref),U&&(t.writeStartElement("w:p"),t.writeFullEndElement()),z&&(t.writeStartElement("w:permEnd"),t.writeAttributeString("w:id","0"),t.writeEndElement())}else{var X=null,z={ref:X},W=this.renderBorder2TableGetValues(w,c,z),Y=0;if(0==(W&rt.Right)){while(c+Y+1<a&&null==this.matrix.cells[w-1][c+Y+1-1]&&0==f[w][c+Y+1]&&0==v[w][c+Y+1]){var G=null,V={ref:G},V=this.renderBorder2TableGetValues(w,c+Y+1,V);if(0<(V&rt.Left))break;if((V&(rt.Top|rt.Bottom))!=(W&(rt.Top|rt.Bottom)))break;if(X!=G)break;if(Y++,0<(V&rt.Right))break}if(0<Y)for(var N=1;N<=Y;N++)f[w][c+N]=!0}t.writeStartElement("w:tcPr");var O=l[c+Y]-l[c-1];t.writeStartElement("w:tcW"),t.writeAttributeString("w:w",et.format("{0}",O)),t.writeAttributeString("w:type","dxa"),t.writeEndElement(),0<Y&&(t.writeStartElement("w:gridSpan"),t.writeAttributeString("w:val",et.format("{0}",Y+1)),t.writeEndElement()),this.writeBorders(t,w-1,c-1,1,Y+1),t.writeEndElement(),t.writeStartElement("w:p"),t.writeFullEndElement()}t.writeFullEndElement()}}if(64<=I)break}b&&t.writeFullEndElement();try{for(var _=(n=void 0,__values(x)),j=_.next();!j.done;j=_.next()){var q=j.value;u&&t.writeEndElement(),u=!1,S=q.height;var K,J={ref:K=!1};this.writeCellContent(t,q,J,q.top+1,q.left+1,l,g),K=J.ref}}catch(t){n={error:t}}finally{try{j&&!j.done&&(o=_.return)&&o.call(_)}finally{if(n)throw n.error}}}u&&t.writeEndElement()},at.prototype.writeCellContent=function(t,e,r,i,n,o,a){var s,l,m,c,p=r.ref,g=null,h=-1,w=this.matrix.bookmarks[i-1][n-1];null==w||this.bookmarkList.containsKey(w)||(h=this.bookmarkList.count,g=this.convertStringToBookmark(w),this.bookmarkList.set(w,h));var d=null,u=-1,S,f,v,E,w,S,b,p,v,v,w,S,y,x,A,T,b,n,E;if(null==e.component||null==e.component.hyperlinkValue||0<(S=e.component.hyperlinkValue.toString().trim()).length&&!S.stimulsoft.startsWith("javascript:")&&(S.stimulsoft.startsWith("#")?d=this.convertStringToBookmark(S.substr(1)):(d=this.stringToUrl(S),this.hyperlinkList.containsKey(d)?u=Math.trunc(this.hyperlinkList.get(d)):(u=this.hyperlinkList.count,this.hyperlinkList.add(d,u)))),!e.component.is(ot)||e.component.isExportAsImage(Z.StiExportFormat.Word2007)||e.component.checkAllowHtmlTags()){e.component.is(nt)&&!Q["StiOptions"].Export.Word.renderRichTextAsImage?f=e.component:e.component.is(ot)&&e.component.checkAllowHtmlTags()&&!Q["StiOptions"].Export.Word.renderHtmlTagsAsImage?et.isNullOrWhiteSpace(e.text)||this.writeHtmlTags(t,e):e.component.isExportAsImage(Z.StiExportFormat.Word2007)?null!=(v=e.component.stimulsoft.as(J))&&(w={ref:this.imageResolution},S=v.getImage(w),E=w.ref,null!=S&&(p=!1,v=0,v=null!=(b=this.matrix.getRealImageData(e,S))?this.imageCache.addImageIntRaw(b,b.imageFormat):this.imageCache.addImageIntRaw(S,S.imageFormat),S=w=-1,t.writeStartElement("w:p"),t.writeStartElement("w:pPr"),y=e.cellStyle.horAlignment,x=!1,null!=e.cellStyle.textOptions&&(x=e.cellStyle.textOptions.rightToLeft),null==e.component.stimulsoft.as(j)&&(A=e.component.stimulsoft.as(K)),T="",(y==q.Left&&1==x||y==q.Right&&0==x)&&(T="right"),y==q.Center&&(T="center"),y==q.Width&&(T="both"),""!=T&&(t.writeStartElement("w:jc"),t.writeAttributeString("w:val",T),t.writeEndElement()),t.writeEndElement(),-1!=h&&(t.writeStartElement("w:bookmarkStart"),t.writeAttributeString("w:id",h.toString()),t.writeAttributeString("w:name",g),t.writeEndElement()),t.writeStartElement("w:r"),t.writeStartElement("w:rPr"),t.writeElementString("w:noProof",""),t.writeEndElement(),t.writeStartElement("w:drawing"),t.writeStartElement("wp:inline"),t.writeAttributeString("distT","0"),t.writeAttributeString("distB","0"),t.writeAttributeString("distL","0"),t.writeAttributeString("distR","0"),b=a[i-1+e.height+1]-a[i-1],n=o[n-1+e.width+1]-o[n-1],-1!=w&&(n=w,b=S),t.writeStartElement("wp:extent"),t.writeAttributeString("cx",et.format("{0}",this.convertTwipsToEmu(n))),t.writeAttributeString("cy",et.format("{0}",this.convertTwipsToEmu(b))),t.writeEndElement(),t.writeStartElement("wp:effectExtent"),t.writeAttributeString("l","0"),t.writeAttributeString("t","0"),t.writeAttributeString("r","0"),t.writeAttributeString("b","0"),t.writeEndElement(),t.writeStartElement("wp:docPr"),t.writeAttributeString("id",et.format("{0}",v+2)),t.writeAttributeString("name",et.format("Picture {0}",v+1)),t.writeAttributeString("descr",et.format("Image{0:D5}.jpg",v+1)),null!=d&&(-1==u&&(d="#"+d,this.hyperlinkList.containsKey(d)?u=this.hyperlinkList.get(d):(u=this.hyperlinkList.count,this.hyperlinkList.add(d,u))),t.writeStartElement("a:hlinkClick"),t.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),t.writeAttributeString("r:id",et.format("hId{0}",u)),t.writeEndElement()),t.writeEndElement(),t.writeStartElement("wp:cNvGraphicFramePr"),t.writeStartElement("a:graphicFrameLocks"),t.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),t.writeAttributeString("noChangeAspect","1"),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("a:graphic"),t.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),t.writeStartElement("a:graphicData"),t.writeAttributeString("uri","http://schemas.openxmlformats.org/drawingml/2006/picture"),t.writeStartElement("pic:pic"),t.writeAttributeString("xmlns:pic","http://schemas.openxmlformats.org/drawingml/2006/picture"),t.writeStartElement("pic:nvPicPr"),t.writeStartElement("pic:cNvPr"),t.writeAttributeString("id","0"),t.writeAttributeString("name",et.format("Image{0:D5}.jpg",v+1)),t.writeEndElement(),t.writeStartElement("pic:cNvPicPr"),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("pic:blipFill"),t.writeStartElement("a:blip"),t.writeAttributeString("r:embed",et.format("rId{0}",5+v)),t.writeAttributeString("cstate","print"),t.writeEndElement(),t.writeStartElement("a:stretch"),t.writeStartElement("a:fillRect"),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("pic:spPr"),t.writeStartElement("a:xfrm"),t.writeStartElement("a:off"),t.writeAttributeString("x","0"),t.writeAttributeString("y","0"),t.writeEndElement(),t.writeStartElement("a:ext"),t.writeAttributeString("cx",et.format("{0}",this.convertTwipsToEmu(n))),t.writeAttributeString("cy",et.format("{0}",this.convertTwipsToEmu(b))),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("a:prstGeom"),t.writeAttributeString("prst","rect"),t.writeStartElement("a:avLst"),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),-1!=h&&(t.writeStartElement("w:bookmarkEnd"),t.writeAttributeString("w:id",h.toString()),t.writeEndElement()),t.writeEndElement())):-1!=h&&(t.writeStartElement("w:bookmarkStart"),t.writeAttributeString("w:id",h.toString()),t.writeAttributeString("w:name",g),t.writeEndElement(),t.writeStartElement("w:bookmarkEnd"),t.writeAttributeString("w:id",h.toString()),t.writeEndElement())}else{var P=new V(e.text),b;this.usePageHeadersAndFooters&&(b=e.component.tagValue,et.isNullOrEmpty(b)||-1!=b.toLowerCase().indexOf("rtfnewpage")||-1==b.indexOf("#PageNumber#")&&-1==b.indexOf("#TotalPageCount#")&&-1==b.indexOf("#PageRef")||(P=new V(b)));var L=[],C="";try{for(var F=__values(P.toString().split("")),R=F.next();!R.done;R=F.next()){var I=R.value;G.isControl(I)&&"\t"!=I?"\n"==I&&(L.push(C),C=""):C+=I}}catch(t){s={error:t}}finally{try{R&&!R.done&&(l=F.return)&&l.call(F)}finally{if(s)throw s.error}}""!=C&&L.push(C),0==L.length&&L.push(C),0<L.length&&(p=!1);for(var B=this.getStyleFromComponent(e.component),D=0;D<L.length;D++){var k=L[D];t.writeStartElement("w:p"),t.writeStartElement("w:pPr");var N=e.component.stimulsoft.as(ot).lineSpacing,O,M;null==this.lineSpace&&1==N||(O=this.lineSpace,1!=N&&(O=Math.round2(240*Q["StiOptions"].Export.Word.lineSpacing*N).toString()),null!=(M=e.component.stimulsoft.as(_))&&null!=M.font&&this.checkFontsToCorrectHeight(M.font.name)&&(O=this.lineSpace2,1!=N&&(O=Math.round2(240*Q["StiOptions"].Export.Word.lineSpacing*.772*N).toString())),t.writeStartElement("w:spacing"),t.writeAttributeString("w:line",O),t.writeEndElement()),-1!=B&&(t.writeStartElement("w:pStyle"),t.writeAttributeString("w:val",et.format("Style{0}",B)),t.writeEndElement());var y=e.cellStyle.horAlignment,x=!1;null!=e.cellStyle.textOptions&&(x=e.cellStyle.textOptions.rightToLeft);var T="";if((y==q.Left&&1==x||y==q.Right&&0==x)&&(T="right"),y==q.Center&&(T="center"),y==q.Width&&(T="both"),""!=T&&(t.writeStartElement("w:jc"),t.writeAttributeString("w:val",T),t.writeEndElement()),-1==B&&this.writeRunProperties(t,e),t.writeEndElement(),null!=d&&(t.writeStartElement("w:hyperlink"),-1==u?t.writeAttributeString("w:anchor",d):t.writeAttributeString("r:id",et.format("hId{0}",u))),-1!=h&&(t.writeStartElement("w:bookmarkStart"),t.writeAttributeString("w:id",h.toString()),t.writeAttributeString("w:name",g),t.writeEndElement()),""!=k)if(this.usePageHeadersAndFooters){k=k.stimulsoft.replaceAll("#PageNumber#","").stimulsoft.replaceAll("#TotalPageCount#","");var H=[],U=new V;try{for(var z=(m=void 0,__values(k.split(""))),X=z.next(),I;!X.done;X=z.next()){""==(I=X.value)||""==I?(0<U.length&&H.push(U.toString()),H.push(I.toString()),U=new V):U.append(I)}}catch(t){m={error:t}}finally{try{X&&!X.done&&(c=z.return)&&c.call(z)}finally{if(m)throw m.error}}0<U.length&&H.push(U.toString()),0==H.length&&H.push(k);for(var W=0;W<H.length;W++){var Y=H[W];if(0<Y.length&&(""==Y[0]||""==Y[0])){switch(t.writeStartElement("w:r"),-1==B&&this.writeRunProperties(t,e),t.writeStartElement("w:fldChar"),t.writeAttributeString("w:fldCharType","begin"),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("w:r"),this.writeRunProperties(t,e),t.writeStartElement("w:instrText"),Y.charAt(0)){case"":t.writeString("PAGE");break;case"":t.writeString("NUMPAGES");break}t.writeEndElement(),t.writeEndElement(),t.writeStartElement("w:r"),this.writeRunProperties(t,e),t.writeStartElement("w:fldChar"),t.writeAttributeString("w:fldCharType","end"),t.writeEndElement(),t.writeEndElement()}else t.writeStartElement("w:r"),-1==B&&this.writeRunProperties(t,e),t.writeStartElement("w:t"),t.writeAttributeString("xml:space","preserve"),t.writeString(Y),t.writeEndElement(),t.writeEndElement()}}else t.writeStartElement("w:r"),-1==B&&this.writeRunProperties(t,e),t.writeStartElement("w:t"),t.writeAttributeString("xml:space","preserve"),t.writeString(k),t.writeEndElement(),t.writeEndElement();-1!=h&&(t.writeStartElement("w:bookmarkEnd"),t.writeAttributeString("w:id",h.toString()),t.writeEndElement()),null!=d&&t.writeEndElement(),t.writeEndElement()}}r.ref=p},at.prototype.writeTableInfo=function(t,e,r){t.writeStartElement("w:tblPr"),t.writeStartElement("w:tblStyle"),t.writeAttributeString("w:val","a1"),t.writeEndElement(),t.writeStartElement("w:tblW"),t.writeAttributeString("w:w","0"),t.writeAttributeString("w:type","dxa"),t.writeEndElement(),t.writeStartElement("w:tblLayout"),t.writeAttributeString("w:type","fixed"),t.writeEndElement(),t.writeStartElement("w:tblCellMar"),t.writeStartElement("w:top"),t.writeAttributeString("w:w","0"),t.writeAttributeString("w:type","dxa"),t.writeEndElement(),t.writeStartElement("w:left"),t.writeAttributeString("w:w","0"),t.writeAttributeString("w:type","dxa"),t.writeEndElement(),t.writeStartElement("w:bottom"),t.writeAttributeString("w:w","0"),t.writeAttributeString("w:type","dxa"),t.writeEndElement(),t.writeStartElement("w:right"),t.writeAttributeString("w:w","0"),t.writeAttributeString("w:type","dxa"),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("w:tblLook"),t.writeAttributeString("w:val","04A0"),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("w:tblGrid");for(var i=1;i<r;i++){var n=e[i]-e[i-1];t.writeStartElement("w:gridCol"),t.writeAttributeString("w:w",et.format("{0}",n)),t.writeEndElement()}t.writeFullEndElement()},at.prototype.writeHtmlTags=function(t,e){var r=e.component,i=e.text,n=new f(r.font.bold,r.font.italic,r.font.underline,r.font.strikeout,r.font.sizeInPoints,r.font.name,u.toColor(r.textBrush),u.toColor(r.brush),!1,!1,0,0,r.lineSpacing,r.horAlignment),r=new v(n,0),o=Q.Base.Drawing.StiTextRenderer.parseHtmlToStates(i,r),a=this.getStyleFromComponent(e.component);this.writeParagraphBegin(t,e,a,o,0);for(var s=0;s<o.length;s++){var l=o[s],m=l.ts;if("\n"==l.text.toString()&&s<o.stimulsoft.countItems-1){t.writeEndElement(),this.writeParagraphBegin(t,e,a,o,s+1);continue}t.writeStartElement("w:r"),t.writeStartElement("w:rPr"),m.bold&&(t.writeStartElement("w:b"),t.writeEndElement()),m.italic&&(t.writeStartElement("w:i"),t.writeEndElement()),m.underline&&(t.writeStartElement("w:u"),t.writeAttributeString("w:val","single"),t.writeEndElement()),m.strikeout&&(t.writeStartElement("w:strike"),t.writeEndElement()),m.superscript&&(t.writeStartElement("w:vertAlign"),t.writeAttributeString("w:val","superscript"),t.writeEndElement()),m.subsript&&(t.writeStartElement("w:vertAlign"),t.writeAttributeString("w:val","subscript"),t.writeEndElement()),m.fontColor.toArgb()!=n.fontColor.toArgb()&&(t.writeStartElement("w:color"),t.writeAttributeString("w:val",this.getColorString(m.fontColor)),t.writeEndElement()),m.backColor.toArgb()!=n.backColor.toArgb()&&(t.writeStartElement("w:shd"),t.writeAttributeString("w:val","clear"),t.writeAttributeString("w:color","auto"),t.writeAttributeString("w:fill",this.getColorString(m.backColor)),t.writeEndElement()),t.writeStartElement("w:sz"),t.writeAttributeString("w:val",(2*m.fontSize).toString()),t.writeEndElement(),t.writeStartElement("w:szCs"),t.writeAttributeString("w:val",(2*m.fontSize).toString()),t.writeEndElement(),t.writeStartElement("w:rFonts");var c=m.fontName;this.fontList.set(c,c),t.writeAttributeString("w:ascii",c),t.writeAttributeString("w:hAnsi",c),t.writeAttributeString("w:eastAsia",c),t.writeAttributeString("w:cs",c),t.writeEndElement();var m=m.letterSpacing*m.fontSize*18.8+Q["StiOptions"].Export.Word.spaceBetweenCharacters;0!=m&&(t.writeStartElement("w:spacing"),t.writeAttributeString("w:val",m.toString()),t.writeEndElement()),null!=e.cellStyle.textOptions&&e.cellStyle.textOptions.rightToLeft&&(t.writeStartElement("w:rtl"),t.writeEndElement()),t.writeEndElement(),t.writeStartElement("w:t"),t.writeAttributeString("xml:space","preserve"),t.writeString(Q.Base.Drawing.StiTextRenderer.prepareStateText(l.text).toString()),t.writeEndElement(),t.writeEndElement()}t.writeEndElement()},at.prototype.writeParagraphBegin=function(t,e,r,i,n){t.writeStartElement("w:p"),t.writeStartElement("w:pPr"),-1!=r?(t.writeStartElement("w:pStyle"),t.writeAttributeString("w:val",et.format("Style{0}",r)),t.writeEndElement()):this.writeRunProperties(t,e);var o=i[n];if("\n"!=o.text.toString()){var a=n+1;while(a<i.length&&"\n"!=i[a].text.toString())o=i[a],a++}var n=Q["StiOptions"].Export.Word.lineSpacing*o.ts.lineHeight;this.checkFontsToCorrectHeight(o.ts.fontName)&&(n*=.772),1!=n&&(t.writeStartElement("w:spacing"),t.writeAttributeString("w:line",Math.round2(240*n).toString()),t.writeEndElement());var n=null;o.ts.textAlign==q.Center&&(n="center"),o.ts.textAlign==q.Right&&(n="right"),o.ts.textAlign==q.Width&&(n="both"),null!=n&&(t.writeStartElement("w:jc"),t.writeAttributeString("w:val",n),t.writeEndElement()),t.writeEndElement()},at.prototype.writeRunProperties=function(t,e){t.writeStartElement("w:rPr"),t.writeStartElement("w:rFonts");var r=e.cellStyle.font.name;this.fontList.set(r,r),t.writeAttributeString("w:ascii",r),t.writeAttributeString("w:hAnsi",r),t.writeAttributeString("w:eastAsia",r),t.writeAttributeString("w:cs",r),t.writeEndElement(),e.cellStyle.font.bold&&(t.writeStartElement("w:b"),t.writeEndElement()),e.cellStyle.font.italic&&(t.writeStartElement("w:i"),t.writeEndElement()),e.cellStyle.font.underline&&(t.writeStartElement("w:u"),t.writeAttributeString("w:val","single"),t.writeEndElement()),t.writeStartElement("w:color"),t.writeAttributeString("w:val",this.getColorString(e.cellStyle.textColor)),t.writeEndElement(),t.writeStartElement("w:sz"),t.writeAttributeString("w:val",et.format("{0}",2*e.cellStyle.font.sizeInPoints)),t.writeEndElement(),0!=Q["StiOptions"].Export.Word.spaceBetweenCharacters&&(t.writeStartElement("w:spacing"),t.writeAttributeString("w:val",et.format("{0}",Q["StiOptions"].Export.Word.spaceBetweenCharacters)),t.writeEndElement()),null!=e.cellStyle.textOptions&&e.cellStyle.textOptions.rightToLeft&&(e.cellStyle.font.bold&&(t.writeStartElement("w:bCs"),t.writeEndElement()),e.cellStyle.font.italic&&(t.writeStartElement("w:iCs"),t.writeEndElement()),t.writeStartElement("w:szCs"),t.writeAttributeString("w:val",et.format("{0}",2*e.cellStyle.font.sizeInPoints)),t.writeEndElement(),t.writeStartElement("w:rtl"),t.writeEndElement()),t.writeEndElement()},at.prototype.renderBorder2TableGetValues=function(t,e,r){var i=r.ref,n=rt.None,o=new V;return null!=this.matrix.bordersY[t-1][e-1]&&(n|=rt.Left),null!=this.matrix.bordersY[t-1][e-1+1]&&(n|=rt.Right),null!=this.matrix.bordersX[t-1][e-1]&&(o.append("\\t"+this.getLineStyle2TableGetValues(this.matrix.bordersX[t-1][e-1])),n|=rt.Top),null!=this.matrix.bordersX[t-1+1][e-1]&&(o.append("\\b"+this.getLineStyle2TableGetValues(this.matrix.bordersX[t-1+1][e-1])),n|=rt.Bottom),i=o.toString(),r.ref=i,n},at.prototype.getLineStyle2TableGetValues=function(t){var e=new V;return e.append(this.getLineStyle(t.style)),e.append(Math.trunc(15*t.size)),e.append(et.format("c{0}",this.getColorString(t.color))),e.toString()},at.prototype.writeDocument=function(t,e,r){var i=new h,n=new d(g.UTF8,i);n.indentation=this.xmlIndentation<0?0:this.xmlIndentation,n.formatting=this.xmlIndentation<0?p.None:p.Indented,n.writeStartDocument(),n.writeStartElement("w:document"),n.writeAttributeString("xmlns:ve","http://schemas.openxmlformats.org/markup-compatibility/2006"),n.writeAttributeString("xmlns:o","urn:schemas-microsoft-com:office:office"),n.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),n.writeAttributeString("xmlns:m","http://schemas.openxmlformats.org/officeDocument/2006/math"),n.writeAttributeString("xmlns:v","urn:schemas-microsoft-com:vml"),n.writeAttributeString("xmlns:wp","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"),n.writeAttributeString("xmlns:w10","urn:schemas-microsoft-com:office:word"),n.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),n.writeAttributeString("xmlns:wne","http://schemas.microsoft.com/office/word/2006/wordml"),n.writeStartElement("w:body");var o=t;t=null;var a=0,s=0;while(a<o.count){(t=new w(e,o)).cacheMode=e.renderedPages.cacheMode,t.addV2Internal(o.getPageWithoutCache(a));while(a<o.count-1&&this.comparePages(o.getPageWithoutCache(a+1),o.getPageWithoutCache(a)))a++,t.addV2Internal(o.getPageWithoutCache(a));var l=t.getByIndex(0);if(null!=l){if(t.getPage(l),this.usePageHeadersAndFooters){var l=new w(e,e.renderedPages);l.cacheMode=e.renderedPages.cacheMode,l.add(t.getByIndex(0)),this._matrix=new $.StiMatrix(l,Q["StiOptions"].Export.Word.divideBigCells,this),this.matrix.scanComponentsPlacement(!1);var m=0,c=0,l=!1,c=this.matrix.coordY.countItems-1-1;while(0<c&&this.matrix.linePlacement[c]!=$.StiTableLineInfo.PageHeader)c--;if(0<=c&&this.matrix.linePlacement[c]==$.StiTableLineInfo.PageHeader){m=0;while(this.matrix.linePlacement[m]!=$.StiTableLineInfo.PageHeader)m++;l=!0}this.headersData.push(this.writeHeader(m,c,l)),0<this.imageCache.imagePackedStore.length?this.headersRels.push(this.writeHeaderFooterRels()):this.headersRels.push(null);var l=!1,m=0;while(this.matrix.linePlacement[m]!=$.StiTableLineInfo.PageFooter&&m<this.matrix.coordY.countItems-1-1)m++;if(this.matrix.linePlacement[m]==$.StiTableLineInfo.PageFooter){c=this.matrix.coordY.countItems-1-1;while(this.matrix.linePlacement[c]!=$.StiTableLineInfo.PageFooter)c--;l=!0}this.footersData.push(this.writeFooter(m,c,l)),0<this.imageCache.imagePackedStore.length?this.footersRels.push(this.writeHeaderFooterRels()):this.footersRels.push(null),this._matrix=new $.StiMatrix(t,Q["StiOptions"].Export.Word.divideBigCells,this),this.matrix.scanComponentsPlacement(!0),c=this.matrix.coordY.countItems-1-1,this.writeFromMatrix(n,0,c,!1)}else this._matrix=new $.StiMatrix(t,Q["StiOptions"].Export.Word.divideBigCells,this,null,$.StiDataExportMode.AllBands,r),this.writeFromMatrix(n,0,this.matrix.coordY.countItems-1-1,!0);a<o.count-1&&(n.writeStartElement("w:p"),n.writeStartElement("w:pPr"),this.writePageInfo(n,t.getByIndex(0),s),n.writeEndElement(),n.writeEndElement())}a++,s++}return 0<t.count&&this.writePageInfo(n,t.getByIndex(0),s-1),n.writeFullEndElement(),n.writeFullEndElement(),n.writeEndDocument(),n.flush(),i},at.prototype.comparePages=function(t,e){var r=t.excelSheetValue;et.isNullOrEmpty(r)&&(r="");var i=e.excelSheetValue;if(et.isNullOrEmpty(i)&&(i=""),r!=i)return!1;if(t.orientation!=e.orientation)return!1;if(!t.margins.equals(e.margins))return!1;if(t.unlimitedHeight!=e.unlimitedHeight)return!1;return!0},at.prototype.writePageInfo=function(t,e,r){var i=this.convertHiToTwips(e.unit.convertToHInches(e.pageHeight*(this.usePageHeadersAndFooters?1:e.segmentPerHeight))),n=this.convertHiToTwips(e.unit.convertToHInches(e.pageWidth*(this.usePageHeadersAndFooters?1:e.segmentPerWidth))),o=this.convertHiToTwips(e.unit.convertToHInches(e.margins.left)),a=this.convertHiToTwips(e.unit.convertToHInches(e.margins.right)),s=this.convertHiToTwips(e.unit.convertToHInches(e.margins.top)),l=this.convertHiToTwips(e.unit.convertToHInches(e.margins.bottom))-Q["StiOptions"].Export.Word.bottomMarginCorrection;l<0&&(l=0),31500<n&&(n=31500),31500<i&&(i=31500),t.writeStartElement("w:sectPr"),this.usePageHeadersAndFooters?(t.writeStartElement("w:headerReference"),t.writeAttributeString("w:type","default"),t.writeAttributeString("r:id",et.format("rIdh{0}",r+1)),t.writeEndElement(),t.writeStartElement("w:footerReference"),t.writeAttributeString("w:type","default"),t.writeAttributeString("r:id",et.format("rIdf{0}",r+1)),t.writeEndElement()):Q.Base.vEIvF.JlKzR.RNAxU()||Q.Base.vEIvF.JlKzR.KqUvN()||(Q.Base.vEIvF.JlKzR.ZHIhL()||Q.Base.vEIvF.JlKzR.LuQMU()||Q.Base.vEIvF.JlKzR.UPtPa())&&Q.System.NodeJs.isStandaloneVersion||(t.writeStartElement("w:headerReference"),t.writeAttributeString("w:type","default"),t.writeAttributeString("r:id","rIdh1"),t.writeEndElement()),t.writeStartElement("w:pgSz"),t.writeAttributeString("w:w",et.format("{0}",n)),t.writeAttributeString("w:h",et.format("{0}",i)),e.orientation==c.Landscape&&t.writeAttributeString("w:orient","landscape"),t.writeEndElement(),t.writeStartElement("w:pgMar"),t.writeAttributeString("w:top",et.format("{0}",s)),t.writeAttributeString("w:right",et.format("{0}",a)),t.writeAttributeString("w:bottom",et.format("{0}",l)),t.writeAttributeString("w:left",et.format("{0}",o)),t.writeAttributeString("w:header",et.format("{0}",s)),t.writeAttributeString("w:footer",et.format("{0}",l)),t.writeAttributeString("w:gutter","0"),t.writeEndElement(),t.writeEndElement()},at.prototype.writeBorders=function(t,e,r,i,n){for(var o=!0,a=!0,s=0;s<i;s++)null==this.matrix.bordersY[e+s][r]&&(o=!1),null==this.matrix.bordersY[e+s][r+n]&&(a=!1);for(var l=!0,m=!0,s=0;s<n;s++)null==this.matrix.bordersX[e][r+s]&&(l=!1),null==this.matrix.bordersX[e+i][r+s]&&(m=!1);(l||o||m||a)&&(t.writeStartElement("w:tcBorders"),l&&this.writeBorderData(t,"w:top",this.matrix.bordersX[e][r]),o&&this.writeBorderData(t,"w:left",this.matrix.bordersY[e][r]),m&&this.writeBorderData(t,"w:bottom",this.matrix.bordersX[e+i][r]),a&&this.writeBorderData(t,"w:right",this.matrix.bordersY[e][r+n]),t.writeEndElement())},at.prototype.writeBorderData=function(t,e,r){var i;null==r||""!=(i=this.getLineStyle(r.style))&&(t.writeStartElement(e),t.writeAttributeString("w:val",i),t.writeAttributeString("w:sz",et.format("{0}",Math.trunc(5*r.size))),t.writeAttributeString("w:space","0"),t.writeAttributeString("w:color",this.getColorString(r.color)),t.writeEndElement())},at.prototype.writeFootNotes=function(){var t=new h,e=new d(g.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?p.None:p.Indented,e.writeStartDocument(),e.writeStartElement("w:footnotes"),e.writeAttributeString("xmlns:ve","http://schemas.openxmlformats.org/markup-compatibility/2006"),e.writeAttributeString("xmlns:o","urn:schemas-microsoft-com:office:office"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeAttributeString("xmlns:m","http://schemas.openxmlformats.org/officeDocument/2006/math"),e.writeAttributeString("xmlns:v","urn:schemas-microsoft-com:vml"),e.writeAttributeString("xmlns:wp","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"),e.writeAttributeString("xmlns:w10","urn:schemas-microsoft-com:office:word"),e.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),e.writeAttributeString("xmlns:wne","http://schemas.microsoft.com/office/word/2006/wordml"),e.writeStartElement("w:footnote"),e.writeAttributeString("w:type","separator"),e.writeAttributeString("w:id","0"),e.writeStartElement("w:p"),e.writeStartElement("w:r"),e.writeStartElement("w:separator"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeStartElement("w:footnote"),e.writeAttributeString("w:type","continuationSeparator"),e.writeAttributeString("w:id","1"),e.writeStartElement("w:p"),e.writeStartElement("w:r"),e.writeStartElement("w:continuationSeparator"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},at.prototype.writeEndNotes=function(){var t=new h,e=new d(g.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?p.None:p.Indented,e.writeStartDocument(),e.writeStartElement("w:endnotes"),e.writeAttributeString("xmlns:ve","http://schemas.openxmlformats.org/markup-compatibility/2006"),e.writeAttributeString("xmlns:o","urn:schemas-microsoft-com:office:office"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeAttributeString("xmlns:m","http://schemas.openxmlformats.org/officeDocument/2006/math"),e.writeAttributeString("xmlns:v","urn:schemas-microsoft-com:vml"),e.writeAttributeString("xmlns:wp","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"),e.writeAttributeString("xmlns:w10","urn:schemas-microsoft-com:office:word"),e.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),e.writeAttributeString("xmlns:wne","http://schemas.microsoft.com/office/word/2006/wordml"),e.writeStartElement("w:endnote"),e.writeAttributeString("w:type","separator"),e.writeAttributeString("w:id","0"),e.writeStartElement("w:p"),e.writeStartElement("w:r"),e.writeStartElement("w:separator"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeStartElement("w:endnote"),e.writeAttributeString("w:type","continuationSeparator"),e.writeAttributeString("w:id","1"),e.writeStartElement("w:p"),e.writeStartElement("w:r"),e.writeStartElement("w:continuationSeparator"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},at.prototype.writeHeader=function(t,e,r){var i=new h,n=new d(g.UTF8,i);return n.indentation=this.xmlIndentation<0?0:this.xmlIndentation,n.formatting=this.xmlIndentation<0?p.None:p.Indented,n.writeStartDocument(),n.writeStartElement("w:hdr"),n.writeAttributeString("xmlns:ve","http://schemas.openxmlformats.org/markup-compatibility/2006"),n.writeAttributeString("xmlns:o","urn:schemas-microsoft-com:office:office"),n.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),n.writeAttributeString("xmlns:m","http://schemas.openxmlformats.org/officeDocument/2006/math"),n.writeAttributeString("xmlns:v","urn:schemas-microsoft-com:vml"),n.writeAttributeString("xmlns:wp","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"),n.writeAttributeString("xmlns:w10","urn:schemas-microsoft-com:office:word"),n.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),n.writeAttributeString("xmlns:wne","http://schemas.microsoft.com/office/word/2006/wordml"),r?this.writeFromMatrix(n,t,e,!0):(n.writeStartElement("w:p"),n.writeStartElement("w:r"),n.writeStartElement("w:cr"),n.writeEndElement(),n.writeEndElement(),n.writeEndElement()),n.writeFullEndElement(),n.writeEndDocument(),n.flush(),i},at.prototype.writeFooter=function(t,e,r){var i=new h,n=new d(g.UTF8,i);return n.indentation=this.xmlIndentation<0?0:this.xmlIndentation,n.formatting=this.xmlIndentation<0?p.None:p.Indented,n.writeStartDocument(),n.writeStartElement("w:ftr"),n.writeAttributeString("xmlns:ve","http://schemas.openxmlformats.org/markup-compatibility/2006"),n.writeAttributeString("xmlns:o","urn:schemas-microsoft-com:office:office"),n.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),n.writeAttributeString("xmlns:m","http://schemas.openxmlformats.org/officeDocument/2006/math"),n.writeAttributeString("xmlns:v","urn:schemas-microsoft-com:vml"),n.writeAttributeString("xmlns:wp","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"),n.writeAttributeString("xmlns:w10","urn:schemas-microsoft-com:office:word"),n.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),n.writeAttributeString("xmlns:wne","http://schemas.microsoft.com/office/word/2006/wordml"),r?this.writeFromMatrix(n,t,e,!0):(n.writeStartElement("w:p"),n.writeStartElement("w:r"),n.writeStartElement("w:cr"),n.writeEndElement(),n.writeEndElement(),n.writeEndElement()),n.writeFullEndElement(),n.writeEndDocument(),n.flush(),i},at.prototype.writeContentTypes=function(){var t=new h,e=new d(g.UTF8,t);if(e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?p.None:p.Indented,e.writeStartDocument(),e.writeStartElement("Types"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/content-types"),e.writeStartElement("Default"),e.writeAttributeString("Extension","rels"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-package.relationships+xml"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","xml"),e.writeAttributeString("ContentType","application/xml"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","jpeg"),e.writeAttributeString("ContentType","image/jpeg"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","emf"),e.writeAttributeString("ContentType","image/x-emf"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","rtf"),e.writeAttributeString("ContentType","application/rtf"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","png"),e.writeAttributeString("ContentType","image/png"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/docProps/app.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.extended-properties+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/docProps/core.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-package.core-properties+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/word/document.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/word/styles.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/word/settings.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/word/webSettings.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.webSettings+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/word/fontTable.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml"),e.writeEndElement(),this.usePageHeadersAndFooters){e.writeStartElement("Override"),e.writeAttributeString("PartName","/word/footnotes.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/word/endnotes.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.endnotes+xml"),e.writeEndElement();for(var r=0;r<this.headersData.length;r++)e.writeStartElement("Override"),e.writeAttributeString("PartName",et.format("/word/footer{0}.xml",r+1)),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName",et.format("/word/header{0}.xml",r+1)),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml"),e.writeEndElement()}else Q.Base.vEIvF.JlKzR.RNAxU()||Q.Base.vEIvF.JlKzR.KqUvN()||(Q.Base.vEIvF.JlKzR.ZHIhL()||Q.Base.vEIvF.JlKzR.LuQMU()||Q.Base.vEIvF.JlKzR.UPtPa())&&Q.System.NodeJs.isStandaloneVersion||(e.writeStartElement("Override"),e.writeAttributeString("PartName","/word/footnotes.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/word/endnotes.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.endnotes+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/word/headerAdditional.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml"),e.writeEndElement());return e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},at.prototype.writeMainRels=function(){var t=new h,e=new d(g.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?p.None:p.Indented,e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId1"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument"),e.writeAttributeString("Target","word/document.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId2"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties"),e.writeAttributeString("Target","docProps/core.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId3"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties"),e.writeAttributeString("Target","docProps/app.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},at.prototype.writeDocPropsApp=function(){var t=new h,e=new d(g.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?p.None:p.Indented,e.writeStartDocument(),e.writeStartElement("Properties"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"),e.writeAttributeString("xmlns:vt","http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"),e.writeElementString("Application","Microsoft Office Word"),e.writeElementString("Company",null==this.docCompanyString?"":this.docCompanyString),e.writeElementString("Template","Normal.dotm"),e.writeElementString("TotalTime","0"),e.writeElementString("Pages","1"),e.writeElementString("Words","1"),e.writeElementString("Characters","1"),e.writeElementString("DocSecurity",this.restrictEditing==$.StiWord2007RestrictEditing.No?"0":"8"),e.writeElementString("Lines","1"),e.writeElementString("Paragraphs","1"),e.writeElementString("ScaleCrop","false"),e.writeElementString("LinksUpToDate","false"),e.writeElementString("CharactersWithSpaces","1"),e.writeElementString("SharedDoc","false"),e.writeElementString("HyperlinksChanged","false"),e.writeElementString("AppVersion","12.0000"),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},at.prototype.writeDocPropsCore=function(){var t=new h,e=new d(g.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?p.None:p.Indented,e.writeStartDocument(),e.writeStartElement("cp:coreProperties"),e.writeAttributeString("xmlns:cp","http://schemas.openxmlformats.org/package/2006/metadata/core-properties"),e.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),e.writeAttributeString("xmlns:dcterms","http://purl.org/dc/terms/"),e.writeAttributeString("xmlns:dcmitype","http://purl.org/dc/dcmitype/"),e.writeAttributeString("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance");var r=et.format("{0}{1}",i.now.toString("yyyy-MM-dd"),i.now.toString("THH:mm:ssZ"));return e.writeElementString("dc:title",null==this.report.reportName?"":this.report.reportName),e.writeElementString("dc:subject",null==this.report.reportAlias?"":this.report.reportAlias),e.writeElementString("dc:creator",null==this.report.reportAuthor?"":this.report.reportAuthor),e.writeElementString("cp:keywords",""),e.writeElementString("dc:description",null==this.report.reportDescription?"":this.report.reportDescription),e.writeElementString("cp:lastModifiedBy",null==this.docLastModifiedString?"":this.docLastModifiedString),e.writeElementString("cp:revision","1"),e.writeStartElement("dcterms:created"),e.writeAttributeString("xsi:type","dcterms:W3CDTF"),e.writeString(r),e.writeEndElement(),e.writeStartElement("dcterms:modified"),e.writeAttributeString("xsi:type","dcterms:W3CDTF"),e.writeString(r),e.writeEndElement(),e.writeElementString("cp:contentStatus",Q.StiVersion.platform()),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},at.prototype.writeSettings=function(){var t=new h,e=new d(g.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?p.None:p.Indented,e.writeStartDocument(),e.writeStartElement("w:settings"),e.writeAttributeString("xmlns:o","urn:schemas-microsoft-com:office:office"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeAttributeString("xmlns:m","http://schemas.openxmlformats.org/officeDocument/2006/math"),e.writeAttributeString("xmlns:v","urn:schemas-microsoft-com:vml"),e.writeAttributeString("xmlns:w10","urn:schemas-microsoft-com:office:word"),e.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),e.writeAttributeString("xmlns:sl","http://schemas.openxmlformats.org/schemaLibrary/2006/main"),this.restrictEditing!=$.StiWord2007RestrictEditing.No&&(e.writeStartElement("w:documentProtection"),e.writeAttributeString("w:edit","readOnly"),e.writeAttributeString("w:enforcement","1"),e.writeAttributeString("w:cryptProviderType","rsaFull"),e.writeAttributeString("w:cryptAlgorithmClass","hash"),e.writeAttributeString("w:cryptAlgorithmType","typeAny"),e.writeAttributeString("w:cryptAlgorithmSid","4"),e.writeAttributeString("w:cryptSpinCount","50000"),e.writeAttributeString("w:hash","aw5VYrxGrQVOl7/SJDI9GvbcwaE="),e.writeAttributeString("w:salt","974T1u8C/8p0OAB+3ev3nQ=="),e.writeEndElement()),e.writeStartElement("w:zoom"),e.writeAttributeString("w:percent","100"),e.writeEndElement(),e.writeStartElement("w:proofState"),e.writeAttributeString("w:spelling","clean"),e.writeAttributeString("w:grammar","clean"),e.writeEndElement(),e.writeStartElement("w:defaultTabStop"),e.writeAttributeString("w:val","708"),e.writeEndElement(),e.writeStartElement("w:characterSpacingControl"),e.writeAttributeString("w:val","doNotCompress"),e.writeEndElement(),this.usePageHeadersAndFooters&&(e.writeStartElement("w:footnotePr"),e.writeStartElement("w:footnote"),e.writeAttributeString("w:id","0"),e.writeEndElement(),e.writeStartElement("w:footnote"),e.writeAttributeString("w:id","1"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("w:endnotePr"),e.writeStartElement("w:endnote"),e.writeAttributeString("w:id","0"),e.writeEndElement(),e.writeStartElement("w:endnote"),e.writeAttributeString("w:id","1"),e.writeEndElement(),e.writeEndElement()),e.writeStartElement("w:compat"),e.writeEndElement(),e.writeStartElement("m:mathPr"),e.writeStartElement("m:mathFont"),e.writeAttributeString("m:val","Cambria Math"),e.writeEndElement(),e.writeStartElement("m:brkBin"),e.writeAttributeString("m:val","before"),e.writeEndElement(),e.writeStartElement("m:brkBinSub"),e.writeAttributeString("m:val","--"),e.writeEndElement(),e.writeStartElement("m:smallFrac"),e.writeAttributeString("m:val","off"),e.writeEndElement(),e.writeStartElement("m:dispDef"),e.writeEndElement(),e.writeStartElement("m:lMargin"),e.writeAttributeString("m:val","0"),e.writeEndElement(),e.writeStartElement("m:rMargin"),e.writeAttributeString("m:val","0"),e.writeEndElement(),e.writeStartElement("m:defJc"),e.writeAttributeString("m:val","centerGroup"),e.writeEndElement(),e.writeStartElement("m:wrapIndent"),e.writeAttributeString("m:val","1440"),e.writeEndElement(),e.writeStartElement("m:intLim"),e.writeAttributeString("m:val","subSup"),e.writeEndElement(),e.writeStartElement("m:naryLim"),e.writeAttributeString("m:val","undOvr"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("w:themeFontLang"),e.writeAttributeString("w:val","en-EN"),e.writeEndElement(),e.writeStartElement("w:clrSchemeMapping"),e.writeAttributeString("w:bg1","light1"),e.writeAttributeString("w:t1","dark1"),e.writeAttributeString("w:bg2","light2"),e.writeAttributeString("w:t2","dark2"),e.writeAttributeString("w:accent1","accent1"),e.writeAttributeString("w:accent2","accent2"),e.writeAttributeString("w:accent3","accent3"),e.writeAttributeString("w:accent4","accent4"),e.writeAttributeString("w:accent5","accent5"),e.writeAttributeString("w:accent6","accent6"),e.writeAttributeString("w:hyperlink","hyperlink"),e.writeAttributeString("w:followedHyperlink","followedHyperlink"),e.writeEndElement(),e.writeStartElement("w:shapeDefaults"),e.writeStartElement("o:shapedefaults"),e.writeAttributeString("v:ext","edit"),e.writeAttributeString("spidmax","2050"),e.writeEndElement(),e.writeStartElement("o:shapelayout"),e.writeAttributeString("v:ext","edit"),e.writeStartElement("o:idmap"),e.writeAttributeString("v:ext","edit"),e.writeAttributeString("data","1"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("w:decimalSymbol"),e.writeAttributeString("w:val",","),e.writeEndElement(),e.writeStartElement("w:listSeparator"),e.writeAttributeString("w:val",";"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},at.prototype.writeWebSettings=function(){var t=new h,e=new d(g.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?p.None:p.Indented,e.writeStartDocument(),e.writeStartElement("w:webSettings"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),e.writeStartElement("w:optimizeForBrowser"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},at.prototype.writeFontTable=function(){var e,t,r=new h,i=new d(g.UTF8,r);i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?p.None:p.Indented,i.writeStartDocument(),i.writeStartElement("w:fonts"),i.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),i.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),this.fontList.set("Calibri","Calibri"),this.fontList.set("Cambria","Cambria");try{for(var n=__values(this.fontList.values),o=n.next();!o.done;o=n.next()){var a=o.value;i.writeStartElement("w:font"),i.writeAttributeString("w:name",a),i.writeFullEndElement()}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return i.writeFullEndElement(),i.writeEndDocument(),i.flush(),r},at.prototype.writeDocumentRels=function(){var e,t,r=new h,i=new d(g.UTF8,r);i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?p.None:p.Indented,i.writeStartDocument(),i.writeStartElement("Relationships"),i.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),i.writeStartElement("Relationship"),i.writeAttributeString("Id","rId1"),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles"),i.writeAttributeString("Target","styles.xml"),i.writeEndElement(),i.writeStartElement("Relationship"),i.writeAttributeString("Id","rId2"),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings"),i.writeAttributeString("Target","settings.xml"),i.writeEndElement(),i.writeStartElement("Relationship"),i.writeAttributeString("Id","rId3"),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings"),i.writeAttributeString("Target","webSettings.xml"),i.writeEndElement(),i.writeStartElement("Relationship"),i.writeAttributeString("Id","rId4"),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable"),i.writeAttributeString("Target","fontTable.xml"),i.writeEndElement();for(var n=0;n<this.imageCache.imagePackedStore.length;n++)i.writeStartElement("Relationship"),i.writeAttributeString("Id",et.format("rId{0}",5+n)),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"),i.writeAttributeString("Target",et.format("media/image{0:D5}.jpeg",n+1)),i.writeEndElement();if(this.usePageHeadersAndFooters){i.writeStartElement("Relationship"),i.writeAttributeString("Id",et.format("rId{0}",5+this.imageCache.imagePackedStore.length+0)),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes"),i.writeAttributeString("Target","footnotes.xml"),i.writeEndElement(),i.writeStartElement("Relationship"),i.writeAttributeString("Id",et.format("rId{0}",5+this.imageCache.imagePackedStore.length+1)),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes"),i.writeAttributeString("Target","endnotes.xml"),i.writeEndElement();for(var n=0;n<this.headersData.length;n++)i.writeStartElement("Relationship"),i.writeAttributeString("Id",et.format("rIdh{0}",n+1)),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/header"),i.writeAttributeString("Target",et.format("header{0}.xml",n+1)),i.writeEndElement(),i.writeStartElement("Relationship"),i.writeAttributeString("Id",et.format("rIdf{0}",n+1)),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer"),i.writeAttributeString("Target",et.format("footer{0}.xml",n+1)),i.writeEndElement()}else Q.Base.vEIvF.JlKzR.RNAxU()||Q.Base.vEIvF.JlKzR.KqUvN()||(Q.Base.vEIvF.JlKzR.ZHIhL()||Q.Base.vEIvF.JlKzR.LuQMU()||Q.Base.vEIvF.JlKzR.UPtPa())&&Q.System.NodeJs.isStandaloneVersion||(i.writeStartElement("Relationship"),i.writeAttributeString("Id",et.format("rId{0}",5+this.imageCache.imagePackedStore.length+0)),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes"),i.writeAttributeString("Target","footnotes.xml"),i.writeEndElement(),i.writeStartElement("Relationship"),i.writeAttributeString("Id",et.format("rId{0}",5+this.imageCache.imagePackedStore.length+1)),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes"),i.writeAttributeString("Target","endnotes.xml"),i.writeEndElement(),i.writeStartElement("Relationship"),i.writeAttributeString("Id","rIdh1"),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/header"),i.writeAttributeString("Target","headerAdditional.xml"),i.writeEndElement());if(0<this.hyperlinkList.count)try{for(var o=__values(this.hyperlinkList.keys),a=o.next();!a.done;a=o.next()){var s=a.value;i.writeStartElement("Relationship"),i.writeAttributeString("Id",et.format("hId{0}",Math.trunc(this.hyperlinkList.get(s)))),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"),i.writeAttributeString("Target",s),i.writeAttributeString("TargetMode","External"),i.writeEndElement()}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}if(0<this.embedsList.length)for(var n=0;n<this.embedsList.length;n++)i.writeStartElement("Relationship"),i.writeAttributeString("Id",et.format("reId{0}",1+n)),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/aFChunk"),i.writeAttributeString("Target",et.format("embeddings/richtext{0:D5}.rtf",n+1)),i.writeAttributeString("TargetMode","Internal"),i.writeEndElement();return i.writeFullEndElement(),i.writeEndDocument(),i.flush(),r},at.prototype.writeHeaderFooterRels=function(){var t=new h,e=new d(g.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?p.None:p.Indented,e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships");for(var r=0;r<this.imageCache.imagePackedStore.length;r++)e.writeStartElement("Relationship"),e.writeAttributeString("Id",et.format("rId{0}",5+r)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"),e.writeAttributeString("Target",et.format("media/image{0:D5}.jpeg",r+1)),e.writeEndElement();return e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},at.prototype.writeStyles=function(){var t=new h,e=new d(g.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?p.None:p.Indented,e.writeStartDocument(),e.writeStartElement("w:styles"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),e.writeStartElement("w:style"),e.writeAttributeString("w:type","paragraph"),e.writeAttributeString("w:default","1"),e.writeAttributeString("w:styleId","a"),e.writeStartElement("w:name"),e.writeAttributeString("w:val","Normal"),e.writeEndElement(),e.writeStartElement("w:qFormat"),e.writeEndElement(),e.writeStartElement("w:pPr"),e.writeStartElement("w:spacing"),e.writeAttributeString("w:after","0"),e.writeAttributeString("w:line","240"),e.writeAttributeString("w:lineRule","auto"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("w:rPr"),e.writeStartElement("w:sz"),e.writeAttributeString("w:val",et.format("{0}",Math.round2(2*Q["StiOptions"].Export.Word.normalStyleDefaultFontSize))),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("w:style"),e.writeAttributeString("w:type","character"),e.writeAttributeString("w:default","1"),e.writeAttributeString("w:styleId","a0"),e.writeStartElement("w:name"),e.writeAttributeString("w:val","Default Paragraph Font"),e.writeEndElement(),e.writeStartElement("w:uiPriority"),e.writeAttributeString("w:val","1"),e.writeEndElement(),e.writeStartElement("w:semiHidden"),e.writeEndElement(),e.writeStartElement("w:unhideWhenUsed"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("w:style"),e.writeAttributeString("w:type","table"),e.writeAttributeString("w:default","1"),e.writeAttributeString("w:styleId","a1"),e.writeStartElement("w:name"),e.writeAttributeString("w:val","Normal Table"),e.writeEndElement(),e.writeStartElement("w:uiPriority"),e.writeAttributeString("w:val","99"),e.writeEndElement(),e.writeStartElement("w:semiHidden"),e.writeEndElement(),e.writeStartElement("w:unhideWhenUsed"),e.writeEndElement(),e.writeStartElement("w:qFormat"),e.writeEndElement(),e.writeStartElement("w:tblPr"),e.writeStartElement("w:tblInd"),e.writeAttributeString("w:w","0"),e.writeAttributeString("w:type","dxa"),e.writeEndElement(),e.writeStartElement("w:tblCellMar"),e.writeStartElement("w:top"),e.writeAttributeString("w:w","0"),e.writeAttributeString("w:type","dxa"),e.writeEndElement(),e.writeStartElement("w:left"),e.writeAttributeString("w:w","0"),e.writeAttributeString("w:type","dxa"),e.writeEndElement(),e.writeStartElement("w:bottom"),e.writeAttributeString("w:w","0"),e.writeAttributeString("w:type","dxa"),e.writeEndElement(),e.writeStartElement("w:right"),e.writeAttributeString("w:w","0"),e.writeAttributeString("w:type","dxa"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("w:style"),e.writeAttributeString("w:type","numbering"),e.writeAttributeString("w:default","1"),e.writeAttributeString("w:styleId","a2"),e.writeStartElement("w:name"),e.writeAttributeString("w:val","No List"),e.writeEndElement(),e.writeStartElement("w:uiPriority"),e.writeAttributeString("w:val","99"),e.writeEndElement(),e.writeStartElement("w:semiHidden"),e.writeEndElement(),e.writeStartElement("w:unhideWhenUsed"),e.writeEndElement(),e.writeEndElement();for(var r=0;r<this.styleList.length;r++){var i=this.styleList[r];e.writeStartElement("w:style"),e.writeAttributeString("w:type","paragraph"),e.writeAttributeString("w:customStyle","1"),e.writeAttributeString("w:styleId",et.format("Style{0}",r)),e.writeStartElement("w:name"),e.writeAttributeString("w:val",i.name),e.writeEndElement(),e.writeStartElement("w:basedOn"),e.writeAttributeString("w:val","a"),e.writeEndElement(),e.writeStartElement("w:rPr"),e.writeStartElement("w:rFonts"),e.writeAttributeString("w:ascii",i.fontName),e.writeAttributeString("w:hAnsi",i.fontName),e.writeAttributeString("w:cs",i.fontName),e.writeEndElement(),i.bold&&(e.writeStartElement("w:b"),e.writeEndElement()),i.italic&&(e.writeStartElement("w:i"),e.writeEndElement()),i.underline&&(e.writeStartElement("w:u"),e.writeAttributeString("w:val","single"),e.writeEndElement()),e.writeStartElement("w:color"),e.writeAttributeString("w:val",this.getColorString(i.textColor)),e.writeEndElement(),e.writeStartElement("w:sz"),e.writeAttributeString("w:val",et.format("{0}",i.fontSize)),e.writeEndElement(),0!=Q["StiOptions"].Export.Word.spaceBetweenCharacters&&(e.writeStartElement("w:spacing"),e.writeAttributeString("w:val",et.format("{0}",Q["StiOptions"].Export.Word.spaceBetweenCharacters)),e.writeEndElement()),i.rightToLeft&&(i.bold&&(e.writeStartElement("w:bCs"),e.writeEndElement()),i.italic&&(e.writeStartElement("w:iCs"),e.writeEndElement()),e.writeStartElement("w:szCs"),e.writeAttributeString("w:val",et.format("{0}",i.fontSize)),e.writeEndElement(),e.writeStartElement("w:rtl"),e.writeEndElement()),e.writeEndElement(),e.writeEndElement()}return e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},at.prototype.writeImage=function(t){var e=new h,t=this.imageCache.imagePackedStore[t];return null!=t&&e.write(t,0,t.length),e},at.prototype.writeAdditionalData=function(t,e){var r=new h,i=null,i=e?Q.System.Convert.fromBase64String(t):g.ASCII.getBytes(t);return r.write(i,0,i.length),r},at.prototype.exportWord=function(t,e,r){if(Z.StiLogService.write(this.stimulsoft.getType(),"Export report to Word 2007 format"),null==r)throw new Error("The 'settings' argument cannot be equal in null.");var i=r.pageRange;this.usePageHeadersAndFooters=r.usePageHeadersAndFooters,this._removeEmptySpaceAtBottom=r.removeEmptySpaceAtBottom,this.imageResolution=r.imageResolution,this.imageQuality=r.imageQuality,this.docCompanyString=r.companyString,this.docLastModifiedString=r.lastModifiedString,this.restrictEditing=r.restrictEditing,this.xmlIndentation=-1,this.imageQuality<0&&(this.imageQuality=0),1<this.imageQuality&&(this.imageQuality=1),this.imageResolution<10&&(this.imageResolution=10),this.imageResolution=this.imageResolution/100,1!=Q["StiOptions"].Export.Word.lineSpacing&&(this.lineSpace=Math.round2(240*Q["StiOptions"].Export.Word.lineSpacing).toString(),this.lineSpace2=Math.round2(.772*Q["StiOptions"].Export.Word.lineSpacing*240).toString()),Q["StiOptions"].Export.Word.restrictEditing>this.restrictEditing&&(this.restrictEditing=Q["StiOptions"].Export.Word.restrictEditing),this.report=t;try{this.styleList=[],this.fontList=new S,this.imageCache=new Z.StiImageCache(Q["StiOptions"].Export.Word.allowImageComparer,!0,Z.ImageFormat.Jpeg,this.imageQuality,!1),this.bookmarkList=new S,this.hyperlinkList=new S,this.embedsList=[],this.currentPassNumber=0,this.maximumPassNumber=3+(Q["StiOptions"].Export.Word.divideSegmentPages?1:0);var n=!1,o=i.getSelectedPages(t.renderedPages),a,a;Q["StiOptions"].Export.Word.divideSegmentPages&&(a=!0,this.usePageHeadersAndFooters&&0<o.count&&o.getByIndex(0).unlimitedHeight&&1==o.getByIndex(0).segmentPerWidth&&(a=!1),a&&(o!=(a=$.StiSegmentPagesDivider.divide(o,this))&&(n=!0),o=a,this.currentPassNumber++));var s=new m;if(s.begin(e,!0),this.usePageHeadersAndFooters&&(this.headersData=[],this.headersRels=[],this.footersData=[],this.footersRels=[]),s.addFile("word/document.xml",this.writeDocument(o,t,n),!0),this.usePageHeadersAndFooters)for(var l=0;l<this.headersData.length;l++)s.addFile(et.format("word/header{0}.xml",l+1),this.headersData[l]),null!=this.headersRels[l]&&s.addFile(et.format("word/_rels/header{0}.xml.rels",l+1),this.headersRels[l]),s.addFile(et.format("word/footer{0}.xml",l+1),this.footersData[l]),null!=this.footersRels[l]&&s.addFile(et.format("word/_rels/footer{0}.xml.rels",l+1),this.footersRels[l]);if(this.usePageHeadersAndFooters&&(s.addFile("word/footnotes.xml",this.writeFootNotes()),s.addFile("word/endnotes.xml",this.writeEndNotes())),s.addFile("[Content_Types].xml",this.writeContentTypes()),s.addFile("_rels/.rels",this.writeMainRels()),s.addFile("docProps/app.xml",this.writeDocPropsApp()),s.addFile("docProps/core.xml",this.writeDocPropsCore()),s.addFile("word/settings.xml",this.writeSettings()),s.addFile("word/webSettings.xml",this.writeWebSettings()),s.addFile("word/fontTable.xml",this.writeFontTable()),s.addFile("word/_rels/document.xml.rels",this.writeDocumentRels()),s.addFile("word/styles.xml",this.writeStyles()),0<this.imageCache.imagePackedStore.length)for(var l=0;l<this.imageCache.imagePackedStore.length;l++)s.addFile(et.format("word/media/image{0:D5}.jpeg",l+1),this.writeImage(l));Q.Base.vEIvF.JlKzR.RNAxU()||Q.Base.vEIvF.JlKzR.KqUvN()||this.usePageHeadersAndFooters||(Q.Base.vEIvF.JlKzR.ZHIhL()||Q.Base.vEIvF.JlKzR.LuQMU()||Q.Base.vEIvF.JlKzR.UPtPa())&&Q.System.NodeJs.isStandaloneVersion||(s.addFile("word/footnotes.xml",this.writeFootNotes()),s.addFile("word/endnotes.xml",this.writeEndNotes()),s.addFile("word/media/imageAdditional.png",this.writeAdditionalData($.StiExportUtils.additionalData,!0)),s.addFile("word/headerAdditional.xml",this.writeAdditionalData('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n<w:hdr xmlns:ve="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:o="urn:schemas-microsoft-com:office:office" '+'xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:m="http://schemas.openxmlformats.org/officeDocument/2006/math" xmlns:v="urn:schemas-microsoft-com:vml" '+'xmlns:wp="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing" xmlns:w10="urn:schemas-microsoft-com:office:word" xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main" '+'xmlns:wne="http://schemas.microsoft.com/office/word/2006/wordml"><w:p><w:pPr><w:pStyle w:val="a3"/></w:pPr><w:r><w:rPr><w:noProof/><w:lang w:eastAsia="ru-RU"/></w:rPr><w:pict>'+'<v:shapetype id="_x0000_t75" coordsize="21600,21600" o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f"> <v:stroke joinstyle="miter"/> <v:formulas>'+'<v:f eqn="if lineDrawn pixelLineWidth 0"/><v:f eqn="sum @0 1 0"/><v:f eqn="sum 0 0 @1"/><v:f eqn="prod @2 1 2"/><v:f eqn="prod @3 21600 pixelWidth"/><v:f eqn="prod @3 21600 pixelHeight"/><v:f eqn="sum @0 0 1"/>'+'<v:f eqn="prod @6 1 2"/><v:f eqn="prod @7 21600 pixelWidth"/><v:f eqn="sum @8 21600 0"/><v:f eqn="prod @7 21600 pixelHeight"/><v:f eqn="sum @10 21600 0"/></v:formulas><v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>'+'<o:lock v:ext="edit" aspectratio="t"/></v:shapetype><v:shape id="WordPictureWatermark11777093" o:spid="_x0000_s2050" type="#_x0000_t75" '+'style="position:absolute;margin-left:0;margin-top:0;width:467.45pt;height:433.85pt;z-index:-251657216;mso-position-horizontal:center;mso-position-horizontal-relative:margin;mso-position-vertical:center;mso-position-vertical-relative:margin" '+'o:allowincell="f"><v:imagedata r:id="rId1" o:title="additional"/></v:shape></w:pict></w:r></w:p></w:hdr>',!1)),s.addFile("word/_rels/headerAdditional.xml.rels",this.writeAdditionalData('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image" Target="media/imageAdditional.png" /></Relationships>',!1))),s.end()}finally{null!=this.matrix&&(this.matrix.clear(),this._matrix=null),this.fontList.clear(),this.fontList=null,this.imageCache.clear(),this.imageCache=null,this.styleList.stimulsoft.clear(),this.styleList=null,this.bookmarkList.clear(),this.bookmarkList=null,this.hyperlinkList.clear(),this.hyperlinkList=null,this.embedsList.stimulsoft.clear(),this.embedsList=null,this.usePageHeadersAndFooters&&(this.headersData.stimulsoft.clear(),this.headersData=null,this.headersRels.stimulsoft.clear(),this.headersRels=null,this.footersData.stimulsoft.clear(),this.footersData=null,this.footersRels.stimulsoft.clear(),this.footersRels=null),t.renderedPages.cacheMode&&$.StiMatrix.GCCollect()}},o=at,$.StiWord2007ExportService=o}(Stimulsoft=Stimulsoft||{}),function(_e){var t,je,e;je=t=_e.Report||(_e.Report={}),function(ce){var pe=_e.Report.Export.StiPdfEmbeddedFileData,ge=_e.System.Collections.List,he=_e.Report.Components.StiSparkline,we=_e.Base.Drawing.StiColorUtils,de=_e.Report.Components.StiDataBarIndicator,ue=_e.Report.Components.StiIconSetHelper,Se=_e.Report.Components.StiIcon,fe=_e.Report.Components.StiIconSetIndicator,ve=_e.System.StiArray,o=_e.Report.Components.StiBookmarksCollection,Ee=_e.Report.Components.StiBookmark,m=_e.System.Char,be=_e.Base.Drawing.StiHtmlTag,f=_e.Report.Components.StiImageRotation,ye=_e.System.StiString,a=_e.Report.Dashboard.StiDashboardExport,s=_e.Report.Dashboard.IStiDashboard,v=_e.System.Drawing.Color,D=_e.System.IO.MemoryStream,xe=_e.Report.Components.StiContainer,Ae=_e.Base.Drawing.StiBrush,l=_e.Base.Drawing.StiGradientBrush,c=_e.Base.Drawing.StiGlareBrush,n=_e.Base.Drawing.StiHatchBrush,p=_e.Base.Drawing.StiGlassBrush,Te=_e.System.Collections.Hashtable,Pe=_e.System.Text.StringBuilder,Le=_e.Report.Components.StiText,Ce=_e.Report.Components.StiShape,Fe=_e.Report.Components.StiRectanglePrimitive,Re=_e.Report.Components.IStiFont,Ie=_e.Report.Components.IStiBrush,Be=_e.Report.Components.IStiTextBrush,De=_e.Report.Components.IStiTextOptions,ke=_e.Report.Components.IStiBorder,S=_e.System.Xml.XmlTextWriter,Ne=_e.System.DateTime,Oe=_e.Report.Chart.IStiChart,E=_e.Report.Components.StiImage,b=_e.System.Drawing.Rectangle,y=_e.Base.Drawing.StiHorAlignment,x=_e.Base.Drawing.StiVertAlignment,Me=_e.Report.Components.IStiExportImageExtended,He=_e.Report.Components.StiCheckBox,Ue=_e.Report.BarCodes.StiBarCode,ze=_e.Report.Components.IStiTextHorAlignment,Xe=(Object.defineProperty(t.prototype,"Right",{get:function(){return this.X+this.Width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Top",{get:function(){return this.Y+this.Height},enumerable:!1,configurable:!0}),t);function t(t){this.X=0,this.Y=0,this.Width=0,this.Height=0,this.Component=null,this.service=null,this.service=t}ce.StiPdfData=Xe;var g=e;function e(){}ce.StiImageData=g;var We=r;function r(){}ce.StiShadingData=We;var h=i;function i(){}ce.StiShadingFunctionData=h;var Ye=w;function w(){}ce.StiEditableObject=Ye;var Ge=d;function d(){}var Ve=u;function u(){}var A=(T=ce.StiExportService,__extends(P,T),P.prototype.implements=function(){return[ce.IStiPdfExportService]},Object.defineProperty(P.prototype,"exportFormat",{get:function(){return je.StiExportFormat.Pdf},enumerable:!1,configurable:!0}),P.prototype.exportTo=function(t,e,r){this.exportPdf1(t,e,r)},P.prototype.exportToAsync=function(t,e,r,i){var n=this,o=i.imageCompressionMethod==ce.StiPdfImageCompressionMethod.Flate;_e.Report.Export.StiExportImageHelper.convertAllImages(e,_e.System.Drawing.Imaging.ImageFormat.Jpeg,o).try(function(){if(!e.isDocument&&e.getCurrentPage().is(s))return void a.exportAsync(e,r,i).try(function(){return t()});n.exportTo(e,r,i),null!=e&&null!=e.preparedExportImages&&(e.preparedExportImages.clear(),e.preparedExportImages=null),t()})},P.prototype.stringReplace=function(t,e,r){e=e.replace(P.regexEscape,"\\$1");var e=new RegExp(e,"g");return t.replace(e,r)},P.prototype.getHatchNumber=function(t){if(0<this.hatchArray.length)for(var e=0;e<this.hatchArray.length;e++){var r=this.hatchArray[e];if(t.style==r.style&&t.backColor==r.backColor&&t.foreColor==r.foreColor)return e}return this.hatchArray.push(t),this.hatchArray.length-1},P.prototype.getShadingFunctionNumber=function(t,e,r){if(0<this.shadingFunctionArray.length)for(var i=0;i<this.shadingFunctionArray.length;i++){var n=this.shadingFunctionArray[i];if(n.Color1.equals(t)&&n.Color2.equals(e)&&n.IsGlare==r)return i}var o=new h;return o.Color1=t,o.Color2=e,o.IsGlare=r,this.shadingFunctionArray.push(o),this.shadingFunctionArray.length-1},P.prototype.addXref=function(t){var e=this.sw.position;this.xref[t]=e.toString().stimulsoft.padLeft(10,"0")+" 00000 n",this.currentObjectNumber=t,this.currentGenerationNumber=0},P.prototype.convertToString=function(t,e){var r;return void 0===e&&(e=2),Math.round2(t,e).toString().split(",").join(_e.System.Globalization.CultureInfo.currentCulture.numberFormat.numberDecimalSeparator)},P.convertToEscapeSequence=function(t){var e=[40,41,92,13,10,8,12],r="()\\rnbf",i,n;if(null==t)return"";n=new Pe;for(var o=0;o<t.length;o++){i=!1;for(var a=0;a<e.length;a++)if(t.charCodeAt(o)==e[a]){n.append("\\"+r[a]),i=!0;break}i||n.append(t.charAt(o))}return n.toString()},P.convertToEscapeSequencePlusTabs=function(t){var e=[40,41,92,13,10,9,8,12],r="()\\rntbf",i,n;if(null==t)return"";n="";for(var o=0;o<t.length;o++){i=!1;for(var a=0;a<e.length;a++)if(t.charCodeAt(o)==e[a]){n+="\\"+r[a],i=!0;break}i||(n+=t.charAt(o))}return n},P.prototype.setStrokeColor=function(t){var e=this.colorHash1.get(t);null==e&&(e=ye.format("{0} {1} {2} RG",this.colorTable[t.r],this.colorTable[t.g],this.colorTable[t.b]),this.colorHash1.set(t,e)),this.pageStream.writeLine(e);var t=t.a;t!=this.lastColorStrokeA&&_e["StiOptions"].Export.Pdf.allowExtGState&&!this.usePdfA&&(this.pageStream.writeLine(this.gsTable[t][0]),this.lastColorStrokeA=t,this.alphaTable[t]=!0)},P.prototype.setNonStrokeColor=function(t){var e=this.colorHash2.get(t);null==e&&(e=ye.format("{0} {1} {2} rg",this.colorTable[t.r],this.colorTable[t.g],this.colorTable[t.b]),this.colorHash2.set(t,e)),this.pageStream.writeLine(e);var t=t.a;t!=this.lastColorNonStrokeA&&_e["StiOptions"].Export.Pdf.allowExtGState&&!this.usePdfA&&(this.pageStream.writeLine(this.gsTable[t][1]),this.lastColorNonStrokeA=t,this.alphaTable[t]=!0)},Object.defineProperty(P.prototype,"gsTable",{get:function(){if(null==this._gsTable){this._gsTable=ve.create2(String,256,2);for(var t=0;t<256;t++)this._gsTable[t][0]=ye.format("/GS{0:X2}S gs",t),this._gsTable[t][1]=ye.format("/GS{0:X2}N gs",t)}return this._gsTable},enumerable:!1,configurable:!0}),P.prototype.pushColorToStack=function(){this.colorStack.push(this.lastColorStrokeA),this.colorStack.push(this.lastColorNonStrokeA)},P.prototype.popColorFromStack=function(){this.lastColorNonStrokeA=this.colorStack.pop(),this.lastColorStrokeA=this.colorStack.pop()},P.prototype.fillRectBrush=function(t,e){var r=Ae.toColor(t),i,t;this.setNonStrokeColor(r),this.storeShadingData2(e.x,e.y,e.width,e.height,t),(t.is(l)||t.is(c))&&this.pageStream.writeLine1("/Pattern cs /P{0} scn",1+this.shadingCurrent),t.is(n)&&this.pageStream.writeLine1("/Cs1 cs /PH{0} scn",this.getHatchNumber(t)+1),t.is(p)&&(t=t,this.setNonStrokeColor(t.getTopColor()),this.pageStream.writeLine1("{0} {1} {2} {3} re f",this.convertToString(e.x),this.convertToString(e.y+e.height/2),this.convertToString(e.width),this.convertToString(e.height/2)),this.setNonStrokeColor(t.getBottomColor()),this.pageStream.writeLine1("{0} {1} {2} {3} re f",this.convertToString(e.x),this.convertToString(e.y),this.convertToString(e.width),this.convertToString(e.height/2)),r=v.transparent),0!=r.a&&this.pageStream.writeLine1("{0} {1} {2} {3} re f",this.convertToString(e.x),this.convertToString(e.y),this.convertToString(e.width),this.convertToString(e.height))},P.prototype.storeStringLine=function(t,e,r){void 0===r&&(r=!1);var r=t+this.convertToHexString(e,r);this.storeString(r),this.sw.writeLine()},P.prototype.storeString=function(t){this.sw.writeString(t,!1)},P.prototype.convertToHexString=function(t,e,r){void 0===r&&(r=!1);var i="";if(ye.isNullOrEmpty(t))if(this.encrypted){for(var n=this.pdfSecurity.encryptData([],this.currentObjectNumber,this.currentGenerationNumber),o="",a=0;a<n.length;a++)o+=String.fromCharCode(n[a]);i+="("+P.convertToEscapeSequencePlusTabs(o)+")"}else i+="()";else{for(var s=r,l=0;l<t.length;l++)127<t.charCodeAt(l)&&(s=!0);if(this.encrypted){var m=null;if(1==s){m=[];for(var a=0;a<t.length;a++){var c=t.charCodeAt(a);m[2+2*a+0]=c>>8&255,m[2+2*a+1]=255&c}m[0]=254,m[1]=255}else{m=[];for(var a=0;a<t.length;a++)m[a]=t.charCodeAt(a)}for(var n=this.pdfSecurity.encryptData(m,this.currentObjectNumber,this.currentGenerationNumber),o="",a=0;a<n.length;a++)o+=String.fromCharCode(n[a]);i+="("+P.convertToEscapeSequencePlusTabs(o)+")"}else if(1==s){i+="<FEFF";for(var a=0;a<t.length;a++)i+=ye.format("{0:X4}",t.charCodeAt(a));i+=">"}else i+=e?"("+P.convertToEscapeSequencePlusTabs(t)+")":"("+t+")"}return i},P.prototype.storeMemoryStream2=function(t,e){var r;this.encrypted?(r=this.pdfSecurity.encryptData(t.toArray(),this.currentObjectNumber,this.currentGenerationNumber),this.sw.writeLine1(ye.format(e,r.length)),this.sw.writeLine(">>"),this.sw.writeLine("stream"),this.sw.write(r,0,r.length)):(this.sw.writeLine1(ye.format(e,t.length)),this.sw.writeLine(">>"),this.sw.writeLine("stream"),t.writeTo(this.sw)),t.close()},P.prototype.storeMemoryStream3=function(t,e){for(var r=new D,i=0;i<t.length;i++)r.writeByte(t[i]);this.storeMemoryStream2(r,e),r.close()},P.prototype.storeMemoryStream4=function(t,e){for(var r=new D,i=0;i<t.length;i++)r.writeByte(t[i]);this.storeMemoryStream2(r,e),r.close()},P.prototype.renderStartDoc=function(t,e){var r,i;this.sw.writeLine(this.keyLength==ce.StiPdfEncryptionKeyLength.Bit256_r5||this.keyLength==ce.StiPdfEncryptionKeyLength.Bit256_r6?"%PDF-1.7":"%PDF-1.4"),this.sw.write([37,226,227,207,211],0,5),this.sw.writeLine(),this.addXref(1),this.sw.writeLine("1 0 obj"),this.sw.writeLine("<<"),this.keyLength==ce.StiPdfEncryptionKeyLength.Bit256_r5&&this.sw.writeLine("/Extensions<</ADBE<</BaseVersion/1.7/ExtensionLevel 3>>>>"),this.keyLength==ce.StiPdfEncryptionKeyLength.Bit256_r6&&this.sw.writeLine("/Extensions<</ADBE<</BaseVersion/1.7/ExtensionLevel 8>>>>"),this.sw.writeLine("/Type /Catalog"),this.sw.writeLine1("/Pages {0} 0 R",this.info.pages.ref),this.sw.writeLine("/MarkInfo<</Marked true>>"),this.sw.writeLine1("/Metadata {0} 0 R",this.info.metadata.ref),this.sw.writeLine1("/OutputIntents {0} 0 R",this.info.outputIntents.ref),this.sw.writeLine1("/StructTreeRoot {0} 0 R",this.info.structTreeRoot.ref),this.haveBookmarks?(this.sw.writeLine1("/Outlines {0} 0 R",this.info.outlines.ref),this.sw.writeLine("/PageMode /UseOutlines")):this.sw.writeLine("/PageMode /UseNone"),this.printScaling||(this.sw.writeLine("/ViewerPreferences"),this.sw.writeLine("<<"),this.sw.writeLine("/PrintScaling /None"),this.sw.writeLine(">>")),(this.haveAnnots||this.haveDigitalSignature)&&this.sw.writeLine1("/AcroForm {0} 0 R",this.info.acroForm.ref);var n=this.autoPrint!=ce.StiPdfAutoPrintMode.None,o=0<this.info.embeddedFilesList.length;if(n||o){if(this.sw.writeLine("/Names <<"),n&&this.sw.writeLine1("/JavaScript {0} 0 R",this.info.embeddedJS.ref),o){this.sw.writeLine("/EmbeddedFiles <<"),this.sw.writeString("/Names [ ");for(var a=0;a<this.info.embeddedFilesList.length;a++){var s=this.embeddedFiles[a],s=ye.format("{0} {1} 0 R ",this.convertToHexString(s.name,!0,!0),this.info.embeddedFilesList[a].ref);this.sw.writeString(s)}this.sw.writeLine("]"),this.sw.writeLine(">>")}this.sw.writeLine(">>")}if(this.zugferdComplianceMode!=ce.StiPdfZUGFeRDComplianceMode.None||this.pdfComplianceMode==ce.StiPdfComplianceMode.A3){this.sw.writeString("/AF [ ");for(var a=0;a<this.info.embeddedFilesList.length;a++)this.sw.writeString(ye.format("{0} 0 R ",this.info.embeddedFilesList[a].ref));this.sw.writeLine("]")}this.usePdfA||this.sw.writeLine1("/OCProperties << /OCGs [{0} 0 R] /D << /ON [{0} 0 R] /AS [<</Event /Print /OCGs [{0} 0 R] /Category [/Print]>>] >> >>",this.info.optionalContentGroup.ref),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(2),this.sw.writeLine("2 0 obj"),this.sw.writeLine("<<"),this.storeStringLine("/Producer ",this.producerName,!0),this.storeStringLine("/Creator ",this.creatorName,!0),ye.isNullOrEmpty(t.reportAuthor)||this.storeStringLine("/Author ",t.reportAuthor,!0),ye.isNullOrEmpty(t.reportAlias)||this.storeStringLine("/Subject ",t.reportAlias,!0),ye.isNullOrEmpty(t.reportName)||this.storeStringLine("/Title ",t.reportName,!0),ye.isNullOrEmpty(this.keywords)||this.storeStringLine("/Keywords ",this.keywords,!0),this.storeStringLine("/CreationDate ","D:"+this.currentDateTime),this.storeStringLine("/ModDate ","D:"+this.currentDateTime);try{for(var l=__values(t.metaTags.list),m=l.next();!m.done;m=l.next()){var c=m.value;c.name.stimulsoft.startsWith("pdf:")&&this.storeStringLine(ye.format("/{0} ",je.StiNameValidator.correctName(c.name.substr(4),!1)),c.tag)}}catch(t){r={error:t}}finally{try{m&&!m.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(3),this.sw.writeLine("3 0 obj"),this.sw.writeLine("<<"),this.sw.writeLine("/Cs1 [/Pattern /DeviceRGB]"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.pages.ref),this.sw.writeLine1("{0} 0 obj",this.info.pages.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Pages"),this.sw.writeString("/Kids [ ");for(var a=0,p;a<e.count;a++)this.sw.writeString(ye.format("{0} 0 R ",this.info.pageList[a].ref));if(this.sw.writeLine("]"),this.sw.writeLine1("/Count {0}",e.count),_e["StiOptions"].Export.Pdf.allowInheritedPageResources){(p=[]).push("/Resources"),p.push("<<"),p.push("/ProcSet [/PDF /Text /ImageC]"),p.push("/Font"),p.push("<<");for(var a=0;a<this.fontsCounter;a++)p.push(ye.format("/F{0} {1} 0 R",a,this.info.fontList[a].ref));if(p.push(">>"),0<this.imageCache.imageStore.length){p.push("/XObject"),p.push("<<");for(var a=0;a<this.imageCache.imageStore.length;a++)p.push(ye.format("/Image{0} {1} 0 R",a,this.info.xObjectList[a].ref));p.push(">>")}p.push("/Pattern"),p.push("<<"),p.push(ye.format("/P1 {0} 0 R",this.info.patterns.first.ref));for(var g=0;g<this.hatchArray.length;g++)p.push(ye.format("/PH{0} {1} 0 R",1+g,this.info.patterns.hatchItems[g].ref));for(var g=0;g<this.shadingArray.length;g++)p.push(ye.format("/P{0} {1} 0 R",2+g,this.info.patterns.shadingItems[g].ref));p.push(">>"),p.push("/ColorSpace 3 0 R"),_e["StiOptions"].Export.Pdf.allowExtGState&&this.useTransparency&&p.push(ye.format("/ExtGState {0} 0 R",this.info.extGState.ref)),this.usePdfA||p.push(ye.format("/Properties << /oc1 {0} 0 R >>",this.info.optionalContentGroup.ref)),p.push(">>");for(var h=0;h<p.length;h++)this.sw.writeLine(p[h])}this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(5),this.sw.writeLine("5 0 obj"),this.sw.writeLine("<<"),this.sw.writeLine("/Type /StructTreeRoot"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(6),this.sw.writeLine("6 0 obj"),this.sw.writeLine("<<"),this.sw.writeLine("/Type /OCG"),this.sw.writeLine("/Name (Printable off)"),this.sw.writeLine("/Usage <<"),this.sw.writeLine("/Print << /PrintState /OFF >>"),this.sw.writeLine("/View << /ViewState /ON >>"),this.sw.writeLine(">>"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("");for(var w=0;w<e.count;w++){this.addXref(this.info.pageList[w].ref),this.sw.writeLine1("{0} 0 obj",this.info.pageList[w].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Page"),this.sw.writeLine("/Parent 4 0 R");var d=e.getByIndex(w),u=this.hiToTwips*t.unit.convertToHInches(d.pageHeight*d.segmentPerHeight),d=this.hiToTwips*t.unit.convertToHInches(d.pageWidth*d.segmentPerWidth),p;if(14400<u&&(u=14400),14400<d&&(d=14400),this.sw.writeLine1("/MediaBox [ 0 0 {0} {1} ]",this.convertToString(d),this.convertToString(u)),!_e["StiOptions"].Export.Pdf.allowInheritedPageResources){(p=[]).push("/Resources"),p.push("<<"),p.push("/ProcSet [/PDF /Text /ImageC]"),p.push("/Font"),p.push("<<");for(var a=0;a<this.fontsCounter;a++)p.push(ye.format("/F{0} {1} 0 R",a,this.info.fontList[a].ref));if(p.push(">>"),0<this.imageCache.imageStore.length){p.push("/XObject"),p.push("<<");for(var a=0;a<this.imageCache.imageStore.length;a++)p.push(ye.format("/Image{0} {1} 0 R",a,this.info.xObjectList[a].ref));p.push(">>")}var S=new Pe;S.append(ye.format("/P1 {0} 0 R",this.info.patterns.first.ref));for(var g=0;g<this.hatchArray.length;g++)S.append(ye.format("/PH{0} {1} 0 R",1+g,this.info.patterns.hatchItems[g].ref));for(var g=0,f;g<this.shadingArray.length;g++){this.shadingArray[g].Page==w&&S.append(ye.format("/P{0} {1} 0 R",2+g,this.info.patterns.shadingItems[g].ref))}p.push("/Pattern << "+S.toString()+" >>"),p.push("/ColorSpace 3 0 R"),_e["StiOptions"].Export.Pdf.allowExtGState&&this.useTransparency&&p.push(ye.format("/ExtGState {0} 0 R",this.info.extGState.ref)),this.usePdfA||p.push(ye.format("/Properties << /oc1 {0} 0 R >>",this.info.optionalContentGroup.ref)),p.push(">>");for(var h=0;h<p.length;h++)this.sw.writeLine(p[h])}if(this.sw.writeLine1("/Contents {0} 0 R",this.info.pageList[w].content.ref),this.usePdfA||(this.sw.writeLine("/Group"),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Group"),this.sw.writeLine("/S /Transparency"),this.sw.writeLine("/CS /DeviceRGB"),this.sw.writeLine(">>")),this.haveLinks||this.haveAnnots||this.haveDigitalSignature||this.haveTooltips){if(this.sw.writeLine("/Annots ["),this.haveLinks)for(var v=0,E;v<this.linksCounter;v++){this.linksArray[v].Page==w&&this.sw.writeLine1("{0} 0 R ",this.info.linkList[v].ref)}if(this.haveAnnots){for(var v=0,b;v<this.annotsCounter;v++){(b=this.annotsArray[v]).Page==w&&this.sw.writeLine1("{0} 0 R ",this.info.acroForm.annots[v].ref)}for(var v=0,b;v<this.annots2Counter;v++){if((b=this.annots2Array[v]).Page==w)for(var y=0;y<this.info.acroForm.checkBoxes[v].items.length;y++)this.sw.writeLine1("{0} 0 R ",this.info.acroForm.checkBoxes[v].items[y].ref)}}this.sw.writeLine("]")}this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}},P.prototype.renderEndDoc=function(){var t=this.sw.position;this.sw.writeLine("xref"),this.sw.writeLine1("0 {0}",this.xref.stimulsoft.countItems+1),this.sw.writeLine("0000000000 65535 f");for(var e=0;e<this.xref.stimulsoft.countItems;e++)this.sw.writeLine(this.xref[e+1]);this.sw.writeLine("trailer"),this.sw.writeLine("<<"),this.sw.writeLine1("/Size {0}",this.xref.stimulsoft.countItems+1),this.sw.writeLine("/Root 1 0 R"),this.sw.writeLine("/Info 2 0 R"),this.encrypted&&this.sw.writeLine1("/Encrypt {0} 0 R",this.info.encode.ref),this.sw.writeLine1("/ID[<{0}><{0}>]",this.IDValueString),this.sw.writeLine(">>"),this.sw.writeLine("%"+ce.StiExportUtils.getReportVersion()),this.sw.writeLine("%"+_e.StiVersion.platform()),this.sw.writeLine("startxref"),this.sw.writeLine1("{0}",t),this.sw.writeLine("%%EOF")},P.prototype.renderPageHeader=function(t){this.addXref(this.info.pageList[t].content.ref),this.sw.writeLine1("{0} 0 obj",this.info.pageList[t].content.ref),this.sw.writeLine("<<"),this.pageStream=new D,this.pageStream.writeLine("2 J")},P.prototype.renderPageFooter=function(t,e){var r,i,t,t;_e.Base.vEIvF.JlKzR.RNAxU()||_e.Base.vEIvF.JlKzR.KqUvN()||(_e.Base.vEIvF.JlKzR.ZHIhL()||_e.Base.vEIvF.JlKzR.LuQMU()||_e.Base.vEIvF.JlKzR.UPtPa())&&_e.System.NodeJs.isStandaloneVersion||((i=t/840*1.4)<(r=e/596*1.4)?r=i:i=r,this.pageStream.writeLine("q"),this.pushColorToStack(),this.pageStream.writeLine("1 J 1 j 20 w"),this.setStrokeColor(v.fromArgb(64,100,100,100)),this.pageStream.writeLine1("{0} 0 0 {1} {2} {3} cm 0.707 0.707 -0.707 0.707 0 0 cm 1 0 0 1 -155 -50 cm",this.convertToString(r),this.convertToString(i),this.convertToString(e/2),this.convertToString(t/2)),this.pageStream.writeLine("40 0 m 40 100 l 0 100 m 80 100 l S"),this.pageStream.writeLine("100 0 m 100 70 l 100 45 m 120 65 l 130 72 l 140 68 l S"),this.pageStream.writeLine("170 0 m 170 70 l 169 100 m 171 100 l S"),this.pageStream.writeLine("215 60 m 222 69 l 232 71 l 255 70 l 265 60 l 265 5 l 270 0 l 265 44 m 220 31 l 212 20 l 212 10 l 225 0 l 235 0 l 250 5 l 265 18 l S"),this.pageStream.writeLine("310 0 m 310 100 l S"),this.pageStream.writeLine("Q"),this.popColorFromStack()),this.pageStream.position<this.pageStream.length&&this.pageStream.setLength(this.pageStream.position),1==this.compressed?(t=this.pageStream.toArray(),t=ce.StiExportUtils.makePdfDeflateStream(t),this.storeMemoryStream2(t,"/Filter [/FlateDecode] /Length {0}")):this.storeMemoryStream2(this.pageStream,"/Filter [] /Length {0}"),this.sw.writeLine(),this.pageStream.close(),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")},P.prototype.renderFontTable=function(){for(var t=0;t<this.fontsCounter;t++){var e=new Pe;this.pdfFont.currentFont=t;var r=this.pdfFont.fontList[t],i=r.Name;_e["StiOptions"].Export.Pdf.useAlternativeFontNames&&_e["StiOptions"].Export.Pdf.alternativeFontNames.containsKey(i)&&(i=_e["StiOptions"].Export.Pdf.alternativeFontNames.get(i));var n=this.embeddedFonts||ce.PdfFonts.isFontStimulsoft(r.Name);if(this.pdfFont.UseUnicode){e=new Pe(i.stimulsoft.replaceAll(" ","#20")),(r.Bold||r.Italic)&&(e.append(","),r.Bold&&e.append("Bold"),r.Italic&&e.append("Italic")),n&&e.insert(0,ye.format("SR{0}{1}{2}{3}+",String.fromCharCode(24*Math.random()+65),String.fromCharCode(24*Math.random()+65),String.fromCharCode(24*Math.random()+65),String.fromCharCode(24*Math.random()+65))),this.addXref(this.info.fontList[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[t].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Font"),this.sw.writeLine("/Subtype /Type0"),this.sw.writeLine1("/BaseFont /{0}",e),this.sw.writeLine1("/DescendantFonts [{0} 0 R]",this.info.fontList[t].descendantFont.ref),this.sw.writeLine("/Encoding /Identity-H"),this.sw.writeLine1("/ToUnicode {0} 0 R",this.info.fontList[t].toUnicode.ref),this.sw.writeLine1("/Name /F{0}",t),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.fontList[t].descendantFont.ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[t].descendantFont.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Font"),this.sw.writeLine("/Subtype /CIDFontType2"),this.sw.writeLine1("/BaseFont /{0}",e),this.sw.writeLine("/CIDSystemInfo"),this.sw.writeLine("<<"),this.storeStringLine("/Registry","Adobe"),this.storeStringLine("/Ordering","Identity"),this.sw.writeLine("/Supplement 0"),this.sw.writeLine(">>"),this.sw.writeLine1("/FontDescriptor {0} 0 R",this.info.fontList[t].fontDescriptor.ref),this.usePdfA&&this.sw.writeLine("/CIDToGIDMap /Identity"),this.sw.writeLine("/W [0 [1000]");for(var o=this.pdfFont.GlyphList,a=o.length,s=ve.create(Number,a),l=ve.create(Number,a),m=32;m<a;m++)s[m]=o[m],l[m]=m;for(var c=32;c<s.length-1;c++)for(var p=c+1,g,g;p<s.length;p++){s[c]>s[p]&&(g=s[c],s[c]=s[p],s[p]=g,g=l[c],l[c]=l[p],l[p]=g)}var h=new Pe,w=32;while(w<this.pdfFont.MappedSymbolsCount){h.append(s[w].toString()+" ["),h.append(this.pdfFont.Widths[l[w]-32].toString()),w++;while(w<this.pdfFont.MappedSymbolsCount&&s[w]-1==s[w-1])h.append(" "+this.pdfFont.Widths[l[w]-32].toString()),w++;while(w<this.pdfFont.MappedSymbolsCount&&s[w]==s[w-1])w++;h.append("]"),this.sw.writeLine1("{0}",h),h=new Pe}null!=this.pdfFont.GlyphWidths&&this.pdfFont.GlyphWidths[65535],this.sw.writeLine("]"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.fontList[t].toUnicode.ref);var d="SR+F"+t.toString();this.sw.writeLine1("{0} 0 obj",this.info.fontList[t].toUnicode.ref),this.sw.writeLine("<<");var u=new D;u.writeLine("/CIDInit /ProcSet findresource begin"),u.writeLine("12 dict begin"),u.writeLine("begincmap"),u.writeLine("/CIDSystemInfo"),u.writeLine("<<"),u.writeLine("/Registry (Adobe)"),u.writeLine1("/Ordering ({0})",d),u.writeLine("/Supplement 0"),u.writeLine(">> def"),u.writeLine1("/CMapName /{0} def",d),u.writeLine("/CMapType 2 def"),u.writeLine("1 begincodespacerange"),u.writeLine("<0000> <FFFF>"),u.writeLine("endcodespacerange");var S=this.pdfFont.MappedSymbolsCount-32,f=32;while(0<S){var v=S;100<v&&(v=100),u.writeLine1("{0} beginbfchar",v);for(var E=0;E<v;E++)u.writeLine1("<{0:X4}> <{1:X4}>",this.pdfFont.GlyphList[f],this.pdfFont.UnicodeMapBack[f]),f++;u.writeLine("endbfchar"),S-=v}u.writeLine("endcmap"),u.writeLine("CMapName currentdict /CMap defineresource pop"),u.writeLine("end"),u.writeLine("end"),u.flush();var d=u.toArray(),b;u.close(),1==this.compressed?(b=ce.StiExportUtils.makePdfDeflateStream(d),this.storeMemoryStream2(b,"/Length {0} /Filter [/FlateDecode] /Length1 "+d.length.toString())):this.storeMemoryStream4(d,"/Length {0} /Filter [] /Length1 {0}"),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.fontList[t].cIDSet.ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[t].cIDSet.ref),this.sw.writeLine("<<");for(var y=ve.create(Boolean,65536+32),x=0,A=0;A<this.pdfFont.GlyphList.length;A++){var T=this.pdfFont.GlyphList[A];65535!=T&&(y[T]=!0,x<T&&(x=T))}if(null!=this.pdfFont.GlyphWidths&&0!=this.pdfFont.GlyphWidths[65535])for(var A=0;A<65535;A++)0<this.pdfFont.GlyphWidths[A]&&0==this.pdfFont.GlyphBackList[A]&&(y[A]=!0,x<A&&(x=A));var P=Math.trunc(x/8)+1,L=ve.create(Number,P+1),C=0,b;while(C<P){var F=8*C,R=0;y[F]&&(R|=128),y[F+1]&&(R|=64),y[F+2]&&(R|=32),y[F+3]&&(R|=16),y[F+4]&&(R|=8),y[F+5]&&(R|=4),y[F+6]&&(R|=2),y[F+7]&&(R|=1),L[C]=R,C++}1==this.compressed?(b=ce.StiExportUtils.makePdfDeflateStream(L),this.storeMemoryStream2(b,"/Length {0} /Filter [/FlateDecode] /Length1 "+L.length.toString())):this.storeMemoryStream4(L,"/Length {0} /Filter [] /Length1 "+L.length.toString()),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")}else{this.addXref(this.info.fontList[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[t].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Font"),1==this.standardPdfFonts?(this.sw.writeLine("/Subtype /Type1"),this.sw.writeLine1("/BaseFont /{0}",r.PdfName)):(this.sw.writeLine("/Subtype /TrueType"),e=new Pe(this.stringReplace(i," ","#20")),1!=r.Bold&&1!=r.Italic||(e.append(","),1==r.Bold&&e.append("Bold"),1==r.Italic&&e.append("Italic")),this.sw.writeLine1("/BaseFont /{0}",e),this.sw.writeLine1("/FontDescriptor {0} 0 R",this.info.fontList[t].fontDescriptor.ref)),this.sw.writeLine1("/Encoding {0} 0 R",this.info.fontList[t].encoding.ref);for(var I=new Pe(" "),E=32;E<this.pdfFont.MappedSymbolsCount;E++)I.append(this.pdfFont.Widths[E-32].toString()+" ");if(this.sw.writeLine1("/FirstChar {0}",32),this.sw.writeLine1("/LastChar {0}",this.pdfFont.MappedSymbolsCount-1),this.sw.writeLine1("/Widths [{0}]",I),this.sw.writeLine1("/Name /F{0}",t),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.fontList[t].encoding.ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[t].encoding.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Encoding"),this.sw.writeLine("/BaseEncoding /WinAnsiEncoding"),this.pdfFont.MappedSymbolsCount>this.pdfFont.firstMappedSymbol){for(var B=new Pe(this.pdfFont.firstMappedSymbol.toString()+" "),E=this.pdfFont.firstMappedSymbol;E<this.pdfFont.MappedSymbolsCount;E++)B.append("/"+this.pdfFont.CharPdfNames[E]);this.sw.writeLine1("/Differences [{0}]",B)}this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}var i=null,e,L,b,r,b;n&&(i=this.pdfFont.getFontDataBuf(r.Font,this.report)),0==this.standardPdfFonts&&(this.addXref(this.info.fontList[t].fontDescriptor.ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[t].fontDescriptor.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /FontDescriptor"),this.sw.writeLine1("/FontName /{0}",e),this.sw.writeLine("/Flags 32"),this.sw.writeLine1("/Ascent {0}",this.pdfFont.tmASC),this.sw.writeLine1("/CapHeight {0}",this.pdfFont.CH),this.sw.writeLine1("/Descent {0}",this.pdfFont.tmDESC),this.sw.writeLine1("/FontBBox [{0} {1} {2} {3}]",this.pdfFont.LLX,this.pdfFont.LLY,this.pdfFont.URX,this.pdfFont.URY),this.sw.writeLine1("/ItalicAngle {0}",this.pdfFont.ItalicAngle),this.sw.writeLine1("/StemV {0}",this.pdfFont.StemV),n&&null!=i&&this.sw.writeLine1("/FontFile2 {0} 0 R",this.info.fontList[-1==r.ParentFontNumber?t:r.ParentFontNumber].fontFile2.ref),e=this.pdfFont.UseUnicode,this.pdfComplianceMode!=ce.StiPdfComplianceMode.A2&&this.pdfComplianceMode!=ce.StiPdfComplianceMode.A3||(e=!1),e&&this.sw.writeLine1("/CIDSet {0} 0 R",this.info.fontList[t].cIDSet.ref),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")),n&&(null!=i&&0<i.length&&-1==r.ParentFontNumber?(this.reduceFontSize&&null!=(L=this.pdfFont.reduceFontSize(i,r.Name,!this.fontGlyphsReduceNotNeed[t]))&&(i=L),this.addXref(this.info.fontList[t].fontFile2.ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[t].fontFile2.ref),this.sw.writeLine("<<"),1==this.compressedFonts?(i instanceof Uint8Array&&(b=ce.StiExportUtils.makePdfDeflateStream(i),this.storeMemoryStream2(b,"/Length {0} /Filter [/FlateDecode] /Length1 "+i.length.toString())),i instanceof D&&(r=i.toArray(),b=ce.StiExportUtils.makePdfDeflateStream(r),this.storeMemoryStream2(b,"/Length {0} /Filter [/FlateDecode] /Length1 "+i.length.toString()))):(i instanceof Uint8Array&&this.storeMemoryStream3(i,"/Length {0} /Filter [] /Length1 "+i.length.toString()),i instanceof D&&this.storeMemoryStream2(i,"/Length {0} /Filter [] /Length1 "+i.length.toString())),this.sw.writeLine(""),this.sw.writeLine("endstream")):(this.addXref(this.info.fontList[t].fontFile2.ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[t].fontFile2.ref),this.sw.writeLine("<< >>")),this.sw.writeLine("endobj"),this.sw.writeLine(""))}},P.prototype.renderImageTable=function(){if(0<this.imageCache.imageStore.length)for(var t=0;t<this.imageCache.imageStore.length;t++){var e=this.imageCacheIndexToList.get(t),r=this.imageCache.imagePackedStore[t],i=this.imageCache.imageMaskStore[t],n=e.ImageFormat;this.addXref(this.info.xObjectList[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.xObjectList[t].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /XObject"),this.sw.writeLine("/Subtype /Image"),this.sw.writeLine1("/ColorSpace /{0}",n==ce.StiImageFormat.Monochrome?"DeviceGray":"DeviceRGB"),this.sw.writeLine1("/Width {0}",e.Width),this.sw.writeLine1("/Height {0}",e.Height),this.sw.writeLine1("/BitsPerComponent {0}",n==ce.StiImageFormat.Monochrome?"1":"8"),!this.usePdfA&&this.imageInterpolationTable.containsKey(t)&&this.sw.writeLine("/Interpolate true"),null!=i&&this.sw.writeLine1("/SMask {0} 0 R",this.info.xObjectList[t].mask.ref),this.sw.writeLine1("/Name /{0}",e.Name);var o="DCTDecode";this.imageCompressionMethod==ce.StiPdfImageCompressionMethod.Flate&&(o="FlateDecode"),null==r&&(r=[56,48,56,48,56,48],o="ASCIIHexDecode");var n="/Length {0} "+ye.format("/Filter [/{0}]",o),o=new D,n,e;o.write(r,0,r.length),this.storeMemoryStream2(o,n),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine(""),null!=i&&(this.addXref(this.info.xObjectList[t].mask.ref),this.sw.writeLine1("{0} 0 obj",this.info.xObjectList[t].mask.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /XObject"),this.sw.writeLine("/Subtype /Image"),this.sw.writeLine("/ColorSpace /DeviceGray"),this.sw.writeLine("/Matte [ 0 0 0 ]"),this.sw.writeLine1("/Width {0}",e.Width),this.sw.writeLine1("/Height {0}",e.Height),this.sw.writeLine("/BitsPerComponent 8"),!this.usePdfA&&this.imageInterpolationTable.containsKey(t)&&this.sw.writeLine("/Interpolate true"),n="/Length {0} /Filter /FlateDecode",(e=new D).write(i,0,i.length),this.storeMemoryStream2(e,n),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine(""))}},P.prototype.renderBookmarksTable=function(){if(this.haveBookmarks){this.addXref(this.info.outlines.ref),this.sw.writeLine1("{0} 0 obj",this.info.outlines.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Outlines"),this.sw.writeLine1("/First {0} 0 R",this.info.outlines.items[0].ref),this.sw.writeLine1("/Last {0} 0 R",this.info.outlines.items[0].ref),this.sw.writeLine1("/Count {0}",1),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("");for(var t=0;t<this.bookmarksCounter;t++){this.addXref(this.info.outlines.items[t].ref);var e=this.bookmarksTree[t];this.sw.writeLine1("{0} 0 obj",this.info.outlines.items[t].ref),this.sw.writeLine("<<"),this.storeStringLine("/Title ",e.Title,!0),-1!=e.Parent&&this.sw.writeLine1("/Parent {0} 0 R",this.info.outlines.items[e.Parent].ref),-1!=e.Prev&&this.sw.writeLine1("/Prev {0} 0 R",this.info.outlines.items[e.Prev].ref),-1!=e.Next&&this.sw.writeLine1("/Next {0} 0 R",this.info.outlines.items[e.Next].ref),-1!=e.First&&this.sw.writeLine1("/First {0} 0 R",this.info.outlines.items[e.First].ref),-1!=e.Last&&this.sw.writeLine1("/Last {0} 0 R",this.info.outlines.items[e.Last].ref),0<e.Count&&(0==t?this.sw.writeLine1("/Count {0}",e.Count):this.sw.writeLine1("/Count {0}",-e.Count)),-1<e.Y&&this.sw.writeLine1("/Dest [{0} 0 R /XYZ null {1} null]",this.info.pageList[e.Page].ref,this.convertToString(e.Y)),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}}},P.prototype.renderPatternTable=function(){if(this.addXref(this.info.patterns.resources.ref),this.sw.writeLine1("{0} 0 obj",this.info.patterns.resources.ref),this.sw.writeLine("<< /ProcSet [/PDF] >>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.patterns.first.ref),this.sw.writeLine1("{0} 0 obj",this.info.patterns.first.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Pattern"),this.sw.writeLine("/PatternType 1"),this.sw.writeLine("/PaintType 1"),this.sw.writeLine("/TilingType 1"),this.sw.writeLine("/BBox [0 0 2 2]"),this.sw.writeLine("/XStep 3"),this.sw.writeLine("/YStep 3"),this.sw.writeLine1("/Resources {0} 0 R",this.info.patterns.resources.ref),this.pageStream=new D,this.pageStream.writeLine("1 J 1 j 1 w"),this.pageStream.writeLine("1 0 0 RG"),this.pageStream.writeString("1 1 m 1.1 1.1 l S"),this.storeMemoryStream2(this.pageStream,"/Length {0}"),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine(""),0<this.hatchArray.length)for(var t=0;t<this.hatchArray.length;t++)this.writeHatchPattern(t);if(0<this.shadingArray.length)for(var e=0;e<this.shadingArray.length;e++)this.writeShadingPattern(e);if(0<this.shadingFunctionArray.length){for(var r=0;r<this.shadingFunctionArray.length;r++)this.writeShadingFunction(r);this.sw.writeLine("")}this.pageStream.close()},P.prototype.writeHatchPattern=function(t){var e=this.hatchArray[t],r=e.style;53<r&&(r=53),this.addXref(this.info.patterns.hatchItems[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.patterns.hatchItems[t].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Pattern"),this.sw.writeLine("/PatternType 1"),this.sw.writeLine("/PaintType 1"),this.sw.writeLine("/TilingType 1"),this.sw.writeLine("/BBox [0 0 1 1]"),this.sw.writeLine("/XStep 1"),this.sw.writeLine("/YStep 1"),this.sw.writeLine1("/Resources {0} 0 R",this.info.patterns.resources.ref),this.sw.writeLine("/Matrix [5.5 0 0 5.5 0 0]");var t=new D;0!=e.backColor.a&&(t.writeLine1("{0} {1} {2} rg",this.colorTable[e.backColor.r],this.colorTable[e.backColor.g],this.colorTable[e.backColor.b]),t.writeLine("0 0 1 1 re f")),t.writeLine1("{0} {1} {2} rg",this.colorTable[e.foreColor.r],this.colorTable[e.foreColor.g],this.colorTable[e.foreColor.b]),t.writeLine("BI"),t.writeLine("/W 8"),t.writeLine("/H 8"),t.writeLine("/BPC 1"),t.writeLine("/IM true"),t.writeLine("/D [1 0]"),t.writeLine("/F [/AHx]"),t.writeLine("ID"),t.writeLine(ce.StiPdfResources.hatchData[r]+">"),t.writeLine("EI"),t.flush(),this.storeMemoryStream2(t,"/Length {0}"),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")},P.prototype.writeShadingPattern=function(t){var e=this.shadingArray[t],r=1,i=1,n=e.Angle;n<0&&(n+=360),270<=n&&n<360&&(n=360-n,i=-1),180<=n&&n<270&&(n-=180,r=i=-1),90<=n&&n<180&&(n=180-n,r=-1),n=n*Math.PI/180;var o=e.X+e.Width/2,a=e.Y+e.Height/2,s=Math.sqrt(e.Width*e.Width+e.Height*e.Height)/2,l=Math.atan2(e.Height,e.Width),l=Math.PI/2-n+l,l=s*Math.sin(l),r=l*Math.cos(n)*r,n=l*Math.sin(n)*i,i=o-r,o=o+r,r=a+n,n=a-n;this.addXref(this.info.patterns.shadingItems[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.patterns.shadingItems[t].ref),this.sw.writeString("<<"),this.sw.writeString("/PatternType 2"),this.sw.writeString("/Shading <<"),this.sw.writeString("/ColorSpace /DeviceRGB"),this.sw.writeString("/ShadingType 2"),this.sw.writeString(ye.format("/Coords [{0} {1} {2} {3}]",this.convertToString(i),this.convertToString(r),this.convertToString(o),this.convertToString(n))),this.sw.writeString("/Extend [true true]"),this.sw.writeString(ye.format("/Function {0} 0 R",this.info.patterns.shadingFunctionItems[e.FunctionIndex].ref)),this.sw.writeString(">> "),this.sw.writeLine(">>"),this.sw.writeLine("endobj")},P.prototype.writeShadingFunction=function(t){var e=this.shadingFunctionArray[t];this.addXref(this.info.patterns.shadingFunctionItems[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.patterns.shadingFunctionItems[t].ref),this.sw.writeString("<<"),this.sw.writeString("/FunctionType 0"),this.sw.writeString("/Size [3]"),this.sw.writeString("/Decode [0 1 0 1 0 1]"),this.sw.writeString("/Range [0 1 0 1 0 1]"),this.sw.writeString("/BitsPerSample 8"),this.sw.writeString("/Domain [0 1]"),this.sw.writeString(ye.format("/Encode [0 {0}]",e.IsGlare?2:1)),this.sw.writeString("/Order 1");var t=new D;t.writeByte(e.Color1.r),t.writeByte(e.Color1.g),t.writeByte(e.Color1.b),t.writeByte(e.Color2.r),t.writeByte(e.Color2.g),t.writeByte(e.Color2.b),t.writeByte(e.Color1.r),t.writeByte(e.Color1.g),t.writeByte(e.Color1.b),this.storeMemoryStream2(t,"/Length {0}"),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj")},P.prototype.renderLinkTable=function(){if(this.haveLinks)for(var t=0;t<this.linksCounter;t++){var e=this.linksArray[t],r,i,n,i;if(e.Link.stimulsoft.startsWith("##")&&0<this.tagsArray.stimulsoft.countItems)for(var r=e.Link.substr(2),o=0;o<this.tagsArray.stimulsoft.countItems;o++){var a=this.tagsArray[o];if(a.Link==r){e.DestPage=a.Page,e.DestY=a.Y;break}}else if("#"==e.Link.charAt(0)&&this.haveBookmarks){"%"==(r=e.Link.substr(1)).charAt(0)&&2<r.length&&((i=r.lastIndexOf(r.charAt(1)))<r.length-1&&(r=r.substr(i+1)));for(var s=0;s<this.bookmarksCounter;s++){var l=this.bookmarksTree[s];if(l.Title==r){e.DestPage=l.Page,e.DestY=l.Y;break}}}this.linksArray[t]=e,this.addXref(this.info.linkList[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.linkList[t].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Link"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(e.X),this.convertToString(e.Y),this.convertToString(e.X+e.Width),this.convertToString(e.Y+e.Height)),this.sw.writeLine("/Border [0 0 0]"),"#"==e.Link.charAt(0)?-1<e.DestY?this.sw.writeLine1("/Dest [{0} 0 R /XYZ null {1} null]",this.info.pageList[e.DestPage].ref,this.convertToString(e.DestY)):this.sw.writeLine1("/Dest [{0} 0 R /XYZ null null null]",this.info.pageList[0].ref):((i=6<(n=this.stringReplace(e.Link,"\\","/")).length&&m.isLetter(n,0)&&":"==n.charAt(1)&&"/"==n.charAt(2)||"/"==n.charAt(0)&&m.isLetter(n,1)&&"/"==n.charAt(2))&&":"==n.charAt(1)&&(n="/"+n.charAt(0)+n.substr(2)),this.sw.writeLine("/A <<"),this.sw.writeLine("/Type /Action"),i?(this.sw.writeLine("/S /Launch"),this.sw.writeLine("/F <<"),this.sw.writeLine("/Type /Filespec"),this.storeStringLine("/F ",n),this.storeStringLine("/UF ",n),this.sw.writeLine(">>")):(this.sw.writeLine("/S /URI"),this.storeStringLine("/URI ",ce.StiExportUtils.stringToUrl(n))),this.sw.writeLine(">>")),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}},P.prototype.renderAnnotTable=function(){if(this.haveAnnots||this.haveDigitalSignature||this.haveTooltips){this.addXref(this.info.acroForm.ref),this.sw.writeLine1("{0} 0 obj",this.info.acroForm.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Fields [");for(var t=0;t<this.annotsCounter;t++)this.sw.writeLine1("{0} 0 R",this.info.acroForm.annots[t].ref);for(var t=0;t<this.annots2Counter;t++)for(var e=0;e<this.info.acroForm.checkBoxes[t].items.length;e++)this.sw.writeLine1("{0} 0 R",this.info.acroForm.checkBoxes[t].items[e].ref);for(var t=0;t<this.unsignedSignaturesCounter;t++)this.sw.writeLine1("{0} 0 R",this.info.acroForm.unsignedSignatures[t].ref);this.haveDigitalSignature&&this.sw.writeLine1("{0} 0 R",this.info.acroForm.signatures[0].ref);for(var t=0;t<this.tooltipsCounter;t++)this.sw.writeLine1("{0} 0 R",this.info.acroForm.tooltips[t].ref);if(this.sw.writeLine("]"),this.sw.writeLine("/DR <<"),0<this.annotsCounter||0<this.annots2Counter){this.sw.writeLine("/Font <<");for(var t=0;t<this.fontsCounter;t++)this.sw.writeLine1("/FA{0} {1} 0 R",t,this.info.acroForm.annotFontItems[t].ref);this.sw.writeLine(">>")}if(this.sw.writeLine(">>"),this.haveAnnots&&0<this.fontsCounter&&this.storeStringLine("/DA ","/FA0 0 Tf 0 g"),this.haveDigitalSignature&&this.sw.writeLine("/SigFlags 3"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.haveAnnots){for(var r=new Te,t=0;t<this.annotsCounter;t++){var i=this.annotsArray[t],n="";if(_e["StiOptions"].Export.Pdf.useEditableFieldName&&(n=i.Component.name),_e["StiOptions"].Export.Pdf.useEditableFieldAlias&&(n=i.Component.alias),_e["StiOptions"].Export.Pdf.useEditableFieldTag&&(n=i.Component.tagValue),ye.isNullOrEmpty(n)&&(n=ye.format("Field{0}",t)),r.containsKey(n)){var o=2,a="";while(r.containsKey(n+a))a="_"+o.toString(),o++;n+=a}r.add(n,n),this.addXref(this.info.acroForm.annots[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.acroForm.annots[t].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Widget"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(i.X),this.convertToString(i.Y),this.convertToString(i.X+i.Width),this.convertToString(i.Y+i.Height)),this.sw.writeLine("/F 4"),this.sw.writeLine1("/P {0} 0 R",this.info.pageList[i.Page].ref),this.sw.writeLine("/FT /Tx"),this.sw.writeLine("/BS << /W 0 >>"),this.storeStringLine("/T ",n),this.sw.writeLine("/MK << /TP 2 >>"),this.sw.writeLine("/H /P"),this.sw.writeLine1("/AP << /N {0} 0 R >>",this.info.acroForm.annots[t].aP.ref);var s=i.Multiline?4096:0,l;null!=i.Component.as(Le)&&null!=i.Component.as(Le).textOptions&&i.Component.as(Le).textOptions.lineLimit&&(s|=8388608),this.sw.writeLine1("/Ff {0}",s),this.storeStringLine("/DA ",ye.format("/FA{0} {1} Tf {2} {3} {4} rg",i.FontNumber,this.convertToString(i.FontSize,this.precision_digits_font),this.colorTable[i.FontColor.r],this.colorTable[i.FontColor.g],this.colorTable[i.FontColor.b])),this.storeStringLine("/V ",i.Text),this.storeStringLine("/DV ",i.Text),this.sw.writeLine1("/Q {0}",(i.Alignment==_e.Base.Drawing.StiTextHorAlignment.Center?1:0)+(i.Alignment==_e.Base.Drawing.StiTextHorAlignment.Right?2:0)),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.acroForm.annots[t].aP.ref),this.sw.writeLine1("{0} 0 obj",this.info.acroForm.annots[t].aP.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Subtype /Form"),this.sw.writeLine1("/BBox [{0} {1} {2} {3}]",this.convertToString(0),this.convertToString(0),this.convertToString(i.Width),this.convertToString(i.Height)),this.sw.writeLine("/Resources <<"),this.sw.writeLine("/ProcSet [ /PDF /Text ]"),this.sw.writeLine1("/Font << /F{0} {1} 0 R >> >>",i.FontNumber,this.info.fontList[i.FontNumber].ref),(l=new D).writeLine("/Tx BMC"),l.writeLine("q");var m=1;l.writeLine1("{0} {1} {2} {3} re W n",this.convertToString(m),this.convertToString(m),this.convertToString(i.Width-m),this.convertToString(i.Height-m)),l.flush(),l.write(i.Content,0,i.Content.length),l.writeLine("Q"),l.writeLine("EMC"),l.flush(),this.storeMemoryStream2(l,"/Filter [] /Length {0}"),this.sw.writeLine(""),l.close(),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")}for(var c=0;c<this.fontsCounter;c++){this.pdfFont.currentFont=c;var p=this.pdfFont.fontList[c],g=p.Name;_e["StiOptions"].Export.Pdf.useAlternativeFontNames&&_e["StiOptions"].Export.Pdf.alternativeFontNames.containsKey(g)&&(g=_e["StiOptions"].Export.Pdf.alternativeFontNames.get(g));var g=new Pe(this.stringReplace(g," ","#20"));if((p.Bold||p.Italic)&&(g.append(","),
p.Bold&&g.append("Bold"),p.Italic&&g.append("Italic")),this.addXref(this.info.acroForm.annotFontItems[c].ref),this.sw.writeLine1("{0} 0 obj",this.info.acroForm.annotFontItems[c].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Font"),this.sw.writeLine("/Subtype /TrueType"),this.sw.writeLine1("/Name /FA{0}",c),this.sw.writeLine1("/BaseFont /{0}",g),this.sw.writeLine("/Encoding /WinAnsiEncoding"),this.sw.writeLine1("/FontDescriptor {0} 0 R",this.info.acroForm.annotFontItems[c].fontDescriptor.ref),this.fontGlyphsReduceNotNeed[c]){for(var h=new Pe(" "),w=32;w<256;w++)h.append(this.pdfFont.Widths[this.pdfFont.UnicodeMap[this.CodePage1252[w]]-32].toString()+" ");this.sw.writeLine("/FirstChar 32"),this.sw.writeLine("/LastChar 255"),this.sw.writeLine1("/Widths [{0}]",h)}this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.acroForm.annotFontItems[c].fontDescriptor.ref),this.sw.writeLine1("{0} 0 obj",this.info.acroForm.annotFontItems[c].fontDescriptor.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /FontDescriptor"),this.sw.writeLine1("/FontName /{0}",g),this.sw.writeLine("/Flags 32"),this.sw.writeLine1("/Ascent {0}",this.pdfFont.tmASC),this.sw.writeLine1("/CapHeight {0}",this.pdfFont.CH),this.sw.writeLine1("/Descent {0}",-this.pdfFont.tmDESC),this.sw.writeLine1("/FontBBox [{0} {1} {2} {3}]",-500,-200,1500,1e3),this.sw.writeLine1("/ItalicAngle {0}",this.pdfFont.ItalicAngle),this.sw.writeLine1("/StemV {0}",this.pdfFont.StemV),1==this.embeddedFonts&&this.sw.writeLine1("/FontFile2 {0} 0 R",this.info.fontList[c].fontFile2.ref),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}for(var t=0;t<this.annots2Counter;t++){var i=this.annots2Array[t],n="";if(_e["StiOptions"].Export.Pdf.useEditableFieldName&&(n=i.Component.name),_e["StiOptions"].Export.Pdf.useEditableFieldAlias&&(n=i.Component.alias),_e["StiOptions"].Export.Pdf.useEditableFieldTag&&(n=i.Component.tagValue),ye.isNullOrEmpty(n)&&(n=ye.format("Checkbox{0}",t+1)),r.containsKey(n)){var o=2,a="";while(r.containsKey(n+a))a="_"+o.toString(),o++;n+=a}r.add(n,n);var d=.01,u=i.Component.as(He),S=ce.StiPdfRenderPrimitives.getCheckBoxValue(u),f;if(null==S&&(S=!1),1<this.info.acroForm.checkBoxes[t].items.length){var f=this.info.acroForm.checkBoxes[t].items[0];this.addXref(f.ref),this.sw.writeLine1("{0} 0 obj",f.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Widget"),this.sw.writeLine("/FT /Btn"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(i.X),this.convertToString(i.Y),this.convertToString(i.X+i.Width-d),this.convertToString(i.Y+i.Height-d)),this.sw.writeLine1("/F {0}",4+(3==this.info.acroForm.checkBoxes[t].items.length||0==S?2:0)),this.sw.writeLine1("/P {0} 0 R",this.info.pageList[i.Page].ref),this.storeStringLine("/T ",n+"Yes"),this.sw.writeLine("/MK << >>"),this.sw.writeLine("/Ff 65536"),this.sw.writeLine1("/A {0} 0 R",f.aA[0].ref),this.sw.writeLine1("/AP << /N {0} 0 R >>",f.aP.ref),this.sw.writeLine("/H /O"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(f.aP.ref),this.sw.writeLine1("{0} 0 obj",f.aP.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /XObject"),this.sw.writeLine("/Subtype /Form"),this.sw.writeLine("/FormType 1"),this.sw.writeLine1("/BBox [{0} {1} {2} {3}]",this.convertToString(0),this.convertToString(0),this.convertToString(i.Width),this.convertToString(i.Height)),this.sw.writeLine("/Matrix [ 1 0 0 1 0 0 ]"),this.sw.writeLine("/Resources <<"),this.sw.writeLine("/ProcSet [ /PDF ]"),this.sw.writeLine("/Pattern"),this.sw.writeLine("<<");for(var v=0;v<this.hatchArray.length;v++)this.sw.writeLine1(ye.format("/PH{0} {1} 0 R",1+v,this.info.patterns.hatchItems[v].ref));for(var v=0,l;v<this.shadingArray.length;v++)this.sw.writeLine1(ye.format("/P{0} {1} 0 R",2+v,this.info.patterns.shadingItems[v].ref));this.sw.writeLine(">>"),this.sw.writeLine("/ColorSpace 3 0 R"),this.sw.writeLine(">>"),(l=new D).writeLine("/Tx BMC"),l.writeLine("q");var m=1;l.writeLine1("{0} {1} {2} {3} re W n",this.convertToString(m),this.convertToString(m),this.convertToString(i.Width-m),this.convertToString(i.Height-m)),l.flush(),l.write(i.Content,0,i.Content.length),l.writeLine("Q"),l.writeLine("EMC"),l.flush(),this.storeMemoryStream2(l,"/Filter [] /Length {0}"),this.sw.writeLine(""),l.close(),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(f.aA[0].ref),this.sw.writeLine1("{0} 0 obj",f.aA[0].ref),this.sw.writeLine("<<"),this.sw.writeLine1("/Next {0} 0 R",f.aA[1].ref),this.sw.writeLine("/S /Hide"),this.sw.writeLine1("/T ({0})",n+"Yes"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(f.aA[1].ref),this.sw.writeLine1("{0} 0 obj",f.aA[1].ref),this.sw.writeLine("<<"),this.sw.writeLine("/H false"),this.sw.writeLine("/S /Hide"),this.sw.writeLine1("/T ({0})",n+"No"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),f=this.info.acroForm.checkBoxes[t].items[1],this.addXref(f.ref),this.sw.writeLine1("{0} 0 obj",f.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Widget"),this.sw.writeLine("/FT /Btn"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(i.X),this.convertToString(i.Y),this.convertToString(i.X+i.Width-d),this.convertToString(i.Y+i.Height-d)),this.sw.writeLine1("/F {0}",4+(3==this.info.acroForm.checkBoxes[t].items.length||1==S?2:0)),this.sw.writeLine1("/P {0} 0 R",this.info.pageList[i.Page].ref),this.storeStringLine("/T ",n+"No"),this.sw.writeLine("/MK << >>"),this.sw.writeLine("/Ff 65536"),this.sw.writeLine1("/A {0} 0 R",f.aA[0].ref),this.sw.writeLine1("/AP << /N {0} 0 R >>",f.aP.ref),this.sw.writeLine("/H /O"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(f.aP.ref),this.sw.writeLine1("{0} 0 obj",f.aP.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /XObject"),this.sw.writeLine("/Subtype /Form"),this.sw.writeLine("/FormType 1"),this.sw.writeLine1("/BBox [{0} {1} {2} {3}]",this.convertToString(0),this.convertToString(0),this.convertToString(i.Width),this.convertToString(i.Height)),this.sw.writeLine("/Matrix [ 1 0 0 1 0 0 ]"),this.sw.writeLine("/Resources <<"),this.sw.writeLine("/ProcSet [ /PDF ]"),this.sw.writeLine("/Pattern"),this.sw.writeLine("<<");for(var v=0;v<this.hatchArray.length;v++)this.sw.writeLine1(ye.format("/PH{0} {1} 0 R",1+v,this.info.patterns.hatchItems[v].ref));for(var v=0;v<this.shadingArray.length;v++)this.sw.writeLine1(ye.format("/P{0} {1} 0 R",2+v,this.info.patterns.shadingItems[v].ref));this.sw.writeLine(">>"),this.sw.writeLine("/ColorSpace 3 0 R"),this.sw.writeLine(">>"),(l=new D).writeLine("/Tx BMC"),l.writeLine("q"),m=1,l.writeLine1("{0} {1} {2} {3} re W n",this.convertToString(m),this.convertToString(m),this.convertToString(i.Width-m),this.convertToString(i.Height-m)),l.flush(),l.write(i.Content2,0,i.Content2.length),l.writeLine("Q"),l.writeLine("EMC"),l.flush(),this.storeMemoryStream2(l,"/Filter [] /Length {0}"),this.sw.writeLine(""),l.close(),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(f.aA[0].ref),this.sw.writeLine1("{0} 0 obj",f.aA[0].ref),this.sw.writeLine("<<"),this.sw.writeLine("/H false"),this.sw.writeLine1("/Next {0} 0 R",f.aA[1].ref),this.sw.writeLine("/S /Hide"),this.sw.writeLine1("/T ({0})",n+"Yes"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(f.aA[1].ref),this.sw.writeLine1("{0} 0 obj",f.aA[1].ref),this.sw.writeLine("<<"),this.sw.writeLine("/S /Hide"),this.sw.writeLine1("/T ({0})",n+"No"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}3==this.info.acroForm.checkBoxes[t].items.length&&(f=this.info.acroForm.checkBoxes[t].items[2],this.addXref(f.ref),this.sw.writeLine1("{0} 0 obj",f.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Widget"),this.sw.writeLine("/FT /Btn"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(i.X),this.convertToString(i.Y),this.convertToString(i.X+i.Width-d),this.convertToString(i.Y+i.Height-d)),this.sw.writeLine("/F 4"),this.sw.writeLine1("/P {0} 0 R",this.info.pageList[i.Page].ref),this.storeStringLine("/T ",n+"None"),this.sw.writeLine("/MK << >>"),this.sw.writeLine("/Ff 65536"),this.sw.writeLine1("/A {0} 0 R",f.aA[0].ref),this.sw.writeLine("/H /O"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(f.aA[0].ref),this.sw.writeLine1("{0} 0 obj",f.aA[0].ref),this.sw.writeLine("<<"),this.sw.writeLine1("/Next {0} 0 R",f.aA[1].ref),this.sw.writeLine("/S /Hide"),this.sw.writeLine1("/T ({0})",n+"None"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(f.aA[1].ref),this.sw.writeLine1("{0} 0 obj",f.aA[1].ref),this.sw.writeLine("<<"),this.sw.writeLine("/H false"),this.sw.writeLine("/S /Hide"),this.sw.writeLine1("/T ({0})",n+(u.checkStyleForTrue==_e.Report.Components.StiCheckStyle.None?"No":"Yes")),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""))}for(var t=0;t<this.unsignedSignaturesCounter;t++){var i=this.unsignedSignaturesArray[t],n="";if(_e["StiOptions"].Export.Pdf.useEditableFieldName&&(n=i.Component.name),_e["StiOptions"].Export.Pdf.useEditableFieldAlias&&(n=i.Component.alias),_e["StiOptions"].Export.Pdf.useEditableFieldTag&&(n=i.Component.tagValue),ye.isNullOrEmpty(n)&&(n=ye.format("UnsignedSignature{0}",t)),r.containsKey(n)){var o=2,a="";while(r.containsKey(n+a))a="_"+o.toString(),o++;n+=a}r.add(n,n);var E=this.info.acroForm.unsignedSignatures[t].ref;this.addXref(E),this.sw.writeLine1("{0} 0 obj",E),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Widget"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(i.X),this.convertToString(i.Y),this.convertToString(i.X+i.Width),this.convertToString(i.Y+i.Height)),this.sw.writeLine("/F 4"),this.sw.writeLine1("/P {0} 0 R",this.info.pageList[i.Page].ref),this.sw.writeLine("/FT /Sig"),this.storeStringLine("/T ",n),this.sw.writeLine("/MK << >>"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}}}},P.prototype.renderTooltipTable=function(){if(this.haveTooltips)for(var t=0;t<this.tooltipsCounter;t++){for(var e=this.tooltipsArray[t],r=!1,i=new Ge,n=0;n<this.linksCounter;n++)if((i=this.linksArray[n]).X==e.X&&i.Y==e.Y&&i.Width==e.Width&&i.Height==e.Height&&i.Page-1==e.Page){r=!0;break}this.addXref(this.info.acroForm.tooltips[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.acroForm.tooltips[t].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Widget"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(e.X),this.convertToString(e.Y),this.convertToString(e.X+e.Width),this.convertToString(e.Y+e.Height)),this.storeStringLine("/TU ",e.Link),this.sw.writeLine("/F 0"),this.sw.writeLine1("/P {0} 0 R",this.info.pageList[e.Page].ref),this.storeStringLine("/T ",ye.format("Tooltip{0}",t)),this.sw.writeLine("/FT /Btn"),this.sw.writeLine("/Ff 65536"),this.sw.writeLine("/H /N"),this.sw.writeLine("/AP <<"),this.sw.writeLine(">>"),r&&("#"==i.Link.charAt(0)?-1<i.DestY?this.sw.writeLine1("/Dest [{0} 0 R /XYZ null {1} null]",this.info.pageList[i.DestPage].ref,this.convertToString(i.DestY)):this.sw.writeLine1("/Dest [{0} 0 R /XYZ null null null]",this.info.pageList[0].ref):(this.sw.writeLine("/A <<"),this.sw.writeLine("/Type /Action"),this.sw.writeLine("/S /URI"),this.storeStringLine("/URI ",ce.StiExportUtils.stringToUrl(this.stringReplace(i.Link,"\\","/"))),this.sw.writeLine(">>"))),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}},P.prototype.renderEncodeRecord=function(){this.encrypted&&(this.addXref(this.info.encode.ref),this.sw.writeLine1("{0} 0 obj",this.info.encode.ref),this.sw.writeLine("<<"),this.pdfSecurity.renderEncodeRecord(this.sw),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""))},P.prototype.renderExtGStateRecord=function(){this.addXref(this.info.extGState.ref),this.sw.writeLine1("{0} 0 obj",this.info.extGState.ref),this.sw.writeLine("<<");for(var t=0,e;t<256;t++){this.alphaTable[t]&&(e=ye.format("{0:X2}",t).toUpperCase(),this.sw.writeLine1("/GS{0}S <</Type /ExtGState /BM /Normal /CA {1}>>",e,this.colorTable[t]),this.sw.writeLine1("/GS{0}N <</Type /ExtGState /BM /Normal /ca {1}>>",e,this.colorTable[t]))}this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")},P.prototype.storeImageData=function(t,e,r,i,n){void 0===n&&(n=!1),null!=t&&t.tryConvertSync(_e.System.Drawing.Imaging.ImageFormat.Jpeg);var o=this.imageCache.addImageInt(t),n=new g;return null!=t&&null!=t.bytes?(n.Width=t.width,n.Height=t.height):(n.Width=1,n.Height=1),n.Name=ye.format("Image{0}",o),n.ImageFormat=this.imageFormat,this.imageList.push(n),this.imageCacheIndexToList.set(o,n),i&&this.imageInterpolationTable.set(o,!0),e},P.prototype.storeImageDataForGeom=function(t){var e=t.imageToDraw.horizontalResolution/100;this.imageResolutionMode==ce.StiImageResolutionMode.NoMoreThan&&(e=t.stretch?t.imageToDraw.width/this.report.unit.convertToHInches(t.width):1/t.multipleFactor),e=this.storeImageData(t.imageToDraw,e,!0,t.smoothing),this.imageInfoList.set(this.imageInfoCounter,e)},P.prototype.writeImageInfo=function(t,e){var r=this.imageList[this.imagesCurrent];this.imagesCurrent++;var i=t.Component.as(E),n,o,a,s;this.imageResolutionMode==ce.StiImageResolutionMode.Exactly||null==i||i.margins.isEmpty||(n=this.hiToTwips*i.margins.left,o=this.hiToTwips*i.margins.right,a=this.hiToTwips*i.margins.top,s=this.hiToTwips*i.margins.bottom,0!=n&&(t.X+=n,t.Width-=n),0!=s&&(t.Y+=s,t.Height-=s),0!=o&&(t.Width-=o),0!=a&&(t.Height-=a));var l=f.None;null!=i&&(l=i.imageRotation);var m=r.Width,c=r.Height;l!=f.Rotate90CCW&&l!=f.Rotate90CW||(m=r.Height,c=r.Width);var p=t.X,g=t.Y,h=this.hiToTwips*(m-1)/e,w=this.hiToTwips*(c-1)/e,d=!1;if(this.imageResolutionMode!=ce.StiImageResolutionMode.Exactly&&null!=i&&null!=i.imageToDraw){var n=i.imageToDraw,s=i.getPaintRectangle(!0,!1),s=i.convertImageMargins(s,!1),o=new b(0,0,s.width,s.height);if(i.stretch){var u=m,S=c;if(null==n&&(S=u=1),i.aspectRatio){var a=o.width/u,e=o.height/S;switch(e<a?o.width=u*e:o.height=S*a,i.vertAlignment){case x.Center:o.y=(s.height-o.height)/2;break;case x.Top:o.y=s.height-o.height;break}switch(i.horAlignment){case y.Center:o.x=(s.width-o.width)/2;break;case y.Right:o.x=s.width-o.width;break}p+=o.x*this.hiToTwips,g+=o.y*this.hiToTwips,h=o.width*this.hiToTwips,w=o.height*this.hiToTwips}else h=t.Width,w=t.Height}else{var u=m*i.multipleFactor,S=c*i.multipleFactor;switch(null!=n&&null!=n.bytes||(S=u=1),o.width=u,o.height=S,i.horAlignment){case y.Center:o.x=(s.width-u)/2;break;case y.Right:o.x=s.width-u;break}switch(i.vertAlignment){case x.Center:o.y=(s.height-S)/2;break;case x.Top:o.y=s.height-S;break}p+=o.x*this.hiToTwips,g+=o.y*this.hiToTwips,h=o.width*this.hiToTwips,w=o.height*this.hiToTwips,d=!0}}this.pageStream.writeLine("q"),this.pushColorToStack(),this.setNonStrokeColor(v.black),d&&this.pageStream.writeLine1("{0} {1} {2} {3} re W n",this.convertToString(t.X),this.convertToString(t.Y),this.convertToString(t.Width),this.convertToString(t.Height)),l==f.None?this.pageStream.writeLine1("{0} 0 0 {1} {2} {3} cm",this.convertToString(h),this.convertToString(w),this.convertToString(p),this.convertToString(g)):(this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(p+h/2),this.convertToString(g+w/2)),l==f.Rotate90CCW&&this.pageStream.writeLine("0 1 -1 0 0 0 cm"),l==f.Rotate90CW&&this.pageStream.writeLine("0 -1 1 0 0 0 cm"),l==f.Rotate180&&this.pageStream.writeLine("-1 0 0 -1 0 0 cm"),l==f.FlipHorizontal&&this.pageStream.writeLine("-1 0 0 1 0 0 cm"),l==f.FlipVertical&&this.pageStream.writeLine("1 0 0 -1 0 0 cm"),l==f.Rotate90CCW||l==f.Rotate90CW?this.pageStream.writeLine1("{0} 0 0 {1} {2} {3} cm",this.convertToString(w),this.convertToString(h),this.convertToString(-w/2),this.convertToString(-h/2)):this.pageStream.writeLine1("{0} 0 0 {1} {2} {3} cm",this.convertToString(h),this.convertToString(w),this.convertToString(-h/2),this.convertToString(-w/2))),this.pageStream.writeLine1("/{0} Do",r.Name),this.pageStream.writeLine("Q"),this.popColorFromStack()},P.prototype.writeImageInfo2=function(t,e,r){var i=this.imageList[this.imagesCurrent];this.imagesCurrent++,this.pageStream.writeLine("q"),this.pushColorToStack(),this.setNonStrokeColor(v.black),this.pageStream.writeLine1("{0} 0 0 {1} {2} {3} cm",this.convertToString(this.hiToTwips*i.Width/e),this.convertToString(this.hiToTwips*i.Height/r),this.convertToString(t.X),this.convertToString(t.Y)),this.pageStream.writeLine1("/{0} Do",i.Name),this.pageStream.writeLine("Q"),this.popColorFromStack()},P.prototype.renderImage=function(t,e){var r,i,r,e,i;this.imageInfoList.containsKey(this.imageInfoCounter)?(r=this.imageInfoList.get(this.imageInfoCounter),this.writeImageInfo(t,r)):null!=(i=t.Component.as(Me))&&t.Component.isExportAsImage(je.StiExportFormat.Pdf)&&(e={ref:r=e},i=i.getImage(e,je.StiExportFormat.Pdf),r=e.ref,null!=i&&null!=i.bytes&&this.writeImageInfo(t,r))},P.prototype.renderWatermark=function(t,e,r,i,n){var o=t.watermark,e,i;if(null!=o&&o.enabled){if(null!=o.image&&o.showImageBehind==e){var a=this.imageList[this.imagesCurrent],s=a.Width*this.hiToTwips*o.imageMultipleFactor,l=a.Height*this.hiToTwips*o.imageMultipleFactor,m=0,c=0,p=1,g=1,h=o.imageAlignment,w=o.imageTiling,d,s,l,w;switch(o.imageStretch&&(d=l/s,s=r,l=i,w=!1,o.aspectRatio&&(d<i/r?l=s*d:s=l/d)),(o.imageStretch||1<o.imageMultipleFactor)&&this.imageInterpolationTable.set(this.imageCache.imageIndex[this.imagesCurrent],!0),w&&(h=_e.System.Drawing.ContentAlignment.TopLeft,p=Math.round2(r/s)+1,g=Math.round2(i/l)+1),h){case _e.System.Drawing.ContentAlignment.TopCenter:case _e.System.Drawing.ContentAlignment.MiddleCenter:case _e.System.Drawing.ContentAlignment.BottomCenter:m=(r-s)/2;break;case _e.System.Drawing.ContentAlignment.TopRight:case _e.System.Drawing.ContentAlignment.MiddleRight:case _e.System.Drawing.ContentAlignment.BottomRight:m=r-s;break}switch(h){case _e.System.Drawing.ContentAlignment.TopLeft:case _e.System.Drawing.ContentAlignment.TopCenter:case _e.System.Drawing.ContentAlignment.TopRight:c=i-l;break;case _e.System.Drawing.ContentAlignment.MiddleLeft:case _e.System.Drawing.ContentAlignment.MiddleCenter:case _e.System.Drawing.ContentAlignment.MiddleRight:c=(i-l)/2;break}this.setNonStrokeColor(v.fromArgb(255-o.imageTransparency,v.black));for(var u=0;u<g;u++)for(var S=0;S<p;S++)this.pageStream.writeLine("q"),this.pushColorToStack(),this.pageStream.writeLine1("{0} 0 0 {1} {2} {3} cm",this.convertToString(s),this.convertToString(l),this.convertToString(m+s*S),this.convertToString(c-l*u)),this.pageStream.writeLine1("/{0} Do",a.Name),this.pageStream.writeLine("Q"),this.popColorFromStack();this.imagesCurrent++}ye.isNullOrEmpty(o.text)||o.showBehind!=e||((e=new Xe(this)).X=0,e.Y=0,e.Width=r,e.Height=i,(i=new Le(new b(e.X,e.Y,e.Width,e.Height))).text=o.text,i.textBrush=o.textBrush,i.font=o.font,i.textOptions=new _e.Base.Drawing.StiTextOptions,i.textOptions.angle=o.angle,i.horAlignment=_e.Base.Drawing.StiTextHorAlignment.Center,i.vertAlignment=x.Center,i.page=t,i.textQuality=_e.Report.Components.StiTextQuality.Standard,e.Component=i,ce.StiPdfRenderText.renderTextFont(e),ce.StiPdfRenderText.renderText(e))}},P.prototype.storeShadingData1=function(t,e){var r,i,r,i;null!=t&&(t.is(l)&&(r=t,(i=new We).Angle=r.angle,i.Page=e,i.FunctionIndex=this.getShadingFunctionNumber(r.startColor,r.endColor,!1),this.shadingArray.push(i)),t.is(c)&&(r=t,(i=new We).Angle=r.angle,i.FunctionIndex=this.getShadingFunctionNumber(r.startColor,r.endColor,!0),i.Page=e,this.shadingArray.push(i)))},P.prototype.storeShadingData2=function(t,e,r,i,n){var n;return null!=n&&(n.is(l)||n.is(c))&&((n=this.shadingArray[this.shadingCurrent]).X=t,n.Y=e,n.Width=r,n.Height=i,this.shadingArray[this.shadingCurrent]=n,this.shadingCurrent++),this.shadingCurrent},P.prototype.storeHatchData=function(t){var e;null!=t&&(t.is(n)&&this.getHatchNumber(t),t.is(p)&&t.as(p).drawHatch)},P.prototype.renderMetadata=function(t){var e,r,i,n,o=new D,a='<?xpacket begin="" id="W5M0MpCehiHzreSzNTczkc9d"?>\r\n';o.writeString(a);var s=new D,l=new S(_e.System.Text.Encoding.UTF8,s);if(l.formatting=_e.System.Xml.Formatting.Indented,l.writeStartElement("x:xmpmeta"),l.writeAttributeString("xmlns:x","adobe:ns:meta/"),l.writeAttributeString("x:xmptk","Adobe XMP Core 4.0-c316 44.253921, Sun Oct 01 2006 17:14:39"),l.writeStartElement("rdf:RDF"),l.writeAttributeString("xmlns:rdf","http://www.w3.org/1999/02/22-rdf-syntax-ns#"),l.writeStartElement("rdf:Description"),l.writeAttributeString("rdf:about",""),l.writeAttributeString("xmlns:xap","http://ns.adobe.com/xap/1.0/"),l.writeElementString("xap:ModifyDate",this.currentDateTimeMeta),l.writeElementString("xap:CreateDate",this.currentDateTimeMeta),l.writeElementString("xap:MetadataDate",this.currentDateTimeMeta),l.writeElementString("xap:CreatorTool",_e["StiOptions"].Export.Pdf.creatorString),l.writeFullEndElement(),l.writeStartElement("rdf:Description"),l.writeAttributeString("rdf:about",""),l.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),l.writeElementString("dc:format","application/pdf"),l.writeStartElement("dc:title"),l.writeStartElement("rdf:Alt"),ye.isNullOrEmpty(t.reportName)||(l.writeStartElement("rdf:li"),l.writeAttributeString("xml:lang","x-default"),l.writeString(t.reportName),l.writeFullEndElement()),l.writeEndElement(),l.writeFullEndElement(),l.writeStartElement("dc:description"),l.writeStartElement("rdf:Alt"),ye.isNullOrEmpty(t.reportAlias)||(l.writeStartElement("rdf:li"),l.writeAttributeString("xml:lang","x-default"),l.writeString(t.reportAlias),l.writeFullEndElement()),l.writeEndElement(),l.writeFullEndElement(),l.writeStartElement("dc:creator"),l.writeStartElement("rdf:Seq"),ye.isNullOrEmpty(t.reportAuthor)||(l.writeStartElement("rdf:li"),l.writeAttributeString("xml:lang","x-default"),l.writeString(t.reportAuthor),l.writeFullEndElement()),l.writeEndElement(),l.writeFullEndElement(),l.writeStartElement("dc:subject"),l.writeStartElement("rdf:Bag"),!ye.isNullOrEmpty(this.keywords)){var m=this.keywords.split(";");try{for(var c=__values(m),p=c.next();!p.done;p=c.next()){var g=p.value;l.writeStartElement("rdf:li"),l.writeString(g.trim()),l.writeFullEndElement()}}catch(t){e={error:t}}finally{try{p&&!p.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}}l.writeEndElement(),l.writeFullEndElement(),l.writeFullEndElement(),l.writeStartElement("rdf:Description"),l.writeAttributeString("rdf:about",""),l.writeAttributeString("xmlns:xapMM","http://ns.adobe.com/xap/1.0/mm/"),l.writeElementString("xapMM:DocumentID",this.IDValueStringMeta),l.writeElementString("xapMM:InstanceID",this.IDValueStringMeta),l.writeFullEndElement(),l.writeStartElement("rdf:Description"),l.writeAttributeString("rdf:about",""),l.writeAttributeString("xmlns:pdf","http://ns.adobe.com/pdf/1.3/"),l.writeAttributeString("xmlns:pdfx","http://ns.adobe.com/pdf/1.3/"),l.writeElementString("pdf:Producer",this.producerName),l.writeElementString("pdf:Keywords",this.keywords);try{for(var h=__values(t.metaTags.list),w=h.next();!w.done;w=h.next()){var d=w.value;d.name.stimulsoft.startsWith("pdf:")&&l.writeElementString("pdfx:"+d.name.substr(4),d.tag)}}catch(t){i={error:t}}finally{try{w&&!w.done&&(n=h.return)&&n.call(h)}finally{if(i)throw i.error}}if(l.writeFullEndElement(),this.zugferdComplianceMode!=ce.StiPdfZUGFeRDComplianceMode.None&&(l.writeStartElement("rdf:Description"),l.writeAttributeString("xmlns:pdfaExtension","http://www.aiim.org/pdfa/ns/extension/"),l.writeAttributeString("xmlns:pdfaField","http://www.aiim.org/pdfa/ns/field#"),l.writeAttributeString("xmlns:pdfaProperty","http://www.aiim.org/pdfa/ns/property#"),l.writeAttributeString("xmlns:pdfaSchema","http://www.aiim.org/pdfa/ns/schema#"),l.writeAttributeString("xmlns:pdfaType","http://www.aiim.org/pdfa/ns/type#"),l.writeAttributeString("rdf:about",""),l.writeStartElement("pdfaExtension:schemas"),l.writeStartElement("rdf:Bag"),l.writeStartElement("rdf:li"),l.writeAttributeString("rdf:parseType","Resource"),this.zugferdComplianceMode==ce.StiPdfZUGFeRDComplianceMode.V1&&(l.writeElementString("pdfaSchema:schema","ZUGFeRD PDFA Extension Schema"),l.writeElementString("pdfaSchema:namespaceURI","urn:ferd:pdfa:CrossIndustryDocument:invoice:1p0#"),l.writeElementString("pdfaSchema:prefix","zf")),this.zugferdComplianceMode==ce.StiPdfZUGFeRDComplianceMode.V2&&(l.writeElementString("pdfaSchema:schema","ZUGFeRD PDFA Extension Schema"),l.writeElementString("pdfaSchema:namespaceURI","urn:zugferd:pdfa:CrossIndustryDocument:invoice:2p0#"),l.writeElementString("pdfaSchema:prefix","zf")),this.zugferdComplianceMode==ce.StiPdfZUGFeRDComplianceMode.V2_1&&(l.writeElementString("pdfaSchema:schema","Factur-X/ZUGFeRD PDF/A Extension Schema"),l.writeElementString("pdfaSchema:namespaceURI","urn:factur-x:pdfa:CrossIndustryDocument:invoice:1p0#"),l.writeElementString("pdfaSchema:prefix","fx")),l.writeStartElement("pdfaSchema:property"),l.writeStartElement("rdf:Seq"),l.writeStartElement("rdf:li"),l.writeAttributeString("rdf:parseType","Resource"),l.writeElementString("pdfaProperty:name","DocumentFileName"),l.writeElementString("pdfaProperty:valueType","Text"),l.writeElementString("pdfaProperty:category","external"),l.writeElementString("pdfaProperty:description","Name of the embedded XML invoice file"),l.writeFullEndElement(),l.writeStartElement("rdf:li"),l.writeAttributeString("rdf:parseType","Resource"),l.writeElementString("pdfaProperty:name","DocumentType"),l.writeElementString("pdfaProperty:valueType","Text"),l.writeElementString("pdfaProperty:category","external"),l.writeElementString("pdfaProperty:description","INVOICE"),l.writeFullEndElement(),l.writeStartElement("rdf:li"),l.writeAttributeString("rdf:parseType","Resource"),l.writeElementString("pdfaProperty:name","Version"),l.writeElementString("pdfaProperty:valueType","Text"),l.writeElementString("pdfaProperty:category","external"),this.zugferdComplianceMode==ce.StiPdfZUGFeRDComplianceMode.V2_1?l.writeElementString("pdfaProperty:description","Version of the Factur-X/ZUGFeRD XML schema"):l.writeElementString("pdfaProperty:description","The actual version of the ZUGFeRD data"),l.writeFullEndElement(),l.writeStartElement("rdf:li"),l.writeAttributeString("rdf:parseType","Resource"),l.writeElementString("pdfaProperty:name","ConformanceLevel"),l.writeElementString("pdfaProperty:valueType","Text"),l.writeElementString("pdfaProperty:category","external"),this.zugferdComplianceMode==ce.StiPdfZUGFeRDComplianceMode.V2_1?l.writeElementString("pdfaProperty:description","Conformance level of the embedded Factur-X/ZUGFeRD XML invoice data"):l.writeElementString("pdfaProperty:description","The conformance level of the ZUGFeRD data"),l.writeFullEndElement(),l.writeFullEndElement(),l.writeFullEndElement(),l.writeFullEndElement(),l.writeFullEndElement(),l.writeFullEndElement(),l.writeFullEndElement(),l.writeStartElement("rdf:Description"),this.zugferdComplianceMode==ce.StiPdfZUGFeRDComplianceMode.V1&&(l.writeAttributeString("xmlns:zf","urn:ferd:pdfa:CrossIndustryDocument:invoice:1p0#"),l.writeAttributeString("zf:DocumentFileName","ZUGFeRD-invoice.xml"),l.writeAttributeString("zf:ConformanceLevel",this.zugferdConformanceLevel),l.writeAttributeString("zf:DocumentType","INVOICE"),l.writeAttributeString("zf:Version","1.0")),this.zugferdComplianceMode==ce.StiPdfZUGFeRDComplianceMode.V2&&(l.writeAttributeString("xmlns:zf","urn:zugferd:pdfa:CrossIndustryDocument:invoice:2p0#"),l.writeAttributeString("zf:DocumentFileName","zugferd-invoice.xml"),l.writeAttributeString("zf:ConformanceLevel",this.zugferdConformanceLevel),l.writeAttributeString("zf:DocumentType","INVOICE"),l.writeAttributeString("zf:Version","1.0")),this.zugferdComplianceMode==ce.StiPdfZUGFeRDComplianceMode.V2_1&&(l.writeAttributeString("xmlns:fx","urn:factur-x:pdfa:CrossIndustryDocument:invoice:1p0#"),l.writeAttributeString("fx:DocumentFileName","factur-x.xml"),l.writeAttributeString("fx:ConformanceLevel",this.zugferdConformanceLevel),l.writeAttributeString("fx:DocumentType","INVOICE"),l.writeAttributeString("fx:Version","1.0")),l.writeAttributeString("rdf:about",""),l.writeFullEndElement()),this.usePdfA){l.writeStartElement("rdf:Description"),l.writeAttributeString("rdf:about",""),l.writeAttributeString("xmlns:pdfaid","http://www.aiim.org/pdfa/ns/id/");var a="1";switch(this.pdfComplianceMode){case ce.StiPdfComplianceMode.A1:a="1";break;case ce.StiPdfComplianceMode.A2:a="2";break;case ce.StiPdfComplianceMode.A3:a="3";break}var u="A";switch(this.zugferdComplianceMode){case ce.StiPdfZUGFeRDComplianceMode.V1:u="A";break;case ce.StiPdfZUGFeRDComplianceMode.V2:u="B";break;case ce.StiPdfZUGFeRDComplianceMode.V2_1:u="B";break}l.writeElementString("pdfaid:part",a),l.writeElementString("pdfaid:conformance",u),l.writeFullEndElement()}l.writeFullEndElement(),l.writeFullEndElement(),l.writeString("                              \r\n"),l.writeString("                              \r\n"),l.writeString("                              \r\n"),l.writeString("                              \r\n"),l.writeString("                              \r\n");var u=s.toArray();l.close(),s.close(),o.write(u,0,u.length),o.writeString('<?xpacket end="w"?>'),this.addXref(this.info.metadata.ref),this.sw.writeLine1("{0} 0 obj",this.info.metadata.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Metadata"),this.sw.writeLine("/Subtype /XML"),this.storeMemoryStream2(o,"/Length {0}"),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")},P.prototype.renderColorSpace=function(){this.addXref(this.info.destOutputProfile.ref),this.sw.writeLine1("{0} 0 obj",this.info.destOutputProfile.ref),this.sw.writeLine("<<"),this.sw.writeLine("/N 3");var t=null,e=null,e=1==this.compressed?(t=ce.StiExportUtils.makePdfDeflateStream(ce.StiPdfResources.sRGBprofile),"/Length {0} /Filter [/FlateDecode] /Length1 "+ce.StiPdfResources.sRGBprofile.length.toString()):((t=new D).write(ce.StiPdfResources.sRGBprofile,0,ce.StiPdfResources.sRGBprofile.length),"/Length {0}");this.storeMemoryStream2(t,e),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.outputIntents.ref),this.sw.writeLine1("{0} 0 obj",this.info.outputIntents.ref),this.sw.writeLine("[<<"),this.storeStringLine("/Info","sRGB IEC61966-2.1"),this.storeStringLine("/OutputConditionIdentifier","Custom"),this.storeStringLine("/OutputCondition",""),this.storeStringLine("/RegistryName",""),this.sw.writeLine("/S /GTS_PDFA1"),this.sw.writeLine1("/DestOutputProfile {0} 0 R",this.info.destOutputProfile.ref),this.sw.writeLine("/Type /OutputIntent"),this.sw.writeLine(">>]"),this.sw.writeLine("endobj"),this.sw.writeLine("")},P.prototype.renderAutoPrint=function(){this.autoPrint!=ce.StiPdfAutoPrintMode.None&&(this.addXref(this.info.embeddedJS.ref),this.sw.writeLine1("{0} 0 obj",this.info.embeddedJS.ref),this.sw.writeLine("<<"),this.sw.writeLine1("/Names [(EmbeddedJS) {0} 0 R]",this.info.embeddedJS.content.ref),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.embeddedJS.content.ref),this.sw.writeLine1("{0} 0 obj",this.info.embeddedJS.content.ref),this.sw.writeLine("<<"),this.sw.writeLine("/S /JavaScript"),this.sw.writeLine1("/JS (print\\({0}\\);)",this.autoPrint==ce.StiPdfAutoPrintMode.Dialog?"true":"false"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""))},P.prototype.renderEmbeddedFiles=function(){for(var t=0;t<this.info.embeddedFilesList.length;t++){var e=this.embeddedFiles[t],r,e;this.addXref(this.info.embeddedFilesList[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.embeddedFilesList[t].ref),this.sw.writeLine("<<"),this.storeStringLine("/F",e.name),this.sw.writeLine("/Type /Filespec"),this.sw.writeLine("/EF <<"),this.sw.writeLine1("/F {0} 0 R",this.info.embeddedFilesList[t].content.ref),this.sw.writeLine(">>"),this.zugferdComplianceMode==ce.StiPdfZUGFeRDComplianceMode.None&&this.pdfComplianceMode!=ce.StiPdfComplianceMode.A3||this.sw.writeLine("/AFRelationship /Alternative"),this.storeStringLine("/UF",e.name),this.storeStringLine("/Desc",e.description),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.embeddedFilesList[t].content.ref),this.sw.writeLine1("{0} 0 obj",this.info.embeddedFilesList[t].content.ref),this.sw.writeLine("<<"),this.sw.writeLine1("/Subtype /{0}",e.MIMEType.stimulsoft.replaceAll("/","#2F")),this.sw.writeLine("/Type /EmbeddedFile"),this.sw.writeLine("/Params <<"),this.storeStringLine("/ModDate ","D:"+this.currentDateTime),this.sw.writeLine1("/Size {0}",e.data.length),this.sw.writeLine(">>"),this.compressed?(r=ce.StiExportUtils.makePdfDeflateStream(e.data),this.storeMemoryStream2(r,"/Filter [/FlateDecode] /Length {0}")):e.data instanceof Uint8Array?this.storeMemoryStream3(e.data,"/Length {0}"):e.data instanceof Array?this.storeMemoryStream4(e.data,"/Length {0}"):(e=_e.System.Text.Encoding.UTF8.getBytes(e.data),this.storeMemoryStream4(e,"/Length {0}")),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")}},P.prototype.addBookmarkNode=function(t,e){var r=new Ve;r.Parent=-1,r.First=-1,r.Last=-1,r.Prev=-1,r.Next=-1,r.Count=-1,r.Page=-1,r.Y=-1,r.Title="",r.Guid="",r.Used=-1==e,this.bookmarksTree.push(r);var i=this.bookmarksTree.stimulsoft.countItems-1;if(r.Parent=e,r.Title=t.text,r.Guid=t.componentGuid,0==t.bookmarks.count)r.Count=0;else{for(var n=-1,o=0;o<=t.bookmarks.count-1;o++){var a=this.bookmarksTree.stimulsoft.countItems,s=t.bookmarks.list[o];this.addBookmarkNode(s,i);var s=this.bookmarksTree[a];o<t.bookmarks.count-1&&(s.Next=this.bookmarksTree.stimulsoft.countItems),0<o&&(s.Prev=n),this.bookmarksTree[a]=s,n=a}r.First=i+1,r.Last=this.bookmarksTree.stimulsoft.countItems-1,r.Count=this.bookmarksTree.stimulsoft.countItems-i-1}this.bookmarksTree[i]=r},P.prototype.makeBookmarkFromTree=function(t,e){if(t.text=e.Title,t.bookmarks=new o,0<e.Count){var r=e.First;while(-1!=r){var i=this.bookmarksTree[r],n;i.Used&&(n=new Ee,t.bookmarks.add(n),this.makeBookmarkFromTree(n,i)),r=i.Next}}},P.prototype.exportPdf=function(t,e,r){try{this.exportPdf1(t,e,r)}finally{}},P.prototype.exportPdf1=function(t,e,r){var i,n,o,a,s,l,m,c,p,g,h,w,d,u,S,f;if(null==r)throw new Error("The 'settings' argument cannot be equal in null.");this.report=t;var v=r.pageRange,E=r.imageResolution;this.imageResolutionMode=r.imageResolutionMode,this.imageQuality=r.imageQuality,this.embeddedFonts=r.embeddedFonts,this.standardPdfFonts=!!r.standardPdfFonts,this.compressed=!!r.compressed,this.useUnicodeMode=r.useUnicode;var b=r.passwordInputUser,y=r.passwordInputOwner,x=r.userAccessPrivileges;this.keyLength=r.keyLength,this.pdfComplianceMode=r.pdfComplianceMode,this.autoPrint=r.autoPrintMode,this.allowEditable=r.allowEditable,this.embeddedFiles=r.embeddedFiles,this.zugferdComplianceMode=r.ZUGFeRDComplianceMode,this.zugferdConformanceLevel=r.ZUGFeRDConformanceLevel;var A=r.ZUGFeRDInvoiceData;if(this.creatorName=_e["StiOptions"].Export.Pdf.creatorString,this.keywords=_e["StiOptions"].Export.Pdf.keywordsString,ye.isNullOrEmpty(r.creatorString)||(this.creatorName=r.creatorString),ye.isNullOrEmpty(r.keywordsString)||(this.keywords=r.keywordsString),ye.isNullOrEmpty(this.creatorName)&&(this.creatorName=this.producerName),null==this.embeddedFiles&&(this.embeddedFiles=new ge),null!=t.dictionary.resources)try{for(var T=__values(t.dictionary.resources.list),P=T.next();!P.done;P=T.next()){var L=P.value,C,L;L.availableInTheViewer&&(C=L.alias!=L.name?L.alias:"",L=new pe(L.name+L.getFileExt(),C,L.content,L.getContentType()),this.embeddedFiles.add(L))}}catch(t){i={error:t}}finally{try{P&&!P.done&&(n=T.return)&&n.call(T)}finally{if(i)throw i.error}}if(this.zugferdComplianceMode!=ce.StiPdfZUGFeRDComplianceMode.None&&(this.pdfComplianceMode=ce.StiPdfComplianceMode.A3,null!=A)){var F=!1;try{for(var R=__values(this.embeddedFiles),I=R.next();!I.done;I=R.next()){var B,D=I.value.name.toLowerCase();"zugferd-invoice.xml"!=D&&"factur-x.xml"!=D||(F=!0)}}catch(t){o={error:t}}finally{try{I&&!I.done&&(a=R.return)&&a.call(R)}finally{if(o)throw o.error}}F||(this.zugferdComplianceMode==ce.StiPdfZUGFeRDComplianceMode.V1&&this.embeddedFiles.add(new pe("ZUGFeRD-invoice.xml","ZUGFeRD Rechnung",A)),this.zugferdComplianceMode==ce.StiPdfZUGFeRDComplianceMode.V2&&this.embeddedFiles.add(new pe("zugferd-invoice.xml","ZUGFeRD Rechnung",A)),this.zugferdComplianceMode==ce.StiPdfZUGFeRDComplianceMode.V2_1&&this.embeddedFiles.add(new pe("factur-x.xml","Factur-X/ZUGFeRD",A)))}1<this.embeddedFiles.countItems&&(this.embeddedFiles=this.embeddedFiles.orderBy(function(t){return t.name}).toList()),this.usePdfA=this.pdfComplianceMode!=ce.StiPdfComplianceMode.None,this.useTransparency=this.pdfComplianceMode!=ce.StiPdfComplianceMode.A1,this.compressedFonts=!0,this.usePdfA&&(this.standardPdfFonts=!1,this.embeddedFonts=!0,this.useUnicodeMode=!0);var r=v.rangeType!=je.StiRangeType.All,A=!this.usePdfA;this.embeddedFonts&&(this.standardPdfFonts=!1),this.imageQuality<0&&(this.imageQuality=0),1<this.imageQuality&&(this.imageQuality=1),this.useUnicodeMode&&(this.standardPdfFonts=!1),E<10&&(E=10),E/=100,this.imageResolutionMain=E,this.bidi=new ce.StiBidirectionalConvert(!0),this.pdfFont=new ce.PdfFonts,this.pdfFont.standardPdfFonts=this.standardPdfFonts,this.pdfFont.forceUseUnicode=this.useUnicodeMode,this.fontGlyphsReduceNotNeed=null;for(var k=0;k<=255;k++){var N,O=Math.round2(k/255,3).toString().split(",").join(_e.System.Globalization.CultureInfo.currentCulture.numberFormat.numberDecimalSeparator);this.colorTable[k]=O,this.alphaTable[k]=!1}switch(this.lastColorStrokeA=255,this.lastColorNonStrokeA=255,this.colorStack=new Array,this.imageList=new Array,this.imageCompressionMethod){case ce.StiPdfImageCompressionMethod.Flate:this.imageCache=new je.StiImageCache(!0,!0,je.ImageFormat.MemoryBmp,this.imageQuality,A);break;default:this.imageCache=new je.StiImageCache(!0,!0,je.ImageFormat.Jpeg,this.imageQuality,A);break}this.imageInterpolationTable=new Te,this.imageCacheIndexToList=new Te,this.imageInfoList=new Te,this.imageInfoCounter=0,this.pdfFont.fontList=new Array,this.xref=new Array,this.bookmarksTree=new Array,this.haveBookmarks=!1,this.linksArray=new Array,this.annotsArray=new Array,this.annots2Array=new Array,this.unsignedSignaturesArray=new Array,this.shadingArray=new Array,this.shadingFunctionArray=new Array,this.hatchArray=new Array,this.tooltipsArray=new Array,this.sw=e,this.fontsCounter=0,this.bookmarksCounter=0,this.linksCounter=0,this.annotsCounter=0,this.annots2Counter=0;for(var M=this.tooltipsCounter=0;M<256;M++)this.CodePage1252[M]=M;for(var M=0;M<32;M++)this.CodePage1252[128+M]=this.CodePage1252part80AF[M];this.fontGlyphsReduceNotNeed=ve.create(Boolean,256);var A=Ne.now,e=A.toString("yyyyMMddHHmmsszzz");this.currentDateTime=e.substr(0,17)+"'"+e.substr(18,2)+"'",this.currentDateTimeMeta=A.toString("yyyy-MM-ddTHH:mm:sszzz");var H=A.toString("yyyyMMddHHmmssffff");H+=this.producerName,H+=this.creatorName,H+=t.reportAuthor,H+=t.reportAlias,H+=t.reportName;for(var U="",M=0;M<H.length;M++)U+=String.fromCharCode(255&H.charCodeAt(M));this.IDValue=_e.Base.StiMD5Helper.MD5(U,!1);for(var z="",M=0;M<this.IDValue.length;M++)z+=ce.StiExportUtils.toHex(this.IDValue[M]);this.IDValueString=z,this.IDValueStringMeta=ye.format("uuid:{0}-{1}-{2}-{3}-{4}",this.IDValueString.substring(0,8),this.IDValueString.substring(8,4),this.IDValueString.substring(12,4),this.IDValueString.substring(16,4),this.IDValueString.substring(20,12)).toLowerCase(),this.pdfSecurity=new ce.StiPdfSecurity(this),this.usePdfA||(this.encrypted=this.pdfSecurity.computingCryptoValues(x,y,b,this.keyLength,this.IDValue)),this.encrypted&&this.useUnicodeMode&&(this.embeddedFonts=!0);var X=v.getSelectedPages(t.renderedPages);null!=t.bookmark&&0!=t.bookmark.bookmarks.count&&(this.addBookmarkNode(t.bookmark,-1),this.haveBookmarks=!0,this.bookmarksCounter=this.bookmarksTree.stimulsoft.countItems);var W=0;try{for(var Y=__values(X.list),G=Y.next();!G.done;G=Y.next()){var V=G.value,_,j;X.getPage(V),this.storeShadingData1(V.brush,W),this.storeHatchData(V.brush),null!=V.hyperlinkValue&&0<V.hyperlinkValue.toString().trim().length&&!V.hyperlinkValue.toString().trim().stimulsoft.startsWith("javascript:")&&!this.usePdfA&&((_=new Ge).Link=V.hyperlinkValue.ToString(),_.Page=W,this.linksArray.push(_)),null!=V.watermark&&V.watermark.enabled&&(ye.isNullOrEmpty(V.watermark.text)||(null!=V.watermark.font&&this.pdfFont.getFontNumber(V.watermark.font),j=new Pe(V.watermark.text),j=this.bidi.convert(j,!1),this.pdfFont.storeUnicodeSymbolsInMap(j.toString()),this.storeShadingData1(V.watermark.textBrush,W),this.storeHatchData(V.watermark.textBrush)),1==V.watermark.showImageBehind&&null!=V.watermark.image&&this.storeImageData(V.watermark.image,E,!1,!1));try{for(var q=(m=void 0,__values(V.components.list)),K=q.next(),J,Q,_,_,_;!K.done;K=q.next()){if((J=K.value).enabled&&(!t.isPrinting||J.printable)){if(this.imageInfoCounter++,Q=0<J.width&&0<J.height){var Z=J.as(Ie);null!=Z&&(this.storeShadingData1(Z.brush,W),this.storeHatchData(Z.brush));var Z=J.as(Ce),$,tt,et,rt,it,rt,nt,ot;if(null!=Z&&ce.StiPdfRenderPrimitives.checkShape(Z))continue;if(J.is(He)){var et=J,at;this.storeShadingData1(et.textBrush,W),this.storeHatchData(et.textBrush),this.allowEditable==ce.StiPdfAllowEditable.Yes&&et.editable&&((at=new Ye).Page=W,at.Component=J,this.annots2Array.push(at));continue}($=J.isExportAsImage(je.StiExportFormat.Pdf))&&(tt=!1,et=J,this.imageResolutionMode!=ce.StiImageResolutionMode.Exactly&&null!=et&&null!=et.imageToDraw&&null!=et.imageToDraw.bytes&&(tt=!0,rt=et.imageToDraw.horizontalResolution/100,this.imageResolutionMode==ce.StiImageResolutionMode.NoMoreThan&&(rt=et.stretch?et.imageToDraw.width/t.unit.convertToHInches(J.width):1/et.multipleFactor),rt=this.storeImageData(et.imageToDraw,rt,!0,et.smoothing),this.imageInfoList.set(this.imageInfoCounter,rt)),tt||null!=(it=J.as(Me))&&(nt={ref:rt=E},ot=it.getImage(nt,je.StiExportFormat.Pdf),rt=nt.ref,null!=ot&&(this.storeImageData(ot,rt,!1,!1),this.imageInfoList.set(this.imageInfoCounter,rt))));var tt=J.as(Re),st;null!=tt&&(st=this.pdfFont.getFontNumber(tt.font));var lt=J.stimulsoft.as(De),mt,ct,pt,gt,ht,ht;if(J.is(Le)&&!$){var it=J,nt=null!=lt&&null!=lt.textOptions&&lt.textOptions.rightToLeft,j=new Pe(it.text);if(it.allowHtmlTags){var wt=new _e.Base.Drawing.StiHtmlTagsState(it.font.bold,it.font.italic,it.font.underline,it.font.strikeout,it.font.size,it.font.name,Ae.toColor(it.textBrush),Ae.toColor(it.brush),!1,!1,0,0,1,it.horAlignment),dt=new _e.Base.Drawing.StiHtmlState(wt,0),ut=_e.Base.Drawing.StiTextRenderer.parseHtmlToStates(it.text,dt);j=new Pe;for(var St=0;St<ut.length;St++){var ft=ut[St];j.append(_e.Base.Drawing.StiTextRenderer.prepareStateText(ft.text))}}j=this.bidi.convert(j,nt),this.pdfFont.storeUnicodeSymbolsInMap(j.toString());var tt=J.as(Be),at,nt,ot,rt,tt,nt,it,tt;null!=it&&null!=tt&&(this.storeShadingData1(tt.textBrush,W),this.storeHatchData(tt.textBrush)),this.allowEditable==ce.StiPdfAllowEditable.Yes&&it.editable&&((at=new Ye).Page=W,this.annotsArray.push(at),this.fontGlyphsReduceNotNeed[this.pdfFont.currentFont]=!0),null!=it.indicator&&(null==(nt=it.indicator.stimulsoft.as(fe))||nt.icon==Se.None&&null==nt.customIcon||(ot=ue.getIcon(nt),rt=1,rt=this.storeImageData(ot,rt,!1,!0,!0),this.imageInfoList[this.imageInfoCounter]=rt),null!=(tt=it.indicator.stimulsoft.as(de))&&0!=tt.value&&tt.brushType==_e.Report.Components.StiBrushType.Gradient&&(nt=tt.value<0?tt.negativeColor:tt.positiveColor,it=we.light(nt,200),(tt=new We).Page=W,tt.FunctionIndex=this.getShadingFunctionNumber(nt,it,!1),this.shadingArray.push(tt)))}J.is(Ue)&&!$?(mt=new ce.StiPdfGeomWriter(this.pageStream,this,!0),ct=ce.StiBarCodeExportPainter.createNew(mt),pt=J,ye.isNullOrEmpty(pt.codeValue)||null==pt.page||(gt=t.unit.convertRectangleToHInches(pt.clientRectangle),pt.barCodeType.draw(ct,pt,gt,1))):J.is(Oe)&&!$?((ht=new Xe(this)).Component=J,ce.StiPdfRenderChart.renderChart(ht,!0,W)):J.is(he)&&!$&&((ht=new Xe(this)).Component=J,ce.StiPdfRenderChart.renderSparkline(ht,!0,W))}null!=J.hyperlinkValue&&0<J.hyperlinkValue.toString().trim().length&&!J.hyperlinkValue.toString().trim().stimulsoft.startsWith("javascript:")&&!this.usePdfA&&((_=new Ge).Link=J.hyperlinkValue.toString(),_.Page=W,this.linksArray.push(_)),null!=J.toolTipValue&&0<J.toolTipValue.toString().trim().length&&!this.usePdfA&&((_=new Ge).Page=W,this.tooltipsArray.push(_)),null==J.tagValue||"pdfunsignedsignaturefield"!=J.tagValue.toString().toLowerCase()||this.usePdfA||((_=new Ye).Page=W,this.unsignedSignaturesArray.push(_))}}}catch(t){m={error:t}}finally{try{K&&!K.done&&(c=q.return)&&c.call(q)}finally{if(m)throw m.error}}W++,null!=V.watermark&&V.watermark.enabled&&0==V.watermark.showImageBehind&&null!=V.watermark.image&&this.storeImageData(V.watermark.image,E,!1,!1)}}catch(t){s={error:t}}finally{try{G&&!G.done&&(l=Y.return)&&l.call(Y)}finally{if(s)throw s.error}}for(var vt=0;vt<this.pdfFont.fontList.length;vt++)this.pdfFont.currentFont=vt,this.pdfFont.storeUnicodeSymbolsInMap("");if(0<this.unsignedSignaturesArray.stimulsoft.countItems&&(0<this.annotsArray.stimulsoft.countItems||0<this.annots2Array.stimulsoft.countItems))for(var vt=0,Et;vt<this.pdfFont.fontList.stimulsoft.countItems;vt++){"Arial"==this.pdfFont.fontList[vt].Name&&(this.fontGlyphsReduceNotNeed[vt]=!0)}for(var bt="",yt=32;yt<256;yt++)bt+=String.fromCharCode(this.CodePage1252[yt]);for(var xt=0;xt<this.pdfFont.fontList.length;xt++)this.fontGlyphsReduceNotNeed[xt]&&(this.pdfFont.currentFont=xt,this.pdfFont.storeUnicodeSymbolsInMap(bt));this.imagesCurrent=0,this.annotsCurrent=0,this.annots2Current=0,this.shadingCurrent=0,this.linksCounter=this.linksArray.stimulsoft.countItems,this.haveLinks=0<this.linksCounter,this.annotsCounter=this.annotsArray.length,this.annots2Counter=this.annots2Array.length,this.unsignedSignaturesCounter=this.unsignedSignaturesArray.length,this.haveAnnots=0<this.annotsCounter||0<this.annots2Counter||0<this.unsignedSignaturesCounter,this.tooltipsCounter=this.tooltipsArray.stimulsoft.countItems,this.haveTooltips=0<this.tooltipsCounter,this.pdfFont.InitFontsData(t),this.fontsCounter=this.pdfFont.fontList.length,this.info=new ce.StiPdfStructure;for(var M=0;M<X.count;M++)this.info.pageList.push(this.info.createContentObject(!0));for(var M=0;M<this.imageCache.imagePackedStore.length;M++)this.info.xObjectList.push(this.info.createXObject(!0,null!=this.imageCache.imageMaskStore[M]));for(var M=0;M<this.pdfFont.fontList.length;M++){var At=this.pdfFont.fontList[M];this.info.fontList.push(this.info.createFontObject(!0,At.UseUnicode,this.standardPdfFonts,this.embeddedFonts||ce.PdfFonts.isFontStimulsoft(At.Name)))}if(this.info.outlines=this.info.createOutlinesObject(this.haveBookmarks),this.haveBookmarks)for(var M=0;M<this.bookmarksCounter;M++)this.info.outlines.items.push(this.info.createObject(!0));this.info.patterns=this.info.createPatternsObject(!0);for(var M=0;M<this.hatchArray.length;M++)this.info.patterns.hatchItems.push(this.info.createObject(!0));for(var M=0;M<this.shadingArray.length;M++)this.info.patterns.shadingItems.push(this.info.createObject(!0));for(var M=0;M<this.shadingFunctionArray.length;M++)this.info.patterns.shadingFunctionItems.push(this.info.createObject(!0));for(var M=0;M<this.linksCounter;M++)this.info.linkList.push(this.info.createObject(!0));if(this.info.encode=this.info.createObject(this.encrypted),this.info.extGState=this.info.createObject(!0),this.info.acroForm=this.info.createAcroFormObject(this.haveAnnots||this.haveTooltips),this.haveAnnots){for(var M=0;M<this.annotsCounter;M++)this.info.acroForm.annots.push(this.info.createAnnotObject(!0,!0,0));for(var M=0;M<this.fontsCounter;M++)this.info.acroForm.annotFontItems.push(this.info.createFontObject(!0,!1,!1,!1,!0));for(var M=0;M<this.annots2Counter;M++)this.info.acroForm.checkBoxes.push(new ce.StiPdfCheckBoxObjInfo),this.info.acroForm.checkBoxes[M].items=[],this.info.acroForm.checkBoxes[M].items.push(this.info.createAnnotObject(!0,!0,2)),this.info.acroForm.checkBoxes[M].items.push(this.info.createAnnotObject(!0,!0,2)),null==this.annots2Array[M].Component.as(He).checkedValue&&this.info.acroForm.checkBoxes[M].items.push(this.info.createAnnotObject(!0,!1,2));for(var M=0;M<this.unsignedSignaturesCounter;M++)this.info.acroForm.unsignedSignatures.push(this.info.createAnnotObject(!0,!1,0))}for(var M=0;M<this.tooltipsCounter;M++)this.info.acroForm.tooltips.push(this.info.createAnnotObject(!0,!1,0));if(this.info.metadata=this.info.createObject(!0),this.info.destOutputProfile=this.info.createObject(!0),this.info.outputIntents=this.info.createObject(!0),this.info.embeddedJS=this.info.createContentObject(this.autoPrint!=ce.StiPdfAutoPrintMode.None),null!=this.embeddedFiles&&0<this.embeddedFiles.countItems)try{for(var Tt=__values(this.embeddedFiles),Pt=Tt.next();!Pt.done;Pt=Tt.next()){var Lt=Pt.value;this.info.embeddedFilesList.push(this.info.createContentObject(!0))}}catch(t){p={error:t}}finally{try{Pt&&!Pt.done&&(g=Tt.return)&&g.call(Tt)}finally{if(p)throw p.error}}this.renderStartDoc(t,X);var Ct=0;this.linksArray.stimulsoft.clear(),this.tagsArray=new Array,this.tooltipsArray.stimulsoft.clear(),this.unsignedSignaturesArray.stimulsoft.clear(),this.imageInfoCounter=0,this.currentPassNumber++;try{for(var Ft=__values(X.list),Rt=Ft.next();!Rt.done;Rt=Ft.next()){var V=Rt.value;if(X.getPage(V),this.isStopped)return;this.renderPageHeader(Ct++);var It=this.hiToTwips*t.unit.convertToHInches(V.pageHeight*V.segmentPerHeight),Bt=this.hiToTwips*t.unit.convertToHInches(V.pageWidth*V.segmentPerWidth),Dt=this.hiToTwips*t.unit.convertToHInches(V.margins.left),kt=this.hiToTwips*t.unit.convertToHInches(V.margins.right),Nt=this.hiToTwips*t.unit.convertToHInches(V.margins.top),Ot=this.hiToTwips*t.unit.convertToHInches(V.margins.bottom),_,ht,Mt;if(14400<It&&(It=14400),this.haveBookmarks&&(!ye.isNullOrEmpty(V.guid)||null!=V.bookmarkValue&&""!=V.bookmarkValue.toString())){var Ht=0,Ut;while(Ht<this.bookmarksCounter){if(0==(Ut=this.bookmarksTree[Ht]).Used&&-1==Ut.Page){var zt=!1;if(ye.isNullOrEmpty(Ut.Guid)?ye.isNullOrEmpty(Ut.Title)||null!=V.bookmarkValue&&0<V.bookmarkValue.length&&Ut.Title==V.bookmarkValue&&(zt=!0):ye.isNullOrEmpty(V.guid)||Ut.Guid!=V.guid||(zt=!0),zt){Ut.Page=Ct-1,Ut.Y=It,Ut.Used=!0,this.bookmarksTree[Ht]=Ut;break}}Ht++}}null!=V.hyperlinkValue&&0<V.hyperlinkValue.toString().trim().length&&!V.hyperlinkValue.toString().trim().stimulsoft.startsWith("javascript:")&&!this.usePdfA&&((_=new Ge).Link=V.hyperlinkValue.toString(),_.X=0,_.Y=0,_.Width=Bt,_.Height=It,_.Page=Ct,_.DestPage=-1,_.DestY=-1,this.linksArray.push(_)),null!=V.brush&&((ht=new Xe(this)).X=0,ht.Y=0,ht.Width=Bt,ht.Height=It,(Mt=new xe).brush=V.brush,Mt.border=null,ht.Component=Mt,ce.StiPdfRenderPrimitives.renderBorder1(ht)),this.renderWatermark(V,!0,Bt,It,E);var Xt=new Array,ht,Mt;try{for(var Wt=(d=void 0,__values(V.components.list)),Yt=Wt.next(),J;!Yt.done;Yt=Wt.next()){if((J=Yt.value).enabled&&(!t.isPrinting||J.printable)){this.imageInfoCounter++;var Gt=this.hiToTwips*t.unit.convertToHInches(J.left),Vt=this.hiToTwips*t.unit.convertToHInches(J.top),_t=this.hiToTwips*t.unit.convertToHInches(J.right),jt=this.hiToTwips*t.unit.convertToHInches(J.bottom),ht,Q,_,_,qt,_;if((ht=new Xe(this)).X=Gt+Dt,ht.Y=Vt+Nt,ht.Width=_t-Gt,ht.Height=jt-Vt,ht.Y=It-(ht.Y+ht.Height),Q=0<(ht.Component=J).width&&0<J.height){var $=J.isExportAsImage(je.StiExportFormat.Pdf),mt,ct,pt,gt,Kt,at,Jt,Qt,Zt,$t,te,Kt,qt;if(this.usePdfA||J.printable||this.pageStream.writeLine("/OC /oc1 BDC"),J.is(Ce)||ce.StiPdfRenderPrimitives.renderBorder1(ht),J.is(Le)&&!$){var Qt=J,Zt=0;this.haveAnnots&&Qt.editable&&(Zt=this.pageStream.position,this.pushColorToStack(),this.lastColorStrokeA=255,this.lastColorNonStrokeA=255);var Jt=ce.StiPdfRenderIndicators.renderIndicators(ht),$t,te,at;if(Qt.allowHtmlTags){for(var wt=new _e.Base.Drawing.StiHtmlTagsState(Qt.font.bold,Qt.font.italic,Qt.font.underline,Qt.font.strikeout,Qt.font.size,Qt.font.name,Ae.toColor(Qt.textBrush),Ae.toColor(Qt.brush),!1,!1,0,0,1,Qt.horAlignment),dt=new _e.Base.Drawing.StiHtmlState(wt,0),ut=_e.Base.Drawing.StiTextRenderer.parseHtmlToStates(Qt.text,dt),ee=Qt.text.stimulsoft.startsWith("<StiHtmlJs>"),j="",St=0,ft;St<ut.length;St++){if((ft=ut[St]).ts.tag.tag==be.P&&"\n"==ft.text.toString())continue;j+=_e.Base.Drawing.StiTextRenderer.prepareStateText(ft.text)}var Vt=Qt.clone(!0),at,Vt,Kt,lt;Vt.text=j,ht.Component=Vt,ce.StiPdfRenderText.renderTextFont(Jt),ce.StiPdfRenderText.renderText(Jt),this.haveAnnots&&Qt.editable&&((at=this.annotsArray[this.annotsCurrent]).Multiline=Qt.wordWrap,at.X=ht.X,at.Y=ht.Y,at.Width=ht.Width,at.Height=ht.Height,at.Component=ht.Component,at.Alignment=_e.Base.Drawing.StiTextHorAlignment.Left,null!=(Vt=ht.Component.as(ze))&&(Kt=Vt.horAlignment,null!=(lt=ht.Component.as(De))&&null!=lt.textOptions&&lt.textOptions.rightToLeft&&(Kt==_e.Base.Drawing.StiTextHorAlignment.Left?Kt=_e.Base.Drawing.StiTextHorAlignment.Right:Kt==_e.Base.Drawing.StiTextHorAlignment.Right&&(Kt=_e.Base.Drawing.StiTextHorAlignment.Left)),at.Alignment=Kt),at.Text=j.toString().split("\n").join(""))}else ce.StiPdfRenderText.renderTextFont(Jt),ce.StiPdfRenderText.renderText(Jt);this.haveAnnots&&Qt.editable&&(this.pageStream.flush(),$t=this.pageStream.position,this.pageStream.seek(Zt,_e.System.IO.SeekOrigin.Begin),te=[],this.pageStream.read(te,0,$t-Zt),this.pageStream.seek(Zt,_e.System.IO.SeekOrigin.Begin),this.pageStream.setLength(Zt),(at=this.annotsArray[this.annotsCurrent]).Content=te,this.annotsCurrent++,this.popColorFromStack())}J.is(Ce)?ce.StiPdfRenderPrimitives.renderShape(ht,E):J.is(Ue)&&!$?(mt=new ce.StiPdfGeomWriter(this.pageStream,this),ct=ce.StiBarCodeExportPainter.createNew(mt),pt=J,ye.isNullOrEmpty(pt.codeValue)||null==pt.page||(this.pageStream.writeLine("q"),this.pushColorToStack(),this.pageStream.writeLine1("{0} {1} {2} {3} re W n",this.convertToString(ht.X),this.convertToString(ht.Y),this.convertToString(ht.Width),this.convertToString(ht.Height)),this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(Dt),this.convertToString(It-Nt)),this.pageStream.writeLine("1 0 0 -1 0 0 cm"),this.pageStream.writeLine1("{0} 0 0 {0} 0 0 cm",this.convertToString(this.hiToTwips)),gt=t.unit.convertRectangleToHInches(pt.clientRectangle),pt.barCodeType.draw(ct,pt,gt,1),this.pageStream.writeLine("Q"),this.popColorFromStack())):J.is(Oe)&&!$?(this.pageStream.writeLine("q"),this.pushColorToStack(),this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(ht.X),this.convertToString(ht.Y+ht.Height)),this.pageStream.writeLine("1 0 0 -1 0 0 cm"),this.pageStream.writeLine1("{0} 0 0 {0} 0 0 cm",this.convertToString(this.hiToTwips/.96)),ce.StiPdfRenderChart.renderChart(ht,!1,Ct-1),this.pageStream.writeLine("Q"),this.popColorFromStack()):J.is(he)&&!$?(this.pageStream.writeLine("q"),this.pushColorToStack(),this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(ht.X),this.convertToString(ht.Y+ht.Height)),this.pageStream.writeLine("1 0 0 -1 0 0 cm"),this.pageStream.writeLine1("{0} 0 0 {0} 0 0 cm",this.convertToString(this.hiToTwips/.96)),ce.StiPdfRenderChart.renderSparkline(ht,!1,Ct-1),this.pageStream.writeLine("Q"),this.popColorFromStack()):J.is(He)?(Kt=J,this.haveAnnots&&Kt.editable?((at=this.annots2Array[this.annots2Current]).Multiline=!1,at.X=ht.X,at.Y=ht.Y,at.Width=ht.Width,at.Height=ht.Height,at.Component=ht.Component,at.Alignment=_e.Base.Drawing.StiTextHorAlignment.Center,at.Text="",Jt=ht.X,Qt=ht.Y,ht.X=0,ht.Y=0,this.pageStream.flush(),Zt=this.pageStream.position,this.pushColorToStack(),this.lastColorStrokeA=255,this.lastColorNonStrokeA=255,ce.StiPdfRenderPrimitives.renderCheckbox(ht,!0),this.pageStream.flush(),$t=this.pageStream.position,this.pageStream.seek(Zt,_e.System.IO.SeekOrigin.Begin),te=[],this.pageStream.read(te,0,$t-Zt),this.pageStream.seek(Zt,_e.System.IO.SeekOrigin.Begin),at.Content=te,this.popColorFromStack(),this.pageStream.flush(),Zt=this.pageStream.position,this.pushColorToStack(),this.lastColorStrokeA=255,this.lastColorNonStrokeA=255,ce.StiPdfRenderPrimitives.renderCheckbox(ht,!1,!1),this.pageStream.flush(),$t=this.pageStream.position,this.pageStream.seek(Zt,_e.System.IO.SeekOrigin.Begin),te=[],this.pageStream.read(te,0,$t-Zt),this.pageStream.seek(Zt,_e.System.IO.SeekOrigin.Begin),at.Content2=te,this.popColorFromStack(),this.annots2Current++,ht.X=Jt,ht.Y=Qt):null!=(Kt=ce.StiPdfRenderPrimitives.getCheckBoxValue(Kt))&&ce.StiPdfRenderPrimitives.renderCheckbox(ht,Kt)):$&&this.renderImage(ht,E),J.is(Fe)?ce.StiPdfRenderPrimitives.renderRoundedRectanglePrimitive(ht):null!=(qt=ht.Component.as(ke))&&null!=qt.border&&qt.border.topmost?Xt.push(ht):ce.StiPdfRenderPrimitives.renderBorder2(ht),this.usePdfA||J.printable||this.pageStream.writeLine("EMC")}if(this.haveBookmarks&&(!ye.isNullOrEmpty(J.guid)||null!=J.bookmarkValue&&""!=J.bookmarkValue)){var Ht=0,Ut;while(Ht<this.bookmarksCounter){if(0==(Ut=this.bookmarksTree[Ht]).Used&&-1==Ut.Page){var zt=!1;if(ye.isNullOrEmpty(Ut.Guid)?ye.isNullOrEmpty(Ut.Title)||null!=J.bookmarkValue&&0<J.bookmarkValue.length&&Ut.Title==J.bookmarkValue&&(zt=!0):ye.isNullOrEmpty(J.guid)||Ut.Guid!=J.guid||(zt=!0),zt){Ut.Page=Ct-1,Ut.Y=ht.Y+ht.Height,Ut.Used=!0,this.bookmarksTree[Ht]=Ut;break}}Ht++}}null!=J.hyperlinkValue&&0<J.hyperlinkValue.toString().trim().length&&!J.hyperlinkValue.toString().trim().stimulsoft.startsWith("javascript:")&&!this.usePdfA&&((_=new Ge).Link=J.hyperlinkValue.toString(),_.X=ht.X,_.Y=ht.Y,_.Width=ht.Width,_.Height=ht.Height,_.Page=Ct,_.DestPage=-1,_.DestY=-1,this.linksArray.push(_)),null!=J.tagValue&&0<J.tagValue.toString().trim().length&&((_=new Ge).Link=J.tagValue.toString(),_.X=ht.X,_.Y=ht.Y,_.Width=ht.Width,_.Height=ht.Height,_.Page=Ct-1,_.DestPage=-1,_.DestY=-1,this.tagsArray.push(_),"pdfunsignedsignaturefield"!=_.Link.trim().toLowerCase()||this.usePdfA||((qt=new Ye).X=_.X,qt.Y=_.Y,qt.Width=_.Width,qt.Height=_.Height,qt.Page=_.Page,qt.Component=J,this.unsignedSignaturesArray.push(qt))),null!=J.toolTipValue&&0<J.toolTipValue.toString().trim().length&&!this.usePdfA&&((_=new Ge).Link=J.toolTipValue.toString().trim(),_.X=ht.X,_.Y=ht.Y,_.Width=ht.Width,_.Height=ht.Height,_.Page=Ct-1,_.DestPage=-1,_.DestY=-1,this.tooltipsArray.push(_))}}}catch(t){d={error:t}}finally{try{Yt&&!Yt.done&&(u=Wt.return)&&u.call(Wt)}finally{if(d)throw d.error}}try{for(var re=(S=void 0,__values(Xt)),ie=re.next();!ie.done;ie=re.next()){var ne=ie.value;ce.StiPdfRenderPrimitives.renderBorder2(ne)}}catch(t){S={error:t}}finally{try{ie&&!ie.done&&(f=re.return)&&f.call(re)}finally{if(S)throw S.error}}Xt.stimulsoft.clear(),null!=V.border&&((ht=new Xe(this)).X=Dt,ht.Y=Ot,ht.Width=Bt-Dt-kt,ht.Height=It-Nt-Ot,(Mt=new xe).border=V.border,ht.Component=Mt,ce.StiPdfRenderPrimitives.renderBorder2(ht)),this.renderWatermark(V,!1,Bt,It,E),this.renderPageFooter(It,Bt)}}catch(t){h={error:t}}finally{try{Rt&&!Rt.done&&(w=Ft.return)&&w.call(Ft)}finally{if(h)throw h.error}}if(this.bookmarksTreeTemp=null,this.haveBookmarks&&r){for(var oe=0,Ut;oe<this.bookmarksTree.stimulsoft.countItems;oe++){if((Ut=this.bookmarksTree[oe]).Used)while(-1!=Ut.Parent)(Ut=this.bookmarksTree[Ut.Parent]).Used=!0}var r=new Ee;this.makeBookmarkFromTree(r,this.bookmarksTree[0]),this.bookmarksTreeTemp=this.bookmarksTree,this.bookmarksTree=new Array,this.addBookmarkNode(r,-1);var ae=this.bookmarksCounter-this.bookmarksTree.stimulsoft.countItems,Ut;if(0<ae){(Ut=new Ve).Parent=-1,Ut.First=-1,Ut.Last=-1,Ut.Prev=-1,Ut.Next=-1,Ut.Count=-1,Ut.Page=-1,Ut.Y=-1,Ut.Title="";for(var oe=0;oe<ae;oe++)this.bookmarksTree.push(Ut)}for(var se=new Te,le=0;le<this.bookmarksTreeTemp.stimulsoft.countItems;le++){var Ut=this.bookmarksTreeTemp[le];se.set(Ut.Title,Ut)}for(var le=0;le<this.bookmarksTree.stimulsoft.countItems;le++){var Ut=this.bookmarksTree[le],me;ye.isNullOrEmpty(Ut.Title)||(me=se.get(Ut.Title),Ut.Page=me.Page,Ut.Y=me.Y)}this.bookmarksTreeTemp=null}this.renderImageTable(),this.renderFontTable(),this.renderBookmarksTable(),this.renderPatternTable(),this.renderLinkTable(),this.renderEncodeRecord(),this.renderExtGStateRecord(),this.renderAnnotTable(),this.renderTooltipTable(),this.renderMetadata(t),this.renderColorSpace(),this.renderAutoPrint(),this.renderEmbeddedFiles(),this.renderEndDoc(),this.xref=null,this.bookmarksTree=null,this.linksArray=null,this.tagsArray=null,this.tooltipsArray=null,this.annotsArray=null,this.annots2Array=null,this.unsignedSignaturesArray=null,this.shadingArray=null,this.hatchArray=null,this.colorStack=null,this.pdfFont.clear(),this.pdfFont=null,this.bidi.clear(),this.bidi=null},P.regexEscape=new RegExp("([{}()^$&.*?/+|[\\\\]|]|-)","g"),P),T;function P(){var t=null!==T&&T.apply(this,arguments)||this;return t.multipleFiles=!1,t.imageQuality=.75,t.imageResolutionMain=1,t.imageResolutionMode=ce.StiImageResolutionMode.Auto,t.sw=null,t.pageStream=null,t.imageList=null,t.imageCache=null,t.imageInterpolationTable=null,t.imageCacheIndexToList=null,t.imageInfoList=null,t.imageInfoCounter=0,t.colorTable=ve.create(String,256),t.alphaTable=ve.create(Boolean,256),t.pdfFont=null,t.bidi=null,t.standardPdfFonts=!0,t.embeddedFonts=!1,t.useUnicodeMode=!1,t.reduceFontSize=!0,t.compressed=!1,t.compressedFonts=!1,t.encrypted=!1,t.usePdfA=!1,t.pdfComplianceMode=ce.StiPdfComplianceMode.None,t.exportRtfTextAsImage=!1,t.autoPrint=ce.StiPdfAutoPrintMode.None,t.imageCompressionMethod=ce.StiPdfImageCompressionMethod.Jpeg,t.imageFormat=ce.StiImageFormat.Color,t.monochromeDitheringType=ce.StiMonochromeDitheringType.FloydSteinberg,t.allowEditable=ce.StiPdfAllowEditable.No,t.useTransparency=!0,t.embeddedFiles=null,t.zugferdComplianceMode=ce.StiPdfZUGFeRDComplianceMode.None,t.zugferdConformanceLevel="BASIC",t.fontGlyphsReduceNotNeed=null,t.bookmarksTree=null,t.bookmarksTreeTemp=null,t.linksArray=null,t.tagsArray=null,t.tooltipsArray=null,t.shadingArray=null,t.hatchArray=null,t.shadingFunctionArray=null,t.haveBookmarks=!1,t.haveLinks=!1,t.haveAnnots=!1,t.haveTooltips=!1,t.CodePage1252part80AF=[8364,8226,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,8226,381,8226,8226,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,8226,382,376],t.CodePage1252=ve.create(Number,256),t.hiToTwips=.72,t.precision_digits_font=3,t.pdfCKT=.55228,t.IDValue=null,t.IDValueString="",t.IDValueStringMeta="",t.currentDateTime="",t.currentDateTimeMeta="",t.producerName="Stimulsoft Reports",t.creatorName="",t.keywords="",t.keyLength=ce.StiPdfEncryptionKeyLength.Bit40,t.lastColorStrokeA=255,t.lastColorNonStrokeA=255,t.colorStack=null,t.info=null,t.haveDigitalSignature=!1,t.pdfSecurity=null,t.printScaling=!0,t.colorHash1=new Te,t.colorHash2=new Te,t._gsTable=null,t}ce.StiPdfExportService=A}(e=je.Export||(je.Export={}))}(Stimulsoft=Stimulsoft||{}),function(g){var t,e,r;e=t=g.Report||(g.Report={}),function(A){var k=g.System.StiArray,E=g.System.Text.StringBuilder,c=g.System.Drawing.Font,t=g.System.Collections.Hashtable,N=g.System.IO.MemoryStream,a=g.System.Drawing.FontStyle,T=e;function e(){}A.PdfFontInfo=T;var P=r;function r(){}A.pfontInfo=P;var b=i;function i(){this.TagString=null,this.Tag=0,this.CheckSum=0,this.Offset=0,this.Length=0,this.NewOffset=0,this.NewLength=0,this.Required=!1,this.NewTable=null}var y=n;function n(){this.HeaderOffset=0,this.NumTables=0,this.NumTablesRequired=0,this.SfntVersion=0,this.Tables=null,this.HeadCheckSumOffset=0,this.NumGlyphs=0,this.IndexToLocFormat=0,this.IndexLocaTable=0,this.IndexGlyfTable=0,this.IndexCmapTable=0,this.FontName=null,this.HeaderOffset=0,this.NumTables=0,this.NumTablesRequired=0,this.SfntVersion=0,this.Tables=null,this.HeadCheckSumOffset=0,this.NumGlyphs=0,this.IndexToLocFormat=0,this.IndexLocaTable=0,this.IndexGlyfTable=0,this.FontName=new t}var o=(__extends(l,s=T),l.prototype.getFontMetrics=function(t,e,r,i){if(this.WIDTHS=k.create(Number,this.maxSymbols+1),null==t)return;var n=new c(t.name,1024,t.style,g.System.Drawing.GraphicsUnit.Pixel);k.copy(e.UnicodeMapBack,0,this.WIDTHS,e.MappedSymbolsCount);var o=g.System.Drawing.Graphics.measureChars(this.WIDTHS,e.MappedSymbolsCount,n),n=o.height,o=o.width;e.CH=0,e.tmASC=Math.round2(.8*n*this.factor),e.tmDESC=Math.round2(.2*n*this.factor),e.tmExternal=Math.round2((o-n)*this.factor),e.LLX=0,e.LLY=0,e.URX=0,e.URY=0,e.StemV=0,e.ItalicAngle=0,e.UnderscoreSize=Math.round2(n*(t.bold?.08:.06)*this.factor),e.UnderscorePosition=Math.round2(.1*-n*this.factor),e.StrikeoutSize=Math.round2(.045*n*this.factor),e.StrikeoutPosition=Math.round2(.25*n*this.factor);for(var a=0;a<e.MappedSymbolsCount;a++)this.WIDTHS[a]=Math.round2(this.WIDTHS[a]*this.factor,0);var i=this.getFontDataBuf(t,i);if(i instanceof Uint8Array&&0<i.byteLength){var s=this.getCharToGlyphTable(i,t.name);if(null!=s){var l=0;"Wingdings"!=t.name&&"Wingdings 2"!=t.name&&"Wingdings 3"!=t.name||(l=61440);for(var a=0;a<e.MappedSymbolsCount;a++){var m=e.UnicodeMapBack[a];128<=m&&m<=255&&(m+=l),e.GlyphList[a]=s[m]}}}e.NeedSyntBold=this.NeedSyntBold,e.NeedSyntItalic=this.NeedSyntItalic},l.isFontStimulsoft=function(t){return"Stimulsoft"==t},Object.defineProperty(l.prototype,"currentFont",{get:function(){return this._currentFont},set:function(t){this._currentFont!=t&&(this._currentFont=t,null!=this.fonts&&0<this.fonts.length&&(this.Widths=this.fonts[this._currentFont].Widths,this.CH=this.fonts[this._currentFont].CH,this.XH=this.fonts[this._currentFont].XH,this.ASC=this.fonts[this._currentFont].ASC,this.DESC=this.fonts[this._currentFont].DESC,this.tmASC=this.fonts[this._currentFont].tmASC,this.tmDESC=this.fonts[this._currentFont].tmDESC,this.tmExternal=this.fonts[this._currentFont].tmExternal,this.MacAscend=this.fonts[this._currentFont].MacAscend,this.MacDescend=this.fonts[this._currentFont].MacDescend,this.MacLineGap=this.fonts[this._currentFont].MacLineGap,this.LLX=this.fonts[this._currentFont].LLX,this.LLY=this.fonts[this._currentFont].LLY,this.URX=this.fonts[this._currentFont].URX,this.URY=this.fonts[this._currentFont].URY,this.StemV=this.fonts[this._currentFont].StemV,this.ItalicAngle=this.fonts[this._currentFont].ItalicAngle,this.LineGap=this.fonts[this._currentFont].LineGap,this.NtmFlags=this.fonts[this._currentFont].NtmFlags,this.UnderscoreSize=this.fonts[this._currentFont].UnderscoreSize,this.UnderscorePosition=this.fonts[this._currentFont].UnderscorePosition,this.StrikeoutSize=this.fonts[this._currentFont].StrikeoutSize,this.StrikeoutPosition=this.fonts[this._currentFont].StrikeoutPosition,this.UnicodeMap=this.fonts[this._currentFont].UnicodeMap,this.UnicodeMapBack=this.fonts[this._currentFont].UnicodeMapBack,this.GlyphList=this.fonts[this._currentFont].GlyphList,this.GlyphBackList=this.fonts[this._currentFont].GlyphBackList,this.GlyphRtfList=this.fonts[this._currentFont].GlyphRtfList,this.SymsToPDF=this.fonts[this._currentFont].SymsToPDF,this.CharPdfNames=this.fonts[this._currentFont].CharPdfNames,this.MappedSymbolsCount=this.fonts[this._currentFont].MappedSymbolsCount,this.NeedSyntBold=this.fonts[this._currentFont].NeedSyntBold,this.NeedSyntItalic=this.fonts[this._currentFont].NeedSyntItalic,this.GlyphWidths=this.fonts[this._currentFont].GlyphWidths,this.ChildFontsMap=this.fonts[this._currentFont].ChildFontsMap,this.UseUnicode=this.fonts[this._currentFont].UseUnicode))},enumerable:!1,configurable:!0}),l.prototype.InitFontsData=function(t){for(var e=this.fontList.length,r=0;r<e;r++){var i=this.fontList[r],n=this.forceUseUnicode,o,o;if(n&&((o=null)!=(o=this.getFontDataBuf(i.Font,t))&&0!=o.Length||(n=!1)),i.UseUnicode=n,this.fontList[r]=i,!n){for(var a=this.UnicodeMapsList[r],s=this.firstMappedSymbol,l=this.firstMappedSymbol;l<65536;l++)0<a[l]&&s++;if(255<s){i=this.fontList[r];for(var m=null,c=k.create(Number,65536),p=this.fontList.length,l=0;l<this.firstMappedSymbol;l++)c[l]=p;for(var g=!0,s=this.firstMappedSymbol,l=this.firstMappedSymbol,h;l<65536;l++){g&&((h=new P).Name=i.Name,h.PdfName=i.PdfName,h.Bold=i.Bold,h.Italic=i.Italic,h.Number=i.Number,h.Font=i.Font,h.ParentFontNumber=r,h.UseUnicode=n,this.fontList.push(h),m=k.create(Number,65536),k.copy(a,0,m,64),this.UnicodeMapsList.push(m),this.GlyphMapsList.push(k.create(Number,65536)),p=this.fontList.length-1,s=this.firstMappedSymbol,g=!1),0<a[l]&&(m[l]=1,c[l]=p,254==++s&&(g=!0))}i.ChildFontsMap=c,this.fontList[r]=i}}}this.fonts=k.create(T,this.fontList.length);for(var r=0;r<this.fontList.length;r++){this.fonts[r]=new T;var w=this.fonts[r];w.UnicodeMap=this.UnicodeMapsList[r],w.UnicodeMapBack=k.create(Number,this.maxSymbols+1),w.UseUnicode=this.fontList[r].UseUnicode;var d=this.GlyphMapsList[r],u=k.create(Number,65536);d[65535];for(var S=this.firstMappedSymbol,f=this.firstMappedSymbol;f<65536;f++)0!=w.UnicodeMap[f]&&(w.UnicodeMap[f]=S,w.UnicodeMapBack[S]=f,++S>this.maxSymbols&&(S=this.maxSymbols),w.UseUnicode||92!=S||(w.UnicodeMapBack[S]=f,S++));var v=8226;w.UnicodeMap[v]=S,w.UnicodeMapBack[S]=v,S++,w.MappedSymbolsCount=S;for(var f=0;f<this.firstMappedSymbol;f++)w.UnicodeMap[f]=f,w.UnicodeMapBack[f]=f;w.CharPdfNames=k.create(String,S),w.SymsToPDF=k.create(Number,S);for(var E=32;E<w.MappedSymbolsCount;E++){for(var b=-1,y=0;y<this.standardFontNumWidths;y++);w.SymsToPDF[E]=b;var b=A.StiPdfResources.standardFontCharsNames[w.UnicodeMapBack[E]];null==b&&(b="uni"+w.UnicodeMapBack[E].toString(16).toUpperCase().stimulsoft.padLeft(4,"0")),w.CharPdfNames[E]=b}w.GlyphList=k.create(Number,S);var v=this.fontList[r];this.fonts[r].Widths=k.create(Number,S),this.getFontMetrics(v.Font,w,d,t);for(var x=0;x<S-32;x++)this.fonts[r].Widths[x]=this.WIDTHS[32+x];this.standardPdfFonts,null!=this.fontList[r].ChildFontsMap&&(w.MappedSymbolsCount=255,w.ChildFontsMap=this.fontList[r].ChildFontsMap)}this._currentFont=-1,this.currentFont=0},l.prototype.getFontNumber=function(t){var e,r,i,n,o,a,s=-1;if(0<this.fontList.length)for(var l=0;l<this.fontList.length;l++){var m=this.fontList[l];if(m.Name==t.name&&m.Bold==t.bold&&m.Italic==t.italic){s=l;break}}if(-1==s){var c=new P;c.Name=t.name,c.Bold=t.bold,c.Italic=t.italic,c.Font=t,c.ParentFontNumber=-1,s=0;try{for(var p=__values(this.family_Helvetica),g=p.next();!g.done;g=p.next()){var h=g.value;c.Name==h&&(s=0)}}catch(t){e={error:t}}finally{try{g&&!g.done&&(r=p.return)&&r.call(p)}finally{if(e)throw e.error}}try{for(var w=__values(this.family_Times_Roman),d=w.next();!d.done;d=w.next()){var h=d.value;c.Name==h&&(s=4)}}catch(t){i={error:t}}finally{try{d&&!d.done&&(n=w.return)&&n.call(w)}finally{if(i)throw i.error}}try{for(var u=__values(this.family_Courier),S=u.next();!S.done;S=u.next()){var h=S.value;c.Name==h&&(s=8)}}catch(t){o={error:t}}finally{try{S&&!S.done&&(a=u.return)&&a.call(u)}finally{if(o)throw o.error}}s<12&&(1==c.Bold&&(s+=1),1==c.Italic&&(s+=2)),c.Number=s,c.PdfName=this.PdfFontName[s],this.fontList.push(c),s=this.fontList.length-1,this.UnicodeMapsList.push(k.create(Number,65536)),this.GlyphMapsList.push(k.create(Number,65536))}return this.currentFont=s},l.prototype.storeUnicodeSymbolsInMap=function(t){if(0<t.length&&-1!=this.currentFont)for(var e=this.UnicodeMapsList[this.currentFont],r=0;r<t.length;r++)e[t.charCodeAt(r)]=1},l.prototype.getCharToGlyphTable=function(t,e){var e=this.scanFontFile(t,e);if(null!=e)return this.getCmapTable(t,e);return null},l.prototype.reduceFontSize=function(t,e,r){var i=this.scanFontFile(t,e),n=null;if(null!=i){if(r){for(var o=k.create(Boolean,i.NumGlyphs),a=k.create(Boolean,i.NumGlyphs),s=0;s<this.GlyphList.length;s++){var l=this.GlyphList[s];l<i.NumGlyphs&&(o[l]=!0,a[l]=!0)}o[0]=!0,o[1]=!0,o[2]=!0,o[3]=!0,a[0]=!0,a[1]=!0,a[2]=!0,a[3]=!0;var m=i.Tables[i.IndexLocaTable].Offset,c=i.Tables[i.IndexGlyfTable].Offset,p=!0;while(p){p=!1;for(var s=0;s<i.NumGlyphs;s++)if(1==a[s]){a[s]=!1;var g=m+s*(1==i.IndexToLocFormat?4:2),h=0,h=1==i.IndexToLocFormat?this.GetUInt32(t,g):2*this.GetUInt16(t,g);if(h+=c,-1==this.GetInt16(t,h)){p=!0,h+=10;var w=0;do{w=this.GetUInt16(t,h);var d=this.GetUInt16(t,h+2);d<i.NumGlyphs&&(o[d]=!0,a[d]=!0),h+=4,0<(w&this.ARG_1_AND_2_ARE_WORDS)&&(h+=2),h+=2,0<(w&this.WE_HAVE_A_SCALE)?h+=2:0<(w&this.WE_HAVE_AN_X_AND_Y_SCALE)?(h+=2,h+=2):0<(w&this.WE_HAVE_A_TWO_BY_TWO)&&(h+=2,h+=2,h+=2,h+=2)}while(0<(w&this.MORE_COMPONENTS))}}}for(var u=0,S=m,s=0;s<i.NumGlyphs;s++){var f=0,v=0;1==i.IndexToLocFormat?(f=this.GetUInt32(t,S),v=this.GetUInt32(t,S+4),S+=4):(f=2*this.GetUInt16(t,S),v=2*this.GetUInt16(t,S+2),S+=2),o[s]&&(u+=v-f)}for(var E=new Uint8Array(u+4),b=new Uint8Array(i.Tables[i.IndexLocaTable].Length+4),y=0,S=m,x=0,s=0;s<i.NumGlyphs;s++){var f=0,v=0;1==i.IndexToLocFormat?(f=this.GetUInt32(t,S),v=this.GetUInt32(t,S+4),S+=4):(f=2*this.GetUInt16(t,S),v=2*this.GetUInt16(t,S+2),S+=2);var A=v-f;if(1==o[s])for(var T=0;T<A;T++)E[y+T]=t[c+f+T];else A=0;0==i.IndexToLocFormat?this.SetUInt16(b,x,y/2):this.SetUInt32(b,x,y),y+=A,x+=1==i.IndexToLocFormat?4:2}0==i.IndexToLocFormat?this.SetUInt16(b,x,y/2):this.SetUInt32(b,x,y),i.Tables[i.IndexGlyfTable].NewLength=y,i.Tables[i.IndexGlyfTable].NewTable=E,i.Tables[i.IndexLocaTable].NewTable=b}var P=new Uint8Array(this.TtfHeaderSize+16*i.NumTablesRequired);this.copyUint8Array(t,i.HeaderOffset,P,0,P.length);var L=1;while(2<<L-1<=i.NumTablesRequired)L++;var C=16*(2<<--L-1),e=L,r=16*i.NumTablesRequired-C;this.SetUInt16(P,4,i.NumTablesRequired),this.SetUInt16(P,6,C),this.SetUInt16(P,8,e),this.SetUInt16(P,10,r);for(var F=0,R=this.TtfHeaderSize+16*i.NumTablesRequired,I=0,B,D;I<i.NumTables;I++){i.Tables[I].Required&&(i.Tables[I].NewOffset=R,0<(B=(R+=i.Tables[I].NewLength)%4)&&(R+=4-B),D=this.TtfHeaderSize+16*F,this.SetUInt32(P,D,i.Tables[I].Tag),this.SetUInt32(P,D+4,i.Tables[I].CheckSum),this.SetUInt32(P,D+8,i.Tables[I].NewOffset),this.SetUInt32(P,D+12,i.Tables[I].NewLength),F++)}(n=new N).writeBytes(P,0,P.length);for(var I=0,B;I<i.NumTables;I++){i.Tables[I].Required&&(null!=i.Tables[I].NewTable?n.writeBytes(i.Tables[I].NewTable,0,i.Tables[I].NewLength):n.writeBytes(t,i.Tables[I].Offset,i.Tables[I].NewLength),0<(B=i.Tables[I].NewLength%4)&&n.write(k.create(Number,4-B),0,4-B))}n.flush()}return n},l.prototype.scanFontFile=function(t,e){var r=null,i=this.GetUInt32(t,0);if(65536==i)r=this.getTtfInfo(t,0);else{var n=this.GetUInt32(t,4);if(1953784678==i&&(65536==n||131072==n))for(var o,a=this.GetUInt32(t,8)-1;0<=a;a--){var s=this.GetUInt32(t,12+4*a),l=this.GetUInt32(t,s);if(65536==l&&(r=this.getTtfInfo(t,s)).FontName.contains(e))break}}return r},l.prototype.getCmapTable=function(t,e){for(var r=null,i=e.Tables[e.IndexCmapTable].Offset,n=this.GetUInt16(t,i+2),o=0;o<n;o++){var a=i+4+8*o,s=this.GetUInt16(t,a),l=this.GetUInt16(t,a+2),m=i+this.GetUInt32(t,a+4),c;if(3==s&&1==l)if(4==this.GetUInt16(t,m)){r=k.create(Number,65536);for(var p=0;p<65536;p++)r[p]=65535;for(var g=this.GetUInt16(t,m+6),h=0;h<g;h+=2){var w=m+14+h,d=this.GetUInt16(t,w),u=this.GetUInt16(t,w+2+g),S=this.GetInt16(t,w+2+2*g),f=this.GetUInt16(t,w+2+3*g);if(65535!=u)for(var v=u;v<=d;v++){var E=65535,b,E;0==f?E=S+v&65535:(b=f+2*(v-u)+(w+2+3*g),0!=(E=this.GetUInt16(t,b))&&(E+=S)),r[v]=E}}}}return r},l.prototype.copyUint8Array=function(t,e,r,i,n){for(var o=0;o<n;o++)r[i+o]=t[e+o]},l.prototype.getTtfInfo=function(t,e){var r=new y;r.HeaderOffset=e,r.SfntVersion=this.GetUInt32(t,r.HeaderOffset),r.NumTables=this.GetUInt16(t,r.HeaderOffset+4),r.NumTablesRequired=0,r.Tables=[];for(var i=0;i<r.NumTables;i++)r.Tables[i]=new b;for(var n=0;n<r.NumTables;n++){for(var o=r.HeaderOffset+this.TtfHeaderSize+16*n,a=new E,s=0;s<4;s++)a.append(String.fromCharCode(this.GetUInt8(t,o+s)));r.Tables[n].Tag=this.GetUInt32(t,o),r.Tables[n].TagString=a.toString(),r.Tables[n].CheckSum=this.GetUInt32(t,o+4),r.Tables[n].Offset=this.GetUInt32(t,o+8),r.Tables[n].Length=this.GetUInt32(t,o+12),r.Tables[n].NewLength=r.Tables[n].Length;for(var s=0;s<this.TablesNames.length;s++)if(r.Tables[n].TagString==this.TablesNames[s]){r.Tables[n].Required=!0,r.NumTablesRequired++;break}switch(r.Tables[n].TagString){case"head":r.IndexToLocFormat=this.GetUInt16(t,r.Tables[n].Offset+50);break;case"maxp":r.NumGlyphs=this.GetUInt16(t,r.Tables[n].Offset+4);break;case"loca":r.IndexLocaTable=n;break;case"glyf":r.IndexGlyfTable=n;break;case"cmap":r.IndexCmapTable=n;break;case"name":for(var l=r.Tables[n].Offset,m=this.GetUInt16(t,l+2),c=this.GetUInt16(t,l+4),p=0;p<m;p++){var g=l+6+12*p,h=this.GetUInt16(t,g),w=this.GetUInt16(t,g+2),d=this.GetUInt16(t,g+6),u=this.GetUInt16(t,g+8),S=this.GetUInt16(t,g+10);if(3==h&&1==w&&1==d||0==h&&3==w&&1==d){for(var f=new E,v=0;v<u/2;v++)f.append(String.fromCharCode(this.GetUInt16(t,l+c+S+2*v)));var d=f.toString();r.FontName.set(d,d)}}break}}return r},l.prototype.GetUInt8=function(t,e){return t[e]},l.prototype.GetUInt16=function(t,e){return(t[e]<<8)+t[e+1]},l.prototype.GetUInt32=function(t,e){return(t[e]<<24)+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3]},l.prototype.GetInt16=function(t,e){var e=(t[e]<<8)+t[e+1];return 32767<e?e-65536:e},l.prototype.SetUInt16=function(t,e,r){t[e+0]=r>>>8&255,t[e+1]=255&r},l.prototype.SetUInt32=function(t,e,r){t[e+0]=r>>>24&255,t[e+1]=r>>>16&255,t[e+2]=r>>>8&255,t[e+3]=255&r},l.prototype.clear=function(){this.fonts=null,this.fontList=null,this.UnicodeMapsList=null,this.GlyphMapsList=null,this.Widths=null,this.CharPdfNames=null,this.UnicodeMap=null,this.UnicodeMapBack=null,this.GlyphList=null,this.GlyphBackList=null,this.GlyphRtfList=null,this.SymsToPDF=null,this.GlyphWidths=null,this.fontsInfoStore.clear()},l.prototype.getFontDataBuf=function(t,e){return this.getFontDataFromGdi(t,e)},l.prototype.getFontDataFromGdi=function(t,e){var r=null;if(l.isFontStimulsoft(t.name)){var i=g.Report.Resources.StimulsoftFont.getBase64Content(),n=g.System.Convert.fromBase64String(i);return new Uint8Array(n)}var o=g.Base.StiFontCollection.getBinFont(t.name,t.style),i,n,o,r;return(r=null!=o?o.data:null)instanceof Uint8Array&&(r=null),null==r&&(i=0<(t.style&a.Bold),n=0<(t.style&a.Italic),i&&n?null!=(o=g.Base.StiFontCollection.getBinFont(t.name,a.Italic))&&null!=o.data?(r=o.data,this.NeedSyntBold=!0):null!=(o=g.Base.StiFontCollection.getBinFont(t.name,a.Bold))&&null!=o.data?(r=o.data,this.NeedSyntItalic=!0):null!=(o=g.Base.StiFontCollection.getBinFont(t.name,a.Regular))&&null!=o.data&&(r=o.data,this.NeedSyntItalic=!0,this.NeedSyntBold=!0):(i&&null!=(o=g.Base.StiFontCollection.getBinFont(t.name,a.Regular))&&null!=o.data&&(r=o.data,this.NeedSyntBold=!0),n&&null!=(o=g.Base.StiFontCollection.getBinFont(t.name,a.Regular))&&null!=o.data&&(r=o.data,this.NeedSyntItalic=!0))),null==r&&(null==(o=e.dictionary.resources.getByName(t.name))&&(o=e.dictionary.resources.getByAlias(t.name)),null!=o&&null!=o.content&&0<o.content.length&&(r=new Uint8Array(o.content),this.NeedSyntBold=!0,this.NeedSyntItalic=!0)),r},l),s;function l(){var t=s.call(this)||this;return t.standardFontQuantity=12,t.standardFontNumWidths=310,t.standardFontNumChars=3680+189,t.firstMappedSymbol=64,t.factor=1,t.maxSymbols=32767,t.forceUseUnicode=!0,t.WIDTHS=null,t.fonts=null,t.UnicodeMapsList=null,t.GlyphMapsList=null,t.standardPdfFonts=!0,t.fontsInfoStore=null,t.family_Helvetica=["Arial","Arial Black","Arial Narrow","Century Gothic","Comic Sans MS","Impact","Microsoft Sans Serif","Tahoma","Verdana"],t.family_Courier=["Courier New","Lucida Console"],t.family_Times_Roman=["Book Antiqua","Bookman Old Style","Garamond","Georgia","Times New Roman"],t.family_Symbol=["Symbol"],t.family_ZapfDingbats=["Wingdings 2"],t.PdfFontName=["Helvetica","Helvetica-Bold","Helvetica-Oblique","Helvetica-BoldOblique","Times-Roman","Times-Bold","Times-Italic","Times-BoldItalic","Courier","Courier-Bold","Courier-Oblique","Courier-BoldOblique","Symbol","ZapfDingbats"],t._currentFont=-1,t.TtfHeaderSize=12,t.ARG_1_AND_2_ARE_WORDS=1,t.ARGS_ARE_XY_VALUES=2,t.ROUND_XY_TO_GRID=4,t.WE_HAVE_A_SCALE=8,t.MORE_COMPONENTS=32,t.WE_HAVE_AN_X_AND_Y_SCALE=64,t.WE_HAVE_A_TWO_BY_TWO=128,t.WE_HAVE_INSTRUCTIONS=256,t.USE_MY_METRICS=512,t.OVERLAP_COMPOUND=1024,t.SCALED_COMPONENT_OFFSET=2048,t.UNSCALED_COMPONENT_OFFSET=4096,t.TablesNames=["head","hhea","hmtx","maxp","cmap","OS/2","post","cvt ","fpgm","glyf","loca","prep","name"],t.fontList=new Array,t.UnicodeMapsList=new Array,t.GlyphMapsList=new Array,t.fontsInfoStore=new m,t}A.PdfFonts=o;var m=(p.prototype.clear=function(){},p);function p(){}A.FontsInfoStore=m}(r=e.Export||(e.Export={}))}(Stimulsoft=Stimulsoft||{}),function(n){var t,e,r,s,i,f,a,v,l,m,o,c,p,g,h,w,d,u,S,E,b,y,x,A,T,P,L,C;function F(t,e,r){void 0===r&&(r=!1),this.penWidthDefault=.1,this.precision_digits=3,this.hiToTwips=.72,this.pdfCKT=.55228,this.makepath=!1,this.pathClosed=!1,this.path=null,this.pageStream=null,this.pdfService=null,this.assembleData=!1,this.pageNumber=0,this.matrixCache=null,this.xmin=null,this.xmax=null,this.ymin=null,this.ymax=null,this.pageStream=t,this.pdfService=e,this.assembleData=r,this.matrixCache=new Array}e=t=n.Report||(n.Report={}),s=r=e.Export||(e.Export={}),i=n.Report.Components.StiImage,f=n.System.StiArray,a=n.System.StiString,v=n.System.Drawing.Point,l=n.System.Drawing.Rectangle,m=n.System.Text.StringBuilder,o=n.Base.Context.StiPenGeom,c=n.System.Drawing.Color,p=n.Base.Drawing.StiBrush,g=n.Base.Drawing.StiGradientBrush,h=n.Base.Drawing.StiGlareBrush,w=n.Base.Drawing.StiHatchBrush,d=n.Base.Drawing.StiGlassBrush,u=n.Base.Drawing.StiPenStyle,S=n.Base.Drawing.StiPenUtils,E=n.System.Drawing.Drawing2D.DashStyle,b=n.System.Drawing.StringFormat,y=n.Report.Components.StiText,x=n.System.Drawing.Rectangle,A=n.System.Drawing.StringAlignment,T=n.Base.Drawing.StiTextHorAlignment,P=n.Base.Drawing.StiVertAlignment,L=n.System.Drawing.StringFormatFlags,C=n.System.Drawing.Size,F.prototype.calculateMinMax=function(t){null==this.xmin?this.xmin=t.x:this.xmin=Math.min(this.xmin,t.x),null==this.xmax?this.xmax=t.x:this.xmax=Math.max(this.xmax,t.x),null==this.ymin?this.ymin=t.y:this.ymin=Math.min(this.ymin,t.y),null==this.ymax?this.ymax=t.y:this.ymax=Math.max(this.ymax,t.y)},F.prototype.convertToString=function(t){return Math.round2(t,this.precision_digits).toString().stimulsoft.replaceAll(",",n.System.Globalization.CultureInfo.currentCulture.numberFormat.numberDecimalSeparator)},F.prototype.setPen=function(t,e){if(void 0===e&&(e=!1),null==t)return!1;var r=!1,i,t,t,t,i;return t.stimulsoft.is(n.Base.Context.StiPenGeom)&&(i=t.stimulsoft.as(o),t=c.transparent,t=i.brush instanceof c?i.brush:p.toColor(i.brush.stimulsoft.as(p)),this.pdfService.setStrokeColor(t),0==(t=1<i.thickness?i.thickness:i.thickness*this.hiToTwips)&&(t=this.penWidthDefault),this.pageStream.writeLine1("{0} w",this.convertToString(t)),(r=e&&i.penStyle!=u.Solid)&&this.pageStream.writeLine("q"),null!=(i=this.getPenStyleDashString(S.getPenStyle(i.penStyle),.025*i.thickness))&&this.pageStream.writeLine(i)),r},F.prototype.setBrush=function(t,e,r){if(void 0===r&&(r=!1),null==t)return!1;if(this.assembleData)return t instanceof c||!(t.is(g)||t.is(h)||t.is(w)||t.is(d))||(this.pdfService.storeShadingData1(t.stimulsoft.as(p),this.pageNumber),this.pdfService.storeHatchData(t.stimulsoft.as(p))),!1;var i=!1,n=c.transparent,n,o,a,e,e,e,s,n=t instanceof c?t:p.toColor(t.stimulsoft.as(p));return this.pdfService.setNonStrokeColor(n),t instanceof c||!(t.is(g)||t.is(h)||t.is(w)||t.is(d))||(n=this.matrixCache.stimulsoft.peek(),e=[new v(e.x,e.bottom),new v(e.right,e.y)],n.transformPoints(e),e=new l(e[0].x,e[0].y,e[1].x-e[0].x,e[1].y-e[0].y),e=this.pdfService.storeShadingData2(e.x,e.y,e.width,e.height,t.stimulsoft.as(p)),(t.is(g)||t.is(h))&&this.pageStream.writeLine1("/Pattern cs /P{0} scn",1+e),t.is(w)&&this.pageStream.writeLine1("/Cs1 cs /PH{0} scn",this.pdfService.getHatchNumber(t)+1),i=!0),(i=i&&r)&&this.pageStream.writeLine("q"),i},F.prototype.outputLineString=function(t,e){var e;null!=e&&(e=this.setPen(e,!0),this.pageStream.writeLine(t),e&&this.pageStream.writeLine("Q"))},F.prototype.convertArcToBezierPoints=function(t,e,r){var i=t.x+t.width/2,n=t.y+t.height/2,o=t.width/2;e*=Math.PI/180,r*=Math.PI/180;var a=Math.ceil(Math.abs(r)/(Math.PI/2)),s=f.create(v,3*a+1,!0),l=r/a,m=Math.sin(l/2),c=Math.cos(l/2),t=4*(1-c)/3,r=m-t*c/(m+1e-4),p=[],g=[];p[0]=c,g[0]=-m,p[1]=c+t,g[1]=-r,p[2]=c+t,g[2]=r,p[3]=c,g[3]=m;var h=Math.sin(e+l/2),w=Math.cos(e+l/2);s[0].x=i+o*(p[0]*w-g[0]*h),s[0].y=n+o*(p[0]*h+g[0]*w);for(var d=0;d<a;d++)for(var u=e+l*d,h=Math.sin(u+l/2),w=Math.cos(u+l/2),S=1;S<=3;S++)s[S+3*d].x=i+o*(p[S]*w-g[S]*h),s[S+3*d].y=n+o*(p[S]*h+g[S]*w);return s},F.prototype.convertSplineToCubicBezier=function(t,e){var r=t.length,i=3*r-2,n=[];e*=.3,n[0]=t[0],n[1]=this.calculateCurveBezierEndPoints(t[0],t[1],e);for(var o=0;o<r-2;o++){var a=this.calculateCurveBezier(t,o,e);n[3*o+2]=a[0],n[3*o+3]=t[o+1],n[3*o+4]=a[1]}return n[i-2]=this.calculateCurveBezierEndPoints(t[r-1],t[r-2],e),n[i-1]=t[r-1],n},F.prototype.calculateCurveBezier=function(t,e,r){var i=t[e+2].x-t[e+0].x,n=t[e+2].y-t[e+0].y,o,a;return[new v(t[e+1].x-r*i,t[e+1].y-r*n),new v(t[e+1].x+r*i,t[e+1].y+r*n)]},F.prototype.calculateCurveBezierEndPoints=function(t,e,r){return new v(r*(e.x-t.x)+t.x,r*(e.y-t.y)+t.y)},F.prototype.getPointString=function(t){return this.calculateMinMax(t),a.format("{0} {1} {2} ",this.convertToString(t.x),this.convertToString(t.y),this.makepath&&0<this.path.length?"l":"m")},F.prototype.getLineToString=function(t){return this.calculateMinMax(t),a.format("{0} {1} l ",this.convertToString(t.x),this.convertToString(t.y))},F.prototype.getRectString4=function(t,e,r,i){return this.getRectString(new l(t,e,r,i))},F.prototype.getRectString=function(t){return a.format("{0} {1} {2} {3} re ",this.convertToString(t.x),this.convertToString(t.top),this.convertToString(t.right-t.x),this.convertToString(t.bottom-t.y))},F.prototype.getBezierString=function(t,e,r){return this.calculateMinMax(t),this.calculateMinMax(e),this.calculateMinMax(r),a.format("{0} {1} {2} {3} {4} {5} c ",this.convertToString(t.x),this.convertToString(t.y),this.convertToString(e.x),this.convertToString(e.y),this.convertToString(r.x),this.convertToString(r.y))},F.prototype.getBezierString2=function(t,e,r,i,n,o){return this.calculateMinMax(new v(t,e)),this.calculateMinMax(new v(r,i)),this.calculateMinMax(new v(n,o)),a.format("{0} {1} {2} {3} {4} {5} c ",this.convertToString(t),this.convertToString(e),this.convertToString(r),this.convertToString(i),this.convertToString(n),this.convertToString(o))},F.prototype.getPolylineString=function(t,e,r){var i=new m;r||i.append(this.getPointString(t[0]));for(var n=r?0:1;n<t.length;n++)i.append(this.getLineToString(t[n]));return e&&i.append("h "),i.toString()},F.prototype.getEllipseString4=function(t,e,r,i){return this.getEllipseString(new l(t,e,r,i))},F.prototype.getEllipseString=function(t){var e=t.width/2*(1-this.pdfCKT),r=t.height/2*(1-this.pdfCKT),i=new m;return i.appendFormat("{0} {1} m ",this.convertToString(t.x),this.convertToString(t.y+t.height/2)),i.append(this.getBezierString2(t.x,t.y+t.height-r,t.x+e,t.y+t.height,t.x+t.width/2,t.y+t.height)),i.append(this.getBezierString2(t.x+t.width-e,t.y+t.height,t.x+t.width,t.y+t.height-r,t.x+t.width,t.y+t.height/2)),i.append(this.getBezierString2(t.x+t.width,t.y+r,t.x+t.width-e,t.y,t.x+t.width/2,t.y)),i.append(this.getBezierString2(t.x+e,t.y,t.x,t.y+r,t.x,t.y+t.height/2)),i.toString()},F.prototype.getPenStyleDashString=function(t,e){switch(t){case E.Dot:return a.format("[{0} {1}] 0 d",this.convertToString(e),this.convertToString(58*e));case E.Dash:return a.format("[{0} {1}] 0 d",this.convertToString(49.5*e),this.convertToString(62*e));case E.DashDot:return a.format("[{0} {1} {2} {1}] 0 d",this.convertToString(50*e),this.convertToString(55*e),this.convertToString(e));case E.DashDotDot:return a.format("[{0} {1} {2} {1} {2} {1}] 0 d",this.convertToString(50*e),this.convertToString(55*e),this.convertToString(e))}return null},F.prototype.beginPath=function(){if(this.assembleData)return;this.path=new m,this.makepath=!0,this.pathClosed=!1,this.xmin=null,this.xmax=null,this.ymin=null,this.ymax=null},F.prototype.closeFigure=function(){if(this.assembleData)return;this.path.append("h "),this.pathClosed=!0},F.prototype.endPath=function(){if(this.assembleData)return;this.makepath=!1},F.prototype.fillPath=function(t){var e=this.assembleData?new l:new l(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),e=this.setBrush(t,e,!0);if(this.assembleData)return;this.pathClosed||this.endPath(),this.pageStream.writeString(this.path.toString()),this.pageStream.writeLine("f"),e&&this.pageStream.writeLine("Q")},F.prototype.strokePath=function(t){if(this.assembleData)return;this.setPen(t),this.pageStream.writeString(this.path.toString()),this.pageStream.writeLine("S")},F.prototype.moveTo=function(t){if(this.assembleData)return;this.lastPoint=t;var t=this.getPointString(t);this.makepath?this.path.appendLine(t):this.pageStream.writeLine(t)},F.prototype.drawLine=function(t,e,r){if(this.assembleData)return;var t=this.getPointString(t)+this.getLineToString(e);this.makepath?this.path.appendLine(t):this.outputLineString(t+"S",r),this.lastPoint=e},F.prototype.drawLineTo=function(t,e){if(this.assembleData)return;var r=this.getLineToString(t);this.makepath?this.path.appendLine(r):this.outputLineString(r+"S",e),this.lastPoint=t},F.prototype.drawRectangle=function(t,e){if(this.assembleData)return;this.outputLineString(this.getRectString(t)+"S",e)},F.prototype.fillRectangle=function(t,e){var r=this.setBrush(e,t,!0);if(this.assembleData)return;null!=e&&this.pageStream.writeLine(this.getRectString(t)+"f"),r&&this.pageStream.writeLine("Q")},F.prototype.drawPolygon=function(t,e){this.drawPolyline(t,e,!0)},F.prototype.drawPolyline=function(t,e,r,i){if(void 0===r&&(r=!1),void 0===i&&(i=!1),this.assembleData)return;var i=this.getPolylineString(t,r,i);this.makepath?this.path.appendLine(i):this.outputLineString(i+"S",e),this.lastPoint=t[t.length-1]},F.prototype.drawPolylineTo=function(t,e){this.drawPolyline(t,e,!1,!0)},F.prototype.fillPolygon=function(t,e){var r,i;try{for(var n=__values(t),o=n.next();!o.done;o=n.next()){var a=o.value;this.calculateMinMax(a)}}catch(t){r={error:t}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(r)throw r.error}}var s=new l(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),s=this.setBrush(e,s,!0),e;if(this.assembleData)return;null!=e&&(e=this.getPolylineString(t,!0,!1),this.pageStream.writeLine(e+"f")),s&&this.pageStream.writeLine("Q")},F.prototype.drawBezier=function(t,e,r,i,n){if(this.assembleData)return;var r=this.getPointString(t)+this.getBezierString(e,r,i);this.makepath?this.path.appendLine(r):this.outputLineString(r+"S",n),this.lastPoint=i},F.prototype.drawBezierTo=function(t,e,r,i){if(this.assembleData)return;var e=this.getBezierString(t,e,r);this.makepath?this.path.appendLine(e):this.outputLineString(e+"S",i),this.lastPoint=r},F.prototype.drawSpline=function(t,e,r){if(this.assembleData)return;var i=this.convertSplineToCubicBezier(t,e),n=(i.length-1)/3,o=new m;o.append(this.getPointString(i[0])+this.getBezierString(i[1],i[2],i[3]));for(var a=1;a<n;a++)o.append(this.getBezierString(i[3*a+1],i[3*a+2],i[3*a+3]));this.makepath?this.path.appendLine(o.toString()):this.outputLineString(o.toString()+"S",r),this.lastPoint=i[i.length-1]},F.prototype.drawArc=function(t,e,r){if(this.assembleData)return;var i=this.convertArcToBezierPoints(t,e,r),n=(i.length-1)/3;this.drawBezier(i[0],i[1],i[2],i[3],null);for(var o=1;o<n;o++)this.drawBezierTo(i[3*o+1],i[3*o+2],i[3*o+3],null)},F.prototype.drawEllipse=function(t,e){if(this.assembleData)return;this.outputLineString(this.getEllipseString(t)+"S",e)},F.prototype.fillEllipse=function(t,e){var r=this.setBrush(e,t,!0);if(this.assembleData)return;null!=e&&this.pageStream.writeLine(this.getEllipseString(t)+"f"),r&&this.pageStream.writeLine("Q")},F.prototype.drawPie=function(t,e,r){if(this.assembleData)return;var i=this.convertArcToBezierPoints(t,e,r),n=(i.length-1)/3,r=t.x+t.width/2,t=t.y+t.height/2;this.drawBezier(i[0],i[1],i[2],i[3],null);for(var o=1;o<n;o++)this.drawBezierTo(i[3*o+1],i[3*o+2],i[3*o+3],null);this.drawLineTo(new v(r,t),null),this.drawLineTo(i[0],null)},F.prototype.drawString=function(t,e,r,i,n){var o;if(this.assembleData)return null!=e&&(o=this.pdfService.pdfFont.getFontNumber(e)),void this.pdfService.pdfFont.storeUnicodeSymbolsInMap(t);var a=new y;a.clientRectangle=new x(i.x,i.y,i.width,i.height),a.text=t,a.font=e,a.textBrush=r,(n=n||new b).alignment==A.Center&&(a.horAlignment=T.Center),n.alignment==A.Far&&(a.horAlignment=T.Right),n.lineAlignment==A.Center&&(a.vertAlignment=P.Center),n.lineAlignment==A.Far&&(a.vertAlignment=P.Bottom),0==(n.formatFlags&L.NoWrap)&&(a.wordWrap=!0);var n=new s.StiPdfData(this.pdfService);n.Component=a,n.Width=i.width*this.hiToTwips,n.Height=i.height*this.hiToTwips,this.pageStream.writeLine("q"),this.pdfService.pushColorToStack(),this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(i.x),this.convertToString(i.y+i.height)),this.pageStream.writeLine("1.39 0 0 -1.39 0 0 cm"),s.StiPdfRenderText.renderTextFont(n),s.StiPdfRenderText.renderText(n),this.pageStream.writeLine("Q"),this.pdfService.popColorFromStack()},F.prototype.saveState=function(){if(this.assembleData)return;this.pageStream.writeLine("q"),this.pdfService.pushColorToStack(),0<this.matrixCache.length&&this.matrixCache.push(this.matrixCache.stimulsoft.peek().clone())},F.prototype.restoreState=function(){if(this.assembleData)return;this.pageStream.writeLine("Q"),this.pdfService.popColorFromStack(),0<this.matrixCache.length&&this.matrixCache.pop()},F.prototype.translateTransform=function(t,e){if(this.assembleData)return;this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(t),this.convertToString(e)),0<this.matrixCache.length&&this.matrixCache.stimulsoft.peek().translate(t,e)},F.prototype.rotateTransform=function(t){if(this.assembleData)return;var e=t*Math.PI/180;this.pageStream.writeLine1("{0} {1} {2} {3} 0 0 cm",this.convertToString(Math.cos(e)),this.convertToString(Math.sin(e)),this.convertToString(-Math.sin(e)),this.convertToString(Math.cos(e))),0<this.matrixCache.length&&this.matrixCache.stimulsoft.peek().rotate(t)},F.prototype.setClip=function(t){if(this.assembleData)return;this.pageStream.writeLine(this.getRectString(t)+"W n")},F.prototype.drawArc2=function(t,e,r,i){},F.prototype.drawText=function(t,e,r,i,n,o,a){},F.prototype.setPixel=function(t,e){},F.prototype.measureString=function(t,e){return new C(0,0)},F.prototype.drawImage=function(t,e){var r=new i;if(r.clientRectangle=e,r.imageToDraw=t,r.smoothing=!0,r.stretch=!0,this.assembleData)return void this.pdfService.storeImageDataForGeom(r);var t=new s.StiPdfData(this.pdfService);t.Component=r,t.Width=e.width,t.Height=e.height,this.pageStream.writeLine("q"),this.pdfService.pushColorToStack(),this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(e.x),this.convertToString(e.y+e.height)),this.pageStream.writeLine("1 0 0 -1 0 0 cm"),this.pdfService.renderImage(t,100),this.pageStream.writeLine("Q"),this.pdfService.popColorFromStack()},e=F,s.StiPdfGeomWriter=e}(Stimulsoft=Stimulsoft||{}),function(X){var t,e,r,W,s,l,Y,G,w,d,V,_,j,i,q,K,J,Q,Z,$,tt,et,rt,it,nt,ot,at,st,lt,mt,ct,pt,gt,ht,wt,dt,ut,St,ft,vt,Et,u,n,bt,S;function o(){}e=t=X.Report||(X.Report={}),W=r=e.Export||(e.Export={}),s=X.Report.Painters.StiSparklinePainter,l=X.Report.Components.StiSparkline,Y=X.System.Drawing.Color,G=X.System.Drawing.Graphics,w=X.Base.Context.StiContext,d=X.Base.Context.StiContextPainter,V=X.System.Drawing.Point,_=X.System.Drawing.Rectangle,j=X.System.Drawing.StringFormat,i=X.Base.Drawing.StiRotationMode,q=X.Base.Context.StiPushTranslateTransformGeom,K=X.Base.Context.StiPushRotateTransformGeom,J=X.Base.Context.StiPopTransformGeom,Q=X.Base.Context.StiBorderGeom,Z=X.Base.Context.StiLineGeom,$=X.Base.Context.StiLinesGeom,tt=X.Base.Context.StiPushClipGeom,et=X.Base.Context.StiPopClipGeom,rt=X.Base.Context.StiPushSmothingModeToAntiAliasGeom,it=X.Base.Context.StiPopSmothingModeGeom,nt=X.Base.Context.StiPushTextRenderingHintToAntiAliasGeom,ot=X.Base.Context.StiPopTextRenderingHintGeom,at=X.Base.Context.StiCurveGeom,st=X.Base.Context.StiEllipseGeom,lt=X.Base.Context.StiCachedShadowGeom,mt=X.Base.Drawing.StiShadowSides,ct=X.Base.Drawing.StiSolidBrush,pt=X.Base.Context.StiShadowGeom,gt=X.Base.Context.StiTextGeom,ht=X.Base.Context.StiPathGeom,wt=X.Base.Context.StiPieSegmentGeom,dt=X.Base.Context.StiArcSegmentGeom,ut=X.Base.Context.StiLineSegmentGeom,St=X.Base.Context.StiLinesSegmentGeom,ft=X.Base.Context.StiCurveSegmentGeom,vt=X.Base.Context.StiCloseFigureSegmentGeom,Et=X.System.Drawing.Drawing2D.Matrix,u=X.Report.Chart.IStiChart,n=X.Base.Drawing.StiPenStyle,bt=X.System.Drawing.Font,S=X.Report.Components.StiImageRotation,o.renderChart=function(t,e,r){var i=t.Component.as(u),n=.96,o=t.service.report.unit.convertToHInches(t.Component.width)*n,a=t.service.report.unit.convertToHInches(t.Component.height)*n,s=0,l=0,m=0,c=1,p=1,g;switch(i.rotation){case S.Rotate90CCW:s=-90,m=a;break;case S.Rotate90CW:s=90,l=o;break;case S.Rotate180:s=-180,l=o,m=a;break;case S.FlipVertical:p=-1,m=a;break;case S.FlipHorizontal:c=-1,l=o;break}switch(i.rotation){case S.Rotate90CCW:case S.Rotate90CW:var n=o,o=a,a=n;break}e||i.rotation==S.None||((g=new Et(1,0,0,1,0,0)).translate(l,m),g.scale(c,p),g.rotate(s),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} cm",t.service.convertToString(g.elements[0]),t.service.convertToString(g.elements[1]),t.service.convertToString(g.elements[2]),t.service.convertToString(g.elements[3]),t.service.convertToString(g.elements[4]),t.service.convertToString(g.elements[5])));var s=new d,g=new w(s,!0,!1,!1,1),s=i.isAnimation,h;i.isAnimation=!1,i.core.render(g,new _(0,0,o,a),!0).drawGeom(g),i.isAnimation=s,this.renderContext(t,e,r,g)},o.renderSparkline=function(t,e,r){var i=t.Component.as(l),n=.96,o=t.service.report.unit.convertToHInches(t.Component.width)*n,a=t.service.report.unit.convertToHInches(t.Component.height)*n,n=new d,n=new w(n,!0,!1,!1,1);s.renderSparkline(n,new _(0,0,o,a),i,1),this.renderContext(t,e,r,n)},o.renderContext=function(t,e,r,i){var n,o,a,s,l=new Et(1,0,0,1,0,0),m=t.service.hiToTwips/.96;l.translate(t.X,t.Y+t.Height),l.scale(1,-1),l.scale(m,m);var c=new W.StiPdfGeomWriter(t.service.pageStream,t.service,e);c.pageNumber=r,c.matrixCache.push(l);try{for(var p=__values(i.geoms),g=p.next();!g.done;g=p.next()){var h=g.value,w,w,d,u,S,f,v,E,b,d,u,S,f,v,y,v,E,y,E;if(h.is(q)&&(w=h,c.saveState(),c.translateTransform(w.x,w.y)),h.is(K)&&(w=h,c.saveState(),c.rotateTransform(w.angle)),h.is(J)&&c.restoreState(),h.is(tt)&&(d=h,c.saveState(),c.setClip(d.clipRectangle)),h.is(et)&&c.restoreState(),h.is(rt)&&c.saveState(),h.is(it)&&c.restoreState(),h.is(nt)&&c.saveState(),h.is(ot)&&c.restoreState(),h.is(Q)&&(null!=(u=h).background&&c.fillRectangle(this.rectToRectangle(u.rect),u.background),this.checkPenGeom(u.borderPen)&&c.drawRectangle(this.rectToRectangle(u.rect),u.borderPen)),h.is(Z)&&(S=h,this.checkPenGeom(S.pen)&&c.drawLine(new V(S.x1,S.y1),new V(S.x2,S.y2),S.pen)),h.is($)&&(f=h,this.checkPenGeom(f.pen)&&c.drawPolyline(f.points,f.pen)),h.is(at)&&(v=h,this.checkPenGeom(v.pen)&&c.drawSpline(v.points,v.tension,v.pen)),h.is(st)&&(null!=(E=h).background&&c.fillEllipse(this.rectToRectangle(E.rect),E.background),this.checkPenGeom(E.borderPen)&&c.drawEllipse(this.rectToRectangle(E.rect),E.borderPen)),h.is(lt)){var x,A=h.rect,T=h.sides,P=A.y+8,L=A.x+8,C=0<(T&mt.Edge)?4:0;0<(T&mt.Top)&&(P=A.y+4),0<(T&mt.Left)&&(L=A.x+4);for(var F=0;F<3;F++){var R=new Array;0<(T&mt.Right)?(R.push(new V(A.right,P)),0<(T&mt.Bottom)?(R.push(new V(A.right,A.bottom)),R.push(new V(L,A.bottom)),R.push(new V(L,A.bottom+F+1)),R.push(new V(A.right+F+1,A.bottom+F+1))):(R.push(new V(A.right,A.bottom+C)),R.push(new V(A.right+F+1,A.bottom+C))),R.push(new V(A.right+F+1,P))):(R.push(new V(L,A.bottom)),R.push(new V(A.right+C,A.bottom)),R.push(new V(A.right+C,A.bottom+F+1)),R.push(new V(L,A.bottom+F+1)));var I=new ct(Y.fromArgb(40-10*F,Y.black));c.fillPolygon(R,I)}}if(h.is(pt)&&(b=h),h.is(gt)&&(u=new bt((d=h).font.fontName,d.font.fontSize,d.font.fontStyle,d.font.unit),(S=new j).alignment=d.stringFormat.alignment,S.formatFlags=d.stringFormat.formatFlags,S.hotkeyPrefix=d.stringFormat.hotkeyPrefix,S.lineAlignment=d.stringFormat.lineAlignment,S.trimming=d.stringFormat.trimming,f=this.brushToStiBrush(d.brush),d.isRotatedText?(v=new V,v=d.location instanceof V?d.location:(y=this.rectToRectangle(d.location),new V(y.x+y.width/2,y.y+y.height/2)),E=G.measureString(d.text,u,d.maximalWidth),y=new _(0,0,E.width,E.height),E=this.getStartPoint(d.rotationMode,y),y.x-=E.x,y.y-=E.y,S.alignment==X.System.Drawing.StringAlignment.Center&&--y.x,S.alignment==X.System.Drawing.StringAlignment.Far&&(y.x-=2),y.width+=2.5,c.saveState(),c.translateTransform(v.x,v.y),0!=d.angle&&c.rotateTransform(d.angle),c.drawString(d.text,u,f,y,S),c.restoreState()):c.drawString(d.text,u,f,this.rectToRectangle(d.location),S)),h.is(ht)){var B=h;c.beginPath();try{for(var D=(a=void 0,__values(B.geoms)),k=D.next();!k.done;k=D.next()){var N=k.value,O,M,H,U,z;N.is(wt)&&c.drawPie(N.rect,N.startAngle,N.sweepAngle),N.is(dt)&&c.drawArc(N.rect,N.startAngle,N.sweepAngle),N.is(ut)&&(H=N,c.drawLine(new V(H.x1,H.y1),new V(H.x2,H.y2),null)),N.is(St)&&c.drawPolyline(N.points,null),N.is(ft)&&c.drawSpline(N.points,N.tension,null),N.is(vt)&&c.closeFigure()}}catch(t){a={error:t}}finally{try{k&&!k.done&&(s=D.return)&&s.call(D)}finally{if(a)throw a.error}}c.closeFigure(),c.endPath(),null!=B.background&&c.fillPath(B.background),this.checkPenGeom(B.pen)&&c.strokePath(B.pen)}}}catch(t){n={error:t}}finally{try{g&&!g.done&&(o=p.return)&&o.call(p)}finally{if(n)throw n.error}}},o.getStartPoint=function(t,e){var r=new V(e.x+e.width/2,e.y+e.height/2);switch(t){case i.LeftCenter:return new V(e.x,r.y);case i.LeftBottom:return new V(e.x,e.bottom);case i.CenterTop:return new V(r.x,e.top);case i.CenterCenter:return r;case i.CenterBottom:return new V(r.x,e.bottom);case i.RightTop:return new V(e.right,e.top);case i.RightCenter:return new V(e.right,r.y);case i.RightBottom:return new V(e.right,e.bottom);default:return new V(e.x,e.y)}},o.rectToRectangle=function(t){if(null==t)return new _;if(t instanceof _)return t;return new _},o.brushToStiBrush=function(t){if(null==t)return null;return t instanceof Y?new ct(t):t;return null},o.checkPenGeom=function(t){return!(null==t||null==t.brush||t.penStyle==n.None)},e=o,W.StiPdfRenderChart=e}(Stimulsoft=Stimulsoft||{}),function(p){var t,e,r,g,h,w,d,u,S,f,v,E,b,y;function i(){}e=t=p.Report||(p.Report={}),g=r=e.Export||(e.Export={}),h=p.System.Drawing.Rectangle,w=p.Base.Drawing.StiSolidBrush,d=p.Base.Drawing.StiGradientBrush,u=p.Base.Drawing.StiColorUtils,S=p.Report.Components.StiDataBarDirection,f=p.Report.Components.StiDataBarIndicator,v=p.System.Drawing.ContentAlignment,E=p.Report.Components.StiIcon,b=p.Report.Components.StiIconSetIndicator,y=p.Report.Components.StiText,i.renderIndicators=function(t){var e=t.Component.as(y);if(null==e||null==e.indicator)return t;var r=new h(t.X,t.Y,t.Width,t.Height),i=e.indicator.stimulsoft.as(b);if(null!=i&&(i.icon!=E.None||null!=i.customIcon)){var n=t.service.imageList[t.service.imagesCurrent],o=n.Width*t.service.hiToTwips,a=n.Height*t.service.hiToTwips,s=r.clone(),l=t.service.hiToTwips;switch(s.inflate(-l,-l),i.alignment){case v.TopLeft:s=new h(s.x,s.bottom-a,o,a),r.x+=s.width+1,r.width-=s.width+1;break;case v.TopCenter:s=new h(s.x+(s.width-o)/2,s.bottom-a,o,a);break;case v.TopRight:s=new h(s.right-o,s.bottom-a,o,a),r.width-=s.width+1;break;case v.MiddleLeft:s=new h(s.x,s.y+(s.height-a)/2,o,a),r.x+=s.width+1,r.width-=s.width+1;break;case v.MiddleCenter:s=new h(s.x+(s.width-o)/2,s.y+(s.height-a)/2,o,a);break;case v.MiddleRight:s=new h(s.right-o,s.y+(s.height-a)/2,o,a),r.width-=s.width+1;break;case v.BottomLeft:s=new h(s.x,s.y,o,a),r.x+=s.width+1,r.width-=s.width+1;break;case v.BottomCenter:s=new h(s.x+(s.width-o)/2,s.y,o,a);break;case v.BottomRight:s=new h(s.right-o,s.y,o,a),r.width-=s.width+1;break}var m=new g.StiPdfData(t.service);m.X=s.x,m.Y=s.y,m.Width=s.width,m.Height=s.height,t.service.writeImageInfo2(m,1,1)}var n=e.indicator.stimulsoft.as(f),i,l,o,a,s,m,l,o,e,m,l,a,c,s,m,c;null!=n&&0!=n.value&&(i=r.clone(),l=t.service.hiToTwips,i.inflate(-2*l,-2*l),o=n.maximum+Math.abs(n.minimum),a=i.width*Math.abs(n.minimum)/o,s=i.width*n.maximum/o,m=i.width*Math.abs(n.value)/o,(l=n.direction)==S.Default&&(l=null!=e.textOptions&&e.textOptions.rightToLeft?S.RighToLeft:S.LeftToRight),o=0,l==S.LeftToRight?n.value<0?i.x+=a-m:i.x+=a:(o=180,n.value<0?i.x=i.right-a:i.x=i.right-a-m),i.width=m,n.value<0&&(o+=180),e=!1,0<i.width&&0<i.height&&(n.brushType==p.Report.Components.StiBrushType.Gradient?(m=void 0,m=l==S.LeftToRight?0<n.value?new h(r.left+a,r.top,s,r.height):new h(r.left,r.top,a,r.height):n.value<0?new h(r.left+s,r.top,a,r.height):new h(r.left,r.top,s,r.height),0<i.width&&i.width<1&&(i.width=1),0<m.width&&m.width<1&&(m.width=1),0<m.width&&0<i.width&&(l=n.value<0?n.negativeColor:n.positiveColor,a=u.light(l,200),m.x-=.1*m.width,m.width+=.2*m.width,c=new d(l,a,o),t.service.fillRectBrush(c,i),(s=t.service.shadingArray[t.service.shadingCurrent-1]).Angle=o,s.X=m.x,s.Y=m.y,s.Width=m.width,s.Height=m.height,s.FunctionIndex=t.service.getShadingFunctionNumber(l,a,!1),t.service.shadingArray[t.service.shadingCurrent-1]=s,e=!0)):(c=new w(n.value<0?n.negativeColor:n.positiveColor),t.service.fillRectBrush(c,i)),n.showBorder&&(t.service.pageStream.writeLine("q"),t.service.pushColorToStack(),t.service.setStrokeColor(n.value<0?n.negativeBorderColor:n.positiveBorderColor),t.service.pageStream.writeLine1("{0} {1} {2} {3} re S",t.service.convertToString(i.x),t.service.convertToString(i.y),t.service.convertToString(i.width),t.service.convertToString(i.height)),t.service.pageStream.writeLine("Q"),t.service.popColorFromStack())),e||n.brushType!=p.Report.Components.StiBrushType.Gradient||t.service.shadingCurrent++);var n=new g.StiPdfData(t.service);return n.X=r.x,n.Y=t.Y,n.Width=r.width,n.Height=t.Height,n.Component=t.Component,n},e=i,g.StiPdfRenderIndicators=e}(Stimulsoft=Stimulsoft||{}),function(t){var e,r,i,y,x,A,T,P,L,C,p,w,d,g,F,R,I,B,D,k,N,O,M,H,U,z,X,W,Y,G,V,_,j,q,K,J,Q,Z,$,tt,et,rt,it,nt,ot,at,st,lt,mt,ct,pt,a,s,u,n;function o(){}r=e=t.Report||(t.Report={}),y=i=r.Export||(r.Export={}),x=t.System.Drawing.Color,A=t.Base.Drawing.StiBrush,T=t.Base.Drawing.StiGradientBrush,P=t.Base.Drawing.StiGlareBrush,L=t.Base.Drawing.StiHatchBrush,C=t.Report.Components.IStiBrush,p=t.Base.Drawing.StiBorderSides,w=t.Report.Components.IStiBorder,d=t.Base.Drawing.StiBorderSide,g=t.Base.Drawing.StiAdvancedBorder,F=t.Base.Drawing.StiPenStyle,R=t.Report.Components.StiShape,I=t.Report.Components.StiVerticalLineShapeType,B=t.Report.Components.StiHorizontalLineShapeType,D=t.Report.Components.StiTopAndBottomLineShapeType,k=t.Report.Components.StiLeftAndRightLineShapeType,N=t.Report.Components.StiRectangleShapeType,O=t.Report.Components.StiRoundedRectangleShapeType,M=t.Report.Components.StiDiagonalDownLineShapeType,H=t.Report.Components.StiDiagonalUpLineShapeType,U=t.Report.Components.StiTriangleShapeType,z=t.Report.Components.StiOvalShapeType,X=t.Report.Components.StiArrowShapeType,W=t.Report.Components.StiOctagonShapeType,Y=t.Report.Components.StiComplexArrowShapeType,G=t.Report.Components.StiBentArrowShapeType,V=t.Report.Components.StiChevronShapeType,_=t.Report.Components.StiDivisionShapeType,j=t.Report.Components.StiEqualShapeType,q=t.Report.Components.StiFlowchartCardShapeType,K=t.Report.Components.StiFlowchartCollateShapeType,J=t.Report.Components.StiFlowchartDecisionShapeType,Q=t.Report.Components.StiFlowchartManualInputShapeType,Z=t.Report.Components.StiFlowchartOffPageConnectorShapeType,$=t.Report.Components.StiFlowchartPreparationShapeType,tt=t.Report.Components.StiFlowchartSortShapeType,et=t.Report.Components.StiFrameShapeType,rt=t.Report.Components.StiMinusShapeType,it=t.Report.Components.StiMultiplyShapeType,nt=t.Report.Components.StiParallelogramShapeType,ot=t.Report.Components.StiPlusShapeType,at=t.Report.Components.StiRegularPentagonShapeType,st=t.Report.Components.StiTrapezoidShapeType,lt=t.Report.Components.StiSnipSameSideCornerRectangleShapeType,mt=t.Report.Components.StiSnipDiagonalSideCornerRectangleShapeType,ct=t.Report.Components.StiShapeDirection,pt=t.System.Drawing.Rectangle,a=t.Report.Components.StiCheckBox,s=t.Report.Components.StiCheckStyle,u=t.Report.Components.StiRoundedRectanglePrimitive,n=t.System.StiString,o.renderBorder1=function(t){var e=null,r=t.Component.as(C);null!=r&&null!=r.brush&&(e=r.brush),null!=e&&t.service.fillRectBrush(e,new pt(t.X,t.Y,t.Width,t.Height))},o.renderBorder2=function(t){var e=t.Component.as(w),r,i,r,n,o,a,s,l,m,c,r,i,i;null!=e&&(r=x.transparent,e.border.dropShadow&&null!=e.border.shadowBrush&&0!=(r=A.toColor(e.border.shadowBrush)).a&&(i=.8*e.border.shadowSize,t.service.setNonStrokeColor(r),t.service.pageStream.writeLine1("{0} {1} {2} {3} re f",t.service.convertToString(t.X+i),t.service.convertToString(t.Y-i),t.service.convertToString(t.Width-i),t.service.convertToString(i)),t.service.pageStream.writeLine1("{0} {1} {2} {3} re f",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y-i),t.service.convertToString(i),t.service.convertToString(t.Height))),n=new d(e.border.color,e.border.size,e.border.style),a=null!=(o=e.border.stimulsoft.as(g)),s=e.border.isLeftBorderSidePresent,l=e.border.isRightBorderSidePresent,m=e.border.isTopBorderSidePresent,c=e.border.isBottomBorderSidePresent,r=e.border.style!=F.None&&e.border.style!=F.Solid,i=e.border.side!=p.None&&e.border.style!=F.None,a&&(i=o.side!=p.None),i&&(i=0,a||(r&&(t.service.pageStream.writeLine("q"),t.service.pushColorToStack()),i=this.storeBorderSideData(n,t)),a||e.border.side!=p.All?(s&&(a&&((n=o.leftSide).style!=F.Solid&&(t.service.pageStream.writeLine("q"),t.service.pushColorToStack()),i=this.storeBorderSideData(n,t)),t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X-i),t.service.convertToString(t.Y-i)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X-i),t.service.convertToString(t.Y+t.Height+i)),n.style==F.Double&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+i),t.service.convertToString(t.Y+(c?i:-i))),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+i),t.service.convertToString(t.Y+t.Height+(m?-i:i)))),a&&n.style!=F.Solid&&(t.service.pageStream.writeLine("Q"),t.service.popColorFromStack())),l&&(a&&((n=o.rightSide).style!=F.Solid&&(t.service.pageStream.writeLine("q"),t.service.pushColorToStack()),i=this.storeBorderSideData(n,t)),t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+t.Width+i),t.service.convertToString(t.Y-i)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width+i),t.service.convertToString(t.Y+t.Height+i)),n.style==F.Double&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+t.Width-i),t.service.convertToString(t.Y+(c?i:-i))),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width-i),t.service.convertToString(t.Y+t.Height+(m?-i:i)))),a&&n.style!=F.Solid&&(t.service.pageStream.writeLine("Q"),t.service.popColorFromStack())),m&&(a&&((n=o.topSide).style!=F.Solid&&(t.service.pageStream.writeLine("q"),t.service.pushColorToStack()),i=this.storeBorderSideData(n,t)),t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X-i),t.service.convertToString(t.Y+t.Height+i)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width+i),t.service.convertToString(t.Y+t.Height+i)),n.style==F.Double&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+(s?i:-i)),t.service.convertToString(t.Y+t.Height-i)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width+(l?-i:i)),t.service.convertToString(t.Y+t.Height-i))),a&&n.style!=F.Solid&&(t.service.pageStream.writeLine("Q"),t.service.popColorFromStack())),c&&(a&&((n=o.bottomSide).style!=F.Solid&&(t.service.pageStream.writeLine("q"),t.service.pushColorToStack()),i=this.storeBorderSideData(n,t)),t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X-i),t.service.convertToString(t.Y-i)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width+i),t.service.convertToString(t.Y-i)),n.style==F.Double&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+(s?i:-i)),t.service.convertToString(t.Y+i)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width+(l?-i:i)),t.service.convertToString(t.Y+i))),a&&n.style!=F.Solid&&(t.service.pageStream.writeLine("Q"),t.service.popColorFromStack()))):(t.service.pageStream.writeLine1("{0} {1} {2} {3} re S",t.service.convertToString(t.X-i),t.service.convertToString(t.Y-i),t.service.convertToString(t.Width+2*i),t.service.convertToString(t.Height+2*i)),e.border.style==F.Double&&t.service.pageStream.writeLine1("{0} {1} {2} {3} re S",t.service.convertToString(t.X+i),t.service.convertToString(t.Y+i),t.service.convertToString(t.Width-2*i),t.service.convertToString(t.Height-2*i))),!a&&r&&(t.service.pageStream.writeLine("Q"),t.service.popColorFromStack())))},o.storeBorderSideData=function(t,e){var r=t.size;r<1&&(r=1),t.style==F.Double&&(r=1);var i=r*e.service.hiToTwips*.955;e.service.pageStream.writeLine1("{0} w",e.service.convertToString(i));var r=this.getPenStyleDashString(t.style,.04*i,e);return null!=r&&e.service.pageStream.writeLine(r),e.service.setStrokeColor(t.color),t.style==F.Double?i:0},o.getPenStyleDashString=function(t,e,r){switch(t){case F.Dot:return n.format("[{0} {1}] 0 d",r.service.convertToString(e),r.service.convertToString(58*e));case F.Dash:return n.format("[{0} {1}] 0 d",r.service.convertToString(49.5*e),r.service.convertToString(62*e));case F.DashDot:return n.format("[{0} {1} {2} {1}] 0 d",r.service.convertToString(50*e),r.service.convertToString(55*e),r.service.convertToString(e));case F.DashDotDot:return n.format("[{0} {1} {2} {1} {2} {1}] 0 d",r.service.convertToString(50*e),r.service.convertToString(55*e),r.service.convertToString(e))}return null},o.checkShape=function(t){if(t.shapeType.is2(I)||t.shapeType.is2(B)||t.shapeType.is2(D)||t.shapeType.is2(k)||t.shapeType.is2(N)||t.shapeType.is2(O)||t.shapeType.is2(M)||t.shapeType.is2(H)||t.shapeType.is2(U)||t.shapeType.is2(z)||t.shapeType.is2(X)||t.shapeType.is2(W)||t.shapeType.is2(Y)||t.shapeType.is2(G)||t.shapeType.is2(V)||t.shapeType.is2(_)||t.shapeType.is2(j)||t.shapeType.is2(q)||t.shapeType.is2(K)||t.shapeType.is2(J)||t.shapeType.is2(Q)||t.shapeType.is2(Z)||t.shapeType.is2($)||t.shapeType.is2(tt)||t.shapeType.is2(et)||t.shapeType.is2(rt)||t.shapeType.is2(it)||t.shapeType.is2(nt)||t.shapeType.is2(ot)||t.shapeType.is2(at)||t.shapeType.is2(st)||t.shapeType.is2(lt)||t.shapeType.is2(mt))return!0;return!1},o.renderShape=function(t,e){var r=t.Component.as(R);if(null!=r)if(1==this.checkShape(r)){var i=t.Component.as(C),n=new y.StiPdfGeomWriter(t.service.pageStream,t.service,!1),o=x.transparent,a;null!=i&&(o=A.toColor(i.brush)),0!=o.a&&t.service.setNonStrokeColor(o),null!=i&&((i.brush.is(T)||i.brush.is(P))&&(t.service.storeShadingData2(t.X,t.Y,t.Width,t.Height,i.brush),t.service.pageStream.writeLine1("/Pattern cs /P{0} scn",1+t.service.shadingCurrent)),i.brush.is(L)&&(a=i.brush,t.service.pageStream.writeLine1("/Cs1 cs /PH{0} scn",t.service.getHatchNumber(a)+1)));var s=r.borderColor;t.service.setStrokeColor(s);var i=0<o.a,a=r.style!=F.None;if(!i&&!a)return;var s=i?a?"B":"f":a?"S":"n";t.service.pageStream.writeLine1("{0} w",t.service.convertToString(r.size*t.service.hiToTwips)),t.service.pageStream.writeLine("q");var o=r.size*t.service.hiToTwips*.04,l,m,c,c,m,l,m,c,p,g,l,g,p,h,w,d,u,h,h,u,h,u,h,u,h,S,n,f,u,h,u,h;switch(r.style){case F.Dot:t.service.pageStream.writeLine1("[{0} {1}] 0 d",t.service.convertToString(o),t.service.convertToString(55*o));break;case F.Dash:t.service.pageStream.writeLine1("[{0} {1}] 0 d",t.service.convertToString(50*o),t.service.convertToString(55*o));break;case F.DashDot:t.service.pageStream.writeLine1("[{0} {1} {2} {1}] 0 d",t.service.convertToString(50*o),t.service.convertToString(55*o),t.service.convertToString(o));break;case F.DashDotDot:t.service.pageStream.writeLine1("[{0} {1} {2} {1} {2} {1}] 0 d",t.service.convertToString(50*o),t.service.convertToString(55*o),t.service.convertToString(o));break}if(r.shapeType.is(I)&&(i&&t.service.pageStream.writeLine1("{0} {1} {2} {3} re f",t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.Width),t.service.convertToString(t.Height)),a&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y+t.Height)))),r.shapeType.is(B)&&(i&&t.service.pageStream.writeLine1("{0} {1} {2} {3} re f",t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.Width),t.service.convertToString(t.Height)),a&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height/2)))),r.shapeType.is(D)&&(i&&t.service.pageStream.writeLine1("{0} {1} {2} {3} re f",t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.Width),t.service.convertToString(t.Height)),a&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y)))),r.shapeType.is(k)&&(i&&t.service.pageStream.writeLine1("{0} {1} {2} {3} re f",t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.Width),t.service.convertToString(t.Height)),a&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height)))),r.shapeType.is(N)&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l "+s,t.service.convertToString(t.X),t.service.convertToString(t.Y))),r.shapeType.is(M)&&(i&&t.service.pageStream.writeLine1("{0} {1} {2} {3} re f",t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.Width),t.service.convertToString(t.Height)),a&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y)))),r.shapeType.is(H)&&(i&&t.service.pageStream.writeLine1("{0} {1} {2} {3} re f",t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.Width),t.service.convertToString(t.Height)),a&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height)))),r.shapeType.is(U)&&((l=r.shapeType.direction)==ct.Up&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l "+s,t.service.convertToString(t.X),t.service.convertToString(t.Y))),l==ct.Down&&(s=i?a?"B*":"f*":a?"S":"n",t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l "+s,t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height))),l==ct.Left&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l "+s,t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y))),l==ct.Right&&(s=i?a?"B*":"f*":a?"S":"n",t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l "+s,t.service.convertToString(t.X),t.service.convertToString(t.Y)))),r.shapeType.is(z)&&t.service.pageStream.writeLine1(n.getEllipseString(new pt(t.X,t.Y,t.Width,t.Height))+s),r.shapeType.is(O)&&(m=r.shapeType.round,(c=t.Width)>t.Height&&(c=t.Height),m=(c=Math.min(c,70)*m)*(1-t.service.pdfCKT),t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y+c)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height-c)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height-m),t.service.convertToString(t.X+m),t.service.convertToString(t.Y+t.Height),t.service.convertToString(t.X+c),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width-c),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(t.X+t.Width-m),t.service.convertToString(t.Y+t.Height),t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height-m),t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height-c)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+c)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+m),t.service.convertToString(t.X+t.Width-m),t.service.convertToString(t.Y),t.service.convertToString(t.X+t.Width-c),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+c),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c "+s,t.service.convertToString(t.X+m),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Y+m),t.service.convertToString(t.X),t.service.convertToString(t.Y+c))),r.shapeType.is(X)&&(l=r.shapeType.direction,m=r.shapeType.arrowWidth,c=r.shapeType.arrowHeight,p=t.Width*m,g=t.Height*c,l!=ct.Left&&l!=ct.Right||(p=t.Height*m,g=t.Width*c),0==c&&(g=Math.min(t.Width/2,t.Height/2)),l==ct.Up&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+p),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+p),t.service.convertToString(t.Y+t.Height-g)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height-g)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height-g)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width-p),t.service.convertToString(t.Y+t.Height-g)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width-p),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l "+s,t.service.convertToString(t.X+p),t.service.convertToString(t.Y))),l==ct.Down&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+t.Width-p),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width-p),t.service.convertToString(t.Y+g)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+g)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+g)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+p),t.service.convertToString(t.Y+g)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+p),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l "+s,t.service.convertToString(t.X+t.Width-p),t.service.convertToString(t.Y+t.Height))),l==ct.Left&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+p)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+g),t.service.convertToString(t.Y+p)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+g),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+g),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+g),t.service.convertToString(t.Y+t.Height-p)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height-p)),t.service.pageStream.writeLine1("{0} {1} l "+s,t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+p))),l==ct.Right&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height-p)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width-g),t.service.convertToString(t.Y+t.Height-p)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width-g),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width-g),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width-g),t.service.convertToString(t.Y+p)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+p)),t.service.pageStream.writeLine1("{0} {1} l "+s,t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height-p)))),r.shapeType.is(W)&&(l=r.shapeType,p=g=(null!=r.report?r.report.unit.convertToHInches(l.bevel):l.bevel)*t.service.hiToTwips,l.autoSize&&(g=t.Width/(2.414*1.414),p=t.Height/(2.414*1.414)),g>t.Width/2&&(g=t.Width/2),p>t.Height/2&&(p=t.Height/2),t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+g),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width-g),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+p)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height-p)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width-g),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+g),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height-p)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+p)),t.service.pageStream.writeLine1("{0} {1} l "+s,t.service.convertToString(t.X+g),t.service.convertToString(t.Y))),r.shapeType.is(Y)){var h=t.Width<t.Height?t.Width/2:t.Height/2,v=t.Height/3.8,E=t.Width/3.8,u=t.Height<t.Width?t.Height/2:t.Width/2;switch(r.shapeType.direction){case ct.Left:case ct.Right:t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+h),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+h),t.service.convertToString(t.Y+v)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-h),t.service.convertToString(t.Y+v)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-h),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Y+t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-h),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-h),t.service.convertToString(t.Top-v)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+h),t.service.convertToString(t.Top-v)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+h),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l h "+s,t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height/2));break;case ct.Down:case ct.Up:t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y+u)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Y+u)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-E),t.service.convertToString(t.Y+u)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-E),t.service.convertToString(t.Top-u)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Top-u)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Top-u)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+E),t.service.convertToString(t.Top-u)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+E),t.service.convertToString(t.Y+u)),t.service.pageStream.writeLine1("{0} {1} l h "+s,t.service.convertToString(t.X),t.service.convertToString(t.Y+u));break}}if(r.shapeType.is(G)){var w=0,v=0,E=0,E=t.Height>t.Width?(w=v=t.Width/4)/2:(v=w=Math.floor(t.Height/4))/2;switch(r.shapeType.direction){case ct.Up:t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+w)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-(E+w)),t.service.convertToString(t.Y+w)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-(E+w)),t.service.convertToString(t.Top-v)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-2*v),t.service.convertToString(t.Top-v)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-v),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Top-v)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-E),t.service.convertToString(t.Top-v)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-E),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l h "+s,t.service.convertToString(t.X),t.service.convertToString(t.Y));break;case ct.Left:t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.Right),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Top-E)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+v),t.service.convertToString(t.Top-E)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+v),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Top-v)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+v),t.service.convertToString(t.Top-2*v)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+v),t.service.convertToString(t.Top-v-E)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-w),t.service.convertToString(t.Top-v-E)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-w),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l h "+s,t.service.convertToString(t.Right),t.service.convertToString(t.Y));break;case ct.Down:t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.Right),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+E),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+E),t.service.convertToString(t.Y+v)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+v)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+v),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+2*v),t.service.convertToString(t.Y+v)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+v+E),t.service.convertToString(t.Y+v)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+v+E),t.service.convertToString(t.Top-w)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Top-w)),t.service.pageStream.writeLine1("{0} {1} l h "+s,t.service.convertToString(t.Right),t.service.convertToString(t.Top));break;case ct.Right:t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+E)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-v),t.service.convertToString(t.Y+E)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-v),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Y+v)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-v),t.service.convertToString(t.Y+2*v)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-v),t.service.convertToString(t.Y+v+E)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+w),t.service.convertToString(t.Y+v+E)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+w),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l h "+s,t.service.convertToString(t.X),t.service.convertToString(t.Top));break}}if(r.shapeType.is(V)){var f=t.Width>t.Height?t.Height/2:t.Width/2;switch(r.shapeType.direction){case ct.Right:t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+f),t.service.convertToString(t.Top-t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-f),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Top-t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-f),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l h "+s,t.service.convertToString(t.X),t.service.convertToString(t.Top));break;case ct.Left:t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.Right),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+f),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Top-t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+f),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-f),t.service.convertToString(t.Top-t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l h "+s,t.service.convertToString(t.Right),t.service.convertToString(t.Top));break;case ct.Up:t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Top-f)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Top-f)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y+f)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l h "+s,t.service.convertToString(t.X),t.service.convertToString(t.Top-f));break;case ct.Down:t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Top-f)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Y+f)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+f)),t.service.pageStream.writeLine1("{0} {1} l h "+s,t.service.convertToString(t.X),t.service.convertToString(t.Top));break}}if(r.shapeType.is(_)&&(h=t.Height/3,w=4*t.service.hiToTwips,t.service.pageStream.writeLine1(n.getRectString4(t.X,t.Y+h+w,t.Width,h-2*w)+s),t.service.pageStream.writeLine1(n.getEllipseString4(t.X+t.Width/2-h/2,t.Top-t.service.hiToTwips-h,h,h)+s),t.service.pageStream.writeLine1(n.getEllipseString4(t.X+t.Width/2-h/2,t.Y+2*t.service.hiToTwips,h,h)+s)),r.shapeType.is(j)&&(d=(t.Height-t.Height/6)/2,t.service.pageStream.writeLine1(n.getRectString4(t.X,t.Top-d,t.Width,d)+s),t.service.pageStream.writeLine1(n.getRectString4(t.X,t.Y,t.Width,d)+s)),r.shapeType.is(q)&&(t.service.pageStream.writeLine1("{0} {1} m {2} {3} l",t.service.convertToString(t.Right),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+s,t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Top-t.Height/5),t.service.convertToString(t.X+t.Width/5),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top))),r.shapeType.is(K))switch(r.shapeType.direction){case ct.Down:case ct.Up:t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l h "+s,t.service.convertToString(t.X),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y+t.Height/2)),t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l h "+s,t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y+t.Height/2),t.service.convertToString(t.Right),t.service.convertToString(t.Y));break;case ct.Left:case ct.Right:t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l h "+s,t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Top),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y+t.Height/2)),t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l h "+s,t.service.convertToString(t.Right),t.service.convertToString(t.Y),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y+t.Height/2),t.service.convertToString(t.Right),t.service.convertToString(t.Top));break}if(r.shapeType.is(J)&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Top-t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+s,t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top-t.Height/2),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Top-t.Height/2))),r.shapeType.is(Q)&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Top-t.Height/5)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+s,t.service.convertToString(t.Right),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Top-t.Height/5))),r.shapeType.is(Z)){var h=t.Height/5,u=t.Width/5;switch(r.shapeType.direction){case ct.Down:t.service.pageStream.writeLine1("{0} {1} m {2} {3} l",t.service.convertToString(t.X),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+s,t.service.convertToString(t.Right),t.service.convertToString(t.Y+h),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Y+h),t.service.convertToString(t.X),t.service.convertToString(t.Top));break;case ct.Up:t.service.pageStream.writeLine1("{0} {1} m {2} {3} l",t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Top-h)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+s,t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top-h),t.service.convertToString(t.Right),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Y));break;case ct.Left:t.service.pageStream.writeLine1("{0} {1} m {2} {3} l",t.service.convertToString(t.X+u),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+s,t.service.convertToString(t.Right),t.service.convertToString(t.Y),t.service.convertToString(t.X+u),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Top-t.Height/2),t.service.convertToString(t.X+u),t.service.convertToString(t.Top));break;case ct.Right:t.service.pageStream.writeLine1("{0} {1} m {2} {3} l",t.service.convertToString(t.X),t.service.convertToString(t.Top),t.service.convertToString(t.Right-u),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+s,t.service.convertToString(t.Right),t.service.convertToString(t.Top-t.Height/2),t.service.convertToString(t.Right-u),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Top));break}}if(r.shapeType.is($)){var u=t.Width/5,h=t.Height/5,S=t.Width/2,d=t.Height/2;switch(r.shapeType.direction){case ct.Left:case ct.Right:t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l",t.service.convertToString(t.X),t.service.convertToString(t.Top-d),t.service.convertToString(t.X+u),t.service.convertToString(t.Top),t.service.convertToString(t.Right-u),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+s,t.service.convertToString(t.Right),t.service.convertToString(t.Top-d),t.service.convertToString(t.Right-u),t.service.convertToString(t.Y),t.service.convertToString(t.X+u),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Top-d));break;case ct.Down:case ct.Up:t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l",t.service.convertToString(t.X+S),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top-h),t.service.convertToString(t.Right),t.service.convertToString(t.Y+h)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+s,t.service.convertToString(t.X+S),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Y+h),t.service.convertToString(t.X),t.service.convertToString(t.Top-h),t.service.convertToString(t.X+S),t.service.convertToString(t.Top));break}}r.shapeType.is(tt)&&(t.service.pageStream.writeLine1("{0} {1} m {2} {3} l",t.service.convertToString(t.X),t.service.convertToString(t.Top-t.Height/2),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+s,t.service.convertToString(t.Right),t.service.convertToString(t.Top-t.Height/2),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Top-t.Height/2),t.service.convertToString(t.Right),t.service.convertToString(t.Top-t.Height/2))),r.shapeType.is(et)&&(u=t.Width/7,h=t.Height/7,t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l {6} {7} l h",t.service.convertToString(t.X),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l {6} {7} l h "+s,t.service.convertToString(t.X+u),t.service.convertToString(t.Top-h),t.service.convertToString(t.X+u),t.service.convertToString(t.Y+h),t.service.convertToString(t.Right-u),t.service.convertToString(t.Y+h),t.service.convertToString(t.Right-u),t.service.convertToString(t.Top-h))),r.shapeType.is(rt)&&(h=t.Height/3,t.service.pageStream.writeLine1(n.getRectString4(t.X,t.Y+h,t.Width,h)+s)),r.shapeType.is(it)&&(u=t.Width/4,h=t.Height/4,t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Top-h)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l",t.service.convertToString(t.X+u),t.service.convertToString(t.Top),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Top-h),t.service.convertToString(t.Right-u),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top-h)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l",t.service.convertToString(t.Right-u),t.service.convertToString(t.Top-t.Height/2),t.service.convertToString(t.Right),t.service.convertToString(t.Y+h),t.service.convertToString(t.Right-u),t.service.convertToString(t.Y),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y+h)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l h "+s,t.service.convertToString(t.X+u),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Y+h),t.service.convertToString(t.X+u),t.service.convertToString(t.Top-t.Height/2))),r.shapeType.is(nt)&&(u=t.Width/7,h=t.Height/7,t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l {6} {7} l h "+s,t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.X+t.Width/5),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top),t.service.convertToString(t.Right-t.Width/5),t.service.convertToString(t.Y))),r.shapeType.is(ot)&&(u=t.Width/3,h=t.Height/3,t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+u),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l",t.service.convertToString(t.Right-u),t.service.convertToString(t.Top),t.service.convertToString(t.Right-u),t.service.convertToString(t.Top-h),t.service.convertToString(t.Right),t.service.convertToString(t.Top-h),t.service.convertToString(t.Right),t.service.convertToString(t.Y+h)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l",t.service.convertToString(t.Right-u),t.service.convertToString(t.Y+h),t.service.convertToString(t.Right-u),t.service.convertToString(t.Y),t.service.convertToString(t.X+u),t.service.convertToString(t.Y),t.service.convertToString(t.X+u),t.service.convertToString(t.Y+h)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+s,t.service.convertToString(t.X),t.service.convertToString(t.Y+h),t.service.convertToString(t.X),t.service.convertToString(t.Top-h),t.service.convertToString(t.X+u),t.service.convertToString(t.Top-h),t.service.convertToString(t.X+u),t.service.convertToString(t.Top))),r.shapeType.is(at)&&(S=t.Height/2.6,n=t.Width/5.5,t.service.pageStream.writeLine1("{0} {1} m {2} {3} l",t.service.convertToString(t.X),t.service.convertToString(t.Top-S),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+s,t.service.convertToString(t.Right),t.service.convertToString(t.Top-S),t.service.convertToString(t.Right-n),t.service.convertToString(t.Y),t.service.convertToString(t.X+n),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Top-S))),r.shapeType.is(st)&&(f=t.Width/4.75,t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l {6} {7} l h "+s,t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.X+f),t.service.convertToString(t.Top),t.service.convertToString(t.Right-f),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Y))),r.shapeType.is(lt)&&(u=t.Width/7.2,h=t.Height/4.6,t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l",t.service.convertToString(t.X),t.service.convertToString(t.Top-h),t.service.convertToString(t.X+u),t.service.convertToString(t.Top),t.service.convertToString(t.Right-u),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l h "+s,t.service.convertToString(t.Right),t.service.convertToString(t.Top-h),t.service.convertToString(t.Right),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Y))),r.shapeType.is(mt)&&(u=t.Width/7.2,h=t.Height/4.6,t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l",t.service.convertToString(t.X),t.service.convertToString(t.Top),t.service.convertToString(t.Right-u),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top-h)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l h "+s,t.service.convertToString(t.Right),t.service.convertToString(t.Y),t.service.convertToString(t.X+u),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Y+h))),t.service.pageStream.writeLine("Q")}else var b=e},o.renderRoundedRectanglePrimitive=function(t){var e=t.Component.as(w);if(null!=e){var r=new d(e.border.color,e.border.size,e.border.style),i=t.Component.as(u);if(i.style==F.None)return;var n=e.border.style!=F.None&&e.border.style!=F.Solid;n&&(t.service.pageStream.writeLine("q"),t.service.pushColorToStack());var o=this.storeBorderSideData(r,t),a=Math.min(t.Width<t.Height?t.Width:t.Height,100*t.Component.page.zoom)*i.round,s=a*(1-t.service.pdfCKT),l=t.X-o,m=t.X+t.Width+o,c=t.X+t.Width/2,p=t.Y-o,g=t.Y+t.Height+o,h,e,r,o;i.leftSide&&(i.bottomSide?(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(i.rightSide?c:m),t.service.convertToString(p)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(l+a),t.service.convertToString(p)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(l+s),t.service.convertToString(p),t.service.convertToString(l),t.service.convertToString(p+s),t.service.convertToString(l),t.service.convertToString(p+a))):t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(l),t.service.convertToString(p)),i.topSide?(t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(l),t.service.convertToString(g-a)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(l),t.service.convertToString(g-s),t.service.convertToString(l+s),t.service.convertToString(g),t.service.convertToString(l+a),t.service.convertToString(g)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(i.rightSide?c:m),t.service.convertToString(g))):t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(l),t.service.convertToString(g))),i.rightSide&&(i.bottomSide?(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(i.leftSide?c:l),t.service.convertToString(p)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(m-a),t.service.convertToString(p)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(m-s),t.service.convertToString(p),t.service.convertToString(m),t.service.convertToString(p+s),t.service.convertToString(m),t.service.convertToString(p+a))):t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(m),t.service.convertToString(p)),i.topSide?(t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(m),t.service.convertToString(g-a)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(m),t.service.convertToString(g-s),t.service.convertToString(m-s),t.service.convertToString(g),t.service.convertToString(m-a),t.service.convertToString(g)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(i.leftSide?c:l),t.service.convertToString(g))):t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(m),t.service.convertToString(g))),!i.topSide||i.leftSide||i.rightSide||(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(l),t.service.convertToString(g)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(m),t.service.convertToString(g))),!i.bottomSide||i.leftSide||i.rightSide||(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(l),t.service.convertToString(p)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(m),t.service.convertToString(p))),r.style==F.Double&&(s=(a-=2*o)*(1-t.service.pdfCKT),h=t.X+o,e=t.X+t.Width-o,r=t.Y+o,o=t.Y+t.Height-o,i.leftSide&&(i.bottomSide?(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(i.rightSide?c:m),t.service.convertToString(r)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(h+a),t.service.convertToString(r)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(h+s),t.service.convertToString(r),t.service.convertToString(h),t.service.convertToString(r+s),t.service.convertToString(h),t.service.convertToString(r+a))):t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(h),t.service.convertToString(p)),i.topSide?(t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(h),t.service.convertToString(o-a)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(h),t.service.convertToString(o-s),t.service.convertToString(h+s),t.service.convertToString(o),t.service.convertToString(h+a),t.service.convertToString(o)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(i.rightSide?c:m),t.service.convertToString(o))):t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(h),t.service.convertToString(g))),i.rightSide&&(i.bottomSide?(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(i.leftSide?c:l),t.service.convertToString(r)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(e-a),t.service.convertToString(r)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(e-s),t.service.convertToString(r),t.service.convertToString(e),t.service.convertToString(r+s),t.service.convertToString(e),t.service.convertToString(r+a))):t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(e),t.service.convertToString(p)),i.topSide?(t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(e),t.service.convertToString(o-a)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(e),t.service.convertToString(o-s),t.service.convertToString(e-s),t.service.convertToString(o),t.service.convertToString(e-a),t.service.convertToString(o)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(i.leftSide?c:l),t.service.convertToString(o))):t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(e),t.service.convertToString(g))),!i.topSide||i.leftSide||i.rightSide||(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(l),t.service.convertToString(o)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(m),t.service.convertToString(o))),!i.bottomSide||i.leftSide||i.rightSide||(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(l),t.service.convertToString(r)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(m),t.service.convertToString(r)))),n&&(t.service.pageStream.writeLine("Q"),t.service.popColorFromStack())}},o.renderCheckbox=function(t,e,r){void 0===r&&(r=!0);var i=t.Component.as(a);if(null!=i){var n=null;switch(e?i.checkStyleForTrue:i.checkStyleForFalse){case s.Cross:n="62.568 52.024 m 62.018 52.166 60.405 52.537 58.984 52.848 c 55.336 53.645 49.313 58.685 44.741 64.767 c 40.839 69.958 l 45.919 71.092 l \r\n"+"53.272 72.735 59.559 76.81 67.746 85.239 c 74.954 92.661 l 68.543 100.174 l 56.77 113.972 54.196 123.193 59.915 131.088 c 62.809 135.083 71.734 143.458 73.097 143.458 c \r\n"+"73.509 143.458 74.16 141.77 74.546 139.708 c 75.526 134.457 81.002 122.942 85.482 116.708 c 87.557 113.82 89.473 111.458 89.74 111.458 c \r\n"+"90.006 111.458 93.515 114.945 97.537 119.208 c 113.934 136.584 127.211 138.972 135.818 126.095 c 139.973 119.877 140.004 118.024 135.958 117.739 c \r\n"+"130.11 117.329 118.795 109.205 110.443 99.42 c 105.812 93.994 l 110.69 89.679 l 117.241 83.884 129.589 77.786 136.531 76.919 c \r\n"+"139.576 76.539 142.068 75.813 142.068 75.307 c 142.068 72.526 132.802 60.889 129.038 58.942 c 121.077 54.825 112.668 58.23 96.273 72.209 c \r\n"+"91.287 76.46 l 84.2 67.488 l 80.303 62.554 75.379 57.368 73.259 55.965 c 69.353 53.38 64.393 51.552 62.568 52.024 c h";break;case s.Check:n="60.972 37.503 m 51.173 63.277 43.562 76.623 35.37 82.397 c 30.912 85.54 l 33.664 88.435 l 37.539 92.513 43.698 95.935 48.566 96.713 c \r\n"+"52.426 97.33 53.024 97.093 57.102 93.334 c 59.763 90.882 63.368 85.726 66.269 80.223 c 68.899 75.234 71.18 71.153 71.337 71.153 c \r\n"+"71.493 71.153 73.65 74.19 76.13 77.903 c 96.259 108.044 129.683 141.214 157.565 158.718 c 166.414 164.274 l 168.677 161.643 l \r\n"+"170.941 159.012 l 163.178 152.717 l 139.859 133.81 108.017 94.486 89.043 61.164 c 82.362 49.432 81.87 48.851 73.952 43.345 c \r\n"+"69.45 40.214 64.908 37.04 63.858 36.292 c 62.149 35.074 61.848 35.2 60.972 37.503 c h";break;case s.CrossRectangle:n="24.153 97.958 m 24.153 170.458 l 98.653 170.458 l 173.153 170.458 l 173.153 97.958 l 173.153 25.458 l 98.653 25.458 l 24.153 25.458 l 24.153 97.958 l h \r\n"+"157.911 97.708 m 157.653 154.958 l 98.653 154.958 l 39.653 154.958 l 39.393 98.958 l 39.25 68.158 39.348 42.395 39.611 41.708 c \r\n"+"39.987 40.727 52.819 40.458 99.129 40.458 c 158.169 40.458 l 157.911 97.708 l h \r\n"+"67.337 54.521 m 65.513 54.912 62.41 56.378 60.442 57.778 c 57.123 60.14 48.153 70.186 48.153 71.541 c 48.153 71.87 50.57 72.68 53.525 73.342 c \r\n"+"60.71 74.95 67.272 79.277 75.328 87.718 c 82.003 94.713 l 75.624 102.027 l 64.931 114.288 61.644 123.705 65.472 131.108 c \r\n"+"67.054 134.168 78.562 145.458 80.098 145.458 c 80.556 145.458 81.245 143.77 81.63 141.708 c 82.611 136.457 88.086 124.942 92.567 118.708 c \r\n"+"94.642 115.82 96.558 113.458 96.824 113.458 c 97.091 113.458 100.6 116.945 104.622 121.208 c 121.019 138.584 134.296 140.972 142.903 128.095 c \r\n"+"147.058 121.877 147.089 120.024 143.043 119.739 c 137.213 119.33 124.806 110.39 117.127 101.066 c 113.226 96.33 113.155 96.112 114.876 94.198 c \r\n"+"118.066 90.648 128.579 83.654 133.847 81.578 c 136.682 80.461 141.285 79.244 144.077 78.873 c 146.868 78.503 149.153 77.878 149.153 77.484 c \r\n"+"149.153 75.37 140.777 64.275 137.501 62.048 c 129.107 56.344 120.869 59.278 103.358 74.209 c 98.372 78.46 l 91.285 69.488 l \r\n"+"81.563 57.18 74.76 52.928 67.337 54.521 c h";break;case s.CheckRectangle:n="19.915 96.5 m 19.915 169 l 91.857 169 l 163.8 169 l 170.357 173.111 l 176.914 177.223 l 178.882 174.861 l 179.963 173.563 180.864 172.217 180.882 171.872 c \r\n"+"180.9 171.526 178.44 169.334 175.415 167 c 169.915 162.757 l 169.915 93.378 l 169.915 24 l 94.915 24 l 19.915 24 l 19.915 96.5 l h \r\n"+"153.915 92.622 m 153.915 141.962 153.786 146.137 152.294 144.899 c 149.513 142.592 136.609 126.998 127.965 115.5 c 117.473 101.544 104.486 81.963 98.451 71 c \r\n"+"93.993 62.903 93.316 62.192 84.16 56 c 78.873 52.425 74.256 49.375 73.9 49.223 c 73.544 49.07 71.988 52.22 70.441 56.223 c \r\n"+"68.895 60.225 65.183 68.635 62.192 74.911 c 57.906 83.903 55.515 87.56 50.914 92.161 c 47.703 95.372 44.364 98 43.495 98 c \r\n"+"40.697 98 41.79 99.66 47.479 104.049 c 53.073 108.365 60.662 111.14 64.28 110.194 c 67.84 109.263 73.689 102.039 78.2 93.002 c \r\n"+"82.663 84.062 l 87.207 90.895 l 95.518 103.394 108.214 118.311 125.807 136.25 c 143.215 154 l 89.565 154 l 35.915 154 l 35.915 96.5 l \r\n"+"35.915 39 l 94.915 39 l 153.915 39 l 153.915 92.622 l h";break;case s.CrossCircle:n="83.347 26.864 m 61.07 31.95 42.193 47.128 32.202 67.986 c 23.401 86.36 23.68 110.034 32.919 128.958 c 41.882 147.315 60.868 162.86 80.847 168.201 c \r\n"+"91.083 170.936 112.112 170.628 121.812 167.6 c 147.999 159.425 167.881 138.673 173.432 113.721 c 175.869 102.768 175 85.662 171.452 74.743 c \r\n"+"164.795 54.256 145.804 35.792 124.126 28.729 c 117.735 26.647 113.94 26.133 102.847 25.845 c 93.814 25.61 87.363 25.947 83.347 26.864 c h \r\n"+"112.414 41.542 m 129.545 44.672 146.131 57.503 153.827 73.579 c 168.725 104.698 152.719 141.239 119.425 152.119 c 112.712 154.313 109.49 154.763 100.347 154.781 c \r\n"+"90.993 154.8 88.185 154.404 81.579 152.131 c 64.423 146.231 51.91 134.6 45.14 118.265 c 42.988 113.072 42.446 109.911 42.069 100.368 c \r\n"+"41.551 87.229 42.811 81.166 48.181 70.958 c 52.288 63.15 63.613 51.864 71.549 47.67 c 83.611 41.295 98.688 39.034 112.414 41.542 c h \r\n"+"69.097 66.583 m 66.21 69.342 63.847 71.942 63.847 72.361 c 63.847 72.78 69.506 78.671 76.422 85.451 c 88.996 97.78 l 76.198 110.607 l 63.4 123.434 l \r\n"+"68.336 128.446 l 71.051 131.202 73.641 133.458 74.091 133.458 c 74.542 133.458 80.666 127.846 87.7 120.988 c 100.49 108.517 l 104.919 113.071 l \r\n"+"107.354 115.575 113.31 121.259 118.154 125.701 c 126.961 133.777 l 132.308 128.496 l 137.656 123.215 l 124.694 110.658 l 111.733 98.1 l 124.866 84.939 l \r\n"+"137.999 71.779 l 132.815 67.118 l 129.964 64.555 127.11 62.458 126.474 62.458 c 125.837 62.458 119.93 67.858 113.347 74.458 c \r\n"+"106.765 81.058 100.96 86.458 100.449 86.458 c 99.938 86.458 93.856 80.857 86.933 74.013 c 74.347 61.567 l 69.097 66.583 l h";break;case s.DotCircle:n="81.653 29.406 m 59.375 34.493 40.499 49.67 30.507 70.529 c 21.706 88.903 21.985 112.576 31.224 131.5 c 40.187 149.857 59.173 165.402 79.153 170.743 c \r\n"+"89.388 173.479 110.417 173.17 120.117 170.142 c 146.304 161.968 166.186 141.215 171.737 116.263 c 174.174 105.311 173.305 88.205 169.757 77.285 c \r\n"+"163.1 56.798 144.109 38.334 122.431 31.271 c 116.04 29.189 112.245 28.675 101.153 28.387 c 92.119 28.152 85.668 28.49 81.653 29.406 c h \r\n"+"111.653 44.504 m 132.341 48.848 149.671 64.959 155.751 85.5 c 158.113 93.481 158.113 107.519 155.751 115.5 c 150.089 134.629 134.635 149.703 114.653 155.588 c \r\n"+"106.553 157.973 90.741 157.974 82.695 155.589 c 62.46 149.592 46.687 133.961 41.605 114.869 c 39.656 107.547 39.74 91.753 41.764 84.932 c \r\n"+"50.494 55.507 80.736 38.013 111.653 44.504 c h \r\n"+"90.005 77.33 m 76.55 82.362 69.825 98.176 75.898 110.5 c 78.035 114.836 83.045 119.856 87.653 122.277 c 93.231 125.208 104.066 125.204 109.705 122.27 c \r\n"+"127.735 112.887 128.781 89.485 111.62 79.428 c 106.047 76.162 95.789 75.166 90.005 77.33 c h";break;case s.DotRectangle:n="23.847 98.805 m 23.847 171.305 l 98.347 171.305 l 172.847 171.305 l 172.847 98.805 l 172.847 26.305 l 98.347 26.305 l 23.847 26.305 l 23.847 98.805 l h \r\n"+"157.847 98.813 m 157.847 156.321 l 98.597 156.063 l 39.347 155.805 l 39.089 98.555 l 38.831 41.305 l 98.339 41.305 l 157.847 41.305 l 157.847 98.813 l h \r\n"+"63.527 64.959 m 63.153 65.333 62.847 80.638 62.847 98.972 c 62.847 132.305 l 98.361 132.305 l 133.874 132.305 l 133.611 98.555 l 133.347 64.805 l \r\n"+"98.777 64.542 l 79.763 64.398 63.901 64.585 63.527 64.959 c h";break;case s.NoneCircle:n="83.5 29.406 m 61.222 34.493 42.346 49.67 32.355 70.529 c 23.554 88.903 23.832 112.576 33.071 131.5 c 42.034 149.857 61.02 165.402 81 170.743 c \r\n"+"91.235 173.479 112.265 173.17 121.965 170.142 c 148.151 161.968 168.034 141.215 173.585 116.263 c 176.022 105.311 175.152 88.205 171.605 77.285 c \r\n"+"164.948 56.798 145.957 38.334 124.278 31.271 c 117.887 29.189 114.092 28.675 103 28.387 c 93.966 28.152 87.515 28.49 83.5 29.406 c h \r\n"+"113.5 44.504 m 134.189 48.848 151.519 64.959 157.598 85.5 c 159.961 93.481 159.961 107.519 157.598 115.5 c 151.937 134.629 136.483 149.703 116.5 155.588 c \r\n"+"108.401 157.973 92.589 157.974 84.543 155.589 c 64.308 149.592 48.534 133.961 43.453 114.869 c 41.504 107.547 41.588 91.753 43.612 84.932 c \r\n"+"52.342 55.507 82.583 38.013 113.5 44.504 c h";break;case s.NoneRectangle:n="24.153 97.958 m 24.153 170.458 l 98.653 170.458 l 173.153 170.458 l 173.153 97.958 l 173.153 25.458 l 98.653 25.458 l 24.153 25.458 l 24.153 97.958 l h \r\n"+"157.911 97.708 m 157.653 154.958 l 98.653 154.958 l 39.653 154.958 l 39.393 98.958 l 39.25 68.158 39.348 42.395 39.611 41.708 c \r\n"+"39.987 40.727 52.819 40.458 99.129 40.458 c 158.169 40.458 l 157.911 97.708 l h";break}t.service.pageStream.writeLine("q"),t.service.pushColorToStack();var e=A.toColor(i.textBrush),r;0!=e.a&&t.service.setNonStrokeColor(e),(i.textBrush.is(T)||i.textBrush.is(P))&&(r&&t.service.storeShadingData2(t.X,t.Y,t.Width,t.Height,i.textBrush),t.service.pageStream.writeLine1("/Pattern cs /P{0} scn",1+t.service.shadingCurrent)),i.textBrush.is(L)&&(r=i.textBrush,t.service.pageStream.writeLine1("/Cs1 cs /PH{0} scn",t.service.getHatchNumber(r)+1)),t.service.setStrokeColor(i.contourColor),t.service.pageStream.writeLine1("{0} w",t.service.convertToString(i.size)),t.service.pageStream.writeLine1("1 0 0 1 {0} {1} cm",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y+t.Height/2));var o,i=Math.min(t.Width,t.Height)/200;t.service.pageStream.writeLine1("{0} 0 0 {0} 0 0 cm",t.service.convertToString(i)),t.service.pageStream.writeLine("1 0 0 1 -98 -98 cm"),t.service.pageStream.writeLine(n),t.service.pageStream.writeLine("B"),t.service.pageStream.writeLine("Q"),t.service.popColorFromStack()}},o.getCheckBoxValue=function(t){var e=null,r,i,n,e;return null!=t&&null!=t.checkedValue&&(e=!1,r=t.checkedValue.toString().trim().toLowerCase(),1==(i=t.values.split("/")).length&&(i=t.values.split(";")),1==i.length&&(i=t.values.split(",")),null!=i&&0<i.length&&(e=r==i[0].trim().toLowerCase())),e},r=o,y.StiPdfRenderPrimitives=r}(Stimulsoft=Stimulsoft||{}),function(_t){var t,e,r,jt,qt,Kt,Jt,Qt,Zt,$t,te,ee,re,ie,ne,oe,ae,se,le,me,ce,pe,ge,he,we;function i(){}e=t=_t.Report||(_t.Report={}),jt=r=e.Export||(e.Export={}),qt=_t.Base.Drawing.StiPenStyle,Kt=_t.Base.Drawing.StiAdvancedBorder,Jt=_t.System.StiArray,Qt=_t.System.StiString,Zt=_t.Report.Components.IStiTextBrush,$t=_t.Report.Components.IStiText,te=_t.Report.Components.IStiTextHorAlignment,ee=_t.Report.Components.IStiVertAlignment,re=_t.Report.Components.IStiTextOptions,ie=_t.Report.Components.IStiFont,ne=_t.Report.Components.StiText,oe=_t.Base.Drawing.StiTextHorAlignment,ae=_t.Base.Drawing.StiVertAlignment,se=_t.System.Drawing.Color,le=_t.Base.Drawing.StiBrush,me=_t.Base.Drawing.StiGradientBrush,ce=_t.Base.Drawing.StiGlareBrush,pe=_t.Base.Drawing.StiHatchBrush,ge=_t.System.Text.StringBuilder,he=_t.System.Char,we=_t.System.Drawing.Drawing2D.Matrix,i.renderText=function(t){var e=t.Component.as(Zt),r=t.Component.as($t),i=t.Component.as(re),n=t.Component.as(te),o=t.Component.as(ee),a=t.Component.as(ne),s=null!=i&&i.textOptions.wordWrap,l=null!=n&&n.horAlignment==oe.Width,m=t.service.haveAnnots&&a.editable,c=null!=i&&null!=i.textOptions&&i.textOptions.rightToLeft,p=null,g=0,h=0,w=a.textQuality==_t.Report.Components.StiTextQuality.Wysiwyg;l&&(s=!0);var d=t.service.pdfFont.UseUnicode;if(null!=r){var u=a.margins,S=this.hiToTwips*u.left,f=this.hiToTwips*u.right,v=this.hiToTwips*u.top,E=this.hiToTwips*u.bottom,b=t.X+S,y=t.Y+E,x=t.Width-S-f,A=t.Height-v-E,T=0,P=0,L=0,u=0,C;a.border.style!=qt.None&&(C=a.border.getSizeOffset(),a.border.isLeftBorderSidePresent&&(T=C),a.border.isRightBorderSidePresent&&(P=C),a.border.isTopBorderSidePresent&&(L=C),a.border.isBottomBorderSidePresent&&(u=C));var S=a.border.stimulsoft.as(Kt);null!=S&&(T=S.leftSide.getSizeOffset(),P=S.rightSide.getSizeOffset(),L=S.topSide.getSizeOffset(),u=S.bottomSide.getSizeOffset());var f=.94;b+=this.hiToTwips*f*T,y+=this.hiToTwips*f*u,x-=this.hiToTwips*f*(T+P),A-=this.hiToTwips*f*(L+u),m||(t.service.pageStream.writeLine("q"),t.service.pushColorToStack(),t.service.pageStream.writeLine1("{0} {1} {2} {3} re W n",t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.Width),t.service.convertToString(t.Height)));var v=se.transparent,F,R,v;null!=e&&(v=le.toColor(e.textBrush),t.service.setNonStrokeColor(v),t.service.storeShadingData2(t.X,t.Y,t.Width,t.Height,e.textBrush),(e.textBrush.is(me)||e.textBrush.is(ce))&&t.service.pageStream.writeLine1("/Pattern cs /P{0} scn",1+t.service.shadingCurrent),e.textBrush.is(pe)&&(F=e.textBrush.as(pe),t.service.pageStream.writeLine1("/Cs1 cs /PH{0} scn",t.service.getHatchNumber(F)+1)),m&&((R=t.service.annotsArray[t.service.annotsCurrent]).FontColor=v));var I=1,B=t.Component.as(ie);null!=B&&(I=B.font.sizeInPoints);var E=1,C=I*this.fontCorrectValue*t.service.pdfFont.tmASC/1e3*E,S=I*this.fontCorrectValue*t.service.pdfFont.tmDESC/1e3*-1*E,T=I*this.fontCorrectValue*t.service.pdfFont.tmExternal/1e3*E,P=I*this.fontCorrectValue*t.service.pdfFont.UnderscoreSize/1e3*E,f=I*this.fontCorrectValue*t.service.pdfFont.UnderscorePosition/1e3*E,L=I*this.fontCorrectValue*t.service.pdfFont.StrikeoutSize/1e3*E,u=I*this.fontCorrectValue*t.service.pdfFont.StrikeoutPosition/1e3*E,D=(C-S+T)*a.lineSpacing,F=C,E=S,T=!1;null!=i&&(T=45<(h=i.textOptions.angle)&&h<135||225<h&&h<315),m&&(b-=t.X,y-=t.Y);var k=.85,N=0,O,N,M,O;a.textQuality==_t.Report.Components.StiTextQuality.Standard&&(O=.35-.04*(14-I),M=(N=137.61)*(I*this.fontCorrectValue)/1e3,T?(y+=O+M,A-=2*(O+M)):(b+=O+M,x-=2*(O+M))),a.textQuality==_t.Report.Components.StiTextQuality.Typographic&&(O=.05+.009*(8-I),T?(y+=O,A-=2*O):(b+=O,x-=2*O));var C=r.text,R,H;if(null==C&&(C=""),C=t.service.stringReplace(C,"\r",""),C=t.service.stringReplace(C,"",""),m&&(p=t.service.stringReplace(r.text,"\n","")),0<x&&0<C.length){var S=b,M=y,O=x,r=A,T,x,A,h;null!=i&&0!=(h=i.textOptions.angle)&&(T&&(T=x,x=A,A=T),b=-x/2,y=-A/2);var U=jt.StiExportUtils.splitString(C,!1);if(s)for(var z=0,X;z<U.length;z++){if((X=U[z]).length<2)continue;var W=new ge,Y=0;while(Y<X.length)if(he.isWhitespace(X,Y))W.append(X.charAt(Y)),Y++;else{var G=new ge;while(Y<X.length&&!he.isWhitespace(X,Y))G.append(X.charAt(Y)),Y++;var V=t.service.bidi.convert(G,!1);W.append(V);var V=G.length-V.length;0<V&&W.append(Qt.repeat(String.fromCharCode(0),V))}for(var _=[],j=W.toString(),q=0;q<X.length;q++)_[q]=t.service.pdfFont.UnicodeMap[j.charCodeAt(q)];for(var K=Jt.create(Number,X.length),J=Jt.create(Number,X.length),Q=0,Z=0,$=0,tt;$<_.length;$++)32<=_[$]&&(Z+=t.service.pdfFont.Widths[_[$]-32]),9==_[$]&&(Z+=this.getTabsSize(i,I,Z+N)+N),K[$]=Math.trunc(Z),this.isWordWrapSymbol(j,$)&&0<$&&Q++,J[$]=Q;if(x<Z*(I*this.fontCorrectValue)/1e3){var $=X.length-1,et=Math.trunc(1e3*x/(I*this.fontCorrectValue));while(K[$]>et&&0<$)$--;var rt=$;if(0<J[$])if(J[$]!=J[$+1]){rt=$++;while(he.isWhitespace(j,$)&&"\t"!=j.charAt($))$++}else{while(!this.isWordWrapSymbol(j,$))$--;rt=$-1;while(he.isWhitespace(j,rt)&&0<rt)rt--;while(he.isWhitespace(j,$)&&"\t"!=j.charAt($))$++}else $++;U[z]=l?X.substr(0,rt+1)+String.fromCharCode(7):X.substr(0,rt+1),U.stimulsoft.insert(z+1,X.substr($,X.length-$).stimulsoft.trimStart(" "))}}g=U.length;for(var it=-1,z=0,nt,C,o;z<U.length;z++){for(var X=U[z],ot=t.service.bidi.convert(new ge(X),c).toString(),at="",$=0;$<ot.length;$++)at+=String.fromCharCode(t.service.pdfFont.UnicodeMap[ot.charCodeAt($)]);U[z]=at}null!=o&&(C=g*D,o=o.vertAlignment,0!=h&&90!=h&&180!=h&&270!=h&&(o=ae.Center),o==ae.Top&&(y+=A-C+(D-F)),o==ae.Center&&(a.textQuality==_t.Report.Components.StiTextQuality.Typographic?y+=(A-C)/2-E:y+=(A-C)/2+1.2*(D-F)),o==ae.Bottom&&(a.textQuality==_t.Report.Components.StiTextQuality.Typographic?y+=-E:y+=1.4*(D-F))),t.service.pageStream.writeLine("BT");var st=0,lt=0,mt=Jt.create2(Number,U.length,3),ct=null,pt,ct;0!=h&&(pt=h*Math.PI/180,ct=new we(Math.cos(pt),Math.sin(pt),-Math.sin(pt),Math.cos(pt),S+O/2,M+r/2),t.service.pdfFont.NeedSyntItalic&&null!=B&&B.font.italic||t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} Tm",t.service.convertToString(ct.elements[0]),t.service.convertToString(ct.elements[1]),t.service.convertToString(ct.elements[2]),t.service.convertToString(ct.elements[3]),t.service.convertToString(ct.elements[4]),t.service.convertToString(ct.elements[5]))),t.service.pdfFont.NeedSyntBold&&null!=B&&B.font.bold&&(t.service.pageStream.writeLine1("{0} w 2 Tr",t.service.convertToString(this.boldFontStrokeWidthValue*I,3)),t.service.setStrokeColor(v));for(var z=0;z<g;z++){for(var X=U[z],gt=Jt.create(Number,X.length),ht=0,Z=0,wt=0,dt=1e3*x/(I*this.fontCorrectValue),ut=t.service.pdfFont.Widths[t.service.pdfFont.UnicodeMap["".charCodeAt(0)]],St=0,$=0;$<X.length;$++){var ft=X.charCodeAt($),ft;32<=ft&&(Z+=t.service.pdfFont.Widths[ft-32]),9==ft&&(Z+=ft=this.getTabsSize(i,I,Z),gt[ht++]=ft),Z+ut<dt&&(wt=Z,St=$)}if(Z=Z*(I*this.fontCorrectValue)/1e3,-1!=it&&(z==g-1&&it<U.length||x<Z)&&(X=X.substr(0,St)+String.fromCharCode(t.service.pdfFont.UnicodeMap["".charCodeAt(0)]),Z=(wt+ut)*(I*this.fontCorrectValue)/1e3),d){for(var W=new ge,$=0;$<X.length;$++){$%121==120&&W.appendLine("\r");var vt=X.charCodeAt($),vt;32==vt||9==vt||7==vt?W.append(X.charAt($)):(65535==(vt=t.service.pdfFont.GlyphList[vt])&&(vt=0),W.appendFormat("{0:X4}",vt))}X=W.toString()}else X=jt.StiPdfExportService.convertToEscapeSequence(X);var Et=b,bt=y+D*(g-z-1),yt=!1,xt=!1;if(null!=n){var H=n.horAlignment;if(l&&(0<X.length&&7===X.charCodeAt(X.length-1)?X=X.substr(0,X.length-1):H=oe.Left),null!=i&&null!=i.textOptions&&i.textOptions.rightToLeft&&(H==oe.Left?H=oe.Right:H==oe.Right&&(H=oe.Left)),H==oe.Center&&(Et+=(x-Z)/2),H==oe.Right&&(Et+=x-Z),H==oe.Width){for(var At=0,Tt=0;Tt<X.length;Tt++)32===X.charCodeAt(Tt)&&At++;if(0<At&&(z!=U.length-1||w&&x<Z)){xt=!0;var Pt=(x-Z)/At*1e3/(I*this.fontCorrectValue);if(0<Pt||w){yt=!0,(Pt+=t.service.pdfFont.Widths[0])<.5*t.service.pdfFont.Widths[0]&&(Pt=.5*t.service.pdfFont.Widths[0]);for(var Lt=d?"<":"(",Ct=0;Ct<X.length;Ct++)32===X.charCodeAt(Ct)?Lt+=d?">-"+t.service.convertToString(Pt)+"<":")-"+t.service.convertToString(Pt)+"(":Lt+=X[Ct];X=Lt+=d?">":")"}}}}if(0<ht){var Ft=0,Rt="";0==xt&&(Rt+=d?"<":"(");for(var Ct=0,It;Ct<X.length;Ct++){"\t"==X[Ct]?(It=gt[Ft++],Rt+=d?">-"+t.service.convertToString(It)+"<":")-"+t.service.convertToString(It)+"("):Rt+=X[Ct]}0==xt&&(Rt+=d?">":")"),X=Rt}d&&(X=t.service.stringReplace(X," ",t.service.pdfFont.GlyphList[32].toString(16).stimulsoft.padLeft(4,"0")).stimulsoft.replaceAll("a","0000"));for(var Bt=null!=t.service.pdfFont.ChildFontsMap,Dt=0,_=Jt.create(Number,X.length),kt=new Array,q=0,xt;q<X.length;q++){var Nt=X.charCodeAt(q),Ot=!1,Mt,Ht;13==(_[q]=Nt)&&(kt.push(q),Ot=!0),Bt&&(Mt=t.service.pdfFont.UnicodeMapBack[Nt],92==Nt&&(Mt=t.service.pdfFont.UnicodeMapBack[X.charCodeAt(q+1)]),Ht=t.service.pdfFont.ChildFontsMap[Mt],Mt<64&&(0<q?Ht=Dt:1<X.length&&(Ht=t.service.pdfFont.ChildFontsMap[t.service.pdfFont.UnicodeMapBack[X.charCodeAt(1)]])),92!=Nt&&(_[q]=t.service.pdfFont.fonts[Ht].UnicodeMap[Mt]),Ht==Dt||Ot||0==q||kt.push(q),Dt=Ht)}kt.push(X.length),mt[z][0]=Et,mt[z][1]=bt,mt[z][2]=Z,t.service.pdfFont.NeedSyntItalic&&null!=B&&B.font.italic?(xt=new we(1,0,this.italicAngleTanValue,1,Et,bt),null!=ct&&xt.multiply(xt),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} Tm",t.service.convertToString(xt.elements[0]),t.service.convertToString(xt.elements[1]),t.service.convertToString(xt.elements[2]),t.service.convertToString(xt.elements[3]),t.service.convertToString(xt.elements[4]),t.service.convertToString(xt.elements[5]))):(t.service.pageStream.writeLine1("{0} {1} Td",t.service.convertToString(Et-st),t.service.convertToString(bt-lt)),st=Et,lt=bt);for(var Ut=0,zt=0,Xt,Ht;zt<kt.length;zt++){Bt&&0<X.length&&(Xt=X.charCodeAt(Ut)<64&&X.length>Ut+1?Ut+1:Ut,Ht=t.service.pdfFont.ChildFontsMap[t.service.pdfFont.UnicodeMapBack[X.charCodeAt(Xt)]],t.service.pageStream.writeLine1("/F{0} {1} Tf",Ht,t.service.convertToString(I*this.fontCorrectValue,this.precision_digits_font)));var Wt=kt[zt],Xt=Wt-Ut;0<Xt&&(yt||0<ht?(t.service.pageStream.writeString("["),0<zt&&t.service.pageStream.writeString(d?"<":"("),t.service.pageStream.write(_,Ut,Xt),zt<kt.length-1&&t.service.pageStream.writeString(d?">":")"),t.service.pageStream.writeLine("] TJ")):(t.service.pageStream.writeString(d?"<":"("),t.service.pageStream.write(_,Ut,Xt),t.service.pageStream.writeLine1("{0} Tj",d?">":")"))),(Ut=Wt)<_.length-1&&13==_[Wt]&&Ut++}}if(t.service.pdfFont.NeedSyntBold&&null!=B&&B.font.bold&&t.service.pageStream.writeLine("0 Tr"),t.service.pageStream.writeLine("ET"),null!=B&&B.font.underline){t.service.pageStream.writeLine("q"),t.service.pushColorToStack();var Yt=.07*I,Gt=.1*-I,pt;0!=t.service.pdfFont.UnderscoreSize&&(Yt=P,Gt=f),Yt<.1&&(Yt=.1),t.service.pageStream.writeLine1("{0} w",t.service.convertToString(Yt)),0!=h&&(pt=h*Math.PI/180,t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} cm",t.service.convertToString(Math.cos(pt)),t.service.convertToString(Math.sin(pt)),t.service.convertToString(-Math.sin(pt)),t.service.convertToString(Math.cos(pt)),t.service.convertToString(S+O/2),t.service.convertToString(M+r/2))),null!=e&&t.service.setStrokeColor(v);for(var q=0;q<U.length;q++)0!=mt[q][2]&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(mt[q][0]),t.service.convertToString(mt[q][1]+Gt)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(mt[q][0]+mt[q][2]),t.service.convertToString(mt[q][1]+Gt)));t.service.pageStream.writeLine("Q"),t.service.popColorFromStack()}if(null!=B&&B.font.strikeout){t.service.pageStream.writeLine("q"),t.service.pushColorToStack();var Yt=.045*I,Vt=.25*I,pt;0!=t.service.pdfFont.StrikeoutSize&&(Yt=L,Vt=u),Yt<.1&&(Yt=.1),t.service.pageStream.writeLine1("{0} w",t.service.convertToString(Yt)),0!=h&&(pt=h*Math.PI/180,t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} cm",t.service.convertToString(Math.cos(pt)),t.service.convertToString(Math.sin(pt)),t.service.convertToString(-Math.sin(pt)),t.service.convertToString(Math.cos(pt)),t.service.convertToString(S+O/2),t.service.convertToString(M+r/2))),null!=e&&t.service.setStrokeColor(v);for(var q=0;q<U.length;q++)0!=mt[q][2]&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(mt[q][0]),t.service.convertToString(mt[q][1]+Vt)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(mt[q][0]+mt[q][2]),t.service.convertToString(mt[q][1]+Vt)));t.service.pageStream.writeLine("Q"),t.service.popColorFromStack()}}m&&((R=t.service.annotsArray[t.service.annotsCurrent]).Multiline=s,R.X=t.X,R.Y=t.Y,R.Width=t.Width,R.Height=t.Height,R.Text=p,R.Component=t.Component,R.Alignment=oe.Left,null!=n&&(H=n.horAlignment,null!=i&&null!=i.textOptions&&i.textOptions.rightToLeft&&(H==oe.Left?H=oe.Right:H==oe.Right&&(H=oe.Left)),R.Alignment=H)),m||(t.service.pageStream.writeLine("Q"),t.service.popColorFromStack())}},i.isWordWrapSymbol=function(t,e){var r=t.charCodeAt(e),i=t.charAt(e);if(12288<=r&&r<=55215||he.isWhitespace(t,e)&&160!=r||"("==i||"{"==i)return!0;if(0<e){var e=t.charAt(e-1);if("!"==e||"%"==e||")"==e||"}"==e||"-"==e||"?"==e)return!0}return!1},i.getTabsSize=function(t,e,r){if(null!=t&&null!=t.textOptions){var i=r,n=750/e,e=n*t.textOptions.distanceBetweenTabs,n=n*t.textOptions.firstTabOffset+e,t,i;return r<n?i=n:0<t.textOptions.distanceBetweenTabs&&(t=Math.trunc((r-n)/e),i=n+ ++t*e),i-r}return 0},i.renderTextFont=function(t){var e=t.Component.as(ie),r,e,t;null!=e&&(r=t.service.pdfFont.getFontNumber(e.font),e=e.font.sizeInPoints*this.fontCorrectValue,t.service.pageStream.writeLine1("/F{0} {1} Tf",r,t.service.convertToString(e,this.precision_digits_font)),t.service.pdfFont.currentFont=r,t.service.haveAnnots&&t.Component.as(ne).editable&&((t=t.service.annotsArray[t.service.annotsCurrent]).FontNumber=r,t.FontSize=e))},i.hiToTwips=.72,i.precision_digits_font=3,i.fontCorrectValue=.955,i.boldFontStrokeWidthValue=.031,i.italicAngleTanValue=.325,e=i,jt.StiPdfRenderText=e}(Stimulsoft=Stimulsoft||{}),function(t){var e,r,i,t;function n(){}r=e=t.Report||(t.Report={}),t=i=r.Export||(r.Export={}),Object.defineProperty(n,"standardFontCharsNames",{get:function(){if(null==this._standardFontCharsNames){var t=["0020space","0021exclam","0022quotedbl","0023numbersign","0024dollar","0025percent","0026ampersand","0027quotesingle","0028parenleft","0029parenright","002Aasterisk","002Bplus","002Ccomma","002Dhyphen","002Eperiod","002Fslash","0030zero","0031one","0032two","0033three","0034four","0035five","0036six","0037seven","0038eight","0039nine","003Acolon","003Bsemicolon","003Cless","003Dequal","003Egreater","003Fquestion","0040at","0041A","0042B","0043C","0044D","0045E","0046F","0047G","0048H","0049I","004AJ","004BK","004CL","004DM","004EN","004FO","0050P","0051Q","0052R","0053S","0054T","0055U","0056V","0057W","0058X","0059Y","005AZ","005Bbracketleft","005Cbackslash","005Dbracketright","005Easciicircum","005Funderscore","0060grave","0061a","0062b","0063c","0064d","0065e","0066f","0067g","0068h","0069i","006Aj","006Bk","006Cl","006Dm","006En","006Fo","0070p","0071q","0072r","0073s","0074t","0075u","0076v","0077w","0078x","0079y","007Az","007Bbraceleft","007Cbar","007Dbraceright","007Easciitilde","007FcontrolDEL","00A0nbspace","00A1exclamdown","00A2cent","00A3sterling","00A4currency","00A5yen","00A6brokenbar","00A7section","00A8dieresis","00A9copyright","00AAordfeminine","00ABguillemotleft","00AClogicalnot","00ADsofthyphen","00AEregistered","00AFmacron","00B0degree","00B1plusminus","00B2twosuperior","00B3threesuperior","00B4acute","00B5mu","00B6paragraph","00B7periodcentered","00B8cedilla","00B9onesuperior","00BAordmasculine","00BBguillemotright","00BConequarter","00BDonehalf","00BEthreequarters","00BFquestiondown","00C0Agrave","00C1Aacute","00C2Acircumflex","00C3Atilde","00C4Adieresis","00C5Aring","00C6AE","00C7Ccedilla","00C8Egrave","00C9Eacute","00CAEcircumflex","00CBEdieresis","00CCIgrave","00CDIacute","00CEIcircumflex","00CFIdieresis","00D0Eth","00D1Ntilde","00D2Ograve","00D3Oacute","00D4Ocircumflex","00D5Otilde","00D6Odieresis","00D7multiply","00D8Oslash","00D9Ugrave","00DAUacute","00DBUcircumflex","00DCUdieresis","00DDYacute","00DEThorn","00DFgermandbls","00E0agrave","00E1aacute","00E2acircumflex","00E3atilde","00E4adieresis","00E5aring","00E6ae","00E7ccedilla","00E8egrave","00E9eacute","00EAecircumflex","00EBedieresis","00ECigrave","00EDiacute","00EEicircumflex","00EFidieresis","00F0eth","00F1ntilde","00F2ograve","00F3oacute","00F4ocircumflex","00F5otilde","00F6odieresis","00F7divide","00F8oslash","00F9ugrave","00FAuacute","00FBucircumflex","00FCudieresis","00FDyacute","00FEthorn","00FFydieresis","0100Amacron","0101amacron","0102Abreve","0103abreve","0104Aogonek","0105aogonek","0106Cacute","0107cacute","0108Ccircumflex","0109ccircumflex","010ACdotaccent","010Bcdotaccent","010CCcaron","010Dccaron","010EDcaron","010Fdcaron","0110Dcroat","0111dcroat","0112Emacron","0113emacron","0114Ebreve","0115ebreve","0116Edotaccent","0117edotaccent","0118Eogonek","0119eogonek","011AEcaron","011Becaron","011CGcircumflex","011Dgcircumflex","011EGbreve","011Fgbreve","0120Gdotaccent","0121gdotaccent","0122Gcommaaccent","0123gcommaaccent","0124Hcircumflex","0125hcircumflex","0126Hbar","0127hbar","0128Itilde","0129itilde","012AImacron","012Bimacron","012CIbreve","012Dibreve","012EIogonek","012Fiogonek","0130Idotaccent","0131dotlessi","0132IJ","0133ij","0134Jcircumflex","0135jcircumflex","0136Kcommaaccent","0137kcommaaccent","0138kgreenlandic","0139Lacute","013Alacute","013BLcommaaccent","013Clcommaaccent","013DLcaron","013Elcaron","013FLdot","0140ldot","0141Lslash","0142lslash","0143Nacute","0144nacute","0145Ncommaaccent","0146ncommaaccent","0147Ncaron","0148ncaron","0149napostrophe","014AEng","014Beng","014COmacron","014Domacron","014EObreve","014Fobreve","0150Ohungarumlaut","0151ohungarumlaut","0152OE","0153oe","0154Racute","0155racute","0156Rcommaaccent","0157rcommaaccent","0158Rcaron","0159rcaron","015ASacute","015Bsacute","015CScircumflex","015Dscircumflex","015EScedilla","015Fscedilla","0160Scaron","0161scaron","0162Tcommaaccent","0163tcommaaccent","0164Tcaron","0165tcaron","0166Tbar","0167tbar","0168Utilde","0169utilde","016AUmacron","016Bumacron","016CUbreve","016Dubreve","016EUring","016Furing","0170Uhungarumlaut","0171uhungarumlaut","0172Uogonek","0173uogonek","0174Wcircumflex","0175wcircumflex","0176Ycircumflex","0177ycircumflex","0178Ydieresis","0179Zacute","017Azacute","017BZdotaccent","017Czdotaccent","017DZcaron","017Ezcaron","017Flongs","0180bstroke","0181Bhook","0182Btopbar","0183btopbar","0184Tonesix","0185tonesix","0186Oopen","0187Chook","0188chook","0189Dafrican","018ADhook","018BDtopbar","018Cdtopbar","018Ddeltaturned","018EEreversed","018FSchwa","0190Eopen","0191Fhook","0192florin","0193Ghook","0194Gammaafrican","0195hv","0196Iotaafrican","0197Istroke","0198Khook","0199khook","019Albar","019Blambdastroke","019CMturned","019DNhookleft","019Enlegrightlong","019FOcenteredtilde","01A0Ohorn","01A1ohorn","01A2Oi","01A3oi","01A4Phook","01A5phook","01A6yr","01A7Tonetwo","01A8tonetwo","01A9Esh","01AAeshreversedloop","01ABtpalatalhook","01ACThook","01ADthook","01AETretroflexhook","01AFUhorn","01B0uhorn","01B1Upsilonafrican","01B2Vhook","01B3Yhook","01B4yhook","01B5Zstroke","01B6zstroke","01B7Ezh","01B8Ezhreversed","01B9ezhreversed","01BAezhtail","01BBtwostroke","01BCTonefive","01BDtonefive","01BEglottalinvertedstroke","01BFwynn","01C0clickdental","01C1clicklateral","01C2clickalveolar","01C3clickretroflex","01C4DZcaron","01C5Dzcaron","01C6dzcaron","01C7LJ","01C8Lj","01C9lj","01CANJ","01CBNj","01CCnj","01CDAcaron","01CEacaron","01CFIcaron","01D0icaron","01D1Ocaron","01D2ocaron","01D3Ucaron","01D4ucaron","01F0jcaron","01F1DZ","01F2Dz","01F3dz","01F4Gacute","01F5gacute","01FAAringacute","01FBaringacute","01FCAEacute","01FDaeacute","01FEOslashacute","01FFoslashacute","0254oopen","0255ccurl","0256dtail","0257dhook","0258ereversed","0259schwa","025Aschwahook","025Beopen","025Fjdotlessstroke","0260ghook","0261gscript","0264ramshorn","0265hturned","0266hhook","0267henghook","0268istroke","0269iotalatin","026Clbelt","026Elezh","026Fmturned","0271mhook","0272nhookleft","0275obarred","0278philatin","0279rturned","027Brhookturned","027Crlongleg","027Drhook","027Erfishhook","0282shook","0283esh","0286eshcurl","0287tturned","0289ubar","028Bvhook","028Cvturned","028Dwturned","028Eyturned","0290zretroflexhook","0291zcurl","0292ezh","0293ezhcurl","0294glottalstop","02A3dzaltone","02A4dezh","02A5dzcurl","02A6ts","02A7tesh","02A8tccurl","02D6plusmod","02D7minusmod","02D8breve","02D9dotaccent","02DAring","02DBogonek","02DCtilde","0391Alpha","0392Beta","0393Gamma","0394Deltagreek","0395Epsilon","0396Zeta","0397Eta","0398Theta","0399Iota","039AKappa","039BLambda","039CMu","039DNu","039EXi","039FOmicron","03A0Pi","03A1Rho","03A3Sigma","03A4Tau","03A5Upsilon","03A6Phi","03A7Chi","03A8Psi","03A9Omegagreek","03AAIotadieresis","03ABUpsilondieresis","03ACalphatonos","03ADepsilontonos","03AEetatonos","03AFiotatonos","03B0upsilondieresistonos","03B1alpha","03B2beta","03B3gamma","03B4delta","03B5epsilon","03B6zeta","03B7eta","03B8theta","03B9iota","03BAkappa","03BBlambda","03BCmu","03BDnu","03BExi","03BFomicron","03C0pi","03C1rho","03C2sigma1","03C3sigma","03C4tau","03C5upsilon","03C6phi","03C7chi","03C8psi","03C9omega","03CAiotadieresis","03CBupsilondieresis","03CComicrontonos","03CDupsilontonos","03CEomegatonos","03D0betasymbolgreek","03D1theta1","03D2Upsilon1","03D5phi1","03D6omega1","03DAStigmagreek","03DCDigammagreek","03DEKoppagreek","03E0Sampigreek","03E2Sheicoptic","03E3sheicoptic","03E4Feicoptic","03E5feicoptic","03E6Kheicoptic","03E7kheicoptic","03E8Horicoptic","03E9horicoptic","03EAGangiacoptic","03EBgangiacoptic","03ECShimacoptic","03EDshimacoptic","03EEDeicoptic","03EFdeicoptic","03F0kappasymbolgreek","03F1rhosymbolgreek","03F3yotgreek","0401afii10023","0402afii10051","0403afii10052","0404afii10053","0405afii10054","0406afii10055","0407afii10056","0408afii10057","0409afii10058","040Aafii10059","040Bafii10060","040Cafii10061","040Eafii10062","040Fafii10145","0410afii10017","0411afii10018","0412afii10019","0413afii10020","0414afii10021","0415afii10022","0416afii10024","0417afii10025","0418afii10026","0419afii10027","041Aafii10028","041Bafii10029","041Cafii10030","041Dafii10031","041Eafii10032","041Fafii10033","0420afii10034","0421afii10035","0422afii10036","0423afii10037","0424afii10038","0425afii10039","0426afii10040","0427afii10041","0428afii10042","0429afii10043","042Aafii10044","042Bafii10045","042Cafii10046","042Dafii10047","042Eafii10048","042Fafii10049","0430afii10065","0431afii10066","0432afii10067","0433afii10068","0434afii10069","0435afii10070","0436afii10072","0437afii10073","0438afii10074","0439afii10075","043Aafii10076","043Bafii10077","043Cafii10078","043Dafii10079","043Eafii10080","043Fafii10081","0440afii10082","0441afii10083","0442afii10084","0443afii10085","0444afii10086","0445afii10087","0446afii10088","0447afii10089","0448afii10090","0449afii10091","044Aafii10092","044Bafii10093","044Cafii10094","044Dafii10095","044Eafii10096","044Fafii10097","0451afii10071","0452afii10099","0453afii10100","0454afii10101","0455afii10102","0456afii10103","0457afii10104","0458afii10105","0459afii10106","045Aafii10107","045Bafii10108","045Cafii10109","045Eafii10110","045Fafii10193","0462afii10146","0463afii10194","0472afii10147","0473afii10195","0474afii10148","0475afii10196","0490afii10050","0491afii10098","04D9afii10846","060Cafii57388","061Bafii57403","061Fafii57407","0621afii57409","0622afii57410","0623afii57411","0624afii57412","0625afii57413","0626afii57414","0627afii57415","0628afii57416","0629afii57417","062Aafii57418","062Bafii57419","062Cafii57420","062Dafii57421","062Eafii57422","062Fafii57423","0630afii57424","0631afii57425","0632afii57426","0633afii57427","0634afii57428","0635afii57429","0636afii57430","0637afii57431","0638afii57432","0639afii57433","063Aafii57434","0640afii57440","0641afii57441","0642afii57442","0643afii57443","0644afii57444","0645afii57445","0646afii57446","0647afii57470","0648afii57448","0649afii57449","064Aafii57450","064Bafii57451","064Cafii57452","064Dafii57453","064Eafii57454","064Fafii57455","0650afii57456","0651afii57457","0652afii57458","0660afii57392","0661afii57393","0662afii57394","0663afii57395","0664afii57396","0665afii57397","0666afii57398","0667afii57399","0668afii57400","0669afii57401","066Aafii57381","066Bdecimalseparatorarabic","066Cthousandsseparatorarabic","066Dafii63167","0679afii57511","067Eafii57506","0686afii57507","0688afii57512","0691afii57513","0698afii57508","06A4afii57505","06AFafii57509","06BAafii57514","06C1hehaltonearabic","06D1yehthreedotsbelowarabic","06D2afii57519","06D5afii57534","06F0zeropersian","06F1onepersian","06F2twopersian","06F3threepersian","06F4fourpersian","06F5fivepersian","06F6sixpersian","06F7sevenpersian","06F8eightpersian","06F9ninepersian","1E00Aringbelow","1E01aringbelow","1E02Bdotaccent","1E03bdotaccent","1E04Bdotbelow","1E05bdotbelow","1E06Blinebelow","1E07blinebelow","1E08Ccedillaacute","1E09ccedillaacute","1E0ADdotaccent","1E0Bddotaccent","1E0CDdotbelow","1E0Dddotbelow","1E0EDlinebelow","1E0Fdlinebelow","1E10Dcedilla","1E11dcedilla","1E12Dcircumflexbelow","1E13dcircumflexbelow","1E14Emacrongrave","1E15emacrongrave","1E16Emacronacute","1E17emacronacute","1E18Ecircumflexbelow","1E19ecircumflexbelow","1E1AEtildebelow","1E1Betildebelow","1E1CEcedillabreve","1E1Decedillabreve","1E1EFdotaccent","1E1Ffdotaccent","1E20Gmacron","1E21gmacron","1E22Hdotaccent","1E23hdotaccent","1E24Hdotbelow","1E25hdotbelow","1E26Hdieresis","1E27hdieresis","1E28Hcedilla","1E29hcedilla","1E2AHbrevebelow","1E2Bhbrevebelow","1E2CItildebelow","1E2Ditildebelow","1E2EIdieresisacute","1E2Fidieresisacute","1E30Kacute","1E31kacute","1E32Kdotbelow","1E33kdotbelow","1E34Klinebelow","1E35klinebelow","1E36Ldotbelow","1E37ldotbelow","1E38Ldotbelowmacron","1E39ldotbelowmacron","1E3ALlinebelow","1E3Bllinebelow","1E3CLcircumflexbelow","1E3Dlcircumflexbelow","1E3EMacute","1E3Fmacute","1E40Mdotaccent","1E41mdotaccent","1E42Mdotbelow","1E43mdotbelow","1E44Ndotaccent","1E45ndotaccent","1E46Ndotbelow","1E47ndotbelow","1E48Nlinebelow","1E49nlinebelow","1E4ANcircumflexbelow","1E4Bncircumflexbelow","1E4COtildeacute","1E4Dotildeacute","1E4EOtildedieresis","1E4Fotildedieresis","1E50Omacrongrave","1E51omacrongrave","1E52Omacronacute","1E53omacronacute","1E54Pacute","1E55pacute","1E56Pdotaccent","1E57pdotaccent","1E58Rdotaccent","1E59rdotaccent","1E5ARdotbelow","1E5Brdotbelow","1E5CRdotbelowmacron","1E5Drdotbelowmacron","1E5ERlinebelow","1E5Frlinebelow","1E60Sdotaccent","1E61sdotaccent","1E62Sdotbelow","1E63sdotbelow","1E64Sacutedotaccent","1E65sacutedotaccent","1E66Scarondotaccent","1E67scarondotaccent","1E68Sdotbelowdotaccent","1E69sdotbelowdotaccent","1E6ATdotaccent","1E6Btdotaccent","1E6CTdotbelow","1E6Dtdotbelow","1E6ETlinebelow","1E6Ftlinebelow","1E70Tcircumflexbelow","1E71tcircumflexbelow","1E72Udieresisbelow","1E73udieresisbelow","1E74Utildebelow","1E75utildebelow","1E76Ucircumflexbelow","1E77ucircumflexbelow","1E78Utildeacute","1E79utildeacute","1E7AUmacrondieresis","1E7Bumacrondieresis","1E7CVtilde","1E7Dvtilde","1E7EVdotbelow","1E7Fvdotbelow","1E80Wgrave","1E81wgrave","1E82Wacute","1E83wacute","1E84Wdieresis","1E85wdieresis","1E86Wdotaccent","1E87wdotaccent","1E88Wdotbelow","1E89wdotbelow","1E8AXdotaccent","1E8Bxdotaccent","1E8CXdieresis","1E8Dxdieresis","1E8EYdotaccent","1E8Fydotaccent","1E90Zcircumflex","1E91zcircumflex","1E92Zdotbelow","1E93zdotbelow","1E94Zlinebelow","1E95zlinebelow","1E96hlinebelow","1E97tdieresis","1E98wring","1E99yring","1E9Aarighthalfring","1E9Bslongdotaccent","1EA0Adotbelow","1EA1adotbelow","1EA2Ahookabove","1EA3ahookabove","1EA4Acircumflexacute","1EA5acircumflexacute","1EA6Acircumflexgrave","1EA7acircumflexgrave","1EA8Acircumflexhookabove","1EA9acircumflexhookabove","1EAAAcircumflextilde","1EABacircumflextilde","1EACAcircumflexdotbelow","1EADacircumflexdotbelow","1EAEAbreveacute","1EAFabreveacute","1EB0Abrevegrave","1EB1abrevegrave","1EB2Abrevehookabove","1EB3abrevehookabove","1EB4Abrevetilde","1EB5abrevetilde","1EB6Abrevedotbelow","1EB7abrevedotbelow","1EB8Edotbelow","1EB9edotbelow","1EBAEhookabove","1EBBehookabove","1EBCEtilde","1EBDetilde","1EBEEcircumflexacute","1EBFecircumflexacute","1EC0Ecircumflexgrave","1EC1ecircumflexgrave","1EC2Ecircumflexhookabove","1EC3ecircumflexhookabove","1EC4Ecircumflextilde","1EC5ecircumflextilde","1EC6Ecircumflexdotbelow","1EC7ecircumflexdotbelow","1EC8Ihookabove","1EC9ihookabove","1ECAIdotbelow","1ECBidotbelow","1ECCOdotbelow","1ECDodotbelow","1ECEOhookabove","1ECFohookabove","1ED0Ocircumflexacute","1ED1ocircumflexacute","1ED2Ocircumflexgrave","1ED3ocircumflexgrave","1ED4Ocircumflexhookabove","1ED5ocircumflexhookabove","1ED6Ocircumflextilde","1ED7ocircumflextilde","1ED8Ocircumflexdotbelow","1ED9ocircumflexdotbelow","1EDAOhornacute","1EDBohornacute","1EDCOhorngrave","1EDDohorngrave","1EDEOhornhookabove","1EDFohornhookabove","1EE0Ohorntilde","1EE1ohorntilde","1EE2Ohorndotbelow","1EE3ohorndotbelow","1EE4Udotbelow","1EE5udotbelow","1EE6Uhookabove","1EE7uhookabove","1EE8Uhornacute","1EE9uhornacute","1EEAUhorngrave","1EEBuhorngrave","1EECUhornhookabove","1EEDuhornhookabove","1EEEUhorntilde","1EEFuhorntilde","1EF0Uhorndotbelow","1EF1uhorndotbelow","1EF2Ygrave","1EF3ygrave","1EF4Ydotbelow","1EF5ydotbelow","1EF6Yhookabove","1EF7yhookabove","1EF8Ytilde","1EF9ytilde","2002enspace","200Bzerowidthspace","200Cafii61664","200Dafii301","200Eafii299","200Fafii300","2010hyphentwo","2012figuredash","2013endash","2014emdash","2015afii00208","2016dblverticalbar","2017underscoredbl","2018quoteleft","2019quoteright","201Aquotesinglbase","201Bquotereversed","201Cquotedblleft","201Dquotedblright","201Equotedblbase","2020dagger","2021daggerdbl","2022bullet","2024onedotenleader","2025twodotenleader","2026ellipsis","202Cafii61573","202Dafii61574","202Eafii61575","2030perthousand","2032minute","2033second","2035primereversed","2039guilsinglleft","203Aguilsinglright","203Breferencemark","203Cexclamdbl","203Eoverline","2042asterism","2044fraction","2070zerosuperior","2074foursuperior","2075fivesuperior","2076sixsuperior","2077sevensuperior","2078eightsuperior","2079ninesuperior","207Aplussuperior","207Cequalsuperior","207Dparenleftsuperior","207Eparenrightsuperior","207Fnsuperior","2080zeroinferior","2081oneinferior","2082twoinferior","2083threeinferior","2084fourinferior","2085fiveinferior","2086sixinferior","2087seveninferior","2088eightinferior","2089nineinferior","208Dparenleftinferior","208Eparenrightinferior","20A1colonmonetary","20A2cruzeiro","20A3franc","20A4afii08941","20A7peseta","20A9won","20AAafii57636","20ABdong","20ACEuro","2103centigrade","2105afii61248","2109fahrenheit","2111Ifraktur","2113afii61289","2116afii61352","2118weierstrass","211CRfraktur","211Eprescription","2121telephone","2122trademark","2126Omega","212Bangstrom","212Eestimated","2135aleph","2153onethird","2154twothirds","215Boneeighth","215Cthreeeighths","215Dfiveeighths","215Eseveneighths","2160Oneroman","2161Tworoman","2162Threeroman","2163Fourroman","2164Fiveroman","2165Sixroman","2166Sevenroman","2167Eightroman","2168Nineroman","2169Tenroman","216AElevenroman","216BTwelveroman","2170oneroman","2171tworoman","2172threeroman","2173fourroman","2174fiveroman","2175sixroman","2176sevenroman","2177eightroman","2178nineroman","2179tenroman","217Aelevenroman","217Btwelveroman","2200universal","2202partialdiff","2203existential","2205emptyset","2206Delta","2207gradient","2208element","2209notelement","220Bsuchthat","220Cnotcontains","220Fproduct","2211summation","2212minus","2213minusplus","2215divisionslash","2217asteriskmath","2219bulletoperator","221Aradical","221Dproportional","221Einfinity","221Forthogonal","2220angle","2223divides","2225parallel","2226notparallel","2227logicaland","2228logicalor","2229intersection","222Aunion","222Bintegral","222Cdblintegral","222Econtourintegral","2234therefore","2235because","2236ratio","2237proportion","223Csimilar","223Dreversedtilde","2243asymptoticallyequal","2245congruent","2248approxequal","224Callequal","2250approaches","2251geometricallyequal","2252approxequalorimage","2253imageorapproximatelyequal","2260notequal","2261equivalence","2262notidentical","2264lessequal","2265greaterequal","2266lessoverequal","2267greateroverequal","226Amuchless","226Bmuchgreater","226Enotless","226Fnotgreater","2270notlessnorequal","2271notgreaternorequal","2272lessorequivalent","2273greaterorequivalent","2276lessorgreater","2277greaterorless","2279notgreaternorless","227Aprecedes","227Bsucceeds","2280notprecedes","2281notsucceeds","2282propersubset","2283propersuperset","2284notsubset","2285notsuperset","2286reflexsubset","2287reflexsuperset","228Asubsetnotequal","228Bsupersetnotequal","2295circleplus","2296minuscircle","2297circlemultiply","2299circleot","22A3tackleft","22A4tackdown","22A5perpendicular","22BFrighttriangle","22C5dotmath","22CEcurlyor","22CFcurlyand","22DAlessequalorgreater","22DBgreaterequalorless","22EEellipsisvertical","F6BEdotlessj","F6BFLL","F6C0ll","F6C3commaaccent","F6C4afii10063","F6C5afii10064","F6C6afii10192","F6C7afii10831","F6C8afii10832","F6C9Acute","F6CACaron","F6CBDieresis","F6CCDieresisAcute","F6CDDieresisGrave","F6CEGrave","F6CFHungarumlaut","F6D0Macron","F6D1cyrBreve","F6D2cyrFlex","F6D3dblGrave","F6D4cyrbreve","F6D5cyrflex","F6D6dblgrave","F6D7dieresisacute","F6D8dieresisgrave","F6D9copyrightserif","F6DAregisterserif","F6DBtrademarkserif","F6DConefitted","F6DDrupiah","F8FFapple","FB00ff","FB01fi","FB02fl","FB03ffi","FB04ffl","FE61asterisksmall","FE62plussmall","FE63hyphensmall","FE64lesssmall","FE65greatersmall","FE66equalsmall","FE69dollarsmall","FE6Apercentsmall","FE6Batsmall"];this._standardFontCharsNames=[];for(var e=0;e<t.length;e++){var r=parseInt(t[e].substr(0,4),16);this._standardFontCharsNames[r]=t[e].substr(4)}}return this._standardFontCharsNames},enumerable:!1,configurable:!0}),n.sRGBprofile=[0,0,12,72,76,105,110,111,2,16,0,0,109,110,116,114,82,71,66,32,88,89,90,32,7,206,0,2,0,9,0,6,0,49,0,0,97,99,115,112,77,83,70,84,0,0,0,0,73,69,67,32,115,82,71,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,246,214,0,1,0,0,0,0,211,45,72,80,32,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,99,112,114,116,0,0,1,80,0,0,0,51,100,101,115,99,0,0,1,132,0,0,0,108,119,116,112,116,0,0,1,240,0,0,0,20,98,107,112,116,0,0,2,4,0,0,0,20,114,88,89,90,0,0,2,24,0,0,0,20,103,88,89,90,0,0,2,44,0,0,0,20,98,88,89,90,0,0,2,64,0,0,0,20,100,109,110,100,0,0,2,84,0,0,0,112,100,109,100,100,0,0,2,196,0,0,0,136,118,117,101,100,0,0,3,76,0,0,0,134,118,105,101,119,0,0,3,212,0,0,0,36,108,117,109,105,0,0,3,248,0,0,0,20,109,101,97,115,0,0,4,12,0,0,0,36,116,101,99,104,0,0,4,48,0,0,0,12,114,84,82,67,0,0,4,60,0,0,8,12,103,84,82,67,0,0,4,60,0,0,8,12,98,84,82,67,0,0,4,60,0,0,8,12,116,101,120,116,0,0,0,0,67,111,112,121,114,105,103,104,116,32,40,99,41,32,49,57,57,56,32,72,101,119,108,101,116,116,45,80,97,99,107,97,114,100,32,67,111,109,112,97,110,121,0,0,100,101,115,99,0,0,0,0,0,0,0,18,115,82,71,66,32,73,69,67,54,49,57,54,54,45,50,46,49,0,0,0,0,0,0,0,0,0,0,0,18,115,82,71,66,32,73,69,67,54,49,57,54,54,45,50,46,49,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,88,89,90,32,0,0,0,0,0,0,243,81,0,1,0,0,0,1,22,204,88,89,90,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,88,89,90,32,0,0,0,0,0,0,111,162,0,0,56,245,0,0,3,144,88,89,90,32,0,0,0,0,0,0,98,153,0,0,183,133,0,0,24,218,88,89,90,32,0,0,0,0,0,0,36,160,0,0,15,132,0,0,182,207,100,101,115,99,0,0,0,0,0,0,0,22,73,69,67,32,104,116,116,112,58,47,47,119,119,119,46,105,101,99,46,99,104,0,0,0,0,0,0,0,0,0,0,0,22,73,69,67,32,104,116,116,112,58,47,47,119,119,119,46,105,101,99,46,99,104,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,100,101,115,99,0,0,0,0,0,0,0,46,73,69,67,32,54,49,57,54,54,45,50,46,49,32,68,101,102,97,117,108,116,32,82,71,66,32,99,111,108,111,117,114,32,115,112,97,99,101,32,45,32,115,82,71,66,0,0,0,0,0,0,0,0,0,0,0,46,73,69,67,32,54,49,57,54,54,45,50,46,49,32,68,101,102,97,117,108,116,32,82,71,66,32,99,111,108,111,117,114,32,115,112,97,99,101,32,45,32,115,82,71,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,100,101,115,99,0,0,0,0,0,0,0,44,82,101,102,101,114,101,110,99,101,32,86,105,101,119,105,110,103,32,67,111,110,100,105,116,105,111,110,32,105,110,32,73,69,67,54,49,57,54,54,45,50,46,49,0,0,0,0,0,0,0,0,0,0,0,44,82,101,102,101,114,101,110,99,101,32,86,105,101,119,105,110,103,32,67,111,110,100,105,116,105,111,110,32,105,110,32,73,69,67,54,49,57,54,54,45,50,46,49,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,118,105,101,119,0,0,0,0,0,19,164,254,0,20,95,46,0,16,207,20,0,3,237,204,0,4,19,11,0,3,92,158,0,0,0,1,88,89,90,32,0,0,0,0,0,76,9,86,0,80,0,0,0,87,31,231,109,101,97,115,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,143,0,0,0,2,115,105,103,32,0,0,0,0,67,82,84,32,99,117,114,118,0,0,0,0,0,0,4,0,0,0,0,5,0,10,0,15,0,20,0,25,0,30,0,35,0,40,0,45,0,50,0,55,0,59,0,64,0,69,0,74,0,79,0,84,0,89,0,94,0,99,0,104,0,109,0,114,0,119,0,124,0,129,0,134,0,139,0,144,0,149,0,154,0,159,0,164,0,169,0,174,0,178,0,183,0,188,0,193,0,198,0,203,0,208,0,213,0,219,0,224,0,229,0,235,0,240,0,246,0,251,1,1,1,7,1,13,1,19,1,25,1,31,1,37,1,43,1,50,1,56,1,62,1,69,1,76,1,82,1,89,1,96,1,103,1,110,1,117,1,124,1,131,1,139,1,146,1,154,1,161,1,169,1,177,1,185,1,193,1,201,1,209,1,217,1,225,1,233,1,242,1,250,2,3,2,12,2,20,2,29,2,38,2,47,2,56,2,65,2,75,2,84,2,93,2,103,2,113,2,122,2,132,2,142,2,152,2,162,2,172,2,182,2,193,2,203,2,213,2,224,2,235,2,245,3,0,3,11,3,22,3,33,3,45,3,56,3,67,3,79,3,90,3,102,3,114,3,126,3,138,3,150,3,162,3,174,3,186,3,199,3,211,3,224,3,236,3,249,4,6,4,19,4,32,4,45,4,59,4,72,4,85,4,99,4,113,4,126,4,140,4,154,4,168,4,182,4,196,4,211,4,225,4,240,4,254,5,13,5,28,5,43,5,58,5,73,5,88,5,103,5,119,5,134,5,150,5,166,5,181,5,197,5,213,5,229,5,246,6,6,6,22,6,39,6,55,6,72,6,89,6,106,6,123,6,140,6,157,6,175,6,192,6,209,6,227,6,245,7,7,7,25,7,43,7,61,7,79,7,97,7,116,7,134,7,153,7,172,7,191,7,210,7,229,7,248,8,11,8,31,8,50,8,70,8,90,8,110,8,130,8,150,8,170,8,190,8,210,8,231,8,251,9,16,9,37,9,58,9,79,9,100,9,121,9,143,9,164,9,186,9,207,9,229,9,251,10,17,10,39,10,61,10,84,10,106,10,129,10,152,10,174,10,197,10,220,10,243,11,11,11,34,11,57,11,81,11,105,11,128,11,152,11,176,11,200,11,225,11,249,12,18,12,42,12,67,12,92,12,117,12,142,12,167,12,192,12,217,12,243,13,13,13,38,13,64,13,90,13,116,13,142,13,169,13,195,13,222,13,248,14,19,14,46,14,73,14,100,14,127,14,155,14,182,14,210,14,238,15,9,15,37,15,65,15,94,15,122,15,150,15,179,15,207,15,236,16,9,16,38,16,67,16,97,16,126,16,155,16,185,16,215,16,245,17,19,17,49,17,79,17,109,17,140,17,170,17,201,17,232,18,7,18,38,18,69,18,100,18,132,18,163,18,195,18,227,19,3,19,35,19,67,19,99,19,131,19,164,19,197,19,229,20,6,20,39,20,73,20,106,20,139,20,173,20,206,20,240,21,18,21,52,21,86,21,120,21,155,21,189,21,224,22,3,22,38,22,73,22,108,22,143,22,178,22,214,22,250,23,29,23,65,23,101,23,137,23,174,23,210,23,247,24,27,24,64,24,101,24,138,24,175,24,213,24,250,25,32,25,69,25,107,25,145,25,183,25,221,26,4,26,42,26,81,26,119,26,158,26,197,26,236,27,20,27,59,27,99,27,138,27,178,27,218,28,2,28,42,28,82,28,123,28,163,28,204,28,245,29,30,29,71,29,112,29,153,29,195,29,236,30,22,30,64,30,106,30,148,30,190,30,233,31,19,31,62,31,105,31,148,31,191,31,234,32,21,32,65,32,108,32,152,32,196,32,240,33,28,33,72,33,117,33,161,33,206,33,251,34,39,34,85,34,130,34,175,34,221,35,10,35,56,35,102,35,148,35,194,35,240,36,31,36,77,36,124,36,171,36,218,37,9,37,56,37,104,37,151,37,199,37,247,38,39,38,87,38,135,38,183,38,232,39,24,39,73,39,122,39,171,39,220,40,13,40,63,40,113,40,162,40,212,41,6,41,56,41,107,41,157,41,208,42,2,42,53,42,104,42,155,42,207,43,2,43,54,43,105,43,157,43,209,44,5,44,57,44,110,44,162,44,215,45,12,45,65,45,118,45,171,45,225,46,22,46,76,46,130,46,183,46,238,47,36,47,90,47,145,47,199,47,254,48,53,48,108,48,164,48,219,49,18,49,74,49,130,49,186,49,242,50,42,50,99,50,155,50,212,51,13,51,70,51,127,51,184,51,241,52,43,52,101,52,158,52,216,53,19,53,77,53,135,53,194,53,253,54,55,54,114,54,174,54,233,55,36,55,96,55,156,55,215,56,20,56,80,56,140,56,200,57,5,57,66,57,127,57,188,57,249,58,54,58,116,58,178,58,239,59,45,59,107,59,170,59,232,60,39,60,101,60,164,60,227,61,34,61,97,61,161,61,224,62,32,62,96,62,160,62,224,63,33,63,97,63,162,63,226,64,35,64,100,64,166,64,231,65,41,65,106,65,172,65,238,66,48,66,114,66,181,66,247,67,58,67,125,67,192,68,3,68,71,68,138,68,206,69,18,69,85,69,154,69,222,70,34,70,103,70,171,70,240,71,53,71,123,71,192,72,5,72,75,72,145,72,215,73,29,73,99,73,169,73,240,74,55,74,125,74,196,75,12,75,83,75,154,75,226,76,42,76,114,76,186,77,2,77,74,77,147,77,220,78,37,78,110,78,183,79,0,79,73,79,147,79,221,80,39,80,113,80,187,81,6,81,80,81,155,81,230,82,49,82,124,82,199,83,19,83,95,83,170,83,246,84,66,84,143,84,219,85,40,85,117,85,194,86,15,86,92,86,169,86,247,87,68,87,146,87,224,88,47,88,125,88,203,89,26,89,105,89,184,90,7,90,86,90,166,90,245,91,69,91,149,91,229,92,53,92,134,92,214,93,39,93,120,93,201,94,26,94,108,94,189,95,15,95,97,95,179,96,5,96,87,96,170,96,252,97,79,97,162,97,245,98,73,98,156,98,240,99,67,99,151,99,235,100,64,100,148,100,233,101,61,101,146,101,231,102,61,102,146,102,232,103,61,103,147,103,233,104,63,104,150,104,236,105,67,105,154,105,241,106,72,106,159,106,247,107,79,107,167,107,255,108,87,108,175,109,8,109,96,109,185,110,18,110,107,110,196,111,30,111,120,111,209,112,43,112,134,112,224,113,58,113,149,113,240,114,75,114,166,115,1,115,93,115,184,116,20,116,112,116,204,117,40,117,133,117,225,118,62,118,155,118,248,119,86,119,179,120,17,120,110,120,204,121,42,121,137,121,231,122,70,122,165,123,4,123,99,123,194,124,33,124,129,124,225,125,65,125,161,126,1,126,98,126,194,127,35,127,132,127,229,128,71,128,168,129,10,129,107,129,205,130,48,130,146,130,244,131,87,131,186,132,29,132,128,132,227,133,71,133,171,134,14,134,114,134,215,135,59,135,159,136,4,136,105,136,206,137,51,137,153,137,254,138,100,138,202,139,48,139,150,139,252,140,99,140,202,141,49,141,152,141,255,142,102,142,206,143,54,143,158,144,6,144,110,144,214,145,63,145,168,146,17,146,122,146,227,147,77,147,182,148,32,148,138,148,244,149,95,149,201,150,52,150,159,151,10,151,117,151,224,152,76,152,184,153,36,153,144,153,252,154,104,154,213,155,66,155,175,156,28,156,137,156,247,157,100,157,210,158,64,158,174,159,29,159,139,159,250,160,105,160,216,161,71,161,182,162,38,162,150,163,6,163,118,163,230,164,86,164,199,165,56,165,169,166,26,166,139,166,253,167,110,167,224,168,82,168,196,169,55,169,169,170,28,170,143,171,2,171,117,171,233,172,92,172,208,173,68,173,184,174,45,174,161,175,22,175,139,176,0,176,117,176,234,177,96,177,214,178,75,178,194,179,56,179,174,180,37,180,156,181,19,181,138,182,1,182,121,182,240,183,104,183,224,184,89,184,209,185,74,185,194,186,59,186,181,187,46,187,167,188,33,188,155,189,21,189,143,190,10,190,132,190,255,191,122,191,245,192,112,192,236,193,103,193,227,194,95,194,219,195,88,195,212,196,81,196,206,197,75,197,200,198,70,198,195,199,65,199,191,200,61,200,188,201,58,201,185,202,56,202,183,203,54,203,182,204,53,204,181,205,53,205,181,206,54,206,182,207,55,207,184,208,57,208,186,209,60,209,190,210,63,210,193,211,68,211,198,212,73,212,203,213,78,213,209,214,85,214,216,215,92,215,224,216,100,216,232,217,108,217,241,218,118,218,251,219,128,220,5,220,138,221,16,221,150,222,28,222,162,223,41,223,175,224,54,224,189,225,68,225,204,226,83,226,219,227,99,227,235,228,115,228,252,229,132,230,13,230,150,231,31,231,169,232,50,232,188,233,70,233,208,234,91,234,229,235,112,235,251,236,134,237,17,237,156,238,40,238,180,239,64,239,204,240,88,240,229,241,114,241,255,242,140,243,25,243,167,244,52,244,194,245,80,245,222,246,109,246,251,247,138,248,25,248,168,249,56,249,199,250,87,250,231,251,119,252,7,252,152,253,41,253,186,254,75,254,220,255,109,255,255],n.hatchData=["000000FF00000000","1010101010101010","8040201008040201","0102040810204080","101010FF10101010","8142241818244281","8000000008000000","0010000100100001","2200880022008800","2288228822882288","2255885522558855","AA558A55AA55A855","AA55AA55AA55AA55","BB55EE55BB55EE55","DD77DD77DD77DD77","FFDDFF77FFDDFF77","FF7FFFF7FF7FFFF7","FF7FFFFFFFF7FFFF","8844221188442211","1122448811224488","CC663399CC663399","993366CC993366CC","E070381C0E0783C1","C183070E1C3870E0","4040404040404040","00FF000000FF0000","AAAAAAAAAAAAAAAA","FF00FF00FF00FF00","CCCCCCCCCCCCCCCC","FFFF0000FFFF0000","8844221100000000","1122448800000000","F00000000F000000","8080808008080808","0240088004200110","0C8DB130031BD8C0","8403304884033048","00304A8100304A81","0102040818244281","202020FF020202FF","1422518854224588","F0F0F0F0AA55AA55","0100201020000102","AA00800080008000","0020008800020088","8448300C02010103","33FFCCFF33FFCCFF","98F8F877898F8F77","111111FF111111FF","3333CCCC3333CCCC","0F0F0F0FF0F0F0F0","0502058850205088","10387CFE7C381000","0000000000000000"],n.standardFontWidths=null,n.standardFontInfo=null,n._standardFontCharsNames=null,r=n,t.StiPdfResources=r}(Stimulsoft=Stimulsoft||{}),function(f){var t,e,r,c,v,p;function g(t){this.ownerValue=[],this.userValue=[],this.ownerExtendedValue=[],this.userExtendedValue=[],this.permsValue=[],this.IDValue=null,this.encryptionKey=null,this.encryptionKeyLength=0,this.passwordOwner="",this.passwordUser="",this.securityFlags=0,this.keyLength=c.StiPdfEncryptionKeyLength.Bit40,this.pdfService=null,this.pdfService=t}e=t=f.Report||(f.Report={}),c=r=e.Export||(e.Export={}),v=f.System.StiArray,p=f.System.StiString,g.prototype.padPassword=function(t){for(var e=[],r=0;r<t.length;r++)e[r]=t.charCodeAt(r);for(var i=0;i<g.paddingString.length;i++)e[r++]=g.paddingString[i];for(var n=[],r=0;r<32;r++)n[r]=e[r];return n},g.prototype.computingCryptoValues=function(t,e,r,i,n){this.securityFlags=4294967232;var o=0;0!=(t&c.StiUserAccessPrivileges.PrintDocument)&&(o|=1<<2),0!=(t&c.StiUserAccessPrivileges.ModifyContents)&&(o|=1<<3),0!=(t&c.StiUserAccessPrivileges.CopyTextAndGraphics)&&(o|=1<<4),0!=(t&c.StiUserAccessPrivileges.AddOrModifyTextAnnotations)&&(o|=1<<5),this.securityFlags|=o,null==e&&(e=""),null==r&&(r=""),this.passwordOwner=e,this.passwordUser=r,this.keyLength=i,this.IDValue=n;var n=!1,a,n;return(0<this.passwordOwner.length||0<this.passwordUser.length||t!=c.StiUserAccessPrivileges.All)&&(n=!0,this.computingCryptoValues2()||(n=!1,this.throwEncryptionError(0,"Encryption not work!"))),n},g.prototype.computingCryptoValues2=function(){if(this.keyLength==c.StiPdfEncryptionKeyLength.Bit128_r4)return this.computingCryptoValuesV4();if(this.keyLength==c.StiPdfEncryptionKeyLength.Bit256_r5||this.keyLength==c.StiPdfEncryptionKeyLength.Bit256_r6)return this.computingCryptoValuesV5();var t=this.passwordOwner;p.isNullOrEmpty(this.passwordOwner)&&(t=this.passwordUser);var e=this.padPassword(t),r=this.computeHashMD5(e),i;if(this.keyLength==c.StiPdfEncryptionKeyLength.Bit128)for(var n=0;n<50;n++)r=this.computeHashMD5(r);this.keyLength==c.StiPdfEncryptionKeyLength.Bit40&&((i=[])[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i[4]=r[4],r=i);var o=this.padPassword(this.passwordUser),o=this.rc4(o,r);if(this.keyLength==c.StiPdfEncryptionKeyLength.Bit128)for(var a=1;a<=19;a++){for(var s=0;s<16;s++)r[s]^=a-1,r[s]^=a;o=this.rc4(o,r)}o.stimulsoft.copyTo(this.ownerValue,0);var t=this.passwordUser,e=this.padPassword(t),i=this.getBytesUInt32(this.securityFlags),t=[];if(t.stimulsoft.addRange(e),t.stimulsoft.addRange(o),t.stimulsoft.addRange(i),t.stimulsoft.addRange(this.IDValue),r=this.computeHashMD5(t),this.keyLength==c.StiPdfEncryptionKeyLength.Bit128)for(var n=0;n<50;n++)r=this.computeHashMD5(r);this.encryptionKey=[],this.encryptionKeyLength=this.keyLength==c.StiPdfEncryptionKeyLength.Bit128?16:5;for(var l=0;l<this.encryptionKeyLength;l++)this.encryptionKey[l]=r[l];var i=[];if(this.keyLength==c.StiPdfEncryptionKeyLength.Bit128){(t=[]).stimulsoft.addRange(g.paddingString),t.stimulsoft.addRange(this.IDValue),r=this.computeHashMD5(t),r=this.rc4(r,this.encryptionKey);for(var m=[],a=1;a<=19;a++){for(var s=0;s<16;s++)m[s]=this.encryptionKey[s]^a;r=this.rc4(r,m)}g.paddingString.stimulsoft.copyTo(i,0),r.stimulsoft.copyTo(i,0)}else g.paddingString.stimulsoft.copyTo(i,0),i=this.rc4(i,this.encryptionKey);return i.stimulsoft.copyTo(this.userValue,0),!0},g.prototype.computingCryptoValuesV4=function(){var t=this.passwordOwner;p.isNullOrEmpty(this.passwordOwner)&&(t=this.passwordUser);for(var e=this.padPassword(t),r=this.computeHashMD5(e),i=0;i<50;i++)r=this.computeHashMD5(r);for(var n=this.padPassword(this.passwordUser),n=this.rc4(n,r),o=1;o<=19;o++){for(var a=0;a<16;a++)r[a]^=o-1,r[a]^=o;n=this.rc4(n,r)}n.stimulsoft.copyTo(this.ownerValue,0);var s=this.passwordUser,t=this.padPassword(s),e=this.getBytesUInt32(this.securityFlags),s=[];s.stimulsoft.addRange(t),s.stimulsoft.addRange(n),s.stimulsoft.addRange(e),s.stimulsoft.addRange(this.IDValue),r=this.computeHashMD5(s);for(var i=0;i<50;i++)r=this.computeHashMD5(r);this.encryptionKey=[],this.encryptionKeyLength=16;for(var l=0;l<this.encryptionKeyLength;l++)this.encryptionKey[l]=r[l];var e=[],s;(s=[]).stimulsoft.addRange(g.paddingString),s.stimulsoft.addRange(this.IDValue),r=this.computeHashMD5(s),r=this.rc4(r,this.encryptionKey);for(var m=[],o=1;o<=19;o++){for(var a=0;a<16;a++)m[a]=this.encryptionKey[a]^o;r=this.rc4(r,m)}return g.paddingString.stimulsoft.copyTo(e,0),r.stimulsoft.copyTo(e,0),e.stimulsoft.copyTo(this.userValue,0),!0},g.prototype.computingCryptoValuesV5=function(){var t=new f.System.Crypt.SecureRandom,e=null,r=null,i=t.createNextBytes(32),n=t.createNextBytes(8),o=t.createNextBytes(8),a=t.createNextBytes(8),s=t.createNextBytes(8),l=f.System.Text.Encoding.UTF8.getBytes(this.passwordUser),m;127<l.length&&(m=[],v.copy2(l,0,m,0,127),l=m),(r=this.getHashV5(l,n,null)).stimulsoft.copyTo(this.userValue,0),n.stimulsoft.copyTo(this.userValue,32),o.stimulsoft.copyTo(this.userValue,40),r=this.getHashV5(l,o,null),this.encodeKeyDataV5(r,i,!0).stimulsoft.copyTo(this.userExtendedValue,0);var n=this.passwordOwner;p.isNullOrEmpty(this.passwordOwner)&&(n=this.passwordUser);var n=f.System.Text.Encoding.UTF8.getBytes(n),m;return 127<n.length&&(m=[],v.copy2(n,0,m,0,127),n=m),(r=this.getHashV5(n,a,this.userValue)).stimulsoft.copyTo(this.ownerValue,0),a.stimulsoft.copyTo(this.ownerValue,32),s.stimulsoft.copyTo(this.ownerValue,40),r=this.getHashV5(n,s,this.userValue),this.encodeKeyDataV5(r,i,!0).stimulsoft.copyTo(this.ownerExtendedValue,0),e=t.createNextBytes(16),this.getBytesUInt32(this.securityFlags).stimulsoft.copyTo(e,0),e[4]=255,e[5]=255,e[6]=255,e[7]=255,e[8]=84,e[9]=97,e[10]=100,e[11]=98,this.permsValue=this.encodeKeyDataV5(i,e,!1),r=this.getHashV5(l,o,null),this.encryptionKey=this.decodeKeyDataV5(r,this.userExtendedValue,!0),97==(e=this.decodeKeyDataV5(this.encryptionKey,this.permsValue,!1))[9]&&100==e[10]&&98==e[11]||this.throwEncryptionError(102,"Verifying key calculation failed"),!0},g.prototype.encodeKeyDataV5=function(t,e,r){var i=null,r,n,i,n;i=r?(r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],(n=new f.ExternalLibrary.aesjs.ModeOfOperation.cbc(t,r)).encrypt(e)):(n=new f.ExternalLibrary.aesjs.ModeOfOperation.ecb(t)).encrypt(e);for(var o=[],a=0;a<i.length;a++)o[a]=i[a];return o},g.prototype.decodeKeyDataV5=function(t,e,r){var i=null,r,n,i,n;i=r?(r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],(n=new f.ExternalLibrary.aesjs.ModeOfOperation.cbc(t,r)).decrypt(e)):(n=new f.ExternalLibrary.aesjs.ModeOfOperation.ecb(t)).decrypt(e);for(var o=[],a=0;a<i.length;a++)o[a]=i[a];return o},g.prototype.getHashV5=function(t,e,r){return this.keyLength==c.StiPdfEncryptionKeyLength.Bit256_r5?g.calculate_hash_r5(t,e,r):g.calculate_hash_r6(t,e,r)},g.calculate_hash_r5=function(t,e,r){var i=[];return i.stimulsoft.addRange(t),i.stimulsoft.addRange(e),null!=r&&i.stimulsoft.addRange(r),f.System.Crypt.SHA2.SHA256(i)},g.calculate_hash_r6=function(t,e,r){var i=[],n=[],o=32,a=0,s=null,l=[],m=[],c=new f.System.Crypt.SHA2,s;(s=[]).stimulsoft.addRange(t),s.stimulsoft.addRange(e),null!=r&&s.stimulsoft.addRange(r),c.SHA2_256(s).stimulsoft.copyTo(n,0);for(var p=0;p<64||p<i[64*a-1]+32;p++){s.stimulsoft.clear(),s.stimulsoft.addRange(t);for(var g=0;g<o;g++)s.push(n[g]);a=t.length+o,null!=r&&(s.stimulsoft.addRange(r),a+=48);for(var h=0;h<64;h++)s.stimulsoft.copyTo(i,h*a);v.copy2(n,0,l,0,16),v.copy2(n,16,m,0,16);for(var w,d=new f.ExternalLibrary.aesjs.ModeOfOperation.cbc(l,m).encrypt(i.slice(0,64*a)),u=0;u<d.length;u++)i[u]=d[u];for(var S=0,h=0;h<16;h++)S+=i[h];switch(o=32+S%3*16){case 32:c.SHA2_256(i.slice(0,64*a)).stimulsoft.copyTo(n,0);break;case 48:c.SHA2_384(i.slice(0,64*a)).stimulsoft.copyTo(n,0);break;case 64:c.SHA2_512(i.slice(0,64*a)).stimulsoft.copyTo(n,0);break}}var e=[];return v.copy2(n,0,e,0,32),e},g.prototype.encryptData=function(t,e,r){var i,n,o,a,i,n,o,a,s,l,m,s,l,m;return t=this.keyLength==c.StiPdfEncryptionKeyLength.Bit40||this.keyLength==c.StiPdfEncryptionKeyLength.Bit128?(i=e,n=r,o=[],this.encryptionKey.stimulsoft.copyTo(o,0),this.getBytesUInt32(i).stimulsoft.copyTo(o,this.encryptionKeyLength),this.getBytesUint16(n).stimulsoft.copyTo(o,this.encryptionKeyLength+3),a=this.computeHashMD5(o),this.keyLength==c.StiPdfEncryptionKeyLength.Bit40&&(a=a.slice(0,10)),this.rc4(t,a)):this.keyLength==c.StiPdfEncryptionKeyLength.Bit128_r4?(i=e,n=r,o=[],this.encryptionKey.stimulsoft.copyTo(o,0),this.getBytesUInt32(i).stimulsoft.copyTo(o,16),this.getBytesUint16(n).stimulsoft.copyTo(o,19),o[21]=115,o[22]=65,o[23]=108,o[24]=84,a=this.computeHashMD5(o),s=(new f.System.Crypt.SecureRandom).createNextBytes(16),(l=[]).stimulsoft.addRange(s),l.stimulsoft.addRange(t),l=new f.ExternalLibrary.aesjs.padding.pkcs7.pad(l),(m=new f.ExternalLibrary.aesjs.ModeOfOperation.cbc(a,s)).encrypt(l)):(s=(new f.System.Crypt.SecureRandom).createNextBytes(16),(l=[]).stimulsoft.addRange(s),l.stimulsoft.addRange(t),l=new f.ExternalLibrary.aesjs.padding.pkcs7.pad(l),(m=new f.ExternalLibrary.aesjs.ModeOfOperation.cbc(this.encryptionKey,s)).encrypt(l))},g.prototype.throwEncryptionError=function(t,e){throw new Error(p.format("EncryptionError at step {0} : {1}",t,e))},g.prototype.renderEncodeRecord=function(t){var e="",r="",i=32;this.keyLength!=c.StiPdfEncryptionKeyLength.Bit256_r5&&this.keyLength!=c.StiPdfEncryptionKeyLength.Bit256_r6||(i=48);var n=0;for(n=0;n<i;n++)e+=String.fromCharCode(this.ownerValue[n]),r+=String.fromCharCode(this.userValue[n]);if(t.writeLine("/Filter /Standard"),this.keyLength==c.StiPdfEncryptionKeyLength.Bit128)t.writeLine("/CF<</StdCF<</AuthEvent/DocOpen/CFM/V2/Length 16>>>>"),t.writeLine("/StmF /StdCF"),t.writeLine("/StrF /StdCF"),t.writeLine("/R 3"),t.writeLine("/V 2"),t.writeLine("/Length 128");else if(this.keyLength==c.StiPdfEncryptionKeyLength.Bit128_r4)t.writeLine("/CF<</StdCF<</AuthEvent/DocOpen/CFM/AESV2/Length 16>>>>"),t.writeLine("/StmF /StdCF"),t.writeLine("/StrF /StdCF"),t.writeLine("/R 4"),t.writeLine("/V 4"),t.writeLine("/Length 128");else if(this.keyLength==c.StiPdfEncryptionKeyLength.Bit256_r5||this.keyLength==c.StiPdfEncryptionKeyLength.Bit256_r6){t.writeLine("/CF<</StdCF<</AuthEvent/DocOpen/CFM/AESV3/Length 32>>>>"),t.writeLine("/StmF /StdCF"),t.writeLine("/StrF /StdCF"),t.writeLine1("/R {0}",this.keyLength==c.StiPdfEncryptionKeyLength.Bit256_r5?5:6),t.writeLine("/V 5"),t.writeLine("/Length 256");for(var o="",a="",n=0;n<32;n++)o+=String.fromCharCode(this.ownerExtendedValue[n]),a+=String.fromCharCode(this.userExtendedValue[n]);var s="";for(n=0;n<16;n++)s+=String.fromCharCode(this.permsValue[n]);t.writeString(p.format("/OE ({0})",c.StiPdfExportService.convertToEscapeSequencePlusTabs(o)),!0),t.writeString(p.format("/UE ({0})",c.StiPdfExportService.convertToEscapeSequencePlusTabs(a)),!0),t.writeString(p.format("/Perms ({0})",c.StiPdfExportService.convertToEscapeSequencePlusTabs(s)),!0)}else t.writeLine("/R 2"),t.writeLine("/V 1"),t.writeLine("/Length 40");t.writeString(p.format("/O ({0})",c.StiPdfExportService.convertToEscapeSequencePlusTabs(e)),!0),t.writeString(p.format("/U ({0})",c.StiPdfExportService.convertToEscapeSequencePlusTabs(r)),!0),t.writeLine1("/P {0}",this.securityFlags)},g.prototype.getBytesUInt32=function(t){var e=[];return e.push(255&t),e.push(t>>8&255),e.push(t>>16&255),e.push(t>>24&255),e},g.prototype.getBytesUint16=function(t){var e=[];return e.push(255&t),e.push(t>>8&255),e},g.prototype.rc4=function(t,e){for(var r=[],i=0,n=0,o,a=[],s=e.length,l=t.length,i=0;i<256;i++)r[i]=i;for(i=0;i<256;i++)n=(n+r[i]+e[i%s])%256,o=r[i],r[i]=r[n],r[n]=o;for(var m=n=i=0;m<l;m++)n=(n+r[i=(i+1)%256])%256,o=r[i],r[i]=r[n],r[n]=o,a.push(t[m]^r[(r[i]+r[n])%256]);return a},g.prototype.computeHashMD5=function(t){for(var e="",r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return f.Base.StiMD5Helper.MD5(e,!1)},g.paddingString=[40,191,78,94,78,117,138,65,100,0,78,86,255,250,1,8,46,46,0,182,208,104,62,128,47,12,169,254,100,83,105,122],e=g,c.StiPdfSecurity=e}(Stimulsoft=Stimulsoft||{}),function(F){var t,e,r;e=t=F.Report||(F.Report={}),function(t){var e=F.System.StiString,r=(Object.defineProperty(i.prototype,"isUsed",{get:function(){return!(-1==this.ref)},enumerable:!1,configurable:!0}),i.prototype.addRef=function(){this.info.addRef(this)},i.prototype.toString=function(){if(-1==this.ref)return"-";return e.format("ref = {0}",this.ref)},i);function i(){this.ref=-1,this.info=null}t.StiPdfObjInfo=r;var n=(__extends(a,o=r),a),o;function a(){return null!==o&&o.apply(this,arguments)||this}t.StiPdfContentObjInfo=n;var s=(__extends(m,l=r),m),l;function m(){return null!==l&&l.apply(this,arguments)||this}t.StiPdfXObjectObjInfo=s;var c=(__extends(g,p=r),g),p;function g(){return null!==p&&p.apply(this,arguments)||this}t.StiPdfFontObjInfo=c;var h=(__extends(d,w=r),d),w;function d(){return null!==w&&w.apply(this,arguments)||this}t.StiPdfOutlinesObjInfo=h;var u=(__extends(f,S=r),f),S;function f(){return null!==S&&S.apply(this,arguments)||this}t.StiPdfPatternsObjInfo=u;var v=(__extends(y,E=r),y),E,b;function y(){return null!==E&&E.apply(this,arguments)||this}function x(){}t.StiPdfAnnotObjInfo=v,t.StiPdfCheckBoxObjInfo=x;var A=(__extends(P,T=r),P),T;function P(){return null!==T&&T.apply(this,arguments)||this}t.StiPdfAcroFormObjInfo=A;var L=(C.prototype.addRef=function(t){this.objectsCounter++,t.ref=this.objectsCounter},C.prototype.createObject=function(t){void 0===t&&(t=!1);var e=new r;return e.info=this,t&&this.addRef(e),e},C.prototype.createContentObject=function(t){void 0===t&&(t=!1);var e=new n;return e.info=this,t&&this.addRef(e),e.content=this.createObject(t),e},C.prototype.createXObject=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1);var r=new s;return r.info=this,t&&this.addRef(r),r.mask=this.createObject(t&&e),r},C.prototype.createFontObject=function(t,e,r,i,n){void 0===t&&(t=!1),void 0===e&&(e=!0),void 0===r&&(r=!1),void 0===i&&(i=!0),void 0===n&&(n=!1);var o=new c;return o.info=this,t&&this.addRef(o),o.descendantFont=this.createObject(t&&e),o.toUnicode=this.createObject(t&&e),o.cIDSet=this.createObject(t&&e),o.encoding=this.createObject(t&&!e&&!n),o.fontDescriptor=this.createObject(t&&!r),o.fontFile2=this.createObject(t&&i),o},C.prototype.createOutlinesObject=function(t){void 0===t&&(t=!1);var e=new h;return e.info=this,t&&this.addRef(e),e.items=[],e},C.prototype.createPatternsObject=function(t){void 0===t&&(t=!1);var e=new u;return e.info=this,e.resources=this.createObject(t),e.first=this.createObject(t),e.hatchItems=[],e.shadingItems=[],e.shadingFunctionItems=[],e},C.prototype.createAcroFormObject=function(t){void 0===t&&(t=!1);var e=new A;return e.info=this,t&&this.addRef(e),e.annots=[],e.checkBoxes=[],e.unsignedSignatures=[],e.signatures=[],e.tooltips=[],e.annotFontItems=[],e},C.prototype.createAnnotObject=function(t,e,r){void 0===t&&(t=!1),void 0===e&&(e=!1),void 0===r&&(r=0);var i=new v;i.info=this,t&&this.addRef(i),i.aP=this.createObject(t&&e),i.aA=[];for(var n=0;n<r;n++)i.aA.push(this.createObject(t));return i},C);function C(){this.objectsCounter=0,this.objects=null,this.objectsCounter=0,this.objects=[],this.root=this.createObject(!0),this.info=this.createObject(!0),this.colorSpace=this.createObject(!0),this.pages=this.createObject(!0),this.structTreeRoot=this.createObject(!0),this.optionalContentGroup=this.createObject(!0),this.pageList=[],this.xObjectList=[],this.fontList=[],this.linkList=[],this.embeddedFilesList=[]}t.StiPdfStructure=L}(r=e.Export||(e.Export={}))}(Stimulsoft=Stimulsoft||{}),function(W){var t,k,e,Y,c,N,g,h,w,O,M,G,V,m,_,H,j,q,K,r,i,J,Q,n,Z,$,d,p,o,a;function s(){this.BorderLeft="none",this.BorderRight="none",this.BorderTop="none",this.BorderBottom="none",this.BackColor=i.transparent,this.VertAlign=$.Bottom,this.FontName="Arial",this.FontSize=6,this.Bold=!1,this.Italic=!1,this.Underline=!1,this.FontColor=i.black,this.HorAlign=Z.Left,this.Angle=0,this.Wordwrap=!1,this.DataStyle=-1}function l(){this.isNumeric=!1,this.isCurrency=!1,this.isPercent=!1,this.isDate=!1,this.isTime=!1,this.isDefaultFormat=!1,this.DecimalDigits=2,this.DecimalComma=" ",this.GroupDigits=0,this.CurrencySymbol="$",this.CurrencyPositionBefore=!1,this.NegativeBraces=!1,this.DateTimeFormatString=null,this.CurrencyPositivePattern=null,this.CurrencyNegativePattern=null}function u(){var t=null!==a&&a.apply(this,arguments)||this;return t.multipleFiles=!1,t.matrix=null,t.imageCache=null,t.cellStyleList=null,t.dataStyleList=null,t.sheetNameList=null,t.matrixList=null,t.firstPageIndexList=null,t.minRowList=null,t.maxRowList=null,t.cellStyleTableList=null,t.imageQuality=.75,t.imageResolution=96,t.xmlIndentation=1,t}k=t=W.Report||(W.Report={}),Y=e=k.Export||(k.Export={}),c=W.System.Char,N=W.Report.Components.StiCheckBox,g=W.System.Globalization.CultureInfo,h=W.Base.Zip.StiZipWriter20,w=W.Report.ImageFormat,O=W.Report.Components.IStiExportImageExtended,M=W.Report.Components.StiText,G=W.System.StiArray,V=W.System.Collections.Hashtable,m=W.Report.Components.StiPageOrientation,_=W.Report.Components.StiPagesCollection,H=W.System.DateTime,j=W.System.Xml.Formatting,q=W.System.Xml.XmlTextWriter,K=W.System.Text.Encoding,r=W.System.IO.StreamWriter,i=W.System.Drawing.Color,J=W.System.StiString,Q=W.System.IO.MemoryStream,n=W.Base.Localization.StiLocalization,Z=W.Base.Drawing.StiTextHorAlignment,$=W.Base.Drawing.StiVertAlignment,d=s,p=l,a=Y.StiExportService,__extends(u,a),u.prototype.implements=function(){return[Y.IStiOdsExportService]},Object.defineProperty(u.prototype,"defaultExtension",{get:function(){return"ods"},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"exportFormat",{get:function(){return k.StiExportFormat.Ods},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"groupCategory",{get:function(){return"Excel"},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"position",{get:function(){return Y.StiExportPosition.Ods},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"exportNameInMenu",{get:function(){return n.get("Export","ExportTypeCalcFile")},enumerable:!1,configurable:!0}),u.prototype.getFilter=function(){return n.get("FileFilters","WriteCalcFilesrFiles")},u.prototype.exportTo=function(t,e,r){this.exportOds(t,e,r)},u.prototype.exportToAsync=function(t,e,r,i){var n=this;W.Report.Export.StiExportImageHelper.convertAllImages(e,W.System.Drawing.Imaging.ImageFormat.Jpeg).try(function(){n.exportTo(e,r,i),null!=e&&null!=e.preparedExportImages&&(e.preparedExportImages.clear(),e.preparedExportImages=null),t()})},u.prototype.doubleToString=function(t){return Math.round2(t/100,4).toString().stimulsoft.replaceAll(",",".")+"in"},u.prototype.getColumnName=function(t){var e=t/26|0,r=t%26,t="";return 0<e&&(t+=String.fromCharCode(65+e-1)),t+=String.fromCharCode(65+r)},u.prototype.getColorString=function(t){return"#"+J.format("{0:X8}",t.toArgb()).substr(2)},u.prototype.getCellStyleNumber=function(t,e,r,i){for(var n=new d,o=!0,a=!0,s=0;s<r;s++)null==this.matrix.bordersY[t+s][e]&&(o=!1),null==this.matrix.bordersY[t+s][e+i]&&(a=!1);for(var l=!0,m=!0,s=0,c,p,g,g,c;s<i;s++)null==this.matrix.bordersX[t][e+s]&&(l=!1),null==this.matrix.bordersX[t+r][e+s]&&(m=!1);if(l&&(n.BorderTop=this.getStringFromBorder(this.matrix.bordersX[t][e])),o&&(n.BorderLeft=this.getStringFromBorder(this.matrix.bordersY[t][e])),m&&(n.BorderBottom=this.getStringFromBorder(this.matrix.bordersX[t+r][e])),a&&(n.BorderRight=this.getStringFromBorder(this.matrix.bordersY[t][e+i])),null!=this.matrix.cells[t][e]&&(p=(c=this.matrix.cells[t][e]).cellStyle,n.BackColor=p.color,n.VertAlign=p.vertAlignment,n.FontName=p.font.name,n.FontSize=p.font.sizeInPoints,n.Bold=p.font.bold,n.Italic=p.font.italic,n.Underline=p.font.underline,n.FontColor=p.textColor,n.HorAlign=p.horAlignment,g=0,null!=p.textOptions&&(g=p.textOptions.angle,n.Wordwrap=p.textOptions.wordWrap),n.Angle=0|Math.round(g),null!=c.component&&(null!=(g=c.component.stimulsoft.as(M))&&(n.DataStyle=this.getDataStyleNumber(g)),null==(c=c.component.stimulsoft.as(N))||J.isNullOrEmpty(c.excelDataValue)||(n.FontName=W["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.name,n.FontSize=W["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.sizeInPoints,n.Bold=W["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.bold,n.Italic=W["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.italic,n.Underline=W["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.underline,n.VertAlign=W["StiOptions"].Export.CheckBoxReplacementForExcelValue.VertAlignment,n.HorAlign=W["StiOptions"].Export.CheckBoxReplacementForExcelValue.HorAlignment))),0<this.cellStyleList.length)for(var s=0;s<this.cellStyleList.length;s++){var h=this.cellStyleList[s];if(h.BorderLeft==n.BorderLeft&&h.BorderRight==n.BorderRight&&h.BorderTop==n.BorderTop&&h.BorderBottom==n.BorderBottom&&h.BackColor.equals(n.BackColor)&&h.VertAlign==n.VertAlign&&h.FontName==n.FontName&&h.FontSize==n.FontSize&&h.Bold==n.Bold&&h.Italic==n.Italic&&h.Underline==n.Underline&&h.FontColor.equals(n.FontColor)&&h.HorAlign==n.HorAlign&&h.Angle==n.Angle&&h.Wordwrap==n.Wordwrap&&h.DataStyle==n.DataStyle)return s}return this.cellStyleList.push(n),this.cellStyleList.length-1},u.prototype.getStringFromBorder=function(t){return J.format("{0} solid {1}",this.doubleToString(t.size),this.getColorString(t.color))},u.prototype.getDataStyleNumber=function(t){var e=new p,r=t.format,i=null!=t&&t.hideZeros,n=null!=r?r.indexOf("|"):-1,o;if(-1!=n&&(e.CurrencyPositivePattern=Y.StiExportUtils.getPositivePattern(r.charCodeAt(n+1)-65),e.CurrencyNegativePattern=Y.StiExportUtils.getNegativePattern(r.charCodeAt(n+2)-65),r=r.substr(0,n)),J.isNullOrEmpty(r))return-1;if("C"==r.charAt(0)&&(e.isCurrency=!0),"N"==r.charAt(0)&&(e.isNumeric=!0),"P"==r.charAt(0)&&(e.isPercent=!0),"D"==r.charAt(0)&&(e.isDate=!0,1<r.length&&(e.DateTimeFormatString=r.substr(1))),"T"==r.charAt(0)&&(e.isTime=!0,1<r.length&&(e.DateTimeFormatString=r.substr(1))),1==r.length)e.isDefaultFormat=!0;else if(e.isCurrency||e.isNumeric||e.isPercent){var a=1;if(c.isDigit(r,a)){var s="";while(a<r.length&&c.isDigit(r,a))s+=r.charAt(a),a++;e.DecimalDigits=parseInt(s)}a<r.length&&"G"==r.charAt(a)&&(a++,e.GroupDigits=3),a<r.length&&"("==r.charAt(a)&&(a++,e.NegativeBraces=!0),a<r.length&&("."==r.charAt(a)||","==r.charAt(a))&&(e.DecimalComma=r.charAt(a),a++),a<r.length&&("+"==r.charAt(a)||"-"==r.charAt(a))&&("+"==r.charAt(a)&&(e.CurrencyPositionBefore=!0),++a<r.length&&(e.CurrencySymbol=r.substr(a)))}if(t.hideZeros&&!J.isNullOrEmpty(r)&&(e.isDefaultFormat=!1),0<this.dataStyleList.length)for(var l=0;l<this.dataStyleList.length;l++){var m=this.dataStyleList.stimulsoft.getByIndex(l);if(m.isNumeric==e.isNumeric&&m.isCurrency==e.isCurrency&&m.isPercent==e.isPercent&&m.isDate==e.isDate&&m.isTime==e.isTime&&m.isDefaultFormat==e.isDefaultFormat&&m.DecimalDigits==e.DecimalDigits&&m.DecimalComma==e.DecimalComma&&m.GroupDigits==e.GroupDigits&&m.CurrencySymbol==e.CurrencySymbol&&m.CurrencyPositionBefore==e.CurrencyPositionBefore&&m.DateTimeFormatString==e.DateTimeFormatString&&m.CurrencyPositivePattern==e.CurrencyPositivePattern&&m.CurrencyNegativePattern==e.CurrencyNegativePattern)return l}return this.dataStyleList.push(e),this.dataStyleList.stimulsoft.countItems-1},u.prototype.writeMimetype=function(){var t=new Q,e=new r(t,K.ASCII);return e.write("application/vnd.oasis.opendocument.spreadsheet"),e.flush(),t},u.prototype.writeMeta=function(){var t=new Q,e=new q(K.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?j.None:j.Indented,e.writeStartDocument(),e.writeStartElement("office:document-meta"),e.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),e.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),e.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),e.writeAttributeString("xmlns:meta","urn:oasis:names:tc:opendocument:xmlns:meta:1.0"),e.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),e.writeAttributeString("office:version","1.1"),e.writeStartElement("office:meta");var r=H.now.toString("yyyy-MM-ddTHH:mm:ss"),i=Y.StiExportUtils.getReportVersion();return e.writeElementString("meta:generator",i),e.writeElementString("meta:creation-date",r),e.writeElementString("dc:date",r),e.writeElementString("meta:editing-cycles","1"),e.writeElementString("meta:editing-duration","PT0M0S"),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 1"),e.writeEndElement(),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 2"),e.writeEndElement(),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 3"),e.writeEndElement(),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 4"),e.writeEndElement(),e.writeStartElement("meta:document-statistic"),e.writeAttributeString("meta:table-count","1"),e.writeAttributeString("meta:cell-count","1"),e.writeEndElement(),e.writeFullEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},u.prototype.writeManifest=function(){var t=new Q,e=new q(K.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?j.None:j.Indented,e.writeStartDocument(),e.writeStartElement("manifest:manifest"),e.writeAttributeString("xmlns:manifest","urn:oasis:names:tc:opendocument:xmlns:manifest:1.0"),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","application/vnd.oasis.opendocument.spreadsheet"),e.writeAttributeString("manifest:full-path","/"),e.writeEndElement();for(var r=0;r<this.imageCache.imagePackedStore.stimulsoft.countItems;r++)e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","image/jpeg"),e.writeAttributeString("manifest:full-path",J.format("Pictures/{0:D5}.jpg",r+1)),e.writeEndElement();return e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","content.xml"),e.writeEndElement(),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","styles.xml"),e.writeEndElement(),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","meta.xml"),e.writeEndElement(),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","settings.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},u.prototype.writeImage=function(t){var e=new Q,t=this.imageCache.imagePackedStore[t];return e.write(t,0,t.length),e},u.prototype.writeSettings=function(){var t=new Q,e=new q(K.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?j.None:j.Indented,e.writeStartDocument(),e.writeStartElement("office:document-settings"),e.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),e.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),e.writeAttributeString("xmlns:config","urn:oasis:names:tc:opendocument:xmlns:config:1.0"),e.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),e.writeAttributeString("office:version","1.1"),e.writeStartElement("office:settings"),e.writeStartElement("config:config-item-set"),e.writeAttributeString("config:name","ooo:view-settings"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleAreaTop"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleAreaLeft"),e.writeAttributeString("config:type","int"),e.writeString("-10107"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleAreaWidth"),e.writeAttributeString("config:type","int"),e.writeString("43208"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleAreaHeight"),e.writeAttributeString("config:type","int"),e.writeString("22174"),e.writeEndElement(),e.writeStartElement("config:config-item-map-indexed"),e.writeAttributeString("config:name","Views"),e.writeStartElement("config:config-item-map-entry"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewId"),e.writeAttributeString("config:type","string"),e.writeString("View1"),e.writeEndElement(),e.writeStartElement("config:config-item-map-named"),e.writeAttributeString("config:name","Tables"),e.writeStartElement("config:config-item-map-entry"),e.writeAttributeString("config:name","Sheet1"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CursorPositionX"),e.writeAttributeString("config:type","int"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CursorPositionY"),e.writeAttributeString("config:type","int"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HorizontalSplitMode"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VerticalSplitMode"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HorizontalSplitPosition"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VerticalSplitPosition"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ActiveSplitRange"),e.writeAttributeString("config:type","short"),e.writeString("2"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PositionLeft"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PositionRight"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PositionTop"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PositionBottom"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ActiveTable"),e.writeAttributeString("config:type","string"),e.writeString("Sheet1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HorizontalScrollbarWidth"),e.writeAttributeString("config:type","int"),e.writeString("270"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ZoomType"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ZoomValue"),e.writeAttributeString("config:type","int"),e.writeString("100"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PageViewZoomValue"),e.writeAttributeString("config:type","int"),e.writeString("60"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowPageBreakPreview"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowZeroValues"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowNotes"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowGrid"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","GridColor"),e.writeAttributeString("config:type","long"),e.writeString("12632256"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowPageBreaks"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HasColumnRowHeaders"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HasSheetTabs"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsOutlineSymbolsSet"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsSnapToRaster"),e.writeAttributeString("config:type","long"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterIsVisible"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterResolutionX"),e.writeAttributeString("config:type","int"),e.writeString("1000"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterResolutionY"),e.writeAttributeString("config:type","int"),e.writeString("1000"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterSubdivisionX"),e.writeAttributeString("config:type","int"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterSubdivisionY"),e.writeAttributeString("config:type","int"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsRasterAxisSynchronized"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("config:config-item-set"),e.writeAttributeString("config:name","ooo:configuration-settings"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowZeroValues"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowNotes"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowGrid"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","GridColor"),e.writeAttributeString("config:type","long"),e.writeString("12632256"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowPageBreaks"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","LinkUpdateMode"),e.writeAttributeString("config:type","short"),e.writeString("3"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HasColumnRowHeaders"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HasSheetTabs"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsOutlineSymbolsSet"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsSnapToRaster"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterIsVisible"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterResolutionX"),e.writeAttributeString("config:type","int"),e.writeString("1000"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterResolutionY"),e.writeAttributeString("config:type","int"),e.writeString("1000"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterSubdivisionX"),e.writeAttributeString("config:type","int"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterSubdivisionY"),e.writeAttributeString("config:type","int"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsRasterAxisSynchronized"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AutoCalculate"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrinterName"),e.writeAttributeString("config:type","string"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrinterSetup"),e.writeAttributeString("config:type","base64Binary"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ApplyUserData"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CharacterCompressionType"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsKernAsianPunctuation"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","SaveVersionOnClose"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UpdateFromTemplate"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AllowPrintJobCancel"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","LoadReadonly"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},u.prototype.writeStyles=function(t){var e=new Q,r=new q(K.UTF8,e);r.indentation=this.xmlIndentation<0?0:this.xmlIndentation,r.formatting=this.xmlIndentation<0?j.None:j.Indented,r.writeStartDocument(),r.writeStartElement("office:document-styles"),r.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),r.writeAttributeString("xmlns:style","urn:oasis:names:tc:opendocument:xmlns:style:1.0"),r.writeAttributeString("xmlns:text","urn:oasis:names:tc:opendocument:xmlns:text:1.0"),r.writeAttributeString("xmlns:table","urn:oasis:names:tc:opendocument:xmlns:table:1.0"),r.writeAttributeString("xmlns:draw","urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"),r.writeAttributeString("xmlns:fo","urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0"),r.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),r.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),r.writeAttributeString("xmlns:meta","urn:oasis:names:tc:opendocument:xmlns:meta:1.0"),r.writeAttributeString("xmlns:number","urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0"),r.writeAttributeString("xmlns:presentation","urn:oasis:names:tc:opendocument:xmlns:presentation:1.0"),r.writeAttributeString("xmlns:svg","urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0"),r.writeAttributeString("xmlns:chart","urn:oasis:names:tc:opendocument:xmlns:chart:1.0"),r.writeAttributeString("xmlns:dr3d","urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"),r.writeAttributeString("xmlns:math","http://www.w3.org/1998/Math/MathML"),r.writeAttributeString("xmlns:form","urn:oasis:names:tc:opendocument:xmlns:form:1.0"),r.writeAttributeString("xmlns:script","urn:oasis:names:tc:opendocument:xmlns:script:1.0"),r.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),r.writeAttributeString("xmlns:ooow","http://openoffice.org/2004/writer"),r.writeAttributeString("xmlns:oooc","http://openoffice.org/2004/calc"),r.writeAttributeString("xmlns:dom","http://www.w3.org/2001/xml-events"),r.writeAttributeString("office:version","1.1"),r.writeStartElement("office:font-face-decls"),r.writeStartElement("style:font-face"),r.writeAttributeString("style:name","Arial"),r.writeAttributeString("svg:font-family","Arial"),r.writeEndElement(),r.writeStartElement("style:font-face"),r.writeAttributeString("style:name","Tahoma"),r.writeAttributeString("svg:font-family","Tahoma"),r.writeAttributeString("style:font-family-generic","system"),r.writeAttributeString("style:font-pitch","variable"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("office:styles"),r.writeStartElement("style:default-style"),r.writeAttributeString("style:family","table-cell"),r.writeStartElement("style:table-cell-properties"),r.writeAttributeString("style:decimal-places","2"),r.writeEndElement(),r.writeStartElement("style:paragraph-properties"),r.writeAttributeString("style:tab-stop-distance","1.25cm"),r.writeEndElement(),r.writeStartElement("style:text-properties"),r.writeAttributeString("style:font-name","Arial"),r.writeAttributeString("fo:language","ru"),r.writeAttributeString("fo:country","RU"),r.writeAttributeString("style:font-name-asian","Lucida Sans Unicode"),r.writeAttributeString("style:language-asian","zxx"),r.writeAttributeString("style:country-asian","none"),r.writeAttributeString("style:font-name-complex","Tahoma"),r.writeAttributeString("style:language-complex","zxx"),r.writeAttributeString("style:country-complex","none"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("number:number-style"),r.writeAttributeString("style:name","N0"),r.writeStartElement("number:number"),r.writeAttributeString("number:min-integer-digits","1"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:style"),r.writeAttributeString("style:name","Default"),r.writeAttributeString("style:family","table-cell"),r.writeEndElement(),r.writeStartElement("style:style"),r.writeAttributeString("style:name","Result"),r.writeAttributeString("style:family","table-cell"),r.writeAttributeString("style:parent-style-name","Default"),r.writeStartElement("style:text-properties"),r.writeAttributeString("fo:font-style","italic"),r.writeAttributeString("style:text-underline-style","solid"),r.writeAttributeString("style:text-underline-width","auto"),r.writeAttributeString("style:text-underline-color","font-color"),r.writeAttributeString("fo:font-weight","bold"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:style"),r.writeAttributeString("style:name","Heading"),r.writeAttributeString("style:family","table-cell"),r.writeAttributeString("style:parent-style-name","Default"),r.writeStartElement("style:table-cell-properties"),r.writeAttributeString("style:text-align-source","fix"),r.writeAttributeString("style:repeat-content","false"),r.writeEndElement(),r.writeStartElement("style:paragraph-properties"),r.writeAttributeString("fo:text-align","center"),r.writeEndElement(),r.writeStartElement("style:text-properties"),r.writeAttributeString("fo:font-size","16pt"),r.writeAttributeString("fo:font-style","italic"),r.writeAttributeString("fo:font-weight","bold"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:style"),r.writeAttributeString("style:name","Heading1"),r.writeAttributeString("style:family","table-cell"),r.writeAttributeString("style:parent-style-name","Heading"),r.writeStartElement("style:table-cell-properties"),r.writeAttributeString("style:rotation-angle","90"),r.writeEndElement(),r.writeEndElement(),r.writeFullEndElement(),r.writeStartElement("office:automatic-styles");var i=t.getByIndex(0),n=i.unit.convertToHInches(i.pageHeight*i.segmentPerHeight),o=i.unit.convertToHInches(i.pageWidth*i.segmentPerWidth),a=i.unit.convertToHInches(i.margins.left),s=i.unit.convertToHInches(i.margins.right),l=i.unit.convertToHInches(i.margins.top),t=i.unit.convertToHInches(i.margins.bottom)-4;return t<0&&(t=0),r.writeStartElement("style:page-layout"),r.writeAttributeString("style:name","pm1"),r.writeStartElement("style:page-layout-properties"),r.writeAttributeString("fo:page-width",this.doubleToString(o)),r.writeAttributeString("fo:page-height",this.doubleToString(n)),r.writeAttributeString("style:num-format","1"),r.writeAttributeString("style:print-orientation",i.orientation==m.Portrait?"portrait":"landscape"),r.writeAttributeString("fo:margin-top",this.doubleToString(l)),r.writeAttributeString("fo:margin-bottom",this.doubleToString(t)),r.writeAttributeString("fo:margin-left",this.doubleToString(a)),r.writeAttributeString("fo:margin-right",this.doubleToString(s)),r.writeAttributeString("style:writing-mode","lr-tb"),r.writeEndElement(),r.writeStartElement("style:header-style"),r.writeStartElement("style:header-footer-properties"),r.writeAttributeString("fo:min-height","0.101cm"),r.writeAttributeString("fo:margin-left","0cm"),r.writeAttributeString("fo:margin-right","0cm"),r.writeAttributeString("fo:margin-bottom","0cm"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:footer-style"),r.writeStartElement("style:header-footer-properties"),r.writeAttributeString("fo:min-height","0.101cm"),r.writeAttributeString("fo:margin-left","0cm"),r.writeAttributeString("fo:margin-right","0cm"),r.writeAttributeString("fo:margin-top","0cm"),r.writeEndElement(),r.writeEndElement(),r.writeEndElement(),r.writeFullEndElement(),r.writeStartElement("office:master-styles"),r.writeStartElement("style:master-page"),r.writeAttributeString("style:name","Default"),r.writeAttributeString("style:page-layout-name","pm1"),r.writeStartElement("style:header"),r.writeAttributeString("style:display","false"),r.writeStartElement("text:p"),r.writeStartElement("text:sheet-name"),r.writeString("Sheet1"),r.writeEndElement(),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:header-left"),r.writeAttributeString("style:display","false"),r.writeEndElement(),r.writeStartElement("style:footer"),r.writeAttributeString("style:display","false"),r.writeStartElement("text:p"),r.writeString("Page "),r.writeStartElement("text:page-number"),r.writeString("1"),r.writeEndElement(),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:footer-left"),r.writeAttributeString("style:display","false"),r.writeEndElement(),r.writeEndElement(),r.writeEndElement(),r.writeFullEndElement(),r.writeEndDocument(),r.flush(),e},u.prototype.writeContent=function(t,e){var r,i,n,o,a=new Q,s=new q(K.UTF8,a);s.indentation=this.xmlIndentation<0?0:this.xmlIndentation,s.formatting=this.xmlIndentation<0?j.None:j.Indented,s.writeStartDocument(),s.writeStartElement("office:document-content"),s.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),s.writeAttributeString("xmlns:style","urn:oasis:names:tc:opendocument:xmlns:style:1.0"),s.writeAttributeString("xmlns:text","urn:oasis:names:tc:opendocument:xmlns:text:1.0"),s.writeAttributeString("xmlns:table","urn:oasis:names:tc:opendocument:xmlns:table:1.0"),s.writeAttributeString("xmlns:draw","urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"),s.writeAttributeString("xmlns:fo","urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0"),s.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),s.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),s.writeAttributeString("xmlns:meta","urn:oasis:names:tc:opendocument:xmlns:meta:1.0"),s.writeAttributeString("xmlns:number","urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0"),s.writeAttributeString("xmlns:presentation","urn:oasis:names:tc:opendocument:xmlns:presentation:1.0"),s.writeAttributeString("xmlns:svg","urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0"),s.writeAttributeString("xmlns:chart","urn:oasis:names:tc:opendocument:xmlns:chart:1.0"),s.writeAttributeString("xmlns:dr3d","urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"),s.writeAttributeString("xmlns:math","http://www.w3.org/1998/Math/MathML"),s.writeAttributeString("xmlns:form","urn:oasis:names:tc:opendocument:xmlns:form:1.0"),s.writeAttributeString("xmlns:script","urn:oasis:names:tc:opendocument:xmlns:script:1.0"),s.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),s.writeAttributeString("xmlns:ooow","http://openoffice.org/2004/writer"),s.writeAttributeString("xmlns:oooc","http://openoffice.org/2004/calc"),s.writeAttributeString("xmlns:dom","http://www.w3.org/2001/xml-events"),s.writeAttributeString("xmlns:xforms","http://www.w3.org/2002/xforms"),s.writeAttributeString("xmlns:xsd","http://www.w3.org/2001/XMLSchema"),s.writeAttributeString("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance"),s.writeAttributeString("office:version","1.1");var l=0;while(l<e.count){var m=new _(t,e);m.addV2Internal(e.getByIndex(l));var c=l,p=e.getByIndex(l).excelSheetValue;while(l<e.count-1&&e.getByIndex(l+1).excelSheetValue==p)l++,m.addV2Internal(e.getByIndex(l));m.cacheMode=t.renderedPages.cacheMode;var g=m.getByIndex(0).excelSheetValue;J.isNullOrEmpty(g)&&(g=J.format("Page {0}",this.sheetNameList.stimulsoft.countItems+1));var h="",w=1;if(this.matrix=new Y.StiMatrix(m,W["StiOptions"].Export.OpenDocumentCalc.divideBigCells,this),this.isStopped)return null;var d=0,u;do{if(this.firstPageIndexList.push(c),this.matrixList.push(this.matrix),(u=this.matrix.coordY.countItems-1)-d>W["StiOptions"].Export.OpenDocumentCalc.maximumSheetHeight?u=d+W["StiOptions"].Export.OpenDocumentCalc.maximumSheetHeight:this.matrix=null,this.minRowList.push(d),this.maxRowList.push(u),d=u,(null!=this.matrix||0<h.length)&&(h=J.format(" part{0}",w++)),this.sheetNameList.push(g+h),this.isStopped)return null}while(null!=this.matrix);l++}for(var S=new V,f=new V,v=new V,E=new V,b=0;b<this.matrixList.stimulsoft.countItems;b++){this.matrix=this.matrixList.stimulsoft.getByIndex(b);for(var d=this.minRowList.stimulsoft.getByIndex(b),u=this.maxRowList.stimulsoft.getByIndex(b),y=G.create2(Boolean,this.matrix.coordY.countItems,this.matrix.coordX.countItems),x=G.create2(Number,this.matrix.coordY.countItems,this.matrix.coordX.countItems),A=0;A<this.matrix.coordX.countItems-1;A++){var T=this.matrix.coordX.getByIndex(A+1)-this.matrix.coordX.getByIndex(A),P;v.containsKey(T)||(P=v.count,v.set(T,P),E.set(P,T))}for(var L=d+1;L<u+1;L++){var C=this.matrix.coordY.getByIndex(L)-this.matrix.coordY.getByIndex(L-1),P;S.containsKey(C)||(P=S.count,S.set(C,P),f.set(P,C));for(var A=1;A<this.matrix.coordX.countItems;A++){var F=this.matrix.cells[L-1][A-1];if(!y[L][A])if(null!=F){for(var R=0;R<=F.height;R++)for(var I=0;I<=F.width;I++)y[L+R][A+I]=!0;x[L-1][A-1]=this.getCellStyleNumber(L-1,A-1,F.height+1,F.width+1)}else x[L-1][A-1]=this.getCellStyleNumber(L-1,A-1,1,1)}}this.cellStyleTableList.push(x)}s.writeStartElement("office:scripts"),s.writeEndElement();var B=new V;try{for(var D=__values(this.cellStyleList),k=D.next();!k.done;k=D.next()){var N=k.value;B.set(N.FontName,N.FontName)}}catch(t){r={error:t}}finally{try{k&&!k.done&&(i=D.return)&&i.call(D)}finally{if(r)throw r.error}}s.writeStartElement("office:font-face-decls");try{for(var O=__values(B.keys),M=O.next();!M.done;M=O.next()){var H=M.value,H=B.get(H);s.writeStartElement("style:font-face"),s.writeAttributeString("style:name",H),s.writeAttributeString("svg:font-family",H),s.writeEndElement()}}catch(t){n={error:t}}finally{try{M&&!M.done&&(o=O.return)&&o.call(O)}finally{if(n)throw n.error}}s.writeEndElement(),s.writeStartElement("office:automatic-styles");for(var A=0;A<v.count;A++){s.writeStartElement("style:style"),s.writeAttributeString("style:name",J.format("co{0}",A+1)),s.writeAttributeString("style:family","table-column"),s.writeStartElement("style:table-column-properties"),s.writeAttributeString("fo:break-before","auto");var T=E.get(A);s.writeAttributeString("style:column-width",this.doubleToString(T)),s.writeEndElement(),s.writeEndElement()}for(var L=0;L<S.count;L++){s.writeStartElement("style:style"),s.writeAttributeString("style:name",J.format("ro{0}",L+1)),s.writeAttributeString("style:family","table-row"),s.writeStartElement("style:table-row-properties");var C=f.get(L);s.writeAttributeString("style:row-height",this.doubleToString(C)),s.writeAttributeString("fo:break-before","auto"),s.writeAttributeString("style:use-optimal-row-height","false"),s.writeEndElement(),s.writeEndElement()}s.writeStartElement("style:style"),s.writeAttributeString("style:name","ta1"),s.writeAttributeString("style:family","table"),s.writeAttributeString("style:master-page-name","Default"),s.writeStartElement("style:table-properties"),s.writeAttributeString("table:display","true"),s.writeAttributeString("style:writing-mode","lr-tb"),s.writeEndElement(),s.writeEndElement(),s.writeStartElement("style:style"),s.writeAttributeString("style:name","gr1"),s.writeAttributeString("style:family","graphic"),s.writeStartElement("style:graphic-properties"),s.writeAttributeString("draw:stroke","none"),s.writeAttributeString("draw:fill","none"),s.writeAttributeString("draw:textarea-horizontal-align","center"),s.writeAttributeString("draw:textarea-vertical-align","middle"),s.writeAttributeString("draw:color-mode","standard"),s.writeAttributeString("draw:luminance","0%"),s.writeAttributeString("draw:contrast","0%"),s.writeAttributeString("draw:gamma","100%"),s.writeAttributeString("draw:red","0%"),s.writeAttributeString("draw:green","0%"),s.writeAttributeString("draw:blue","0%"),s.writeAttributeString("fo:clip","rect(0cm 0cm 0cm 0cm)"),s.writeAttributeString("draw:image-opacity","100%"),s.writeAttributeString("style:mirror","none"),s.writeEndElement(),s.writeEndElement(),s.writeStartElement("style:style"),s.writeAttributeString("style:name","P1"),s.writeAttributeString("style:family","paragraph"),s.writeStartElement("style:paragraph-properties"),s.writeAttributeString("fo:text-align","center"),s.writeEndElement(),s.writeEndElement();for(var U=0,z;U<this.dataStyleList.stimulsoft.countItems;U++){(z=this.dataStyleList.stimulsoft.getByIndex(U)).isNumeric&&(s.writeStartElement("number:number-style"),z.NegativeBraces?(s.writeAttributeString("style:name",J.format("N{0}P0",U+1)),s.writeAttributeString("style:volatile","true")):s.writeAttributeString("style:name",J.format("N{0}",U+1))," "!=z.DecimalComma&&(s.writeAttributeString("number:language",","==z.DecimalComma?"ru":"en"),s.writeAttributeString("number:country",","==z.DecimalComma?"RU":"US")),s.writeStartElement("number:number"),s.writeAttributeString("number:decimal-places",z.DecimalDigits.toString()),s.writeAttributeString("number:min-integer-digits","1"),s.writeAttributeString("number:grouping",3==z.GroupDigits?"true":"false"),s.writeEndElement(),s.writeEndElement(),z.NegativeBraces&&(s.writeStartElement("number:number-style"),s.writeAttributeString("style:name",J.format("N{0}",U+1))," "!=z.DecimalComma&&(s.writeAttributeString("number:language",","==z.DecimalComma?"ru":"en"),s.writeAttributeString("number:country",","==z.DecimalComma?"RU":"US")),s.writeElementString("number:text","("),s.writeStartElement("number:number"),s.writeAttributeString("number:decimal-places",z.DecimalDigits.toString()),s.writeAttributeString("number:min-integer-digits","1"),s.writeAttributeString("number:grouping",3==z.GroupDigits?"true":"false"),s.writeEndElement(),s.writeElementString("number:text",")"),s.writeStartElement("style:map"),s.writeAttributeString("style:condition","value()>=0"),s.writeAttributeString("style:apply-style-name",J.format("N{0}P0",U+1)),s.writeEndElement(),s.writeEndElement())),z.isPercent&&(s.writeStartElement("number:percentage-style"),s.writeAttributeString("style:name",J.format("N{0}",U+1))," "!=z.DecimalComma&&(s.writeAttributeString("number:language",","==z.DecimalComma?"ru":"en"),s.writeAttributeString("number:country",","==z.DecimalComma?"RU":"US")),s.writeStartElement("number:number"),s.writeAttributeString("number:decimal-places",z.DecimalDigits.toString()),s.writeAttributeString("number:min-integer-digits","1"),3==z.GroupDigits&&s.writeAttributeString("number:grouping","true"),s.writeEndElement(),s.writeElementString("number:text","%"),s.writeEndElement()),z.isCurrency&&(s.writeStartElement("number:currency-style"),s.writeAttributeString("style:name",J.format("N{0}",U+1))," "!=z.DecimalComma&&(s.writeAttributeString("number:language",","==z.DecimalComma?"ru":"en"),s.writeAttributeString("number:country",","==z.DecimalComma?"RU":"US")),z.CurrencyPositionBefore&&s.writeElementString("number:currency-symbol",z.CurrencySymbol),s.writeStartElement("number:number"),s.writeAttributeString("number:decimal-places",z.DecimalDigits.toString()),s.writeAttributeString("number:min-integer-digits","1"),s.writeAttributeString("number:grouping",3==z.GroupDigits?"true":"false"),s.writeEndElement(),z.CurrencyPositionBefore||s.writeElementString("number:currency-symbol",z.CurrencySymbol),s.writeEndElement()),z.isDate&&(s.writeStartElement("number:date-style"),s.writeAttributeString("style:name",J.format("N{0}",U+1)),this.writeDateTimeFormatString(s,z.DateTimeFormatString,"d"),s.writeEndElement()),z.isTime&&(s.writeStartElement("number:time-style"),s.writeAttributeString("style:name",J.format("N{0}",U+1)),J.isNullOrEmpty(z.DateTimeFormatString)||-1==z.DateTimeFormatString.indexOf("h")||(s.writeAttributeString("number:language","en"),s.writeAttributeString("number:country","US")),this.writeDateTimeFormatString(s,z.DateTimeFormatString,"t"),s.writeEndElement())}for(var U=0;U<this.cellStyleList.stimulsoft.countItems;U++){var z=this.cellStyleList.stimulsoft.getByIndex(U);s.writeStartElement("style:style"),s.writeAttributeString("style:name",J.format("ce{0}",U+1)),s.writeAttributeString("style:family","table-cell"),s.writeAttributeString("style:parent-style-name","Default"),-1!=z.DataStyle&&s.writeAttributeString("style:data-style-name",J.format("N{0}",z.DataStyle+1)),s.writeStartElement("style:table-cell-properties"),0<z.BackColor.a?s.writeAttributeString("fo:background-color",this.getColorString(z.BackColor)):s.writeAttributeString("fo:background-color","transparent"),z.VertAlign==$.Center&&s.writeAttributeString("style:vertical-align","middle"),z.VertAlign==$.Top&&s.writeAttributeString("style:vertical-align","top"),s.writeAttributeString("style:text-align-source","fix"),s.writeAttributeString("style:repeat-content","false"),z.Wordwrap&&s.writeAttributeString("fo:wrap-option","wrap"),s.writeAttributeString("fo:padding","0in"),s.writeAttributeString("fo:border-left",z.BorderLeft),s.writeAttributeString("fo:border-right",z.BorderRight),s.writeAttributeString("fo:border-top",z.BorderTop),s.writeAttributeString("fo:border-bottom",z.BorderBottom),0!=z.Angle&&(s.writeAttributeString("style:rotation-angle",z.Angle.toString()),s.writeAttributeString("style:rotation-align","none")),s.writeEndElement(),s.writeStartElement("style:paragraph-properties"),z.HorAlign==Z.Left&&s.writeAttributeString("fo:text-align","start"),z.HorAlign==Z.Center&&s.writeAttributeString("fo:text-align","center"),z.HorAlign==Z.Right&&s.writeAttributeString("fo:text-align","end"),z.HorAlign==Z.Width&&s.writeAttributeString("fo:text-align","justify"),s.writeAttributeString("fo:margin-left","0cm"),s.writeEndElement(),s.writeStartElement("style:text-properties"),s.writeAttributeString("fo:color",this.getColorString(z.FontColor)),s.writeAttributeString("style:font-name",z.FontName);var X=J.format("{0}pt",z.FontSize).stimulsoft.replaceAll(",",".");s.writeAttributeString("fo:font-size",X),s.writeAttributeString("fo:font-size-asian",X),s.writeAttributeString("fo:font-size-complex",X),z.Italic&&(s.writeAttributeString("fo:font-style","italic"),s.writeAttributeString("fo:font-style-asian","italic"),s.writeAttributeString("fo:font-style-complex","italic")),z.Underline&&(s.writeAttributeString("style:text-underline-style","solid"),s.writeAttributeString("style:text-underline-width","auto"),s.writeAttributeString("style:text-underline-color","font-color")),z.Bold&&(s.writeAttributeString("fo:font-weight","bold"),s.writeAttributeString("fo:font-weight-asian","bold"),s.writeAttributeString("fo:font-weight-complex","bold")),s.writeEndElement(),s.writeEndElement()}s.writeFullEndElement(),s.writeStartElement("office:body"),s.writeStartElement("office:spreadsheet"),s.writeStartElement("table:calculation-settings"),s.writeAttributeString("table:use-regular-expressions","false"),s.writeEndElement(),this.currentPassNumber=W["StiOptions"].Export.OpenDocumentCalc.divideSegmentPages?3:2;for(var b=0;b<this.matrixList.stimulsoft.countItems;b++)this.writeTableFromMatrix(s,b,S,v);return s.writeEndElement(),s.writeEndElement(),s.writeFullEndElement(),s.writeEndDocument(),s.flush(),a},u.prototype.writeDateTimeFormatString=function(t,e,r){if(J.isNullOrEmpty(e)&&(e=r),1==e.length){var r=this.currentCulture.dateTimeFormat;switch(e){case"d":e=r.shortDatePattern;break;case"D":e=r.longDatePattern;break;case"f":e=r.shortDatePattern+" "+r.shortTimePattern;break;case"F":e=r.fullDateTimePattern;break;case"g":e=r.shortDatePattern+" "+r.shortTimePattern;break;case"G":e=r.shortDatePattern+" "+r.longTimePattern;break;case"m":case"M":e=g.currentCulture.name.stimulsoft.contains("en")||g.currentCulture.name.stimulsoft.contains("us")?"MMMM d":"d MMMM";break;case"r":case"R":e="ddd, dd MMM yyyy HH\\:mm\\:ss \\G\\M\\T";break;case"s":e="yyyy\\-MM\\-dd\\THH\\:mm\\:ss";break;case"t":e=r.shortTimePattern;break;case"T":e=r.longTimePattern;break;case"u":e="yyyy\\-MM\\-dd HH\\:mm\\:ss\\Z";break;case"U":e=r.fullDateTimePattern;break;case"y":case"Y":e=r.yearMonthPattern;break}e=e.stimulsoft.replaceAll('"',"").stimulsoft.replaceAll("'","")}var i=0;while(i<e.length){var n=e.charAt(i),o=1;while(i+1<e.length&&e.charAt(i+1)==n)i++,o++;switch(i++,n){case"d":1==o&&(t.writeStartElement("number:day"),t.writeEndElement()),2==o&&(t.writeStartElement("number:day"),t.writeAttributeString("number:style","long"),t.writeEndElement()),3==o&&(t.writeStartElement("number:day-of-week"),t.writeEndElement()),4==o&&(t.writeStartElement("number:day-of-week"),t.writeAttributeString("number:style","long"),t.writeEndElement());break;case"M":1==o&&(t.writeStartElement("number:month"),t.writeEndElement()),2==o&&(t.writeStartElement("number:month"),t.writeAttributeString("number:style","long"),t.writeEndElement()),3==o&&(t.writeStartElement("number:month"),t.writeAttributeString("number:textual","true"),t.writeEndElement()),4==o&&(t.writeStartElement("number:month"),t.writeAttributeString("number:style","long"),t.writeAttributeString("number:textual","true"),t.writeEndElement());break;case"y":1!=o&&2!=o||(t.writeStartElement("number:year"),t.writeEndElement()),3!=o&&4!=o||(t.writeStartElement("number:year"),t.writeAttributeString("number:style","long"),t.writeEndElement());break;case"s":1==o&&(t.writeStartElement("number:seconds"),t.writeEndElement()),2==o&&(t.writeStartElement("number:seconds"),t.writeAttributeString("number:style","long"),t.writeEndElement());break;case"m":1==o&&(t.writeStartElement("number:minutes"),t.writeEndElement()),2==o&&(t.writeStartElement("number:minutes"),t.writeAttributeString("number:style","long"),t.writeEndElement());break;case"h":case"H":1==o&&(t.writeStartElement("number:hours"),t.writeEndElement()),2==o&&(t.writeStartElement("number:hours"),t.writeAttributeString("number:style","long"),t.writeEndElement());break;default:t.writeElementString("number:text",n);break}}},u.prototype.writeTableFromMatrix=function(t,e,r,i){var n=this.matrixList[e],o=this.minRowList[e],a=this.maxRowList[e],s=this.cellStyleTableList[e],l=this.sheetNameList[e],m=G.create2(Boolean,n.coordY.countItems,n.coordX.countItems);t.writeStartElement("table:table"),t.writeAttributeString("table:name",l),t.writeAttributeString("table:style-name","ta1"),t.writeAttributeString("table:print","false");for(var c=0;c<n.coordX.countItems-1;c++){var p=n.coordX.getByIndex(c+1)-n.coordX.getByIndex(c),p=i.get(p);t.writeStartElement("table:table-column"),t.writeAttributeString("table:style-name",J.format("co{0}",p+1)),t.writeAttributeString("table:default-cell-style-name","Default"),t.writeEndElement()}for(var g=Math.max(n.coordY.countItems/200,1),h=0,w=o+1;w<a+1;w++){var d=w/g|0;h<d&&(h=d,this.invokeExporting2(w,n.coordY.countItems,this.currentPassNumber,this.maximumPassNumber));var d=n.coordY.getByIndex(w)-n.coordY.getByIndex(w-1),d=r.get(d);t.writeStartElement("table:table-row"),t.writeAttributeString("table:style-name",J.format("ro{0}",d+1));for(var c=1;c<n.coordX.countItems;c++){var u=n.cells[w-1][c-1];if(m[w][c])t.writeStartElement("table:covered-table-cell"),t.writeEndElement();else if(null!=u){for(var S=0;S<=u.height;S++)for(var f=0;f<=u.width;f++)m[w+S][c+f]=!0;var v=s[w-1][c-1],E=this.cellStyleList[v].DataStyle;t.writeStartElement("table:table-cell"),t.writeAttributeString("table:style-name",J.format("ce{0}",v+1)),(0<u.width||0<u.height)&&(t.writeAttributeString("table:number-columns-spanned",(u.width+1).toString()),t.writeAttributeString("table:number-rows-spanned",(u.height+1).toString()));var b=u.component.stimulsoft.as(M),y=u.text,x=u.component.stimulsoft.as(N),x,b,E,y,x,E,y,b,b;if(null==x||J.isNullOrEmpty(x.excelDataValue)||(y=x.excelDataValue),!u.component.isExportAsImage(k.StiExportFormat.Ods)&&(!J.isNullOrEmpty(y)||null!=b&&null!=b.excelDataValue)){var A=!1,T=0,P=H.now,L=null,C;if(-1!=E&&null!=b&&null!=b.excelDataValue&&"-"!=b.excelDataValue){var C,F=(C=b.excelDataValue).replace(/[^\d.,-]/g,"").stimulsoft.replaceAll(",","."),L=this.dataStyleList[E],A=!0,R;try{L.isDate||L.isTime?(R=H.tryParseExact(C,[null])).successfully?P=R.result:A=!1:(T=parseFloat(F),isNaN(T)&&(A=!1,T=0))}catch(t){A=!1}A||null!=y||(y=C)}A?L.isDate?(t.writeAttributeString("office:value-type","date"),t.writeAttributeString("office:date-value",P.toString("yyyy-MM-dd"))):L.isTime?(t.writeAttributeString("office:value-type","time"),t.writeAttributeString("office:time-value",P.toString("PTHH\\Hmm\\Mss\\S"))):(C=T.toString().stimulsoft.replaceAll(",","."),L.isNumeric&&t.writeAttributeString("office:value-type","float"),L.isPercent&&t.writeAttributeString("office:value-type","percentage"),L.isCurrency&&t.writeAttributeString("office:value-type","currency"),t.writeAttributeString("office:value",C)):t.writeAttributeString("office:value-type","string");for(var I=Y.StiExportUtils.splitString(y,!0),B=0;B<I.length;B++){var D=I[B];t.writeStartElement("text:p"),t.writeString(D),t.writeEndElement()}}u.component.isExportAsImage(k.StiExportFormat.Ods)&&(t.writeAttributeString("office:value-type","string"),null!=(x=u.component.stimulsoft.as(O))&&(b=null,E={ref:this.imageResolution},null!=(b=x.getImage(E,k.StiExportFormat.Ods))&&(null!=(y=n.getRealImageData(u,b))&&(b=y),x=this.imageCache.addImageInt(b),E=n.coordX.getByIndex(c+u.width)-n.coordX.getByIndex(c-1),y=n.coordY.getByIndex(w+u.height)-n.coordY.getByIndex(w-1),b=J.format("'{0}'.{1}{2}",l,this.getColumnName(u.left+u.width+1),u.top+u.height+1+1),t.writeStartElement("draw:frame"),t.writeAttributeString("table:end-cell-address",b),t.writeAttributeString("table:end-x","0in"),t.writeAttributeString("table:end-y","0in"),t.writeAttributeString("draw:z-index","0"),t.writeAttributeString("draw:name",J.format("Picture{0}",x+1)),t.writeAttributeString("draw:style-name","gr1"),t.writeAttributeString("draw:text-style-name","P1"),t.writeAttributeString("text:anchor-type","paragraph"),t.writeAttributeString("svg:x",this.doubleToString(0)),t.writeAttributeString("svg:y",this.doubleToString(0)),t.writeAttributeString("svg:width",this.doubleToString(E)),t.writeAttributeString("svg:height",this.doubleToString(y)),t.writeStartElement("draw:image"),t.writeAttributeString("xlink:href",J.format("Pictures/{0:D5}.jpg",x+1)),t.writeAttributeString("xlink:type","simple"),t.writeAttributeString("xlink:show","embed"),t.writeAttributeString("xlink:actuate","onLoad"),t.writeStartElement("text:p"),t.writeEndElement(),t.writeEndElement(),t.writeEndElement()))),t.writeEndElement()}else{var v=s[w-1][c-1];t.writeStartElement("table:table-cell"),t.writeAttributeString("table:style-name",J.format("ce{0}",v+1)),t.writeEndElement()}}t.writeEndElement()}t.writeEndElement()},u.prototype.exportOds=function(t,e,r){var i,n;if(k.StiLogService.write(this.stimulsoft.getType(),"Export report to ODT format"),null==r)throw new Error("The 'settings' argument cannot be equal in null.");var o=r.pageRange;this.imageResolution=r.imageResolution,this.imageQuality=r.imageQuality,this.xmlIndentation=-1,this.imageQuality<0&&(this.imageQuality=0),1<this.imageQuality&&(this.imageQuality=1),this.imageResolution<10&&(this.imageResolution=10),this.imageResolution=this.imageResolution/100,this.currentCulture=g.currentCulture;try{g.currentCulture=g.cultures["en-US"],this.imageCache=new k.StiImageCache(W["StiOptions"].Export.OpenDocumentCalc.allowImageComparer,!0,w.Jpeg,this.imageQuality,!1),this.cellStyleList=[],this.dataStyleList=[],this.sheetNameList=[],this.matrixList=[],this.firstPageIndexList=[],this.minRowList=[],this.maxRowList=[],this.cellStyleTableList=[],this.currentPassNumber=0,this.maximumPassNumber=W["StiOptions"].Export.OpenDocumentCalc.divideSegmentPages?4:3;var a=o.getSelectedPages(t.renderedPages);if(W["StiOptions"].Export.OpenDocumentCalc.divideSegmentPages&&(a=Y.StiSegmentPagesDivider.divide(a,this),this.currentPassNumber=1),this.isStopped)return;var s=new h;if(s.begin(e,!0),s.addFile("content.xml",this.writeContent(t,a)),s.addFile("mimetype",this.writeMimetype()),s.addFile("meta.xml",this.writeMeta()),s.addFile("META-INF/manifest.xml",this.writeManifest()),s.addFile("settings.xml",this.writeSettings()),s.addFile("styles.xml",this.writeStyles(a)),0<this.imageCache.imagePackedStore.stimulsoft.countItems)for(var l=0;l<this.imageCache.imagePackedStore.stimulsoft.countItems;l++)s.addFile(J.format("Pictures/{0:D5}.jpg",l+1),this.writeImage(l));s.end()}finally{g.currentCulture=this.currentCulture,this.sheetNameList.stimulsoft.clear(),this.sheetNameList=null,this.firstPageIndexList.stimulsoft.clear(),this.firstPageIndexList=null,this.minRowList.stimulsoft.clear(),this.minRowList=null,this.maxRowList.stimulsoft.clear(),this.maxRowList=null;try{for(var m=__values(this.matrixList),c=m.next();!c.done;c=m.next()){var p=c.value;null!=p&&p.clear()}}catch(t){i={error:t}}finally{try{c&&!c.done&&(n=m.return)&&n.call(m)}finally{if(i)throw i.error}}this.matrixList.stimulsoft.clear(),this.matrixList=null,this.cellStyleTableList.stimulsoft.clear(),this.cellStyleTableList=null,this.dataStyleList.stimulsoft.clear(),this.dataStyleList=null,this.cellStyleList.stimulsoft.clear(),this.cellStyleList=null,this.imageCache.clear(),this.imageCache=null,t.renderedPages.cacheMode&&Y.StiMatrix.GCCollect()}},o=u,Y.StiOdsExportService=o}(Stimulsoft=Stimulsoft||{}),function(Y){var t,G,e,s,V,l,m,_,j,q,c,i,K,J,Q,r,n,Z,$,o,tt,et,w,rt,a,p;function g(){this.BorderLeft="none",this.BorderRight="none",this.BorderTop="none",this.BorderBottom="none",this.BackColor=n.transparent,this.VertAlign=et.Bottom}function h(){this.FontName="Arial",this.FontSize=6,this.Bold=!1,this.Italic=!1,this.Underline=!1,this.FontColor=n.black,this.HorAlign=tt.Left,this.Angle=0}function d(){var t=null!==p&&p.apply(this,arguments)||this;return t.multipleFiles=!1,t._matrix=null,t._removeEmptySpaceAtBottom=Y["StiOptions"].Export.OpenDocumentWriter.removeEmptySpaceAtBottom,t.imageCache=null,t.cellStyleList=null,t.paragraphStyleList=null,t.xmlIndentation=1,t.imageQuality=.75,t.imageResolution=96,t.usePageHeadersAndFooters=!1,t}G=t=Y.Report||(Y.Report={}),s=e=G.Export||(G.Export={}),V=Y.System.StiArray,l=Y.Base.Zip.StiZipWriter20,m=Y.Report.ImageFormat,_=Y.Report.Components.IStiExportImageExtended,j=Y.Report.Components.StiText,q=Y.System.Collections.Hashtable,c=Y.Report.Components.StiPageOrientation,i=Y.System.DateTime,K=Y.System.Xml.Formatting,J=Y.System.Xml.XmlTextWriter,Q=Y.System.Text.Encoding,r=Y.System.IO.StreamWriter,n=Y.System.Drawing.Color,Z=Y.System.StiString,$=Y.System.IO.MemoryStream,o=Y.Base.Localization.StiLocalization,tt=Y.Base.Drawing.StiTextHorAlignment,et=Y.Base.Drawing.StiVertAlignment,w=g,rt=h,p=s.StiExportService,__extends(d,p),d.prototype.implements=function(){return[s.IStiOdtExportService]},Object.defineProperty(d.prototype,"defaultExtension",{get:function(){return"odt"},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"exportFormat",{get:function(){return G.StiExportFormat.Odt},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"groupCategory",{get:function(){return"Word"},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"position",{get:function(){return s.StiExportPosition.Odt},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"exportNameInMenu",{get:function(){return o.get("Export","ExportTypeWriterFile")},enumerable:!1,configurable:!0}),d.prototype.getFilter=function(){return o.get("FileFilters","WriterFiles")},d.prototype.exportTo=function(t,e,r){this.exportOdt(t,e,r)},d.prototype.exportToAsync=function(t,e,r,i){var n=this;Y.Report.Export.StiExportImageHelper.convertAllImages(e,Y.System.Drawing.Imaging.ImageFormat.Jpeg).try(function(){n.exportTo(e,r,i),null!=e&&null!=e.preparedExportImages&&(e.preparedExportImages.clear(),e.preparedExportImages=null),t()})},Object.defineProperty(d.prototype,"matrix",{get:function(){return this._matrix},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"removeEmptySpaceAtBottom",{get:function(){return this._removeEmptySpaceAtBottom},enumerable:!1,configurable:!0}),d.prototype.doubleToString=function(t){return Math.round2(t/100,4).toString().stimulsoft.replaceAll(",",".")+"in"},d.prototype.getColumnName=function(t){var e=t/26|0,r=t%26,t="";return 0<e&&(t+=String.fromCharCode(65+e-1)),t+=String.fromCharCode(65+r)},d.prototype.getColorString=function(t){return"#"+Z.format("{0:X8}",t.toArgb()).substr(2)},d.prototype.getCellStyleNumber=function(t,e,r,i){for(var n=new w,o=!0,a=!0,s=0;s<r;s++)null==this.matrix.bordersY[t+s][e]&&(o=!1),null==this.matrix.bordersY[t+s][e+i]&&(a=!1);for(var l=!0,m=!0,s=0,c,p,g;s<i;s++)null==this.matrix.bordersX[t][e+s]&&(l=!1),null==this.matrix.bordersX[t+r][e+s]&&(m=!1);if(l&&(n.BorderTop=this.getStringFromBorder(this.matrix.bordersX[t][e])),o&&(n.BorderLeft=this.getStringFromBorder(this.matrix.bordersY[t][e])),m&&(n.BorderBottom=this.getStringFromBorder(this.matrix.bordersX[t+r][e])),a&&(n.BorderRight=this.getStringFromBorder(this.matrix.bordersY[t][e+i])),null!=this.matrix.cells[t][e]&&(c=this.matrix.cells[t][e],n.BackColor=c.cellStyle.color,n.VertAlign=c.cellStyle.vertAlignment,null==c.cellStyle.textOptions||(45<(p=c.cellStyle.textOptions.angle)&&p<135||225<p&&p<315)&&(c.cellStyle.horAlignment==tt.Left&&(n.VertAlign=et.Bottom),c.cellStyle.horAlignment==tt.Center&&(n.VertAlign=et.Center),c.cellStyle.horAlignment==tt.Right&&(n.VertAlign=et.Top),c.cellStyle.horAlignment==tt.Width&&(n.VertAlign=et.Bottom))),0<this.cellStyleList.length)for(var s=0;s<this.cellStyleList.length;s++){var h=this.cellStyleList[s];if(h.BorderLeft==n.BorderLeft&&h.BorderRight==n.BorderRight&&h.BorderTop==n.BorderTop&&h.BorderBottom==n.BorderBottom&&h.BackColor.equals(n.BackColor)&&h.VertAlign==n.VertAlign)return s}return this.cellStyleList.push(n),this.cellStyleList.length-1},d.prototype.getStringFromBorder=function(t){return Z.format("{0} solid {1}",this.doubleToString(t.size),this.getColorString(t.color))},d.prototype.getParagraphStyleNumber=function(t,e){var t=this.matrix.cells[t][e].cellStyle,r=new rt;r.FontName=t.font.name,r.FontSize=t.font.sizeInPoints,r.Bold=t.font.bold,r.Italic=t.font.italic,r.Underline=t.font.underline,r.FontColor=t.textColor,r.HorAlign=t.horAlignment;var e=0,i;if(null!=t.textOptions&&(e=t.textOptions.angle),45<e&&e<135&&(r.Angle=90),225<e&&e<315&&(r.Angle=270),0!=r.Angle&&(t.vertAlignment==et.Top&&(r.HorAlign=tt.Left),t.vertAlignment==et.Center&&(r.HorAlign=tt.Center),t.vertAlignment==et.Bottom&&(r.HorAlign=tt.Right)),0<this.paragraphStyleList.length)for(var n=0;n<this.paragraphStyleList.length;n++){var o=this.paragraphStyleList[n];if(o.FontName==r.FontName&&o.FontSize==r.FontSize&&o.Bold==r.Bold&&o.Italic==r.Italic&&o.Underline==r.Underline&&o.FontColor.equals(r.FontColor)&&o.HorAlign==r.HorAlign&&o.Angle==r.Angle)return n}return this.paragraphStyleList.push(r),this.paragraphStyleList.length-1},d.prototype.writeMimetype=function(){var t=new $,e=new r(t,Q.ASCII);return e.write("application/vnd.oasis.opendocument.text"),e.flush(),t},d.prototype.writeMeta=function(){var t=new $,e=new J(Q.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?K.None:K.Indented,e.writeStartDocument(),e.writeStartElement("office:document-meta"),e.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),e.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),e.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),e.writeAttributeString("xmlns:meta","urn:oasis:names:tc:opendocument:xmlns:meta:1.0"),e.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),e.writeAttributeString("office:version","1.1"),e.writeStartElement("office:meta");var r=Z.format("{0}",i.now.toString("yyyy-MM-ddTHH:mm:ss"));return e.writeElementString("meta:generator","Stimulsoft Reports"),e.writeElementString("meta:creation-date",r),e.writeElementString("dc:date",r),e.writeElementString("meta:editing-cycles","1"),e.writeElementString("meta:editing-duration","PT0M01S"),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 1"),e.writeEndElement(),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 2"),e.writeEndElement(),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 3"),e.writeEndElement(),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 4"),e.writeEndElement(),e.writeStartElement("meta:document-statistic"),e.writeAttributeString("meta:table-count","1"),e.writeAttributeString("meta:image-count","0"),e.writeAttributeString("meta:object-count","0"),e.writeAttributeString("meta:page-count","1"),e.writeAttributeString("meta:paragraph-count","1"),e.writeAttributeString("meta:word-count","1"),e.writeAttributeString("meta:character-count","1"),e.writeEndElement(),e.writeFullEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},d.prototype.writeManifest=function(){var t=new $,e=new J(Q.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?K.None:K.Indented,e.writeStartDocument(),e.writeStartElement("manifest:manifest"),e.writeAttributeString("xmlns:manifest","urn:oasis:names:tc:opendocument:xmlns:manifest:1.0"),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","application/vnd.oasis.opendocument.text"),e.writeAttributeString("manifest:full-path","/"),e.writeEndElement();for(var r=0;r<this.imageCache.imagePackedStore.stimulsoft.countItems;r++)e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","image/jpeg"),e.writeAttributeString("manifest:full-path",Z.format("Pictures/{0:D5}.jpg",r+1)),e.writeEndElement();return e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","content.xml"),e.writeEndElement(),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","styles.xml"),e.writeEndElement(),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","meta.xml"),e.writeEndElement(),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","settings.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},d.prototype.writeImage=function(t){var e=new $,t=this.imageCache.imagePackedStore[t];return e.write(t,0,t.length),e},d.prototype.writeSettings=function(){var t=new $,e=new J(Q.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?K.None:K.Indented,e.writeStartDocument(),e.writeStartElement("office:document-settings"),e.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),e.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),e.writeAttributeString("xmlns:config","urn:oasis:names:tc:opendocument:xmlns:config:1.0"),e.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),e.writeAttributeString("office:version","1.1"),e.writeStartElement("office:settings"),e.writeStartElement("config:config-item-set"),e.writeAttributeString("config:name","ooo:view-settings"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewAreaTop"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewAreaLeft"),e.writeAttributeString("config:type","int"),e.writeString("-10107"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewAreaWidth"),e.writeAttributeString("config:type","int"),e.writeString("43208"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewAreaHeight"),e.writeAttributeString("config:type","int"),e.writeString("22174"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowRedlineChanges"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","InBrowseMode"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item-map-indexed"),e.writeAttributeString("config:name","Views"),e.writeStartElement("config:config-item-map-entry"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewId"),e.writeAttributeString("config:type","string"),e.writeString("view2"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewLeft"),e.writeAttributeString("config:type","int"),e.writeString("3002"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewTop"),e.writeAttributeString("config:type","int"),e.writeString("10435"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleLeft"),e.writeAttributeString("config:type","int"),e.writeString("-10107"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleTop"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement(
"config:config-item"),e.writeAttributeString("config:name","VisibleRight"),e.writeAttributeString("config:type","int"),e.writeString("33099"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleBottom"),e.writeAttributeString("config:type","int"),e.writeString("22172"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ZoomType"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ZoomFactor"),e.writeAttributeString("config:type","short"),e.writeString("100"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsSelectedFrame"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("config:config-item-set"),e.writeAttributeString("config:name","ooo:configuration-settings"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AddParaTableSpacing"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintReversed"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","OutlineLevelYieldsNumbering"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","LinkUpdateMode"),e.writeAttributeString("config:type","short"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintEmptyPages"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IgnoreFirstLineIndentInNumbering"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CharacterCompressionType"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintSingleJobs"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UpdateFromTemplate"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintPaperFromSetup"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AddFrameOffsets"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintLeftPages"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RedlineProtectionKey"),e.writeAttributeString("config:type","base64Binary"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintTables"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ChartAutoUpdate"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintControls"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrinterSetup"),e.writeAttributeString("config:type","base64Binary"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IgnoreTabsAndBlanksForLineCalculation"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintAnnotationMode"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","LoadReadonly"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AddParaSpacingToTableCells"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AddExternalLeading"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ApplyUserData"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","FieldAutoUpdate"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","SaveVersionOnClose"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","SaveGlobalDocumentLinks"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsKernAsianPunctuation"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AlignTabStopPosition"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ClipAsCharacterAnchoredWriterFlyFrames"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CurrentDatabaseDataSource"),e.writeAttributeString("config:type","string"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","DoNotCaptureDrawObjsOnPage"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","TableRowKeep"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrinterName"),e.writeAttributeString("config:type","string"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintFaxName"),e.writeAttributeString("config:type","string"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ConsiderTextWrapOnObjPos"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UseOldPrinterMetrics"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintRightPages"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsLabelDocument"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UseFormerLineSpacing"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AddParaTableSpacingAtStart"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UseFormerTextWrapping"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","DoNotResetParaAttrsForNumFont"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintProspect"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintGraphics"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AllowPrintJobCancel"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CurrentDatabaseCommandType"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","DoNotJustifyLinesWithManualBreak"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UseFormerObjectPositioning"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrinterIndependentLayout"),e.writeAttributeString("config:type","string"),e.writeString("high-resolution"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UseOldNumbering"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintPageBackground"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CurrentDatabaseCommand"),e.writeAttributeString("config:type","string"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintDrawings"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintBlackFonts"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UnxForceZeroExtLeading"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},d.prototype.writeStyles=function(t){var e=new $,r=new J(Q.UTF8,e);r.indentation=this.xmlIndentation<0?0:this.xmlIndentation,r.formatting=this.xmlIndentation<0?K.None:K.Indented,r.writeStartDocument(),r.writeStartElement("office:document-styles"),r.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),r.writeAttributeString("xmlns:style","urn:oasis:names:tc:opendocument:xmlns:style:1.0"),r.writeAttributeString("xmlns:text","urn:oasis:names:tc:opendocument:xmlns:text:1.0"),r.writeAttributeString("xmlns:table","urn:oasis:names:tc:opendocument:xmlns:table:1.0"),r.writeAttributeString("xmlns:draw","urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"),r.writeAttributeString("xmlns:fo","urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0"),r.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),r.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),r.writeAttributeString("xmlns:meta","urn:oasis:names:tc:opendocument:xmlns:meta:1.0"),r.writeAttributeString("xmlns:number","urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0"),r.writeAttributeString("xmlns:svg","urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0"),r.writeAttributeString("xmlns:chart","urn:oasis:names:tc:opendocument:xmlns:chart:1.0"),r.writeAttributeString("xmlns:dr3d","urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"),r.writeAttributeString("xmlns:math","http://www.w3.org/1998/Math/MathML"),r.writeAttributeString("xmlns:form","urn:oasis:names:tc:opendocument:xmlns:form:1.0"),r.writeAttributeString("xmlns:script","urn:oasis:names:tc:opendocument:xmlns:script:1.0"),r.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),r.writeAttributeString("xmlns:ooow","http://openoffice.org/2004/writer"),r.writeAttributeString("xmlns:oooc","http://openoffice.org/2004/calc"),r.writeAttributeString("xmlns:dom","http://www.w3.org/2001/xml-events"),r.writeAttributeString("office:version","1.1"),r.writeStartElement("office:font-face-decls"),r.writeStartElement("style:font-face"),r.writeAttributeString("style:name","Arial"),r.writeAttributeString("svg:font-family","Arial"),r.writeEndElement(),r.writeStartElement("style:font-face"),r.writeAttributeString("style:name","Tahoma"),r.writeAttributeString("svg:font-family","Tahoma"),r.writeAttributeString("style:font-family-generic","system"),r.writeAttributeString("style:font-pitch","variable"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("office:styles"),r.writeStartElement("style:default-style"),r.writeAttributeString("style:family","graphic"),r.writeStartElement("style:graphic-properties"),r.writeAttributeString("draw:shadow-offset-x","0.3cm"),r.writeAttributeString("draw:shadow-offset-y","0.3cm"),r.writeAttributeString("draw:start-line-spacing-horizontal","0.283cm"),r.writeAttributeString("draw:start-line-spacing-vertical","0.283cm"),r.writeAttributeString("draw:end-line-spacing-horizontal","0.283cm"),r.writeAttributeString("draw:end-line-spacing-vertical","0.283cm"),r.writeAttributeString("style:flow-with-text","false"),r.writeEndElement(),r.writeStartElement("style:paragraph-properties"),r.writeAttributeString("style:text-autospace","ideograph-alpha"),r.writeAttributeString("style:line-break","strict"),r.writeAttributeString("style:writing-mode","lr-tb"),r.writeAttributeString("style:font-independent-line-spacing","false"),r.writeStartElement("style:tab-stops"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:text-properties"),r.writeAttributeString("style:use-window-font-color","true"),r.writeAttributeString("fo:font-size","10pt"),r.writeAttributeString("style:letter-kerning","true"),r.writeAttributeString("style:font-size-asian","12pt"),r.writeAttributeString("style:language-asian","zxx"),r.writeAttributeString("style:country-asian","none"),r.writeAttributeString("style:font-size-complex","12pt"),r.writeAttributeString("style:language-complex","zxx"),r.writeAttributeString("style:country-complex","none"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:default-style"),r.writeAttributeString("style:family","paragraph"),r.writeStartElement("style:paragraph-properties"),r.writeAttributeString("fo:hyphenation-ladder-count","no-limit"),r.writeAttributeString("style:text-autospace","ideograph-alpha"),r.writeAttributeString("style:punctuation-wrap","hanging"),r.writeAttributeString("style:line-break","strict"),r.writeAttributeString("style:tab-stop-distance","1.251cm"),r.writeAttributeString("style:writing-mode","page"),r.writeEndElement(),r.writeStartElement("style:text-properties"),r.writeAttributeString("style:use-window-font-color","true"),r.writeAttributeString("style:font-name","Arial"),r.writeAttributeString("fo:font-size","10pt"),r.writeAttributeString("style:letter-kerning","true"),r.writeAttributeString("style:font-name-asian","Lucida Sans Unicode"),r.writeAttributeString("style:font-size-asian","12pt"),r.writeAttributeString("style:language-asian","zxx"),r.writeAttributeString("style:country-asian","none"),r.writeAttributeString("style:font-name-complex","Tahoma"),r.writeAttributeString("style:font-size-complex","12pt"),r.writeAttributeString("style:language-complex","zxx"),r.writeAttributeString("style:country-complex","none"),r.writeAttributeString("fo:hyphenate","false"),r.writeAttributeString("fo:hyphenation-remain-char-count","2"),r.writeAttributeString("fo:hyphenation-push-char-count","2"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:default-style"),r.writeAttributeString("style:family","table"),r.writeStartElement("style:table-properties"),r.writeAttributeString("table:border-model","collapsing"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:default-style"),r.writeAttributeString("style:family","table-row"),r.writeStartElement("style:table-row-properties"),r.writeAttributeString("fo:keep-together","auto"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:style"),r.writeAttributeString("style:name","Standard"),r.writeAttributeString("style:family","paragraph"),r.writeAttributeString("style:class","text"),r.writeEndElement(),r.writeStartElement("style:style"),r.writeAttributeString("style:name","Title"),r.writeAttributeString("style:family","paragraph"),r.writeAttributeString("style:parent-style-name","Standard"),r.writeAttributeString("style:next-style-name","Text_20_body"),r.writeAttributeString("style:class","text"),r.writeStartElement("style:paragraph-properties"),r.writeAttributeString("fo:margin-top","0.423cm"),r.writeAttributeString("fo:margin-bottom","0.212cm"),r.writeAttributeString("fo:keep-with-next","always"),r.writeEndElement(),r.writeStartElement("style:text-properties"),r.writeAttributeString("style:font-name","Arial1"),r.writeAttributeString("fo:font-size","14pt"),r.writeAttributeString("style:font-name-asian","Lucida Sans Unicode"),r.writeAttributeString("style:font-size-asian","14pt"),r.writeAttributeString("style:font-name-complex","Tahoma"),r.writeAttributeString("style:font-size-complex","14pt"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:style"),r.writeAttributeString("style:name","Text_20_body"),r.writeAttributeString("style:display-name","Text body"),r.writeAttributeString("style:family","paragraph"),r.writeAttributeString("style:parent-style-name","Standard"),r.writeAttributeString("style:class","text"),r.writeStartElement("style:paragraph-properties"),r.writeAttributeString("fo:margin-top","0cm"),r.writeAttributeString("fo:margin-bottom","0.212cm"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:style"),r.writeAttributeString("style:name","Subtitle"),r.writeAttributeString("style:family","paragraph"),r.writeAttributeString("style:parent-style-name","Title"),r.writeAttributeString("style:next-style-name","Text_20_body"),r.writeAttributeString("style:class","chapter"),r.writeStartElement("style:paragraph-properties"),r.writeAttributeString("fo:text-align","center"),r.writeAttributeString("style:justify-single-word","false"),r.writeEndElement(),r.writeStartElement("style:text-properties"),r.writeAttributeString("fo:font-size","14pt"),r.writeAttributeString("fo:font-style","italic"),r.writeAttributeString("style:font-size-asian","14pt"),r.writeAttributeString("style:font-style-asian","italic"),r.writeAttributeString("style:font-size-complex","14pt"),r.writeAttributeString("style:font-style-complex","italic"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:style"),r.writeAttributeString("style:name","List"),r.writeAttributeString("style:family","paragraph"),r.writeAttributeString("style:parent-style-name","Text_20_body"),r.writeAttributeString("style:class","list"),r.writeStartElement("style:text-properties"),r.writeAttributeString("style:font-name","Arial"),r.writeAttributeString("style:font-name-complex","Tahoma1"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:style"),r.writeAttributeString("style:name","Caption"),r.writeAttributeString("style:family","paragraph"),r.writeAttributeString("style:parent-style-name","Standard"),r.writeAttributeString("style:class","extra"),r.writeStartElement("style:paragraph-properties"),r.writeAttributeString("fo:margin-top","0.212cm"),r.writeAttributeString("fo:margin-bottom","0.212cm"),r.writeAttributeString("text:number-lines","false"),r.writeAttributeString("text:line-number","0"),r.writeEndElement(),r.writeStartElement("style:text-properties"),r.writeAttributeString("style:font-name","Arial"),r.writeAttributeString("fo:font-size","10pt"),r.writeAttributeString("fo:font-style","italic"),r.writeAttributeString("style:font-size-asian","12pt"),r.writeAttributeString("style:font-style-asian","italic"),r.writeAttributeString("style:font-name-complex","Tahoma1"),r.writeAttributeString("style:font-size-complex","12pt"),r.writeAttributeString("style:font-style-complex","italic"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:style"),r.writeAttributeString("style:name","Index"),r.writeAttributeString("style:family","paragraph"),r.writeAttributeString("style:parent-style-name","Standard"),r.writeAttributeString("style:class","index"),r.writeStartElement("style:paragraph-properties"),r.writeAttributeString("text:number-lines","false"),r.writeAttributeString("text:line-number","0"),r.writeEndElement(),r.writeStartElement("style:text-properties"),r.writeAttributeString("style:font-name","Arial"),r.writeAttributeString("style:font-name-complex","Tahoma1"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:style"),r.writeAttributeString("style:name","Table_20_Contents"),r.writeAttributeString("style:display-name","Table Contents"),r.writeAttributeString("style:family","paragraph"),r.writeAttributeString("style:parent-style-name","Standard"),r.writeAttributeString("style:class","extra"),r.writeStartElement("style:paragraph-properties"),r.writeAttributeString("text:number-lines","false"),r.writeAttributeString("text:line-number","0"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:style"),r.writeAttributeString("style:name","Graphics"),r.writeAttributeString("style:family","graphic"),r.writeStartElement("style:graphic-properties"),r.writeAttributeString("text:anchor-type","paragraph"),r.writeAttributeString("svg:x","0cm"),r.writeAttributeString("svg:y","0cm"),r.writeAttributeString("style:wrap","dynamic"),r.writeAttributeString("style:number-wrapped-paragraphs","no-limit"),r.writeAttributeString("style:wrap-contour","false"),r.writeAttributeString("style:vertical-pos","top"),r.writeAttributeString("style:vertical-rel","paragraph"),r.writeAttributeString("style:horizontal-pos","center"),r.writeAttributeString("style:horizontal-rel","paragraph"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("text:outline-style"),r.writeStartElement("text:outline-level-style"),r.writeAttributeString("text:level","1"),r.writeAttributeString("style:num-format",""),r.writeStartElement("style:list-level-properties"),r.writeAttributeString("text:min-label-distance","0.381cm"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("text:outline-level-style"),r.writeAttributeString("text:level","2"),r.writeAttributeString("style:num-format",""),r.writeStartElement("style:list-level-properties"),r.writeAttributeString("text:min-label-distance","0.381cm"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("text:outline-level-style"),r.writeAttributeString("text:level","3"),r.writeAttributeString("style:num-format",""),r.writeStartElement("style:list-level-properties"),r.writeAttributeString("text:min-label-distance","0.381cm"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("text:outline-level-style"),r.writeAttributeString("text:level","4"),r.writeAttributeString("style:num-format",""),r.writeStartElement("style:list-level-properties"),r.writeAttributeString("text:min-label-distance","0.381cm"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("text:outline-level-style"),r.writeAttributeString("text:level","5"),r.writeAttributeString("style:num-format",""),r.writeStartElement("style:list-level-properties"),r.writeAttributeString("text:min-label-distance","0.381cm"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("text:outline-level-style"),r.writeAttributeString("text:level","6"),r.writeAttributeString("style:num-format",""),r.writeStartElement("style:list-level-properties"),r.writeAttributeString("text:min-label-distance","0.381cm"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("text:outline-level-style"),r.writeAttributeString("text:level","7"),r.writeAttributeString("style:num-format",""),r.writeStartElement("style:list-level-properties"),r.writeAttributeString("text:min-label-distance","0.381cm"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("text:outline-level-style"),r.writeAttributeString("text:level","8"),r.writeAttributeString("style:num-format",""),r.writeStartElement("style:list-level-properties"),r.writeAttributeString("text:min-label-distance","0.381cm"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("text:outline-level-style"),r.writeAttributeString("text:level","9"),r.writeAttributeString("style:num-format",""),r.writeStartElement("style:list-level-properties"),r.writeAttributeString("text:min-label-distance","0.381cm"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("text:outline-level-style"),r.writeAttributeString("text:level","10"),r.writeAttributeString("style:num-format",""),r.writeStartElement("style:list-level-properties"),r.writeAttributeString("text:min-label-distance","0.381cm"),r.writeEndElement(),r.writeEndElement(),r.writeFullEndElement(),r.writeStartElement("text:notes-configuration"),r.writeAttributeString("text:note-class","footnote"),r.writeAttributeString("style:num-format","1"),r.writeAttributeString("text:start-value","0"),r.writeAttributeString("text:footnotes-position","page"),r.writeAttributeString("text:start-numbering-at","document"),r.writeEndElement(),r.writeStartElement("text:notes-configuration"),r.writeAttributeString("text:note-class","endnote"),r.writeAttributeString("style:num-format","i"),r.writeAttributeString("text:start-value","0"),r.writeEndElement(),r.writeStartElement("text:linenumbering-configuration"),r.writeAttributeString("text:number-lines","false"),r.writeAttributeString("text:offset","0.499cm"),r.writeAttributeString("style:num-format","1"),r.writeAttributeString("text:number-position","left"),r.writeAttributeString("text:increment","5"),r.writeEndElement(),r.writeEndElement();var i=t.getByIndex(0),n=i.unit.convertToHInches(i.pageHeight*i.segmentPerHeight),o=i.unit.convertToHInches(i.pageWidth*i.segmentPerWidth),a=i.unit.convertToHInches(i.margins.left),s=i.unit.convertToHInches(i.margins.right),l=i.unit.convertToHInches(i.margins.top),t=i.unit.convertToHInches(i.margins.bottom)-4;return t<0&&(t=0),r.writeStartElement("office:automatic-styles"),r.writeStartElement("style:page-layout"),r.writeAttributeString("style:name","pm1"),r.writeStartElement("style:page-layout-properties"),r.writeAttributeString("fo:page-width",this.doubleToString(o)),r.writeAttributeString("fo:page-height",this.doubleToString(n)),r.writeAttributeString("style:num-format","1"),r.writeAttributeString("style:print-orientation",i.orientation==c.Portrait?"portrait":"landscape"),r.writeAttributeString("fo:margin-top",this.doubleToString(l)),r.writeAttributeString("fo:margin-bottom",this.doubleToString(t)),r.writeAttributeString("fo:margin-left",this.doubleToString(a)),r.writeAttributeString("fo:margin-right",this.doubleToString(s)),r.writeAttributeString("style:writing-mode","lr-tb"),r.writeAttributeString("style:footnote-max-height","0cm"),r.writeStartElement("style:footnote-sep"),r.writeAttributeString("style:width","0.018cm"),r.writeAttributeString("style:distance-before-sep","0.101cm"),r.writeAttributeString("style:distance-after-sep","0.101cm"),r.writeAttributeString("style:adjustment","left"),r.writeAttributeString("style:rel-width","25%"),r.writeAttributeString("style:color","#000000"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:header-style"),r.writeEndElement(),r.writeStartElement("style:footer-style"),r.writeEndElement(),r.writeEndElement(),r.writeFullEndElement(),r.writeStartElement("office:master-styles"),r.writeStartElement("style:master-page"),r.writeAttributeString("style:name","Standard"),r.writeAttributeString("style:page-layout-name","pm1"),r.writeEndElement(),r.writeEndElement(),r.writeFullEndElement(),r.writeEndDocument(),r.flush(),e},d.prototype.writeContent=function(){var e,t,r,i,n=new $,o=new J(Q.UTF8,n);o.indentation=this.xmlIndentation<0?0:this.xmlIndentation,o.formatting=this.xmlIndentation<0?K.None:K.Indented,o.writeStartDocument(),o.writeStartElement("office:document-content"),o.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),o.writeAttributeString("xmlns:style","urn:oasis:names:tc:opendocument:xmlns:style:1.0"),o.writeAttributeString("xmlns:text","urn:oasis:names:tc:opendocument:xmlns:text:1.0"),o.writeAttributeString("xmlns:table","urn:oasis:names:tc:opendocument:xmlns:table:1.0"),o.writeAttributeString("xmlns:draw","urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"),o.writeAttributeString("xmlns:fo","urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0"),o.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),o.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),o.writeAttributeString("xmlns:meta","urn:oasis:names:tc:opendocument:xmlns:meta:1.0"),o.writeAttributeString("xmlns:number","urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0"),o.writeAttributeString("xmlns:svg","urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0"),o.writeAttributeString("xmlns:chart","urn:oasis:names:tc:opendocument:xmlns:chart:1.0"),o.writeAttributeString("xmlns:dr3d","urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"),o.writeAttributeString("xmlns:math","http://www.w3.org/1998/Math/MathML"),o.writeAttributeString("xmlns:form","urn:oasis:names:tc:opendocument:xmlns:form:1.0"),o.writeAttributeString("xmlns:script","urn:oasis:names:tc:opendocument:xmlns:script:1.0"),o.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),o.writeAttributeString("xmlns:ooow","http://openoffice.org/2004/writer"),o.writeAttributeString("xmlns:oooc","http://openoffice.org/2004/calc"),o.writeAttributeString("xmlns:dom","http://www.w3.org/2001/xml-events"),o.writeAttributeString("xmlns:xforms","http://www.w3.org/2002/xforms"),o.writeAttributeString("xmlns:xsd","http://www.w3.org/2001/XMLSchema"),o.writeAttributeString("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance"),o.writeAttributeString("office:version","1.1");for(var a=V.create2(Boolean,this.matrix.coordY.countItems,this.matrix.coordX.countItems),s=V.create2(Number,this.matrix.coordY.countItems,this.matrix.coordX.countItems),l=new q,m=new q,c=[],p=1;p<this.matrix.coordY.countItems;p++){var g=this.matrix.coordY.getByIndex(p)-this.matrix.coordY.getByIndex(p-1),h;l.containsKey(g)||(h=l.count,l.set(g,h),m.set(h,g)),c[p-1]=0|l.get(g);for(var w=1;w<this.matrix.coordX.countItems;w++){var d=this.matrix.cells[p-1][w-1];if(!a[p][w])if(null!=d){for(var u=0;u<=d.height;u++)for(var S=0;S<=d.width;S++)a[p+u][w+S]=!0;s[p-1][w-1]=this.getCellStyleNumber(p-1,w-1,d.height+1,d.width+1);var f=this.getParagraphStyleNumber(p-1,w-1)}else s[p-1][w-1]=this.getCellStyleNumber(p-1,w-1,1,1)}}o.writeStartElement("office:scripts"),o.writeEndElement();var v=new q;try{for(var E=__values(this.paragraphStyleList),b=E.next();!b.done;b=E.next()){var y=b.value;v.set(y.FontName,y.FontName)}}catch(t){e={error:t}}finally{try{b&&!b.done&&(t=E.return)&&t.call(E)}finally{if(e)throw e.error}}o.writeStartElement("office:font-face-decls");try{for(var x=__values(v.keys),A=x.next();!A.done;A=x.next()){var T=A.value,T=v.get(T);o.writeStartElement("style:font-face"),o.writeAttributeString("style:name",T),o.writeAttributeString("svg:font-family",T),o.writeEndElement()}}catch(t){r={error:t}}finally{try{A&&!A.done&&(i=x.return)&&i.call(x)}finally{if(r)throw r.error}}o.writeEndElement(),o.writeStartElement("office:automatic-styles"),o.writeStartElement("style:style"),o.writeAttributeString("style:name","Table1"),o.writeAttributeString("style:family","table"),o.writeStartElement("style:table-properties");var P=this.matrix.coordX.getByIndex(this.matrix.coordX.countItems-1)-this.matrix.coordX.getByIndex(0);o.writeAttributeString("style:width",this.doubleToString(P)),o.writeAttributeString("table:align","left"),o.writeEndElement(),o.writeEndElement();for(var w=0;w<this.matrix.coordX.countItems-1;w++){o.writeStartElement("style:style"),o.writeAttributeString("style:name",Z.format("Table1.{0}",this.getColumnName(w))),o.writeAttributeString("style:family","table-column"),o.writeStartElement("style:table-column-properties");var L=this.matrix.coordX.getByIndex(w+1)-this.matrix.coordX.getByIndex(w);o.writeAttributeString("style:column-width",this.doubleToString(L)),o.writeEndElement(),o.writeEndElement()}for(var p=0;p<l.count;p++){o.writeStartElement("style:style"),o.writeAttributeString("style:name",Z.format("Table1.{0}",p+1)),o.writeAttributeString("style:family","table-row"),o.writeStartElement("style:table-row-properties");var g=m.get(p);o.writeAttributeString("style:row-height",this.doubleToString(g)),o.writeEndElement(),o.writeEndElement()}for(var C=0;C<this.cellStyleList.stimulsoft.countItems;C++){var F=this.cellStyleList[C];o.writeStartElement("style:style"),o.writeAttributeString("style:name",Z.format("cell{0}",C+1)),o.writeAttributeString("style:family","table-cell"),o.writeStartElement("style:table-cell-properties"),F.VertAlign==et.Center&&o.writeAttributeString("style:vertical-align","middle"),F.VertAlign==et.Bottom&&o.writeAttributeString("style:vertical-align","bottom"),0<F.BackColor.a?o.writeAttributeString("fo:background-color",this.getColorString(F.BackColor)):o.writeAttributeString("fo:background-color","transparent"),o.writeAttributeString("fo:padding","0in"),o.writeAttributeString("fo:border-left",F.BorderLeft),o.writeAttributeString("fo:border-right",F.BorderRight),o.writeAttributeString("fo:border-top",F.BorderTop),o.writeAttributeString("fo:border-bottom",F.BorderBottom),o.writeEndElement(),o.writeEndElement()}for(var C=0;C<this.paragraphStyleList.stimulsoft.countItems;C++){var F=this.paragraphStyleList[C];o.writeStartElement("style:style"),o.writeAttributeString("style:name",Z.format("par{0}",C+1)),o.writeAttributeString("style:family","paragraph"),o.writeAttributeString("style:parent-style-name","Table_20_Contents"),F.HorAlign!=tt.Left&&(o.writeStartElement("style:paragraph-properties"),F.HorAlign==tt.Center&&o.writeAttributeString("fo:text-align","center"),F.HorAlign==tt.Right&&o.writeAttributeString("fo:text-align","right"),F.HorAlign==tt.Width&&o.writeAttributeString("fo:text-align","justify"),o.writeEndElement()),o.writeStartElement("style:text-properties"),o.writeAttributeString("fo:color",this.getColorString(F.FontColor)),o.writeAttributeString("style:font-name",F.FontName);var R=Z.format("{0}pt",F.FontSize).stimulsoft.replaceAll(",",".");o.writeAttributeString("fo:font-size",R),o.writeAttributeString("fo:font-size-asian",R),o.writeAttributeString("fo:font-size-complex",R),F.Italic&&(o.writeAttributeString("fo:font-style","italic"),o.writeAttributeString("fo:font-style-asian","italic"),o.writeAttributeString("fo:font-style-complex","italic")),F.Underline&&(o.writeAttributeString("style:text-underline-style","solid"),o.writeAttributeString("style:text-underline-width","auto"),o.writeAttributeString("style:text-underline-color","font-color")),F.Bold&&(o.writeAttributeString("fo:font-weight","bold"),o.writeAttributeString("fo:font-weight-asian","bold"),o.writeAttributeString("fo:font-weight-complex","bold")),0!=F.Angle&&o.writeAttributeString("style:text-rotation-angle",Z.format("{0}",F.Angle)),o.writeEndElement(),o.writeEndElement()}o.writeStartElement("style:style"),o.writeAttributeString("style:name","parEnd"),o.writeAttributeString("style:family","paragraph"),o.writeAttributeString("style:parent-style-name","Table_20_Contents"),o.writeStartElement("style:text-properties");var P=Z.format("{0}pt",1).stimulsoft.replaceAll(",",".");o.writeAttributeString("fo:font-size",P),o.writeAttributeString("fo:font-size-asian",P),o.writeAttributeString("fo:font-size-complex",P),o.writeEndElement(),o.writeEndElement(),o.writeStartElement("style:style"),o.writeAttributeString("style:name","fr1"),o.writeAttributeString("style:family","graphic"),o.writeAttributeString("style:parent-style-name","Graphics"),o.writeStartElement("style:graphic-properties"),o.writeAttributeString("style:vertical-pos","middle"),o.writeAttributeString("style:vertical-rel","paragraph"),o.writeAttributeString("style:horizontal-pos","center"),o.writeAttributeString("style:horizontal-rel","paragraph"),o.writeAttributeString("fo:background-color","transparent"),o.writeAttributeString("style:background-transparency","100%"),o.writeAttributeString("style:shadow","none"),o.writeAttributeString("style:mirror","none"),o.writeAttributeString("fo:clip","rect(0cm 0cm 0cm 0cm)"),o.writeAttributeString("draw:luminance","0%"),o.writeAttributeString("draw:contrast","0%"),o.writeAttributeString("draw:red","0%"),o.writeAttributeString("draw:green","0%"),o.writeAttributeString("draw:blue","0%"),o.writeAttributeString("draw:gamma","100%"),o.writeAttributeString("draw:color-inversion","false"),o.writeAttributeString("draw:image-opacity","100%"),o.writeAttributeString("draw:color-mode","standard"),o.writeEndElement(),o.writeEndElement(),o.writeEndElement(),o.writeStartElement("office:body"),o.writeStartElement("office:text"),o.writeStartElement("office:forms"),o.writeAttributeString("form:automatic-focus","false"),o.writeAttributeString("form:apply-design-mode","false"),o.writeEndElement(),o.writeStartElement("text:sequence-decls"),o.writeStartElement("text:sequence-decl"),o.writeAttributeString("text:display-outline-level","0"),o.writeAttributeString("text:name","Illustration"),o.writeEndElement(),o.writeStartElement("text:sequence-decl"),o.writeAttributeString("text:display-outline-level","0"),o.writeAttributeString("text:name","Table"),o.writeEndElement(),o.writeStartElement("text:sequence-decl"),o.writeAttributeString("text:display-outline-level","0"),o.writeAttributeString("text:name","Text"),o.writeEndElement(),o.writeStartElement("text:sequence-decl"),o.writeAttributeString("text:display-outline-level","0"),o.writeAttributeString("text:name","Drawing"),o.writeEndElement(),o.writeEndElement(),a=V.create2(Boolean,this.matrix.coordY.countItems,this.matrix.coordX.countItems),o.writeStartElement("table:table"),o.writeAttributeString("table:name","Table1"),o.writeAttributeString("table:style-name","Table1");for(var w=0;w<this.matrix.coordX.countItems-1;w++)o.writeStartElement("table:table-column"),o.writeAttributeString("table:style-name",Z.format("Table1.{0}",this.getColumnName(w))),o.writeEndElement();for(var I=Math.max(this.matrix.coordY.countItems/200,1),B=0,p=1;p<this.matrix.coordY.countItems;p++){var D=p/I|0;B<D&&(B=D,this.invokeExporting2(p,this.matrix.coordY.countItems,this.currentPassNumber,this.maximumPassNumber)),o.writeStartElement("table:table-row"),o.writeAttributeString("table:style-name",Z.format("Table1.{0}",c[p-1]+1));for(var w=1;w<this.matrix.coordX.countItems;w++){var d=this.matrix.cells[p-1][w-1];if(a[p][w])o.writeStartElement("table:covered-table-cell"),o.writeEndElement();else if(null!=d){for(var u=0;u<=d.height;u++)for(var S=0;S<=d.width;S++)a[p+u][w+S]=!0;var k=s[p-1][w-1],N=this.getParagraphStyleNumber(p-1,w-1),O,M,H,U,O,H,U,M;if(o.writeStartElement("table:table-cell"),o.writeAttributeString("table:style-name",Z.format("cell{0}",k+1)),0<d.width&&o.writeAttributeString("table:number-columns-spanned",Z.format("{0}",d.width+1)),0<d.height&&o.writeAttributeString("table:number-rows-spanned",Z.format("{0}",d.height+1)),o.writeAttributeString("office:value-type","string"),d.component.is(j)&&!d.component.isExportAsImage(G.StiExportFormat.Odt)&&null!=d.text){var U=d.text;0!=this.paragraphStyleList[N].stimulsoft.as(rt).Angle&&(U=U.stimulsoft.replaceAll("\n"," "));for(var z=Y.Report.Export.StiExportUtils.splitString(U,!0),X=0;X<z.stimulsoft.countItems;X++){var W=z[X];o.writeStartElement("text:p"),o.writeAttributeString("text:style-name",Z.format("par{0}",N+1)),o.writeString(W),o.writeEndElement()}}!d.component.isExportAsImage(G.StiExportFormat.Odt)||null!=(O=d.component.stimulsoft.as(_))&&(H={ref:this.imageResolution},U=O.getImage(H),M=H.ref,null!=U&&(O=this.imageCache.addImageIntRaw(U,U.imageFormat),H=this.matrix.coordX.getByIndex(w+d.width)-this.matrix.coordX.getByIndex(w-1),U=this.matrix.coordY.getByIndex(p+d.height)-this.matrix.coordY.getByIndex(p-1),o.writeStartElement("text:p"),o.writeAttributeString("text:style-name","Table_20_Contents"),o.writeStartElement("draw:frame"),o.writeAttributeString("draw:style-name","fr1"),o.writeAttributeString("draw:name",Z.format("Picture{0}",O+1)),o.writeAttributeString("text:anchor-type","paragraph"),o.writeAttributeString("svg:width",this.doubleToString(H)),o.writeAttributeString("svg:height",this.doubleToString(U)),o.writeAttributeString("draw:z-index","0"),o.writeStartElement("draw:image"),o.writeAttributeString("xlink:href",Z.format("Pictures/{0:D5}.jpg",O+1)),o.writeAttributeString("xlink:type","simple"),o.writeAttributeString("xlink:show","embed"),o.writeAttributeString("xlink:actuate","onLoad"),o.writeEndElement(),o.writeEndElement(),o.writeEndElement())),o.writeEndElement()}else{var k=s[p-1][w-1];o.writeStartElement("table:table-cell"),o.writeAttributeString("table:style-name",Z.format("cell{0}",k+1)),o.writeEndElement()}}o.writeEndElement()}return o.writeEndElement(),o.writeStartElement("text:p"),o.writeAttributeString("text:style-name","parEnd"),o.writeEndElement(),o.writeEndElement(),o.writeEndElement(),o.writeFullEndElement(),o.writeEndDocument(),o.flush(),n},d.prototype.exportOdt=function(t,e,r){if(G.StiLogService.write(this.stimulsoft.getType(),"Export report to ODT format"),null==r)throw new Error("The 'settings' argument cannot be equal in null.");var i=r.pageRange;this.usePageHeadersAndFooters=r.usePageHeadersAndFooters,this._removeEmptySpaceAtBottom=r.removeEmptySpaceAtBottom,this.imageResolution=r.imageResolution,this.imageQuality=r.imageQuality,this.xmlIndentation=-1,this.imageQuality<0&&(this.imageQuality=0),1<this.imageQuality&&(this.imageQuality=1),this.imageResolution<10&&(this.imageResolution=10),this.imageResolution=this.imageResolution/100;try{this.imageCache=new G.StiImageCache(Y["StiOptions"].Export.OpenDocumentWriter.allowImageComparer,!0,m.Jpeg,this.imageQuality,!1),this.cellStyleList=[],this.paragraphStyleList=[],this.currentPassNumber=0,this.maximumPassNumber=3+(Y["StiOptions"].Export.OpenDocumentWriter.divideSegmentPages?1:0);var n=i.getSelectedPages(t.renderedPages);if(Y["StiOptions"].Export.OpenDocumentWriter.divideSegmentPages&&(n=s.StiSegmentPagesDivider.divide(n,this),this.currentPassNumber++),this.isStopped)return;var o=new l;if(o.begin(e,!0),this._matrix=new s.StiMatrix(n,!0,this),this.currentPassNumber=2+(Y["StiOptions"].Export.OpenDocumentWriter.divideSegmentPages?1:0),o.addFile("content.xml",this.writeContent()),o.addFile("mimetype",this.writeMimetype()),o.addFile("meta.xml",this.writeMeta()),o.addFile("META-INF/manifest.xml",this.writeManifest()),o.addFile("settings.xml",this.writeSettings()),o.addFile("styles.xml",this.writeStyles(n)),0<this.imageCache.imagePackedStore.stimulsoft.countItems)for(var a=0;a<this.imageCache.imagePackedStore.stimulsoft.countItems;a++)o.addFile(Z.format("Pictures/{0:D5}.jpg",a+1),this.writeImage(a));o.end()}finally{null!=this.matrix&&(this.matrix.clear(),this._matrix=null),this.cellStyleList.stimulsoft.clear(),this.cellStyleList=null,this.paragraphStyleList.stimulsoft.clear(),this.paragraphStyleList=null,this.imageCache.clear(),this.imageCache=null,t.renderedPages.cacheMode&&s.StiMatrix.GCCollect()}},a=d,s.StiOdtExportService=a}(Stimulsoft=Stimulsoft||{}),function(t){var e,r,i,n,o,a,s,t,l;function m(){}function c(){}function p(){var t=null!==l&&l.apply(this,arguments)||this;return t.multipleFiles=!1,t.colorList=null,t.fontList=null,t.styleList=null,t.unicodeMapArray=null,t.codePageToFont=null,t.charsetCount=0,t.fontToCodePages=null,t.baseFontNumber=0,t.usePageHeadersAndFooters=!1,t.imageResolution=.96,t.imageQuality=.75,t.imageFormat=r.StiExportFormat.Rtf,t.useStyles=!1,t.bookmarkList=null,t.usedBookmarks=null,t}r=e=t.Report||(t.Report={}),n=i=r.Export||(r.Export={}),o=t.Base.Localization.StiLocalization,a=m,s=c,l=n.StiExportService,__extends(p,l),Object.defineProperty(p.prototype,"defaultExtension",{get:function(){return"rtf"},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"exportFormat",{get:function(){return r.StiExportFormat.Rtf},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"groupCategory",{get:function(){return"Word"},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"position",{get:function(){return n.StiExportPosition.Rtf},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"exportNameInMenu",{get:function(){return o.get("Export","ExportTypeRtfFile")},enumerable:!1,configurable:!0}),p.prototype.getFilter=function(){return o.get("FileFilters","RtfFiles")},p.prototype.exportTo=function(t,e,r){},p.prototype.getColorNumberInt=function(t,e){if(0<t.length)for(var r=0;r<t.length;r++)if(t[r].equals(e))return r;var i;return t.push(e),t.length-1},p.prototype.getColorNumber=function(t,e){return this.getColorNumberInt(t,e).toString()},p.prototype.getFontNumber2=function(t,e){if(0<t.length)for(var r=0,i;r<t.length;r++){if(t[r].name==e.name)return r*(0==this.charsetCount?1:this.charsetCount)}var n;return t.push(e),(t.length-1)*(0==this.charsetCount?1:this.charsetCount)},p.prototype.getFontNumber3=function(t,e,r){if(0<t.length)for(var i=0,n;i<t.length;i++){if(t[i].name==e.name)return i*(0==this.charsetCount?1:this.charsetCount)+this.getCharsetIndex(r)}var o;return t.push(e),(t.length-1)*(0==this.charsetCount?1:this.charsetCount)+this.getCharsetIndex(r)},p.prototype.getCharsetIndex=function(t){var e=0;if(0==this.charsetCount)return this.codePageToFont[e]=1,0;return this.codePageToFont[e]},t=p,n.StiRtfExportService=t}(Stimulsoft=Stimulsoft||{}),function(re){var t,ie,e;ie=t=re.Report||(re.Report={}),function(Xt){var r=re.Report.Export.StiTxtBorderType,Wt=re.Report.Components.IStiTextHorAlignment,Yt=re.Report.Components.IStiVertAlignment,Gt=re.Base.Drawing.StiTextRenderer,Vt=re.Base.Drawing.StiHtmlState,_t=re.Report.Components.StiText,jt=re.Report.Components.StiCheckBox,qt=re.System.StiString,Kt=re.System.IO.StreamWriter,Jt=re.System.StiArray,y=re.Report.Components.IStiTextOptions,x=re.System.Char,Qt=re.System.Text.StringBuilder,Zt=re.System.IO.MemoryStream,$t=re.Base.Drawing.StiTextHorAlignment,t=re.Base.Localization.StiLocalization,te=re.Base.Drawing.StiVertAlignment,e=(i=Xt.StiExportService,__extends(n,i),n.prototype.implements=function(){return[Xt.IStiTxtExportService]},Object.defineProperty(n.prototype,"defaultExtension",{get:function(){return"txt"},enumerable:!1,configurable:!0}),n.prototype.exportTo=function(t,e,r){this.exportTxt(t,e,r)},n.prototype.exportToAsync=function(t,e,r,i){this.exportTo(e,r,i),t()},Object.defineProperty(n.prototype,"exportFormat",{get:function(){return ie.StiExportFormat.Text},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"groupCategory",{get:function(){return"Word"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"position",{get:function(){return Xt.StiExportPosition.Txt},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"exportNameInMenu",{get:function(){return t.get("Export","ExportTypeTxtFile")},enumerable:!1,configurable:!0}),n.prototype.getFilter=function(){return t.get("FileFilters","TxtFiles")},n.prototype.getBorderChar=function(t,e){if(this.useFullVerticalBorder)switch(e){case r.UnicodeSingle:return"   ".charCodeAt(t);case r.UnicodeDouble:return"   ".charCodeAt(t);default:return"-|+++++++++ -  ".charCodeAt(t)}else switch(e){case r.UnicodeSingle:return"    ".charCodeAt(t);case r.UnicodeDouble:return"    ".charCodeAt(t);default:return"-|+++++++++    ".charCodeAt(t)}},n.prototype.lineFill=function(t,e,r,i){for(var n=this.borderCodes[e-1],o=0;o<i;o++)-1==this.borderCodes.indexOf(t[r+o])?32==t[r+o]&&(t[r+o]=n):t[r+o]|=n},n.prototype.lineFillChar=function(t,e,r,i){for(var n=0;n<i;n++)t[r+n]=e},n.prototype.checkWordWrap=function(t,e,r,i){var n=e.ref;if(this.useEscapeCodes)for(var o=0;o<n.length;o++){var a=n[o],s=new Qt(a);if(Xt.StiBidirectionalConvert.stringContainArabicOrHebrew(a)){var l=a.length;while(x.isWhitespace(a,l-1))l--;s.insert(l,"<#ltrMark>")}var m=0;while(m<s.length){if("<"==s.charAt(m)&&m<s.length+1&&"#"==s.charAt(m+1)){var c=m,p=new Qt;while("<"==s.charAt(c)&&c<s.length+1&&"#"==s.charAt(c+1)){while(c<s.length&&">"!=s.charAt(c))p.append(s.charAt(c)),c++;if(p.append(">"),++c>s.length-1)break}c>s.length-1?p.append(String.fromCharCode(65535)):(p.append(s.charAt(c)),c++);var g=this.getEscapeNumber(this.escapeCodesList,p.toString());s.remove(m,c-m),s.insert(m,String.fromCharCode(this.firstEscapeCodeIndex-g))}m++}s.length!=n[o].length&&(n[o]=s.toString())}else for(var o=0;o<n.length;o++)if(Xt.StiBidirectionalConvert.stringContainArabicOrHebrew(n[o])){var a,m=(a=n[o]).length-1;while(x.isWhitespace(a,m))m--;var p=a.charAt(m)+this.ltrMark,g=this.getEscapeNumber(this.escapeCodesList,p);m==a.length-1?n[o]=a.substring(0,m)+String.fromCharCode(this.firstEscapeCodeIndex-g):n[o]=a.substring(0,m)+String.fromCharCode(this.firstEscapeCodeIndex-g)+a.substring(m+1)}var h=r;this.useFullVerticalBorder?this.needVerticalBorders[t.left+t.width]&&h--:!this.useFullTextBoxWidth&&1<h&&h--;var r=!1,t=t.component.stimulsoft.as(y);if(null!=t&&(r=t.textOptions.wordWrap),r){for(var w=n.stimulsoft.clone(),d=0;d<w.length;d++){var u=w[d];if(u.length>h-1&&1<h){var S=Jt.create(Number,u.length),f=0,v=0;while(" "==u.charAt(v))S[v]=f,v++;for(var E=v;E<u.length;E++)" "==u.charAt(E)&&f++,S[E]=f;var o,b=o=h-1-1;if(0<S[o])if(S[o]!=S[o+1]){b=o++;while(" "==u.charAt(o))o++}else{while(" "!=u.charAt(o))o--;b=o++;while(" "==u.charAt(b))b--}else o++;w[d]=u.substring(0,b+1),w.stimulsoft.insert(d+1,u.substr(o,u.length-o))}}w.length>n.length&&(n=w)}if(i)for(var o=0;o<n.length;o++)n[o].length>h&&(n[o]=n[o].substring(0,h));e.ref=n},n.prototype.checkGrow=function(t,e,r){while(t.length<=r)t.push([]),e.push(!1)},n.prototype.addCharsToLine=function(t,e,r,i){for(var n=0;n<r;n++)t[e].push(i)},n.prototype.getStyleNumber=function(t,e){if(0<t.length)for(var r=0;r<t.length;r++){var i=t[r];if(i.Bold==e.Bold&&i.Italic==e.Italic&&i.Underline==e.Underline&&i.Codes==e.Codes)return r}var n;return t.push(e),t.length-1},n.prototype.getEscapeNumber=function(t,e){if(0<t.length)for(var r=0;r<t.length;r++)if(t[r]==e)return r+1;var i;return t.push(e),t.length},n.prototype.getEscapeNames=function(t,e){var r=this.styleList[t],t=this.styleList[e],e=new Qt;return!r.Bold&&t.Bold&&e.append("<#b>"),r.Bold&&!t.Bold&&e.append("<#/b>"),!r.Italic&&t.Italic&&e.append("<#i>"),r.Italic&&!t.Italic&&e.append("<#/i>"),!r.Underline&&t.Underline&&e.append("<#u>"),r.Underline&&!t.Underline&&e.append("<#/u>"),e},n.prototype.exportTxt=function(t,e,r){var i,n,o,a;if(ie.StiLogService.write(this.stimulsoft.getType(),"Export report to Text format"),this.report=t,null==r)throw new Error("The 'settings' argument cannot be equal in null.");var s=r.pageRange,l=r.encoding,m=r.drawBorder,c=r.borderType,p=r.killSpaceLines,g=r.killSpaceGraphLines,h=r.putFeedPageCode,w=r.cutLongLines,d=r.zoomX,u=r.zoomY;this.useEscapeCodes=r.useEscapeCodes;var S=r.escapeCodesCollectionName;this.useFullTextBoxWidth=re["StiOptions"].Export.Text.useFullTextBoxWidth,this.useFullVerticalBorder=re["StiOptions"].Export.Text.useFullVerticalBorder,this.useFullHorizontalBorder=re["StiOptions"].Export.Text.useFullHorizontalBorder;var f=9.7,v=18;0==p&&(g=!1),0==m&&(g=!1),this.useFullVerticalBorder&&(this.useFullTextBoxWidth=!1);var r=new Zt,E=null!=l?new Kt(r,l):new Kt(r),s=s.getSelectedPages(t.renderedPages),b=0;this.styleList=[];var t=new ee;this.getStyleNumber(this.styleList,t),this.escapeCodesList=[],this.currentPassNumber=0,this.maximumPassNumber=3;var y=new Xt.StiMatrix(s,!1,this);if(this.isStopped)return;this.needVerticalBorders=Jt.create(Boolean,y.coordX.countItems);for(var x=1;x<y.coordX.countItems;x++){for(var A=!1,T=1;T<y.coordY.countItems;T++)if(null!=y.bordersY[T-1][x]){A=!0;break}this.needVerticalBorders[x-1]=A}this.needHorizontalBorders=Jt.create(Boolean,y.coordY.countItems);for(var T=1;T<y.coordY.countItems;T++){for(var P=!1,x=1;x<y.coordX.countItems;x++)if(null!=y.bordersX[T][x-1]){P=!0;break}this.needHorizontalBorders[T-1]=P}for(var L=Jt.create(Number,y.coordX.countItems),x=1;x<y.coordX.countItems;x++){var C=y.coordX.getByIndex(x),F=y.coordX.getByIndex(x-1);L[x-1]=Math.round((C-F)/(f/d)),this.useFullVerticalBorder&&this.needVerticalBorders[x-1]&&L[x-1]++}for(var R=Jt.create2(Boolean,y.coordY.countItems,y.coordX.countItems),I=Jt.create2(Number,y.coordY.countItems,y.coordX.countItems),B=Jt.create2(Number,y.coordY.countItems,y.coordX.countItems),T=1;T<y.coordY.countItems;T++)for(var x=1;x<y.coordX.countItems;x++)if(!R[T-1][x-1]){var D=y.cells[T-1][x-1],k,N;if(I[T-1][x-1]=L[x-1],null!=D){if(0<D.width)for(var O=0;O<D.width;O++)I[T-1][x-1]+=L[x-1+1+O];if(null!=D.component){null!=D.component&&(k=D.component.tagValue,qt.isNullOrWhiteSpace(k)||(k=k.trim(),N=parseInt(k),!isNaN(N)&&0<N&&(I[T-1][x-1]=N,this.useFullVerticalBorder&&this.needVerticalBorders[x-1+D.width]&&I[T-1][x-1]++)));var M=D.text,H,U,z;if(null!=(H=D.component.stimulsoft.as(jt))&&null!=H.checkedValue&&(z=U=!1,"boolean"==typeof H.checkedValue&&(H.checkedValue?U=!0:z=!0),"string"==typeof H.checkedValue&&("True"==H.checkedValue?U=!0:z=!0),U&&(M=re["StiOptions"].Export.Text.checkBoxTextForTrue),z&&(M=re["StiOptions"].Export.Text.checkBoxTextForFalse)),!D.component.isExportAsImage(ie.StiExportFormat.Text)&&!qt.isNullOrEmpty(M)){if(D.component.is(_t)&&D.component.checkAllowHtmlTags()){var X=new Vt(""),W=Gt.parseHtmlToStates(M,X),Y=new Qt;try{for(var G=(i=void 0,__values(W)),V=G.next();!V.done;V=G.next()){var _=V.value;Y.append(Gt.prepareStateText(_.text))}}catch(t){i={error:t}}finally{try{V&&!V.done&&(n=G.return)&&n.call(G)}finally{if(i)throw i.error}}M=Y.toString()}var j,q={ref:j=Xt.StiExportUtils.splitString(M.stimulsoft.replaceAll("\r",""),!1)};this.checkWordWrap(D,q,I[T-1][x-1],w);var N=(j=q.ref).length;B[T-1][x-1]=N}}for(var K=0;K<=D.height;K++){for(var J=0;J<=D.width;J++)R[T-1+K][x-1+J]=!0;I[T-1+K][x-1]=I[T-1][x-1]}}}for(var Q=Jt.create(Number,y.coordY.countItems),b=1,T=1;T<y.coordY.countItems;T++){var C=y.coordY.getByIndex(T),F=y.coordY.getByIndex(T-1),Z=Math.round((C-F)/(v/u));Z<1&&(Z=1);for(var x=1,D;x<y.coordX.countItems;x++){null!=(D=y.cells[T-1][x-1])&&D.height<1&&B[T-1][x-1]>Z&&(Z=B[T-1][x-1])}this.useFullHorizontalBorder&&this.needHorizontalBorders[T-1]&&Z++,b+=Q[T-1]=Z}b++;for(var $=[],tt=[],et=[],rt=0;rt<b;rt++)$.push([]),tt.push([]),et.push(!1);R=Jt.create2(Boolean,y.coordY.countItems,y.coordX.countItems);var it=m?1:0,nt=new _t;nt.vertAlignment=te.Center,nt.horAlignment=$t.Center,this.currentPassNumber=2;for(var T=1,ot,ot;T<y.coordY.countItems;T++){this.invokeExporting2(T,y.coordY.countItems,this.currentPassNumber,this.maximumPassNumber);for(var rt=0;rt<y.horizontalPageBreaks.length;rt++)y.horizontalPageBreaks[rt]==T-1&&(et[it-(m&&1<T&&this.needHorizontalBorders[T-1-1]?1:0)]=!0);for(var at=m?1:0,x=1;x<y.coordX.countItems;x++){var D=y.cells[T-1][x-1],st=I[T-1][x-1],lt=Q[T-1];if(!R[T-1][x-1]){var mt=0,ct=0,pt=0;if(null!=D){mt=D.width,ct=D.height;for(var J=0;J<=D.width;J++)for(var K=0;K<=D.height;K++)R[T-1+K][x-1+J]=!0;if(0<D.height)for(var O=0;O<D.height;O++)lt+=Q[T-1+1+O];if(this.useFullHorizontalBorder&&this.needHorizontalBorders[T-1+ct]&&lt--,null!=D.component){var gt=D.component.stimulsoft.as(_t),ht;null!=gt&&((ht=new ee).Bold=gt.font.bold,ht.Italic=gt.font.italic,ht.Underline=gt.font.underline,ht.Codes=null,pt=this.getStyleNumber(this.styleList,ht));var M=D.text,H,U,z;if(null!=(H=D.component.stimulsoft.as(jt))&&null!=H.checkedValue&&(z=U=!1,"boolean"==typeof H.checkedValue&&(H.checkedValue?U=!0:z=!0),"string"==typeof H.checkedValue&&("True"==H.checkedValue?U=!0:z=!0),U&&(M=re["StiOptions"].Export.Text.checkBoxTextForTrue),z&&(M=re["StiOptions"].Export.Text.checkBoxTextForFalse)),!D.component.isExportAsImage(ie.StiExportFormat.Text)&&!qt.isNullOrEmpty(M)){if(D.component.is(_t)&&D.component.checkAllowHtmlTags()){var X=new Vt(""),W=Gt.parseHtmlToStates(M,X),Y=new Qt;try{for(var wt=(o=void 0,__values(W)),dt=wt.next();!dt.done;dt=wt.next()){var _=dt.value;Y.append(Gt.prepareStateText(_.text))}}catch(t){o={error:t}}finally{try{dt&&!dt.done&&(a=wt.return)&&a.call(wt)}finally{if(o)throw o.error}}M=Y.toString()}var j,q={ref:j=Xt.StiExportUtils.splitString(M.stimulsoft.replaceAll("\r",""),!1)};this.checkWordWrap(D,q,I[T-1][x-1],w),j=q.ref;var ut=0,ht=D.component.stimulsoft.as(Yt);null!=H&&(ht=nt),null!=ht&&j.length<lt&&(0<(ht.vertAlignment&te.Center)&&(ut=Math.trunc((lt-j.length)/2)),0<(ht.vertAlignment&te.Bottom)&&(ut=lt-j.length));for(var rt=0;rt<j.length;rt++){var St=0,ft=st;this.useFullVerticalBorder?this.needVerticalBorders[D.left+D.width]&&ft--:!this.useFullTextBoxWidth&&1<ft&&ft--;var vt=D.component.stimulsoft.as(Wt);null!=H&&(vt=nt),null!=vt&&(vt.horAlignment==$t.Center&&(St=Math.trunc((ft-j[rt].length)/2)),vt.horAlignment==$t.Right&&(St=ft-j[rt].length));var Et=at+St,bt=it+ut+rt;Et<0&&(Et=0);var yt=Et+j[rt].length;this.checkGrow($,et,bt),$[bt].length<yt&&this.addCharsToLine($,bt,yt-$[bt].length,32);for(var xt=0,At;xt<j[rt].length;xt++){(At=j[rt].charCodeAt(xt))<32&&(At+=65280),$[bt][Et+xt]=At}}}}}else this.useFullHorizontalBorder&&this.needHorizontalBorders[T-1]&&lt--;this.useFullHorizontalBorder||lt--;for(var Tt=0;Tt<lt;Tt++){tt[it+Tt].length<at+st&&this.addCharsToLine(tt,it+Tt,at+st-tt[it+Tt].length,0);var ft=st;this.useFullVerticalBorder?null!=D&&this.needVerticalBorders[D.left+D.width]&&ft--:!this.useFullTextBoxWidth&&1<ft&&ft--,this.lineFillChar(tt[it+Tt],pt,at,ft)}if(m){for(var yt=at+st-1,O=-1;O<=lt;O++)this.checkGrow($,et,it+O),$[it+O].length<yt+1&&this.addCharsToLine($,it+O,yt+1-$[it+O].length,32);for(var Pt=!0,Lt=!0,O=0;O<ct+1;O++)null==y.bordersY[T-1+O][x-1]&&(Pt=!1),null==y.bordersY[T-1+O][x-1+mt+1]&&(Lt=!1);for(var Ct=!0,Ft=!0,O=0;O<mt+1;O++)null==y.bordersX[T-1][x-1+O]&&(Ct=!1),null==y.bordersX[T-1+ct+1][x-1+O]&&(Ft=!1);if(Ct&&(this.lineFill($[it-1],14,at-1,1),this.lineFill($[it-1],1,at,st-1),this.lineFill($[it-1],13,at+st-1,1)),Pt){this.lineFill($[it-1],15,at-1,1);for(var O=0;O<lt;O++)this.lineFill($[it+O],2,at-1,1);this.lineFill($[it+lt],12,at-1,1)}if(Lt){this.lineFill($[it-1],15,at+st-1,1);for(var O=0;O<lt;O++)this.lineFill($[it+O],2,at+st-1,1);this.lineFill($[it+lt],12,at+st-1,1)}Ft&&(this.lineFill($[it+lt],14,at-1,1),this.lineFill($[it+lt],1,at,st-1),this.lineFill($[it+lt],13,at+st-1,1))}}at+=st}it+=Q[T-1]}if(m){for(var Rt=!0,rt=0;rt<$.length;rt++)if(0<$[rt].length&&32!=$[rt][0]){Rt=!1;break}if(Rt)for(var rt=0;rt<$.length;rt++)0<$[rt].length&&$[rt].stimulsoft.removeRange(0,1),0<tt[rt].length&&tt[rt].stimulsoft.removeRange(0,1)}re.Base.vEIvF.JlKzR.RNAxU()||re.Base.vEIvF.JlKzR.KqUvN()||(re.Base.vEIvF.JlKzR.ZHIhL()||re.Base.vEIvF.JlKzR.LuQMU()||re.Base.vEIvF.JlKzR.UPtPa())&&re.System.NodeJs.isStandaloneVersion||(ot=(y.coordX.getByIndex(y.coordX.countItems-1)-y.coordX.getByIndex(0))/(f/d),ot=Math.max(1,Math.trunc(ot/2-10)),E.writeLine(qt.fill(" ",ot)+"---=== TRIAL ===---\r\n"));var It=$.length-1;while(0<It&&0==$[It].length)It--;for(var Bt=0,rt=0;rt<$.length;rt++){if(0<$[rt].length){for(var O=0;O<this.borderCodes.length;O++)for(var Dt=this.borderCodes[O],kt=this.getBorderChar(O,c),xt=0;xt<$[rt].length;xt++)$[rt][xt]==Dt&&($[rt][xt]=kt);if(re["StiOptions"].Export.Text.trimTrailingSpaces,g){for(var kt=this.getBorderChar(1,c),Nt=!0,O=0;O<$[rt].length;O++){var Ot=$[rt][O];Ot!=kt&&32!=Ot&&(Nt=!1)}Nt&&($[rt]=[])}h&&et[rt]&&(this.useEscapeCodes&&E.write(this.getEscapeNames(Bt,0).toString()),Bt=0,E.write("\f")),this.useEscapeCodes}var Mt=$[rt];if(!p&&rt<=It||0<Mt.length){var Ht=Mt.length;if(re["StiOptions"].Export.Text.trimTrailingSpaces)while(0<Ht&&32==Mt[Ht-1])Ht--;for(var Ut="",zt=0,At;zt<Ht;zt++){65280<=(At=Mt[zt])&&(At-=65280),Ut+=String.fromCharCode(At)}re["StiOptions"].Export.Text.removeLastNewLineMarker&&rt==It?E.write(Ut):E.writeLine(Ut)}}var ot=new Qt;this.useEscapeCodes&&ot.append(this.getEscapeNames(Bt,0)),h&&ot.append("\f"),0<ot.length&&E.write(ot.toString()),E.flush(),this.useEscapeCodes,r.writeTo(e),r.close(),this.needVerticalBorders=null,this.needHorizontalBorders=null,this.styleList=null,this.escapeCodesList=null},n),i;function n(){var t=null!==i&&i.apply(this,arguments)||this;return t.multipleFiles=!1,t.borderCodes=[6,9,12,10,5,3,13,11,14,7,15,1,2,4,8],t.firstEscapeCodeIndex=63742,t.ltrMark=" 0E",t.useFullVerticalBorder=!0,t.useFullHorizontalBorder=!0,t}Xt.StiTxtExportService=e;var ee=o;function o(){}}(e=ie.Export||(ie.Export={}))}(Stimulsoft=Stimulsoft||{});;
var Stimulsoft;
(function (Stimulsoft) {
    var Reflection;
    (function (Reflection) {
        var StiTypesHelper = (function () {
            function StiTypesHelper() {
            }
            StiTypesHelper.run = function (type, namespace) {
                if (type === undefined) {
                    StiTypesHelper.run(Stimulsoft, "Stimulsoft");
                    return;
                }
                namespace = namespace.stimulsoft.replaceAll("Stimulsoft.System", "System");
                for (var name_1 in type) {
                    if (typeof type[name_1] == "function") {
                        type[name_1].ssTypeName = name_1;
                        type[name_1].ssNamespace = namespace;
                    }
                    else if (typeof type[name_1] == "object") {
                        StiTypesHelper.run(type[name_1], namespace + "." + name_1);
                    }
                }
            };
            return StiTypesHelper;
        }());
        Reflection.StiTypesHelper = StiTypesHelper;
    })(Reflection = Stimulsoft.Reflection || (Stimulsoft.Reflection = {}));
})(Stimulsoft || (Stimulsoft = {}));
Stimulsoft.Reflection.StiTypesHelper.run();
;