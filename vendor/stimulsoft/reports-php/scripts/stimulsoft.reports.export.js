/*
Stimulsoft.Reports.JS
Version: 2025.3.5
Build date: 2025.09.04
License: https://www.stimulsoft.com/en/licensing/reports
*/
(e=>{var t;"undefined"!=typeof process&&process.__nwjs||"object"!=typeof exports||"undefined"==typeof module?"function"==typeof define&&define.amd?define(["./stimulsoft.reports.engine"],t=>Object.assign(t,e(t.Stimulsoft))):window.Stimulsoft?window.Stimulsoft.Report?Object.assign(window,e(window.Stimulsoft)):window.Stimulsoft.exportFactory=e:window.Stimulsoft={exportFactory:e}:module.exports=(t=require("./stimulsoft.reports.engine"),Object.assign(t,e(t.Stimulsoft)))})(function(Z){function r(t,e){for(var i in e)i in t?r(t[i],e[i]):t[i]=e[i];return t}Z&&"2025.3.5"!==Z.__engineVersion&&console.warn("Scripts versions mismatch: engine ver. = %s; export ver. = 2025.3.5",Z.__engineVersion);var Z=r(Z||{},{Report:{Export:{Office:{}}},Reflection:{}}),J={},t,n,a;J.a=Z.Report,J.b=Z.Reflection,J.c=J.a.Export,J.d=J.c.Office;let o=Z.System.Exception,$=Z.System.StiMath,tt=Z.System.Char,gt=J.a.Components.StiCheckBox,q=Z.System.Globalization.CultureInfo,p=Z.Base.Zip.StiZipWriter20,s=J.a.ImageFormat,pt=J.a.Components.IStiExportImageExtended,et=J.a.Components.StiText,it=Z.System.StiArray,C=Z.System.Collections.Hashtable,S=J.a.Components.StiPageOrientation,f=J.a.Components.StiPagesCollection,_=Z.System.DateTime,d=Z.System.Xml.Formatting,w=Z.System.Xml.XmlTextWriter,u=Z.System.Text.Encoding,W=Z.System.IO.StreamWriter,rt=Z.System.Drawing.Color,nt=Z.System.StiString,K=Z.System.IO.MemoryStream,e=Z.Base.Localization.StiLocalization,at=Z.Base.Drawing.StiTextHorAlignment,st=Z.Base.Drawing.StiVertAlignment;{class ir{constructor(){this.BorderLeft="none",this.BorderRight="none",this.BorderTop="none",this.BorderBottom="none",this.BackColor=rt.transparent,this.VertAlign=st.Bottom,this.FontName="Arial",this.FontSize=6,this.Bold=!1,this.Italic=!1,this.Underline=!1,this.FontColor=rt.black,this.HorAlign=at.Left,this.Angle=0,this.Wordwrap=!1,this.DataStyle=-1}}class rr{constructor(){this.isNumeric=!1,this.isCurrency=!1,this.isPercent=!1,this.isDate=!1,this.isTime=!1,this.isDefaultFormat=!1,this.DecimalDigits=2,this.DecimalComma=" ",this.GroupDigits=0,this.CurrencySymbol="$",this.CurrencyPositionBefore=!1,this.NegativeBraces=!1,this.DateTimeFormatString=null,this.CurrencyPositivePattern=null,this.CurrencyNegativePattern=null}}J.c.StiOdsExportService=class extends J.c.StiExportService{constructor(){super(...arguments),this.multipleFiles=!1,this.matrix=null,this.imageCache=null,this.cellStyleList=null,this.dataStyleList=null,this.sheetNameList=null,this.matrixList=null,this.firstPageIndexList=null,this.minRowList=null,this.maxRowList=null,this.cellStyleTableList=null,this.imageQuality=.75,this.imageResolution=96,this.xmlIndentation=1}implements(){let t=[J.c.IStiOdsExportService];return(this.implements=()=>t)()}get defaultExtension(){return"ods"}get exportFormat(){return J.a.StiExportFormat.Ods}get groupCategory(){return"Excel"}get position(){return J.c.StiExportPosition.Ods}get exportNameInMenu(){return e.get("Export","ExportTypeCalcFile")}getFilter(){return e.get("FileFilters","WriteCalcFilesrFiles")}exportTo(t,e,i){this.exportOds(t,e,i)}exportToAsync(e,i,t,r){setTimeout(async()=>{try{await J.c.StiExportImageHelper.convertAllImages(i,Z.System.Drawing.Imaging.ImageFormat.Jpeg,!1,this.exportFormat),this.exportTo(i,t,r),null!=i&&null!=i.preparedExportImages&&(i.preparedExportImages.clear(),i.preparedExportImages=null)}catch(t){if(o.log(t,i,`Export Error`).isImportant)return e(o.getMessage(t))}e()})}doubleToString(t){return $.round2(t/100,4).toString()[Z.System.StiObject.stimulsoft]().replaceAll(",",".")+"in"}getColumnName(t){let e=t/26|0,i=t%26,r="";return 0<e&&(r+=String.fromCharCode(65+e-1)),r+=String.fromCharCode(65+i)}getColorString(t){return"#"+nt.format("{0:X8}",t.toArgb()).substr(2)}getCellStyleNumber(r,n,e,i){let a=new ir,s=!0,o=!0;for(let t=0;t<e;t++)null==this.matrix.bordersY.gett(r+t,n)&&(s=!1),null==this.matrix.bordersY.gett(r+t,n+i)&&(o=!1);let l=!0,h=!0;for(let t=0;t<i;t++)null==this.matrix.bordersX.gett(r,n+t)&&(l=!1),null==this.matrix.bordersX.gett(r+e,n+t)&&(h=!1);if(l&&(a.BorderTop=this.getStringFromBorder(this.matrix.bordersX.gett(r,n))),s&&(a.BorderLeft=this.getStringFromBorder(this.matrix.bordersY.gett(r,n))),h&&(a.BorderBottom=this.getStringFromBorder(this.matrix.bordersX.gett(r+e,n))),o&&(a.BorderRight=this.getStringFromBorder(this.matrix.bordersY.gett(r,n+i))),null!=this.matrix.cells.gett(r,n)){let i=this.matrix.cells.gett(r,n),t=i.cellStyle,e=(a.BackColor=t.color,a.VertAlign=t.vertAlignment,a.FontName=t.font.name,a.FontSize=t.font.sizeInPoints,a.Bold=t.font.bold,a.Italic=t.font.italic,a.Underline=t.font.underline,a.FontColor=t.textColor,a.HorAlign=t.horAlignment,0);if(null!=t.textOptions&&(e=t.textOptions.angle,a.Wordwrap=t.textOptions.wordWrap),a.Angle=0|Math.round(e),null!=i.component){let t=i.component.as(et),e=(null!=t&&(a.DataStyle=this.getDataStyleNumber(t)),i.component.as(gt));null==e||nt.isNullOrEmpty(e.excelDataValue)||(a.FontName=Z.StiOptions.Export.CheckBoxReplacementForExcelValue.Font.name,a.FontSize=Z.StiOptions.Export.CheckBoxReplacementForExcelValue.Font.sizeInPoints,a.Bold=Z.StiOptions.Export.CheckBoxReplacementForExcelValue.Font.bold,a.Italic=Z.StiOptions.Export.CheckBoxReplacementForExcelValue.Font.italic,a.Underline=Z.StiOptions.Export.CheckBoxReplacementForExcelValue.Font.underline,a.VertAlign=Z.StiOptions.Export.CheckBoxReplacementForExcelValue.VertAlignment,a.HorAlign=Z.StiOptions.Export.CheckBoxReplacementForExcelValue.HorAlignment)}}if(0<this.cellStyleList.length)for(let e=0;e<this.cellStyleList.length;e++){let t=this.cellStyleList[e];if(t.BorderLeft==a.BorderLeft&&t.BorderRight==a.BorderRight&&t.BorderTop==a.BorderTop&&t.BorderBottom==a.BorderBottom&&t.BackColor.equals(a.BackColor)&&t.VertAlign==a.VertAlign&&t.FontName==a.FontName&&t.FontSize==a.FontSize&&t.Bold==a.Bold&&t.Italic==a.Italic&&t.Underline==a.Underline&&t.FontColor.equals(a.FontColor)&&t.HorAlign==a.HorAlign&&t.Angle==a.Angle&&t.Wordwrap==a.Wordwrap&&t.DataStyle==a.DataStyle)return e}return this.cellStyleList.push(a),this.cellStyleList.length-1}getStringFromBorder(t){return nt.format("{0} solid {1}",this.doubleToString(t.size),this.getColorString(t.color))}getDataStyleNumber(t){let i=new rr,r=t.format,e=null!=r?r.indexOf("|"):-1;if(-1!=e&&(i.CurrencyPositivePattern=J.c.StiExportUtils.getPositivePattern(r.charCodeAt(e+1)-65),i.CurrencyNegativePattern=J.c.StiExportUtils.getNegativePattern(r.charCodeAt(e+2)-65),r=r.substr(0,e)),nt.isNullOrEmpty(r))return-1;if("C"==r.charAt(0)&&(i.isCurrency=!0),"N"==r.charAt(0)&&(i.isNumeric=!0),"P"==r.charAt(0)&&(i.isPercent=!0),"D"==r.charAt(0)&&(i.isDate=!0,1<r.length)&&(i.DateTimeFormatString=r.substr(1)),"T"==r.charAt(0)&&(i.isTime=!0,1<r.length)&&(i.DateTimeFormatString=r.substr(1)),1==r.length)i.isDefaultFormat=!0;else if(i.isCurrency||i.isNumeric||i.isPercent){let e=1;if(tt.isDigit(r,e)){let t="";while(e<r.length&&tt.isDigit(r,e))t+=r.charAt(e),e++;i.DecimalDigits=parseInt(t)}e<r.length&&"G"==r.charAt(e)&&(e++,i.GroupDigits=3),e<r.length&&"("==r.charAt(e)&&(e++,i.NegativeBraces=!0),e<r.length&&("."==r.charAt(e)||","==r.charAt(e))&&(i.DecimalComma=r.charAt(e),e++),e<r.length&&("+"==r.charAt(e)||"-"==r.charAt(e))&&("+"==r.charAt(e)&&(i.CurrencyPositionBefore=!0),++e<r.length)&&(i.CurrencySymbol=r.substr(e))}if(t.hideZeros&&!nt.isNullOrEmpty(r)&&(i.isDefaultFormat=!1),0<this.dataStyleList.length)for(let e=0;e<this.dataStyleList.length;e++){let t=this.dataStyleList[e];if(t.isNumeric==i.isNumeric&&t.isCurrency==i.isCurrency&&t.isPercent==i.isPercent&&t.isDate==i.isDate&&t.isTime==i.isTime&&t.isDefaultFormat==i.isDefaultFormat&&t.DecimalDigits==i.DecimalDigits&&t.DecimalComma==i.DecimalComma&&t.GroupDigits==i.GroupDigits&&t.CurrencySymbol==i.CurrencySymbol&&t.CurrencyPositionBefore==i.CurrencyPositionBefore&&t.DateTimeFormatString==i.DateTimeFormatString&&t.CurrencyPositivePattern==i.CurrencyPositivePattern&&t.CurrencyNegativePattern==i.CurrencyNegativePattern)return e}this.dataStyleList.push(i);let n=this.dataStyleList.length-1;return n}writeMimetype(){let t=new K,e=new W(t,u.ASCII);return e.write("application/vnd.oasis.opendocument.spreadsheet"),e.flush(),t}writeMeta(){let t=new K,e=new w(u.UTF8,t),i=(e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?d.None:d.Indented,e.writeStartDocument(),e.writeStartElement("office:document-meta"),e.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),e.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),e.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),e.writeAttributeString("xmlns:meta","urn:oasis:names:tc:opendocument:xmlns:meta:1.0"),e.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),e.writeAttributeString("office:version","1.1"),e.writeStartElement("office:meta"),_.now.toString("yyyy-MM-ddTHH:mm:ss")),r=J.c.StiExportUtils.getReportVersion(this.report);return e.writeElementString("meta:generator",r),e.writeElementString("meta:creation-date",i),e.writeElementString("dc:date",i),e.writeElementString("meta:editing-cycles","1"),e.writeElementString("meta:editing-duration","PT0M0S"),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 1"),e.writeEndElement(),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 2"),e.writeEndElement(),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 3"),e.writeEndElement(),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 4"),e.writeEndElement(),e.writeStartElement("meta:document-statistic"),e.writeAttributeString("meta:table-count","1"),e.writeAttributeString("meta:cell-count","1"),e.writeEndElement(),e.writeFullEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeManifest(){let t=new K,e=new w(u.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?d.None:d.Indented,e.writeStartDocument(),e.writeStartElement("manifest:manifest"),e.writeAttributeString("xmlns:manifest","urn:oasis:names:tc:opendocument:xmlns:manifest:1.0"),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","application/vnd.oasis.opendocument.spreadsheet"),e.writeAttributeString("manifest:full-path","/"),e.writeEndElement();for(let t=0;t<this.imageCache.imagePackedStore.length;t++)e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","image/jpeg"),e.writeAttributeString("manifest:full-path",nt.format("Pictures/{0:D5}.jpg",t+1)),e.writeEndElement();return e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","content.xml"),e.writeEndElement(),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","styles.xml"),e.writeEndElement(),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","meta.xml"),e.writeEndElement(),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","settings.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeImage(t){let e=new K,i=this.imageCache.imagePackedStore[t];return null!=i&&e.write(i,0,i.length),e}writeSettings(){let t=new K,e=new w(u.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?d.None:d.Indented,e.writeStartDocument(),e.writeStartElement("office:document-settings"),e.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),e.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),e.writeAttributeString("xmlns:config","urn:oasis:names:tc:opendocument:xmlns:config:1.0"),e.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),e.writeAttributeString("office:version","1.1"),e.writeStartElement("office:settings"),e.writeStartElement("config:config-item-set"),e.writeAttributeString("config:name","ooo:view-settings"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleAreaTop"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleAreaLeft"),e.writeAttributeString("config:type","int"),e.writeString("-10107"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleAreaWidth"),e.writeAttributeString("config:type","int"),e.writeString("43208"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleAreaHeight"),e.writeAttributeString("config:type","int"),e.writeString("22174"),e.writeEndElement(),e.writeStartElement("config:config-item-map-indexed"),e.writeAttributeString("config:name","Views"),e.writeStartElement("config:config-item-map-entry"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewId"),e.writeAttributeString("config:type","string"),e.writeString("View1"),e.writeEndElement(),e.writeStartElement("config:config-item-map-named"),e.writeAttributeString("config:name","Tables"),e.writeStartElement("config:config-item-map-entry"),e.writeAttributeString("config:name","Sheet1"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CursorPositionX"),e.writeAttributeString("config:type","int"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CursorPositionY"),e.writeAttributeString("config:type","int"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HorizontalSplitMode"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VerticalSplitMode"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HorizontalSplitPosition"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VerticalSplitPosition"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ActiveSplitRange"),e.writeAttributeString("config:type","short"),e.writeString("2"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PositionLeft"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PositionRight"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PositionTop"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PositionBottom"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ActiveTable"),e.writeAttributeString("config:type","string"),e.writeString("Sheet1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HorizontalScrollbarWidth"),e.writeAttributeString("config:type","int"),e.writeString("270"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ZoomType"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ZoomValue"),e.writeAttributeString("config:type","int"),e.writeString("100"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PageViewZoomValue"),e.writeAttributeString("config:type","int"),e.writeString("60"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowPageBreakPreview"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowZeroValues"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowNotes"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowGrid"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","GridColor"),e.writeAttributeString("config:type","long"),e.writeString("12632256"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowPageBreaks"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HasColumnRowHeaders"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HasSheetTabs"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsOutlineSymbolsSet"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsSnapToRaster"),e.writeAttributeString("config:type","long"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterIsVisible"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterResolutionX"),e.writeAttributeString("config:type","int"),e.writeString("1000"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterResolutionY"),e.writeAttributeString("config:type","int"),e.writeString("1000"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterSubdivisionX"),e.writeAttributeString("config:type","int"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterSubdivisionY"),e.writeAttributeString("config:type","int"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsRasterAxisSynchronized"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("config:config-item-set"),e.writeAttributeString("config:name","ooo:configuration-settings"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowZeroValues"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowNotes"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowGrid"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","GridColor"),e.writeAttributeString("config:type","long"),e.writeString("12632256"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowPageBreaks"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","LinkUpdateMode"),e.writeAttributeString("config:type","short"),e.writeString("3"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HasColumnRowHeaders"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HasSheetTabs"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsOutlineSymbolsSet"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsSnapToRaster"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterIsVisible"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterResolutionX"),e.writeAttributeString("config:type","int"),e.writeString("1000"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterResolutionY"),e.writeAttributeString("config:type","int"),e.writeString("1000"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterSubdivisionX"),e.writeAttributeString("config:type","int"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterSubdivisionY"),e.writeAttributeString("config:type","int"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsRasterAxisSynchronized"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AutoCalculate"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrinterName"),e.writeAttributeString("config:type","string"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrinterSetup"),e.writeAttributeString("config:type","base64Binary"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ApplyUserData"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CharacterCompressionType"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsKernAsianPunctuation"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","SaveVersionOnClose"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UpdateFromTemplate"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AllowPrintJobCancel"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","LoadReadonly"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeStyles(t){let e=new K,i=new w(u.UTF8,e),r=(i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?d.None:d.Indented,i.writeStartDocument(),i.writeStartElement("office:document-styles"),i.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),i.writeAttributeString("xmlns:style","urn:oasis:names:tc:opendocument:xmlns:style:1.0"),i.writeAttributeString("xmlns:text","urn:oasis:names:tc:opendocument:xmlns:text:1.0"),i.writeAttributeString("xmlns:table","urn:oasis:names:tc:opendocument:xmlns:table:1.0"),i.writeAttributeString("xmlns:draw","urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"),i.writeAttributeString("xmlns:fo","urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0"),i.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),i.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),i.writeAttributeString("xmlns:meta","urn:oasis:names:tc:opendocument:xmlns:meta:1.0"),i.writeAttributeString("xmlns:number","urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0"),i.writeAttributeString("xmlns:presentation","urn:oasis:names:tc:opendocument:xmlns:presentation:1.0"),i.writeAttributeString("xmlns:svg","urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0"),i.writeAttributeString("xmlns:chart","urn:oasis:names:tc:opendocument:xmlns:chart:1.0"),i.writeAttributeString("xmlns:dr3d","urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"),i.writeAttributeString("xmlns:math","http://www.w3.org/1998/Math/MathML"),i.writeAttributeString("xmlns:form","urn:oasis:names:tc:opendocument:xmlns:form:1.0"),i.writeAttributeString("xmlns:script","urn:oasis:names:tc:opendocument:xmlns:script:1.0"),i.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),i.writeAttributeString("xmlns:ooow","http://openoffice.org/2004/writer"),i.writeAttributeString("xmlns:oooc","http://openoffice.org/2004/calc"),i.writeAttributeString("xmlns:dom","http://www.w3.org/2001/xml-events"),i.writeAttributeString("office:version","1.1"),i.writeStartElement("office:font-face-decls"),i.writeStartElement("style:font-face"),i.writeAttributeString("style:name","Arial"),i.writeAttributeString("svg:font-family","Arial"),i.writeEndElement(),i.writeStartElement("style:font-face"),i.writeAttributeString("style:name","Tahoma"),i.writeAttributeString("svg:font-family","Tahoma"),i.writeAttributeString("style:font-family-generic","system"),i.writeAttributeString("style:font-pitch","variable"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("office:styles"),i.writeStartElement("style:default-style"),i.writeAttributeString("style:family","table-cell"),i.writeStartElement("style:table-cell-properties"),i.writeAttributeString("style:decimal-places","2"),i.writeEndElement(),i.writeStartElement("style:paragraph-properties"),i.writeAttributeString("style:tab-stop-distance","1.25cm"),i.writeEndElement(),i.writeStartElement("style:text-properties"),i.writeAttributeString("style:font-name","Arial"),i.writeAttributeString("fo:language","ru"),i.writeAttributeString("fo:country","RU"),i.writeAttributeString("style:font-name-asian","Lucida Sans Unicode"),i.writeAttributeString("style:language-asian","zxx"),i.writeAttributeString("style:country-asian","none"),i.writeAttributeString("style:font-name-complex","Tahoma"),i.writeAttributeString("style:language-complex","zxx"),i.writeAttributeString("style:country-complex","none"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("number:number-style"),i.writeAttributeString("style:name","N0"),i.writeStartElement("number:number"),i.writeAttributeString("number:min-integer-digits","1"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Default"),i.writeAttributeString("style:family","table-cell"),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Result"),i.writeAttributeString("style:family","table-cell"),i.writeAttributeString("style:parent-style-name","Default"),i.writeStartElement("style:text-properties"),i.writeAttributeString("fo:font-style","italic"),i.writeAttributeString("style:text-underline-style","solid"),i.writeAttributeString("style:text-underline-width","auto"),i.writeAttributeString("style:text-underline-color","font-color"),i.writeAttributeString("fo:font-weight","bold"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Heading"),i.writeAttributeString("style:family","table-cell"),i.writeAttributeString("style:parent-style-name","Default"),i.writeStartElement("style:table-cell-properties"),i.writeAttributeString("style:text-align-source","fix"),i.writeAttributeString("style:repeat-content","false"),i.writeEndElement(),i.writeStartElement("style:paragraph-properties"),i.writeAttributeString("fo:text-align","center"),i.writeEndElement(),i.writeStartElement("style:text-properties"),i.writeAttributeString("fo:font-size","16pt"),i.writeAttributeString("fo:font-style","italic"),i.writeAttributeString("fo:font-weight","bold"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Heading1"),i.writeAttributeString("style:family","table-cell"),i.writeAttributeString("style:parent-style-name","Heading"),i.writeStartElement("style:table-cell-properties"),i.writeAttributeString("style:rotation-angle","90"),i.writeEndElement(),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("office:automatic-styles"),t.getByIndex(0)),n=r.unit.convertToHInches(r.pageHeight*r.segmentPerHeight),a=r.unit.convertToHInches(r.pageWidth*r.segmentPerWidth),s=r.unit.convertToHInches(r.margins.left),o=r.unit.convertToHInches(r.margins.right),l=r.unit.convertToHInches(r.margins.top),h=r.unit.convertToHInches(r.margins.bottom)-4;return h<0&&(h=0),i.writeStartElement("style:page-layout"),i.writeAttributeString("style:name","pm1"),i.writeStartElement("style:page-layout-properties"),i.writeAttributeString("fo:page-width",this.doubleToString(a)),i.writeAttributeString("fo:page-height",this.doubleToString(n)),i.writeAttributeString("style:num-format","1"),i.writeAttributeString("style:print-orientation",r.orientation==S.Portrait?"portrait":"landscape"),i.writeAttributeString("fo:margin-top",this.doubleToString(l)),i.writeAttributeString("fo:margin-bottom",this.doubleToString(h)),i.writeAttributeString("fo:margin-left",this.doubleToString(s)),i.writeAttributeString("fo:margin-right",this.doubleToString(o)),i.writeAttributeString("style:writing-mode","lr-tb"),i.writeEndElement(),i.writeStartElement("style:header-style"),i.writeStartElement("style:header-footer-properties"),i.writeAttributeString("fo:min-height","0.101cm"),i.writeAttributeString("fo:margin-left","0cm"),i.writeAttributeString("fo:margin-right","0cm"),i.writeAttributeString("fo:margin-bottom","0cm"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:footer-style"),i.writeStartElement("style:header-footer-properties"),i.writeAttributeString("fo:min-height","0.101cm"),i.writeAttributeString("fo:margin-left","0cm"),i.writeAttributeString("fo:margin-right","0cm"),i.writeAttributeString("fo:margin-top","0cm"),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("office:master-styles"),i.writeStartElement("style:master-page"),i.writeAttributeString("style:name","Default"),i.writeAttributeString("style:page-layout-name","pm1"),i.writeStartElement("style:header"),i.writeAttributeString("style:display","false"),i.writeStartElement("text:p"),i.writeStartElement("text:sheet-name"),i.writeString("Sheet1"),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:header-left"),i.writeAttributeString("style:display","false"),i.writeEndElement(),i.writeStartElement("style:footer"),i.writeAttributeString("style:display","false"),i.writeStartElement("text:p"),i.writeString("Page "),i.writeStartElement("text:page-number"),i.writeString("1"),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:footer-left"),i.writeAttributeString("style:display","false"),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeFullEndElement(),i.writeEndDocument(),i.flush(),e}writeContent(o,l){let t=new K,r=new w(u.UTF8,t),h=(r.indentation=this.xmlIndentation<0?0:this.xmlIndentation,r.formatting=this.xmlIndentation<0?d.None:d.Indented,r.writeStartDocument(),r.writeStartElement("office:document-content"),r.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),r.writeAttributeString("xmlns:style","urn:oasis:names:tc:opendocument:xmlns:style:1.0"),r.writeAttributeString("xmlns:text","urn:oasis:names:tc:opendocument:xmlns:text:1.0"),r.writeAttributeString("xmlns:table","urn:oasis:names:tc:opendocument:xmlns:table:1.0"),r.writeAttributeString("xmlns:draw","urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"),r.writeAttributeString("xmlns:fo","urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0"),r.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),r.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),r.writeAttributeString("xmlns:meta","urn:oasis:names:tc:opendocument:xmlns:meta:1.0"),r.writeAttributeString("xmlns:number","urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0"),r.writeAttributeString("xmlns:presentation","urn:oasis:names:tc:opendocument:xmlns:presentation:1.0"),r.writeAttributeString("xmlns:svg","urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0"),r.writeAttributeString("xmlns:chart","urn:oasis:names:tc:opendocument:xmlns:chart:1.0"),r.writeAttributeString("xmlns:dr3d","urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"),r.writeAttributeString("xmlns:math","http://www.w3.org/1998/Math/MathML"),r.writeAttributeString("xmlns:form","urn:oasis:names:tc:opendocument:xmlns:form:1.0"),r.writeAttributeString("xmlns:script","urn:oasis:names:tc:opendocument:xmlns:script:1.0"),r.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),r.writeAttributeString("xmlns:ooow","http://openoffice.org/2004/writer"),r.writeAttributeString("xmlns:oooc","http://openoffice.org/2004/calc"),r.writeAttributeString("xmlns:dom","http://www.w3.org/2001/xml-events"),r.writeAttributeString("xmlns:xforms","http://www.w3.org/2002/xforms"),r.writeAttributeString("xmlns:xsd","http://www.w3.org/2001/XMLSchema"),r.writeAttributeString("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance"),r.writeAttributeString("office:version","1.1"),0);while(h<l.count){let t=new f(o,l),e=(t.addV2Internal(l.getByIndex(h)),h),i=l.getByIndex(h).excelSheetValue;while(h<l.count-1&&l.getByIndex(h+1).excelSheetValue==i)h++,t.addV2Internal(l.getByIndex(h));t.cacheMode=o.renderedPages.cacheMode;let r=t.getByIndex(0).excelSheetValue,n=(nt.isNullOrEmpty(r)&&(r=nt.format("Page {0}",this.sheetNameList.length+1)),""),a=1;if(this.matrix=new J.c.StiMatrix(t,Z.StiOptions.Export.OpenDocumentCalc.divideBigCells,this),this.isStopped)return null;let s=0;do{this.firstPageIndexList.push(e),this.matrixList.push(this.matrix);let t=this.matrix.coordY.countItems-1;if(t-s>Z.StiOptions.Export.OpenDocumentCalc.maximumSheetHeight?t=s+Z.StiOptions.Export.OpenDocumentCalc.maximumSheetHeight:this.matrix=null,this.minRowList.push(s),this.maxRowList.push(t),s=t,(null!=this.matrix||0<n.length)&&(n=` part`+a++),this.sheetNameList.push(r+n),this.isStopped)return null}while(null!=this.matrix);h++}let c=new C,m=new C,g=new C,p=new C;for(let n=0;n<this.matrixList.length;n++){this.matrix=this.matrixList[n];let t=this.minRowList[n],e=this.maxRowList[n],i=this.matrix.coordX.getKeys(),r=this.matrix.coordY.getKeys(),a=it.create2(Boolean,this.matrix.coordY.countItems,this.matrix.coordX.countItems),s=it.create2(Number,this.matrix.coordY.countItems,this.matrix.coordX.countItems);for(let t=0;t<this.matrix.coordX.countItems-1;t++){let e=this.matrix.coordX.getByIndex(t+1,i)-this.matrix.coordX.getByIndex(t,i);if(!g.containsKey(e)){let t=g.count;g.set(e,t),p.set(t,e)}}for(let n=t+1;n<e+1;n++){let e=this.matrix.coordY.getByIndex(n,r)-this.matrix.coordY.getByIndex(n-1,r);if(!c.containsKey(e)){let t=c.count;c.set(e,t),m.set(t,e)}for(let r=1;r<this.matrix.coordX.countItems;r++){let i=this.matrix.cells.gett(n-1,r-1);if(!a[n][r])if(null!=i){for(let e=0;e<=i.height;e++)for(let t=0;t<=i.width;t++)a[n+e][r+t]=!0;s[n-1][r-1]=this.getCellStyleNumber(n-1,r-1,i.height+1,i.width+1)}else s[n-1][r-1]=this.getCellStyleNumber(n-1,r-1,1,1)}}this.cellStyleTableList.push(s)}r.writeStartElement("office:scripts"),r.writeEndElement();let i=new C;for(let t of this.cellStyleList)i.set(t.FontName,t.FontName);r.writeStartElement("office:font-face-decls");for(let e of i.keys){let t=i.get(e);r.writeStartElement("style:font-face"),r.writeAttributeString("style:name",t),r.writeAttributeString("svg:font-family",t),r.writeEndElement()}r.writeEndElement(),r.writeStartElement("office:automatic-styles");for(let e=0;e<g.count;e++){r.writeStartElement("style:style"),r.writeAttributeString("style:name",`co`+(e+1)),r.writeAttributeString("style:family","table-column"),r.writeStartElement("style:table-column-properties"),r.writeAttributeString("fo:break-before","auto");let t=p.get(e);r.writeAttributeString("style:column-width",this.doubleToString(t)),r.writeEndElement(),r.writeEndElement()}for(let e=0;e<c.count;e++){r.writeStartElement("style:style"),r.writeAttributeString("style:name",`ro`+(e+1)),r.writeAttributeString("style:family","table-row"),r.writeStartElement("style:table-row-properties");let t=m.get(e);r.writeAttributeString("style:row-height",this.doubleToString(t)),r.writeAttributeString("fo:break-before","auto"),r.writeAttributeString("style:use-optimal-row-height","false"),r.writeEndElement(),r.writeEndElement()}r.writeStartElement("style:style"),r.writeAttributeString("style:name","ta1"),r.writeAttributeString("style:family","table"),r.writeAttributeString("style:master-page-name","Default"),r.writeStartElement("style:table-properties"),r.writeAttributeString("table:display","true"),r.writeAttributeString("style:writing-mode","lr-tb"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:style"),r.writeAttributeString("style:name","gr1"),r.writeAttributeString("style:family","graphic"),r.writeStartElement("style:graphic-properties"),r.writeAttributeString("draw:stroke","none"),r.writeAttributeString("draw:fill","none"),r.writeAttributeString("draw:textarea-horizontal-align","center"),r.writeAttributeString("draw:textarea-vertical-align","middle"),r.writeAttributeString("draw:color-mode","standard"),r.writeAttributeString("draw:luminance","0%"),r.writeAttributeString("draw:contrast","0%"),r.writeAttributeString("draw:gamma","100%"),r.writeAttributeString("draw:red","0%"),r.writeAttributeString("draw:green","0%"),r.writeAttributeString("draw:blue","0%"),r.writeAttributeString("fo:clip","rect(0cm 0cm 0cm 0cm)"),r.writeAttributeString("draw:image-opacity","100%"),r.writeAttributeString("style:mirror","none"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:style"),r.writeAttributeString("style:name","P1"),r.writeAttributeString("style:family","paragraph"),r.writeStartElement("style:paragraph-properties"),r.writeAttributeString("fo:text-align","center"),r.writeEndElement(),r.writeEndElement();for(let e=0;e<this.dataStyleList.length;e++){let t=this.dataStyleList[e];t.isNumeric&&(r.writeStartElement("number:number-style"),t.NegativeBraces?(r.writeAttributeString("style:name",`N${e+1}P0`),r.writeAttributeString("style:volatile","true")):r.writeAttributeString("style:name",`N`+(e+1))," "!=t.DecimalComma&&(r.writeAttributeString("number:language",","==t.DecimalComma?"ru":"en"),r.writeAttributeString("number:country",","==t.DecimalComma?"RU":"US")),r.writeStartElement("number:number"),r.writeAttributeString("number:decimal-places",t.DecimalDigits.toString()),r.writeAttributeString("number:min-integer-digits","1"),r.writeAttributeString("number:grouping",3==t.GroupDigits?"true":"false"),r.writeEndElement(),r.writeEndElement(),t.NegativeBraces)&&(r.writeStartElement("number:number-style"),r.writeAttributeString("style:name",`N`+(e+1))," "!=t.DecimalComma&&(r.writeAttributeString("number:language",","==t.DecimalComma?"ru":"en"),r.writeAttributeString("number:country",","==t.DecimalComma?"RU":"US")),r.writeElementString("number:text","("),r.writeStartElement("number:number"),r.writeAttributeString("number:decimal-places",t.DecimalDigits.toString()),r.writeAttributeString("number:min-integer-digits","1"),r.writeAttributeString("number:grouping",3==t.GroupDigits?"true":"false"),r.writeEndElement(),r.writeElementString("number:text",")"),r.writeStartElement("style:map"),r.writeAttributeString("style:condition","value()>=0"),r.writeAttributeString("style:apply-style-name",`N${e+1}P0`),r.writeEndElement(),r.writeEndElement()),t.isPercent&&(r.writeStartElement("number:percentage-style"),r.writeAttributeString("style:name",`N`+(e+1))," "!=t.DecimalComma&&(r.writeAttributeString("number:language",","==t.DecimalComma?"ru":"en"),r.writeAttributeString("number:country",","==t.DecimalComma?"RU":"US")),r.writeStartElement("number:number"),r.writeAttributeString("number:decimal-places",t.DecimalDigits.toString()),r.writeAttributeString("number:min-integer-digits","1"),3==t.GroupDigits&&r.writeAttributeString("number:grouping","true"),r.writeEndElement(),r.writeElementString("number:text","%"),r.writeEndElement()),t.isCurrency&&(r.writeStartElement("number:currency-style"),r.writeAttributeString("style:name",`N`+(e+1))," "!=t.DecimalComma&&(r.writeAttributeString("number:language",","==t.DecimalComma?"ru":"en"),r.writeAttributeString("number:country",","==t.DecimalComma?"RU":"US")),t.CurrencyPositionBefore&&r.writeElementString("number:currency-symbol",t.CurrencySymbol),r.writeStartElement("number:number"),r.writeAttributeString("number:decimal-places",t.DecimalDigits.toString()),r.writeAttributeString("number:min-integer-digits","1"),r.writeAttributeString("number:grouping",3==t.GroupDigits?"true":"false"),r.writeEndElement(),t.CurrencyPositionBefore||r.writeElementString("number:currency-symbol",t.CurrencySymbol),r.writeEndElement()),t.isDate&&(r.writeStartElement("number:date-style"),r.writeAttributeString("style:name",`N`+(e+1)),this.writeDateTimeFormatString(r,t.DateTimeFormatString,"d"),r.writeEndElement()),t.isTime&&(r.writeStartElement("number:time-style"),r.writeAttributeString("style:name",`N`+(e+1)),nt.isNullOrEmpty(t.DateTimeFormatString)||-1==t.DateTimeFormatString.indexOf("h")||(r.writeAttributeString("number:language","en"),r.writeAttributeString("number:country","US")),this.writeDateTimeFormatString(r,t.DateTimeFormatString,"t"),r.writeEndElement())}for(let i=0;i<this.cellStyleList.length;i++){let t=this.cellStyleList[i],e=(r.writeStartElement("style:style"),r.writeAttributeString("style:name",`ce`+(i+1)),r.writeAttributeString("style:family","table-cell"),r.writeAttributeString("style:parent-style-name","Default"),-1!=t.DataStyle&&r.writeAttributeString("style:data-style-name",`N`+(t.DataStyle+1)),r.writeStartElement("style:table-cell-properties"),0<t.BackColor.a?r.writeAttributeString("fo:background-color",this.getColorString(t.BackColor)):r.writeAttributeString("fo:background-color","transparent"),t.VertAlign==st.Center&&r.writeAttributeString("style:vertical-align","middle"),t.VertAlign==st.Top&&r.writeAttributeString("style:vertical-align","top"),r.writeAttributeString("style:text-align-source","fix"),r.writeAttributeString("style:repeat-content","false"),t.Wordwrap&&r.writeAttributeString("fo:wrap-option","wrap"),r.writeAttributeString("fo:padding","0in"),r.writeAttributeString("fo:border-left",t.BorderLeft),r.writeAttributeString("fo:border-right",t.BorderRight),r.writeAttributeString("fo:border-top",t.BorderTop),r.writeAttributeString("fo:border-bottom",t.BorderBottom),0!=t.Angle&&(r.writeAttributeString("style:rotation-angle",t.Angle.toString()),r.writeAttributeString("style:rotation-align","none")),r.writeEndElement(),r.writeStartElement("style:paragraph-properties"),t.HorAlign==at.Left&&r.writeAttributeString("fo:text-align","start"),t.HorAlign==at.Center&&r.writeAttributeString("fo:text-align","center"),t.HorAlign==at.Right&&r.writeAttributeString("fo:text-align","end"),t.HorAlign==at.Width&&r.writeAttributeString("fo:text-align","justify"),r.writeAttributeString("fo:margin-left","0cm"),r.writeEndElement(),r.writeStartElement("style:text-properties"),r.writeAttributeString("fo:color",this.getColorString(t.FontColor)),r.writeAttributeString("style:font-name",t.FontName),t.FontSize+`pt`);r.writeAttributeString("fo:font-size",e),r.writeAttributeString("fo:font-size-asian",e),r.writeAttributeString("fo:font-size-complex",e),t.Italic&&(r.writeAttributeString("fo:font-style","italic"),r.writeAttributeString("fo:font-style-asian","italic"),r.writeAttributeString("fo:font-style-complex","italic")),t.Underline&&(r.writeAttributeString("style:text-underline-style","solid"),r.writeAttributeString("style:text-underline-width","auto"),r.writeAttributeString("style:text-underline-color","font-color")),t.Bold&&(r.writeAttributeString("fo:font-weight","bold"),r.writeAttributeString("fo:font-weight-asian","bold"),r.writeAttributeString("fo:font-weight-complex","bold")),r.writeEndElement(),r.writeEndElement()}r.writeFullEndElement(),r.writeStartElement("office:body"),r.writeStartElement("office:spreadsheet"),r.writeStartElement("table:calculation-settings"),r.writeAttributeString("table:use-regular-expressions","false"),r.writeEndElement(),this.currentPassNumber=Z.StiOptions.Export.OpenDocumentCalc.divideSegmentPages?3:2;for(let t=0;t<this.matrixList.length;t++)this.writeTableFromMatrix(r,t,c,g);return r.writeEndElement(),r.writeEndElement(),r.writeFullEndElement(),r.writeEndDocument(),r.flush(),t}writeDateTimeFormatString(i,r,t){if(1==(r=nt.isNullOrEmpty(r)?t:r).length){let t=this.currentCulture.dateTimeFormat;switch(r){case"d":r=t.shortDatePattern;break;case"D":r=t.longDatePattern;break;case"f":r=t.shortDatePattern+" "+t.shortTimePattern;break;case"F":r=t.fullDateTimePattern;break;case"g":r=t.shortDatePattern+" "+t.shortTimePattern;break;case"G":r=t.shortDatePattern+" "+t.longTimePattern;break;case"m":case"M":r=q.currentCulture.name.includes("en")||q.currentCulture.name.includes("us")?"MMMM d":"d MMMM";break;case"r":case"R":r="ddd, dd MMM yyyy HH\\:mm\\:ss \\G\\M\\T";break;case"s":r="yyyy\\-MM\\-dd\\THH\\:mm\\:ss";break;case"t":r=t.shortTimePattern;break;case"T":r=t.longTimePattern;break;case"u":r="yyyy\\-MM\\-dd HH\\:mm\\:ss\\Z";break;case"U":r=t.fullDateTimePattern;break;case"y":case"Y":r=t.yearMonthPattern;break}r=r[Z.System.StiObject.stimulsoft]().replaceAll('"',"")[Z.System.StiObject.stimulsoft]().replaceAll("'","")}let n=0;while(n<r.length){let t=r.charAt(n),e=1;while(n+1<r.length&&r.charAt(n+1)==t)n++,e++;switch(n++,t){case"d":1==e&&(i.writeStartElement("number:day"),i.writeEndElement()),2==e&&(i.writeStartElement("number:day"),i.writeAttributeString("number:style","long"),i.writeEndElement()),3==e&&(i.writeStartElement("number:day-of-week"),i.writeEndElement()),4==e&&(i.writeStartElement("number:day-of-week"),i.writeAttributeString("number:style","long"),i.writeEndElement());break;case"M":1==e&&(i.writeStartElement("number:month"),i.writeEndElement()),2==e&&(i.writeStartElement("number:month"),i.writeAttributeString("number:style","long"),i.writeEndElement()),3==e&&(i.writeStartElement("number:month"),i.writeAttributeString("number:textual","true"),i.writeEndElement()),4==e&&(i.writeStartElement("number:month"),i.writeAttributeString("number:style","long"),i.writeAttributeString("number:textual","true"),i.writeEndElement());break;case"y":1!=e&&2!=e||(i.writeStartElement("number:year"),i.writeEndElement()),3!=e&&4!=e||(i.writeStartElement("number:year"),i.writeAttributeString("number:style","long"),i.writeEndElement());break;case"s":1==e&&(i.writeStartElement("number:seconds"),i.writeEndElement()),2==e&&(i.writeStartElement("number:seconds"),i.writeAttributeString("number:style","long"),i.writeEndElement());break;case"m":1==e&&(i.writeStartElement("number:minutes"),i.writeEndElement()),2==e&&(i.writeStartElement("number:minutes"),i.writeAttributeString("number:style","long"),i.writeEndElement());break;case"h":case"H":1==e&&(i.writeStartElement("number:hours"),i.writeEndElement()),2==e&&(i.writeStartElement("number:hours"),i.writeAttributeString("number:style","long"),i.writeEndElement());break;default:i.writeElementString("number:text",t);break}}}writeTableFromMatrix(g,t,r,n){let p=this.matrixList[t],e=this.minRowList[t],i=this.maxRowList[t],a=this.cellStyleTableList[t],d=this.sheetNameList[t],w=it.create2(Boolean,p.coordY.countItems,p.coordX.countItems),u=(g.writeStartElement("table:table"),g.writeAttributeString("table:name",d),g.writeAttributeString("table:style-name","ta1"),g.writeAttributeString("table:print","false"),p.coordX.getKeys()),S=p.coordY.getKeys();for(let i=0;i<p.coordX.countItems-1;i++){let t=p.coordX.getByIndex(i+1,u)-p.coordX.getByIndex(i,u),e=n.get(t);g.writeStartElement("table:table-column"),g.writeAttributeString("table:style-name",`co`+(e+1)),g.writeAttributeString("table:default-cell-style-name","Default"),g.writeEndElement()}let s=Math.max(p.coordY.countItems/200,1),o=0;for(let m=e+1;m<i+1;m++){let t=m/s|0,e=(t>o&&(o=t,this.invokeExporting2(m,p.coordY.countItems,this.currentPassNumber,this.maximumPassNumber)),p.coordY.getByIndex(m,S)-p.coordY.getByIndex(m-1,S)),i=r.get(e);g.writeStartElement("table:table-row"),g.writeAttributeString("table:style-name",`ro`+(i+1));for(let c=1;c<p.coordX.countItems;c++){let s=p.cells.gett(m-1,c-1);if(w[m][c])g.writeStartElement("table:covered-table-cell");else if(null!=s){for(let e=0;e<=s.height;e++)for(let t=0;t<=s.width;t++)w[m+e][c+t]=!0;let t=a[m-1][c-1],o=this.cellStyleList[t].DataStyle,l=(g.writeStartElement("table:table-cell"),g.writeAttributeString("table:style-name",`ce`+(t+1)),(0<s.width||0<s.height)&&(g.writeAttributeString("table:number-columns-spanned",(s.width+1).toString()),g.writeAttributeString("table:number-rows-spanned",(s.height+1).toString())),s.component.as(et)),h=s.text,e=s.component.as(gt);if(null==e||nt.isNullOrEmpty(e.excelDataValue)||(h=e.excelDataValue),!s.component.isExportAsImage(J.a.StiExportFormat.Ods)&&(!nt.isNullOrEmpty(h)||null!=l&&null!=l.excelDataValue)){let i=!1,r=0,n=_.now,a=null;if(-1!=o&&null!=l&&null!=l.excelDataValue&&"-"!=l.excelDataValue){let e=l.excelDataValue,t=e.replace(/[^\d.,-]/g,"")[Z.System.StiObject.stimulsoft]().replaceAll(",",".");a=this.dataStyleList[o],i=!0;try{if(a.isDate||a.isTime){let t=_.tryParseExact(e,[null]);t.successfully?n=t.result:i=!1}else r=parseFloat(t),isNaN(r)&&(i=!1,r=0)}catch(t){i=!1}i||null!=h||(h=e)}if(i)if(a.isDate)g.writeAttributeString("office:value-type","date"),g.writeAttributeString("office:date-value",n.toString("yyyy-MM-dd"));else if(a.isTime)g.writeAttributeString("office:value-type","time"),g.writeAttributeString("office:time-value",n.toString("PTHH\\Hmm\\Mss\\S"));else{let t=r.toString()[Z.System.StiObject.stimulsoft]().replaceAll(",",".");a.isNumeric&&g.writeAttributeString("office:value-type","float"),a.isPercent&&g.writeAttributeString("office:value-type","percentage"),a.isCurrency&&g.writeAttributeString("office:value-type","currency"),g.writeAttributeString("office:value",t)}else g.writeAttributeString("office:value-type","string");let s=J.c.StiExportUtils.splitString(h,!0);for(let e=0;e<s.length;e++){let t=s[e];g.writeStartElement("text:p"),g.writeString(t),g.writeEndElement()}}if(s.component.isExportAsImage(J.a.StiExportFormat.Ods)){g.writeAttributeString("office:value-type","string");let e=s.component.as(pt);if(null!=e){let a=null,t={ref:this.imageResolution};if(null!=(a=e.getImage(t,J.a.StiExportFormat.Ods))){let t=p.getRealImageData(s,a),e=(null!=t&&(a=t),this.imageCache.addImageInt(a)),i=p.coordX.getByIndex(c+s.width,u)-p.coordX.getByIndex(c-1,u),r=p.coordY.getByIndex(m+s.height,S)-p.coordY.getByIndex(m-1,S),n=`'${d}'.`+this.getColumnName(s.left+s.width+1)+(s.top+s.height+1+1);g.writeStartElement("draw:frame"),g.writeAttributeString("table:end-cell-address",n),g.writeAttributeString("table:end-x","0in"),g.writeAttributeString("table:end-y","0in"),g.writeAttributeString("draw:z-index","0"),g.writeAttributeString("draw:name",`Picture`+(e+1)),g.writeAttributeString("draw:style-name","gr1"),g.writeAttributeString("draw:text-style-name","P1"),g.writeAttributeString("text:anchor-type","paragraph"),g.writeAttributeString("svg:x",this.doubleToString(0)),g.writeAttributeString("svg:y",this.doubleToString(0)),g.writeAttributeString("svg:width",this.doubleToString(i)),g.writeAttributeString("svg:height",this.doubleToString(r)),g.writeStartElement("draw:image"),g.writeAttributeString("xlink:href",nt.format("Pictures/{0:D5}.jpg",e+1)),g.writeAttributeString("xlink:type","simple"),g.writeAttributeString("xlink:show","embed"),g.writeAttributeString("xlink:actuate","onLoad"),g.writeStartElement("text:p"),g.writeEndElement(),g.writeEndElement(),g.writeEndElement()}}}}else{let t=a[m-1][c-1];g.writeStartElement("table:table-cell"),g.writeAttributeString("table:style-name",`ce`+(t+1))}g.writeEndElement()}g.writeEndElement()}g.writeEndElement()}exportOds(i,r,t){if(null==Z.Base[["St","iL","ic","en","se"].join("")].key&&console.warn("You are using a trial version of the Stimulsoft product!"),J.a.StiLogService.write(this[Z.System.StiObject.stimulsoft]().getType(),"Export report to ODT format"),null==t)throw new Error("The 'settings' argument cannot be equal in null.");this.report=i;let n=t.pageRange;this.imageResolution=t.imageResolution,this.imageQuality=t.imageQuality,this.xmlIndentation=-1,this.imageQuality<0&&(this.imageQuality=0),1<this.imageQuality&&(this.imageQuality=1),this.imageResolution<10&&(this.imageResolution=10),this.imageResolution=this.imageResolution/100,this.currentCulture=q.currentCulture;try{q.currentCulture=q.cultures["en-US"],this.imageCache=new J.a.StiImageCache(Z.StiOptions.Export.OpenDocumentCalc.allowImageComparer,!0,s.Jpeg,this.imageQuality,!1),this.cellStyleList=[],this.dataStyleList=[],this.sheetNameList=[],this.matrixList=[],this.firstPageIndexList=[],this.minRowList=[],this.maxRowList=[],this.cellStyleTableList=[],this.currentPassNumber=0,this.maximumPassNumber=Z.StiOptions.Export.OpenDocumentCalc.divideSegmentPages?4:3;let t=n.getSelectedPages(i.renderedPages);if(Z.StiOptions.Export.OpenDocumentCalc.divideSegmentPages&&(t=J.c.StiSegmentPagesDivider.divide(t,this),this.currentPassNumber=1),this.isStopped)return;let e=new p;if(e.begin(r,!0),e.addFile("content.xml",this.writeContent(i,t)),e.addFile("mimetype",this.writeMimetype()),e.addFile("meta.xml",this.writeMeta()),e.addFile("META-INF/manifest.xml",this.writeManifest()),e.addFile("settings.xml",this.writeSettings()),e.addFile("styles.xml",this.writeStyles(t)),0<this.imageCache.imagePackedStore.length)for(let t=0;t<this.imageCache.imagePackedStore.length;t++)e.addFile(nt.format("Pictures/{0:D5}.jpg",t+1),this.writeImage(t));e.end()}finally{q.currentCulture=this.currentCulture,this.sheetNameList[Z.System.StiObject.stimulsoft]().clear(),this.sheetNameList=null,this.firstPageIndexList[Z.System.StiObject.stimulsoft]().clear(),this.firstPageIndexList=null,this.minRowList[Z.System.StiObject.stimulsoft]().clear(),this.minRowList=null,this.maxRowList[Z.System.StiObject.stimulsoft]().clear(),this.maxRowList=null;for(let t of this.matrixList)null!=t&&t.clear();this.matrixList[Z.System.StiObject.stimulsoft]().clear(),this.matrixList=null,this.cellStyleTableList[Z.System.StiObject.stimulsoft]().clear(),this.cellStyleTableList=null,this.dataStyleList[Z.System.StiObject.stimulsoft]().clear(),this.dataStyleList=null,this.cellStyleList[Z.System.StiObject.stimulsoft]().clear(),this.cellStyleList=null,this.imageCache.clear(),this.imageCache=null,i.renderedPages.cacheMode&&J.c.StiMatrix.GCCollect()}}}}{class nr{constructor(){this.BorderLeft="none",this.BorderRight="none",this.BorderTop="none",this.BorderBottom="none",this.BackColor=rt.transparent,this.VertAlign=st.Bottom}}class ar{constructor(){this.FontName="Arial",this.FontSize=6,this.Bold=!1,this.Italic=!1,this.Underline=!1,this.FontColor=rt.black,this.HorAlign=at.Left,this.Angle=0}}J.c.StiOdtExportService=class extends J.c.StiExportService{constructor(){super(...arguments),this.multipleFiles=!1,this.matrix=null,this.removeEmptySpaceAtBottom=Z.StiOptions.Export.OpenDocumentWriter.removeEmptySpaceAtBottom,this.imageCache=null,this.cellStyleList=null,this.paragraphStyleList=null,this.xmlIndentation=1,this.imageQuality=.75,this.imageResolution=96,this.usePageHeadersAndFooters=!1}implements(){let t=[J.c.IStiOdtExportService];return(this.implements=()=>t)()}get defaultExtension(){return"odt"}get exportFormat(){return J.a.StiExportFormat.Odt}get groupCategory(){return"Word"}get position(){return J.c.StiExportPosition.Odt}get exportNameInMenu(){return e.get("Export","ExportTypeWriterFile")}getFilter(){return e.get("FileFilters","WriterFiles")}exportTo(t,e,i){this.exportOdt(t,e,i)}exportToAsync(e,i,t,r){setTimeout(async()=>{try{await J.c.StiExportImageHelper.convertAllImages(i,Z.System.Drawing.Imaging.ImageFormat.Jpeg,!1,this.exportFormat),this.exportTo(i,t,r),null!=i&&null!=i.preparedExportImages&&(i.preparedExportImages.clear(),i.preparedExportImages=null)}catch(t){if(o.log(t,i,`Export Error`).isImportant)return e(o.getMessage(t))}e()},0)}doubleToString(t){return $.round2(t/100,4).toString()[Z.System.StiObject.stimulsoft]().replaceAll(",",".")+"in"}getColumnName(t){let e=t/26|0,i=t%26,r="";return 0<e&&(r+=String.fromCharCode(65+e-1)),r+=String.fromCharCode(65+i)}getColorString(t){return"#"+nt.format("{0:X8}",t.toArgb()).substr(2)}getCellStyleNumber(i,r,e,n){let a=new nr,s=!0,o=!0;for(let t=0;t<e;t++)null==this.matrix.bordersY.gett(i+t,r)&&(s=!1),null==this.matrix.bordersY.gett(i+t,r+n)&&(o=!1);let l=!0,h=!0;for(let t=0;t<n;t++)null==this.matrix.bordersX.gett(i,r+t)&&(l=!1),null==this.matrix.bordersX.gett(i+e,r+t)&&(h=!1);if(l&&(a.BorderTop=this.getStringFromBorder(this.matrix.bordersX.gett(i,r))),s&&(a.BorderLeft=this.getStringFromBorder(this.matrix.bordersY.gett(i,r))),h&&(a.BorderBottom=this.getStringFromBorder(this.matrix.bordersX.gett(i+e,r))),o&&(a.BorderRight=this.getStringFromBorder(this.matrix.bordersY.gett(i,r+n))),null!=this.matrix.cells.gett(i,r)){let e=this.matrix.cells.gett(i,r);if(a.BackColor=e.cellStyle.color,a.VertAlign=e.cellStyle.vertAlignment,null!=e.cellStyle.textOptions){let t=e.cellStyle.textOptions.angle;(45<t&&t<135||225<t&&t<315)&&(e.cellStyle.horAlignment==at.Left&&(a.VertAlign=st.Bottom),e.cellStyle.horAlignment==at.Center&&(a.VertAlign=st.Center),e.cellStyle.horAlignment==at.Right&&(a.VertAlign=st.Top),e.cellStyle.horAlignment==at.Width)&&(a.VertAlign=st.Bottom)}}if(0<this.cellStyleList.length)for(let e=0;e<this.cellStyleList.length;e++){let t=this.cellStyleList[e];if(t.BorderLeft==a.BorderLeft&&t.BorderRight==a.BorderRight&&t.BorderTop==a.BorderTop&&t.BorderBottom==a.BorderBottom&&t.BackColor.equals(a.BackColor)&&t.VertAlign==a.VertAlign)return e}this.cellStyleList.push(a);let t=this.cellStyleList.length-1;return t}getStringFromBorder(t){return nt.format("{0} solid {1}",this.doubleToString(t.size),this.getColorString(t.color))}getParagraphStyleNumber(t,e){let i=this.matrix.cells.gett(t,e).cellStyle,r=new ar,n=(r.FontName=i.font.name,r.FontSize=i.font.sizeInPoints,r.Bold=i.font.bold,r.Italic=i.font.italic,r.Underline=i.font.underline,r.FontColor=i.textColor,r.HorAlign=i.horAlignment,0);if(45<(n=null!=i.textOptions?i.textOptions.angle:n)&&n<135&&(r.Angle=90),225<n&&n<315&&(r.Angle=270),0!=r.Angle&&(i.vertAlignment==st.Top&&(r.HorAlign=at.Left),i.vertAlignment==st.Center&&(r.HorAlign=at.Center),i.vertAlignment==st.Bottom)&&(r.HorAlign=at.Right),0<this.paragraphStyleList.length)for(let e=0;e<this.paragraphStyleList.length;e++){let t=this.paragraphStyleList[e];if(t.FontName==r.FontName&&t.FontSize==r.FontSize&&t.Bold==r.Bold&&t.Italic==r.Italic&&t.Underline==r.Underline&&t.FontColor.equals(r.FontColor)&&t.HorAlign==r.HorAlign&&t.Angle==r.Angle)return e}this.paragraphStyleList.push(r);let a=this.paragraphStyleList.length-1;return a}writeMimetype(){let t=new K,e=new W(t,u.ASCII);return e.write("application/vnd.oasis.opendocument.text"),e.flush(),t}writeMeta(){let t=new K,e=new w(u.UTF8,t),i=(e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?d.None:d.Indented,e.writeStartDocument(),e.writeStartElement("office:document-meta"),e.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),e.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),e.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),e.writeAttributeString("xmlns:meta","urn:oasis:names:tc:opendocument:xmlns:meta:1.0"),e.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),e.writeAttributeString("office:version","1.1"),e.writeStartElement("office:meta"),nt.format("{0}",_.now.toString("yyyy-MM-ddTHH:mm:ss"))),r=J.c.StiExportUtils.getReportVersion(this.report);return e.writeElementString("meta:generator",r),e.writeElementString("meta:creation-date",i),e.writeElementString("dc:date",i),e.writeElementString("meta:editing-cycles","1"),e.writeElementString("meta:editing-duration","PT0M01S"),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 1"),e.writeEndElement(),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 2"),e.writeEndElement(),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 3"),e.writeEndElement(),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 4"),e.writeEndElement(),e.writeStartElement("meta:document-statistic"),e.writeAttributeString("meta:table-count","1"),e.writeAttributeString("meta:image-count","0"),e.writeAttributeString("meta:object-count","0"),e.writeAttributeString("meta:page-count","1"),e.writeAttributeString("meta:paragraph-count","1"),e.writeAttributeString("meta:word-count","1"),e.writeAttributeString("meta:character-count","1"),e.writeEndElement(),e.writeFullEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeManifest(){let t=new K,e=new w(u.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?d.None:d.Indented,e.writeStartDocument(),e.writeStartElement("manifest:manifest"),e.writeAttributeString("xmlns:manifest","urn:oasis:names:tc:opendocument:xmlns:manifest:1.0"),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","application/vnd.oasis.opendocument.text"),e.writeAttributeString("manifest:full-path","/"),e.writeEndElement();for(let t=0;t<this.imageCache.imagePackedStore.length;t++)e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","image/jpeg"),e.writeAttributeString("manifest:full-path",nt.format("Pictures/{0:D5}.jpg",t+1)),e.writeEndElement();return e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","content.xml"),e.writeEndElement(),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","styles.xml"),e.writeEndElement(),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","meta.xml"),e.writeEndElement(),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","settings.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeImage(t){let e=new K,i=this.imageCache.imagePackedStore[t];return null!=i&&e.write(i,0,i.length),e}writeSettings(){let t=new K,e=new w(u.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?d.None:d.Indented,e.writeStartDocument(),e.writeStartElement("office:document-settings"),e.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),e.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),e.writeAttributeString("xmlns:config","urn:oasis:names:tc:opendocument:xmlns:config:1.0"),e.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),e.writeAttributeString("office:version","1.1"),e.writeStartElement("office:settings"),e.writeStartElement("config:config-item-set"),e.writeAttributeString("config:name","ooo:view-settings"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewAreaTop"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewAreaLeft"),e.writeAttributeString("config:type","int"),e.writeString("-10107"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewAreaWidth"),e.writeAttributeString("config:type","int"),e.writeString("43208"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewAreaHeight"),e.writeAttributeString("config:type","int"),e.writeString("22174"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowRedlineChanges"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","InBrowseMode"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item-map-indexed"),e.writeAttributeString("config:name","Views"),e.writeStartElement("config:config-item-map-entry"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewId"),e.writeAttributeString("config:type","string"),e.writeString("view2"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewLeft"),e.writeAttributeString("config:type","int"),e.writeString("3002"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewTop"),e.writeAttributeString("config:type","int"),e.writeString("10435"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleLeft"),e.writeAttributeString("config:type","int"),e.writeString("-10107"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleTop"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleRight"),e.writeAttributeString("config:type","int"),e.writeString("33099"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleBottom"),e.writeAttributeString("config:type","int"),e.writeString("22172"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ZoomType"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ZoomFactor"),e.writeAttributeString("config:type","short"),e.writeString("100"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsSelectedFrame"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("config:config-item-set"),e.writeAttributeString("config:name","ooo:configuration-settings"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AddParaTableSpacing"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintReversed"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","OutlineLevelYieldsNumbering"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","LinkUpdateMode"),e.writeAttributeString("config:type","short"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintEmptyPages"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IgnoreFirstLineIndentInNumbering"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CharacterCompressionType"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintSingleJobs"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UpdateFromTemplate"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintPaperFromSetup"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AddFrameOffsets"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintLeftPages"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RedlineProtectionKey"),e.writeAttributeString("config:type","base64Binary"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintTables"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ChartAutoUpdate"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintControls"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrinterSetup"),e.writeAttributeString("config:type","base64Binary"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IgnoreTabsAndBlanksForLineCalculation"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintAnnotationMode"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","LoadReadonly"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AddParaSpacingToTableCells"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AddExternalLeading"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ApplyUserData"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","FieldAutoUpdate"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","SaveVersionOnClose"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","SaveGlobalDocumentLinks"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsKernAsianPunctuation"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AlignTabStopPosition"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ClipAsCharacterAnchoredWriterFlyFrames"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CurrentDatabaseDataSource"),e.writeAttributeString("config:type","string"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","DoNotCaptureDrawObjsOnPage"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","TableRowKeep"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrinterName"),e.writeAttributeString("config:type","string"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintFaxName"),e.writeAttributeString("config:type","string"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ConsiderTextWrapOnObjPos"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UseOldPrinterMetrics"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintRightPages"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsLabelDocument"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UseFormerLineSpacing"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AddParaTableSpacingAtStart"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UseFormerTextWrapping"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","DoNotResetParaAttrsForNumFont"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintProspect"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintGraphics"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AllowPrintJobCancel"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CurrentDatabaseCommandType"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","DoNotJustifyLinesWithManualBreak"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UseFormerObjectPositioning"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrinterIndependentLayout"),e.writeAttributeString("config:type","string"),e.writeString("high-resolution"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UseOldNumbering"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintPageBackground"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CurrentDatabaseCommand"),e.writeAttributeString("config:type","string"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintDrawings"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintBlackFonts"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UnxForceZeroExtLeading"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeStyles(t){let e=new K,i=new w(u.UTF8,e),r=(i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?d.None:d.Indented,i.writeStartDocument(),i.writeStartElement("office:document-styles"),i.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),i.writeAttributeString("xmlns:style","urn:oasis:names:tc:opendocument:xmlns:style:1.0"),i.writeAttributeString("xmlns:text","urn:oasis:names:tc:opendocument:xmlns:text:1.0"),i.writeAttributeString("xmlns:table","urn:oasis:names:tc:opendocument:xmlns:table:1.0"),i.writeAttributeString("xmlns:draw","urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"),i.writeAttributeString("xmlns:fo","urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0"),i.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),i.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),i.writeAttributeString("xmlns:meta","urn:oasis:names:tc:opendocument:xmlns:meta:1.0"),i.writeAttributeString("xmlns:number","urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0"),i.writeAttributeString("xmlns:svg","urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0"),i.writeAttributeString("xmlns:chart","urn:oasis:names:tc:opendocument:xmlns:chart:1.0"),i.writeAttributeString("xmlns:dr3d","urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"),i.writeAttributeString("xmlns:math","http://www.w3.org/1998/Math/MathML"),i.writeAttributeString("xmlns:form","urn:oasis:names:tc:opendocument:xmlns:form:1.0"),i.writeAttributeString("xmlns:script","urn:oasis:names:tc:opendocument:xmlns:script:1.0"),i.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),i.writeAttributeString("xmlns:ooow","http://openoffice.org/2004/writer"),i.writeAttributeString("xmlns:oooc","http://openoffice.org/2004/calc"),i.writeAttributeString("xmlns:dom","http://www.w3.org/2001/xml-events"),i.writeAttributeString("office:version","1.1"),i.writeStartElement("office:font-face-decls"),i.writeStartElement("style:font-face"),i.writeAttributeString("style:name","Arial"),i.writeAttributeString("svg:font-family","Arial"),i.writeEndElement(),i.writeStartElement("style:font-face"),i.writeAttributeString("style:name","Tahoma"),i.writeAttributeString("svg:font-family","Tahoma"),i.writeAttributeString("style:font-family-generic","system"),i.writeAttributeString("style:font-pitch","variable"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("office:styles"),i.writeStartElement("style:default-style"),i.writeAttributeString("style:family","graphic"),i.writeStartElement("style:graphic-properties"),i.writeAttributeString("draw:shadow-offset-x","0.3cm"),i.writeAttributeString("draw:shadow-offset-y","0.3cm"),i.writeAttributeString("draw:start-line-spacing-horizontal","0.283cm"),i.writeAttributeString("draw:start-line-spacing-vertical","0.283cm"),i.writeAttributeString("draw:end-line-spacing-horizontal","0.283cm"),i.writeAttributeString("draw:end-line-spacing-vertical","0.283cm"),i.writeAttributeString("style:flow-with-text","false"),i.writeEndElement(),i.writeStartElement("style:paragraph-properties"),i.writeAttributeString("style:text-autospace","ideograph-alpha"),i.writeAttributeString("style:line-break","strict"),i.writeAttributeString("style:writing-mode","lr-tb"),i.writeAttributeString("style:font-independent-line-spacing","false"),i.writeStartElement("style:tab-stops"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:text-properties"),i.writeAttributeString("style:use-window-font-color","true"),i.writeAttributeString("fo:font-size","10pt"),i.writeAttributeString("style:letter-kerning","true"),i.writeAttributeString("style:font-size-asian","12pt"),i.writeAttributeString("style:language-asian","zxx"),i.writeAttributeString("style:country-asian","none"),i.writeAttributeString("style:font-size-complex","12pt"),i.writeAttributeString("style:language-complex","zxx"),i.writeAttributeString("style:country-complex","none"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:default-style"),i.writeAttributeString("style:family","paragraph"),i.writeStartElement("style:paragraph-properties"),i.writeAttributeString("fo:hyphenation-ladder-count","no-limit"),i.writeAttributeString("style:text-autospace","ideograph-alpha"),i.writeAttributeString("style:punctuation-wrap","hanging"),i.writeAttributeString("style:line-break","strict"),i.writeAttributeString("style:tab-stop-distance","1.251cm"),i.writeAttributeString("style:writing-mode","page"),i.writeEndElement(),i.writeStartElement("style:text-properties"),i.writeAttributeString("style:use-window-font-color","true"),i.writeAttributeString("style:font-name","Arial"),i.writeAttributeString("fo:font-size","10pt"),i.writeAttributeString("style:letter-kerning","true"),i.writeAttributeString("style:font-name-asian","Lucida Sans Unicode"),i.writeAttributeString("style:font-size-asian","12pt"),i.writeAttributeString("style:language-asian","zxx"),i.writeAttributeString("style:country-asian","none"),i.writeAttributeString("style:font-name-complex","Tahoma"),i.writeAttributeString("style:font-size-complex","12pt"),i.writeAttributeString("style:language-complex","zxx"),i.writeAttributeString("style:country-complex","none"),i.writeAttributeString("fo:hyphenate","false"),i.writeAttributeString("fo:hyphenation-remain-char-count","2"),i.writeAttributeString("fo:hyphenation-push-char-count","2"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:default-style"),i.writeAttributeString("style:family","table"),i.writeStartElement("style:table-properties"),i.writeAttributeString("table:border-model","collapsing"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:default-style"),i.writeAttributeString("style:family","table-row"),i.writeStartElement("style:table-row-properties"),i.writeAttributeString("fo:keep-together","auto"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Standard"),i.writeAttributeString("style:family","paragraph"),i.writeAttributeString("style:class","text"),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Title"),i.writeAttributeString("style:family","paragraph"),i.writeAttributeString("style:parent-style-name","Standard"),i.writeAttributeString("style:next-style-name","Text_20_body"),i.writeAttributeString("style:class","text"),i.writeStartElement("style:paragraph-properties"),i.writeAttributeString("fo:margin-top","0.423cm"),i.writeAttributeString("fo:margin-bottom","0.212cm"),i.writeAttributeString("fo:keep-with-next","always"),i.writeEndElement(),i.writeStartElement("style:text-properties"),i.writeAttributeString("style:font-name","Arial1"),i.writeAttributeString("fo:font-size","14pt"),i.writeAttributeString("style:font-name-asian","Lucida Sans Unicode"),i.writeAttributeString("style:font-size-asian","14pt"),i.writeAttributeString("style:font-name-complex","Tahoma"),i.writeAttributeString("style:font-size-complex","14pt"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Text_20_body"),i.writeAttributeString("style:display-name","Text body"),i.writeAttributeString("style:family","paragraph"),i.writeAttributeString("style:parent-style-name","Standard"),i.writeAttributeString("style:class","text"),i.writeStartElement("style:paragraph-properties"),i.writeAttributeString("fo:margin-top","0cm"),i.writeAttributeString("fo:margin-bottom","0.212cm"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Subtitle"),i.writeAttributeString("style:family","paragraph"),i.writeAttributeString("style:parent-style-name","Title"),i.writeAttributeString("style:next-style-name","Text_20_body"),i.writeAttributeString("style:class","chapter"),i.writeStartElement("style:paragraph-properties"),i.writeAttributeString("fo:text-align","center"),i.writeAttributeString("style:justify-single-word","false"),i.writeEndElement(),i.writeStartElement("style:text-properties"),i.writeAttributeString("fo:font-size","14pt"),i.writeAttributeString("fo:font-style","italic"),i.writeAttributeString("style:font-size-asian","14pt"),i.writeAttributeString("style:font-style-asian","italic"),i.writeAttributeString("style:font-size-complex","14pt"),i.writeAttributeString("style:font-style-complex","italic"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","List"),i.writeAttributeString("style:family","paragraph"),i.writeAttributeString("style:parent-style-name","Text_20_body"),i.writeAttributeString("style:class","list"),i.writeStartElement("style:text-properties"),i.writeAttributeString("style:font-name","Arial"),i.writeAttributeString("style:font-name-complex","Tahoma1"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Caption"),i.writeAttributeString("style:family","paragraph"),i.writeAttributeString("style:parent-style-name","Standard"),i.writeAttributeString("style:class","extra"),i.writeStartElement("style:paragraph-properties"),i.writeAttributeString("fo:margin-top","0.212cm"),i.writeAttributeString("fo:margin-bottom","0.212cm"),i.writeAttributeString("text:number-lines","false"),i.writeAttributeString("text:line-number","0"),i.writeEndElement(),i.writeStartElement("style:text-properties"),i.writeAttributeString("style:font-name","Arial"),i.writeAttributeString("fo:font-size","10pt"),i.writeAttributeString("fo:font-style","italic"),i.writeAttributeString("style:font-size-asian","12pt"),i.writeAttributeString("style:font-style-asian","italic"),i.writeAttributeString("style:font-name-complex","Tahoma1"),i.writeAttributeString("style:font-size-complex","12pt"),i.writeAttributeString("style:font-style-complex","italic"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Index"),i.writeAttributeString("style:family","paragraph"),i.writeAttributeString("style:parent-style-name","Standard"),i.writeAttributeString("style:class","index"),i.writeStartElement("style:paragraph-properties"),i.writeAttributeString("text:number-lines","false"),i.writeAttributeString("text:line-number","0"),i.writeEndElement(),i.writeStartElement("style:text-properties"),i.writeAttributeString("style:font-name","Arial"),i.writeAttributeString("style:font-name-complex","Tahoma1"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Table_20_Contents"),i.writeAttributeString("style:display-name","Table Contents"),i.writeAttributeString("style:family","paragraph"),i.writeAttributeString("style:parent-style-name","Standard"),i.writeAttributeString("style:class","extra"),i.writeStartElement("style:paragraph-properties"),i.writeAttributeString("text:number-lines","false"),i.writeAttributeString("text:line-number","0"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Graphics"),i.writeAttributeString("style:family","graphic"),i.writeStartElement("style:graphic-properties"),i.writeAttributeString("text:anchor-type","paragraph"),i.writeAttributeString("svg:x","0cm"),i.writeAttributeString("svg:y","0cm"),i.writeAttributeString("style:wrap","dynamic"),i.writeAttributeString("style:number-wrapped-paragraphs","no-limit"),i.writeAttributeString("style:wrap-contour","false"),i.writeAttributeString("style:vertical-pos","top"),i.writeAttributeString("style:vertical-rel","paragraph"),i.writeAttributeString("style:horizontal-pos","center"),i.writeAttributeString("style:horizontal-rel","paragraph"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("text:outline-style"),i.writeStartElement("text:outline-level-style"),i.writeAttributeString("text:level","1"),i.writeAttributeString("style:num-format",""),i.writeStartElement("style:list-level-properties"),i.writeAttributeString("text:min-label-distance","0.381cm"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("text:outline-level-style"),i.writeAttributeString("text:level","2"),i.writeAttributeString("style:num-format",""),i.writeStartElement("style:list-level-properties"),i.writeAttributeString("text:min-label-distance","0.381cm"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("text:outline-level-style"),i.writeAttributeString("text:level","3"),i.writeAttributeString("style:num-format",""),i.writeStartElement("style:list-level-properties"),i.writeAttributeString("text:min-label-distance","0.381cm"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("text:outline-level-style"),i.writeAttributeString("text:level","4"),i.writeAttributeString("style:num-format",""),i.writeStartElement("style:list-level-properties"),i.writeAttributeString("text:min-label-distance","0.381cm"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("text:outline-level-style"),i.writeAttributeString("text:level","5"),i.writeAttributeString("style:num-format",""),i.writeStartElement("style:list-level-properties"),i.writeAttributeString("text:min-label-distance","0.381cm"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("text:outline-level-style"),i.writeAttributeString("text:level","6"),i.writeAttributeString("style:num-format",""),i.writeStartElement("style:list-level-properties"),i.writeAttributeString("text:min-label-distance","0.381cm"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("text:outline-level-style"),i.writeAttributeString("text:level","7"),i.writeAttributeString("style:num-format",""),i.writeStartElement("style:list-level-properties"),i.writeAttributeString("text:min-label-distance","0.381cm"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("text:outline-level-style"),i.writeAttributeString("text:level","8"),i.writeAttributeString("style:num-format",""),i.writeStartElement("style:list-level-properties"),i.writeAttributeString("text:min-label-distance","0.381cm"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("text:outline-level-style"),i.writeAttributeString("text:level","9"),i.writeAttributeString("style:num-format",""),i.writeStartElement("style:list-level-properties"),i.writeAttributeString("text:min-label-distance","0.381cm"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("text:outline-level-style"),i.writeAttributeString("text:level","10"),i.writeAttributeString("style:num-format",""),i.writeStartElement("style:list-level-properties"),i.writeAttributeString("text:min-label-distance","0.381cm"),i.writeEndElement(),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("text:notes-configuration"),i.writeAttributeString("text:note-class","footnote"),i.writeAttributeString("style:num-format","1"),i.writeAttributeString("text:start-value","0"),i.writeAttributeString("text:footnotes-position","page"),i.writeAttributeString("text:start-numbering-at","document"),i.writeEndElement(),i.writeStartElement("text:notes-configuration"),i.writeAttributeString("text:note-class","endnote"),i.writeAttributeString("style:num-format","i"),i.writeAttributeString("text:start-value","0"),i.writeEndElement(),i.writeStartElement("text:linenumbering-configuration"),i.writeAttributeString("text:number-lines","false"),i.writeAttributeString("text:offset","0.499cm"),i.writeAttributeString("style:num-format","1"),i.writeAttributeString("text:number-position","left"),i.writeAttributeString("text:increment","5"),i.writeEndElement(),i.writeEndElement(),t.getByIndex(0)),n=r.unit.convertToHInches(r.pageHeight*r.segmentPerHeight),a=r.unit.convertToHInches(r.pageWidth*r.segmentPerWidth),s=r.unit.convertToHInches(r.margins.left),o=r.unit.convertToHInches(r.margins.right),l=r.unit.convertToHInches(r.margins.top),h=r.unit.convertToHInches(r.margins.bottom)-4;return h<0&&(h=0),i.writeStartElement("office:automatic-styles"),i.writeStartElement("style:page-layout"),i.writeAttributeString("style:name","pm1"),i.writeStartElement("style:page-layout-properties"),i.writeAttributeString("fo:page-width",this.doubleToString(a)),i.writeAttributeString("fo:page-height",this.doubleToString(n)),i.writeAttributeString("style:num-format","1"),i.writeAttributeString("style:print-orientation",r.orientation==S.Portrait?"portrait":"landscape"),i.writeAttributeString("fo:margin-top",this.doubleToString(l)),i.writeAttributeString("fo:margin-bottom",this.doubleToString(h)),i.writeAttributeString("fo:margin-left",this.doubleToString(s)),i.writeAttributeString("fo:margin-right",this.doubleToString(o)),i.writeAttributeString("style:writing-mode","lr-tb"),i.writeAttributeString("style:footnote-max-height","0cm"),i.writeStartElement("style:footnote-sep"),i.writeAttributeString("style:width","0.018cm"),i.writeAttributeString("style:distance-before-sep","0.101cm"),i.writeAttributeString("style:distance-after-sep","0.101cm"),i.writeAttributeString("style:adjustment","left"),i.writeAttributeString("style:rel-width","25%"),i.writeAttributeString("style:color","#000000"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:header-style"),i.writeEndElement(),i.writeStartElement("style:footer-style"),i.writeEndElement(),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("office:master-styles"),i.writeStartElement("style:master-page"),i.writeAttributeString("style:name","Standard"),i.writeAttributeString("style:page-layout-name","pm1"),i.writeEndElement(),i.writeEndElement(),i.writeFullEndElement(),i.writeEndDocument(),i.flush(),e}writeContent(){let t=new K,o=new w(u.UTF8,t),l=(o.indentation=this.xmlIndentation<0?0:this.xmlIndentation,o.formatting=this.xmlIndentation<0?d.None:d.Indented,o.writeStartDocument(),o.writeStartElement("office:document-content"),o.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),o.writeAttributeString("xmlns:style","urn:oasis:names:tc:opendocument:xmlns:style:1.0"),o.writeAttributeString("xmlns:text","urn:oasis:names:tc:opendocument:xmlns:text:1.0"),o.writeAttributeString("xmlns:table","urn:oasis:names:tc:opendocument:xmlns:table:1.0"),o.writeAttributeString("xmlns:draw","urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"),o.writeAttributeString("xmlns:fo","urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0"),o.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),o.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),o.writeAttributeString("xmlns:meta","urn:oasis:names:tc:opendocument:xmlns:meta:1.0"),o.writeAttributeString("xmlns:number","urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0"),o.writeAttributeString("xmlns:svg","urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0"),o.writeAttributeString("xmlns:chart","urn:oasis:names:tc:opendocument:xmlns:chart:1.0"),o.writeAttributeString("xmlns:dr3d","urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"),o.writeAttributeString("xmlns:math","http://www.w3.org/1998/Math/MathML"),o.writeAttributeString("xmlns:form","urn:oasis:names:tc:opendocument:xmlns:form:1.0"),o.writeAttributeString("xmlns:script","urn:oasis:names:tc:opendocument:xmlns:script:1.0"),o.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),o.writeAttributeString("xmlns:ooow","http://openoffice.org/2004/writer"),o.writeAttributeString("xmlns:oooc","http://openoffice.org/2004/calc"),o.writeAttributeString("xmlns:dom","http://www.w3.org/2001/xml-events"),o.writeAttributeString("xmlns:xforms","http://www.w3.org/2002/xforms"),o.writeAttributeString("xmlns:xsd","http://www.w3.org/2001/XMLSchema"),o.writeAttributeString("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance"),o.writeAttributeString("office:version","1.1"),it.create2(Boolean,this.matrix.coordY.countItems,this.matrix.coordX.countItems)),h=it.create2(Number,this.matrix.coordY.countItems,this.matrix.coordX.countItems),i=new C,r=new C,a=[],c=this.matrix.coordX.getKeys(),m=this.matrix.coordY.getKeys();for(let n=1;n<this.matrix.coordY.countItems;n++){let e=this.matrix.coordY.getByIndex(n,m)-this.matrix.coordY.getByIndex(n-1,m);if(!i.containsKey(e)){let t=i.count;i.set(e,t),r.set(t,e)}a[n-1]=0|i.get(e);for(let r=1;r<this.matrix.coordX.countItems;r++){let i=this.matrix.cells.gett(n-1,r-1);if(!l[n][r])if(null!=i){for(let e=0;e<=i.height;e++)for(let t=0;t<=i.width;t++)l[n+e][r+t]=!0;h[n-1][r-1]=this.getCellStyleNumber(n-1,r-1,i.height+1,i.width+1),this.getParagraphStyleNumber(n-1,r-1)}else h[n-1][r-1]=this.getCellStyleNumber(n-1,r-1,1,1)}}o.writeStartElement("office:scripts"),o.writeEndElement();let n=new C;for(let t of this.paragraphStyleList)n.set(t.FontName,t.FontName);o.writeStartElement("office:font-face-decls");for(let e of n.keys){let t=n.get(e);o.writeStartElement("style:font-face"),o.writeAttributeString("style:name",t),o.writeAttributeString("svg:font-family",t),o.writeEndElement()}o.writeEndElement(),o.writeStartElement("office:automatic-styles"),o.writeStartElement("style:style"),o.writeAttributeString("style:name","Table1"),o.writeAttributeString("style:family","table"),o.writeStartElement("style:table-properties");let e=this.matrix.coordX.getByIndex(this.matrix.coordX.countItems-1,c)-this.matrix.coordX.getByIndex(0,c);o.writeAttributeString("style:width",this.doubleToString(e)),o.writeAttributeString("table:align","left"),o.writeEndElement(),o.writeEndElement();for(let e=0;e<this.matrix.coordX.countItems-1;e++){o.writeStartElement("style:style"),o.writeAttributeString("style:name",nt.format("Table1.{0}",this.getColumnName(e))),o.writeAttributeString("style:family","table-column"),o.writeStartElement("style:table-column-properties");let t=this.matrix.coordX.getByIndex(e+1,c)-this.matrix.coordX.getByIndex(e,c);o.writeAttributeString("style:column-width",this.doubleToString(t)),o.writeEndElement(),o.writeEndElement()}for(let e=0;e<i.count;e++){o.writeStartElement("style:style"),o.writeAttributeString("style:name",nt.format("Table1.{0}",e+1)),o.writeAttributeString("style:family","table-row"),o.writeStartElement("style:table-row-properties");let t=r.get(e);o.writeAttributeString("style:row-height",this.doubleToString(t)),o.writeEndElement(),o.writeEndElement()}for(let e=0;e<this.cellStyleList.length;e++){let t=this.cellStyleList[e];o.writeStartElement("style:style"),o.writeAttributeString("style:name",nt.format("cell{0}",e+1)),o.writeAttributeString("style:family","table-cell"),o.writeStartElement("style:table-cell-properties"),t.VertAlign==st.Center&&o.writeAttributeString("style:vertical-align","middle"),t.VertAlign==st.Bottom&&o.writeAttributeString("style:vertical-align","bottom"),0<t.BackColor.a?o.writeAttributeString("fo:background-color",this.getColorString(t.BackColor)):o.writeAttributeString("fo:background-color","transparent"),o.writeAttributeString("fo:padding","0in"),o.writeAttributeString("fo:border-left",t.BorderLeft),o.writeAttributeString("fo:border-right",t.BorderRight),o.writeAttributeString("fo:border-top",t.BorderTop),o.writeAttributeString("fo:border-bottom",t.BorderBottom),o.writeEndElement(),o.writeEndElement()}for(let i=0;i<this.paragraphStyleList.length;i++){let t=this.paragraphStyleList[i],e=(o.writeStartElement("style:style"),o.writeAttributeString("style:name",nt.format("par{0}",i+1)),o.writeAttributeString("style:family","paragraph"),o.writeAttributeString("style:parent-style-name","Table_20_Contents"),t.HorAlign!=at.Left&&(o.writeStartElement("style:paragraph-properties"),t.HorAlign==at.Center&&o.writeAttributeString("fo:text-align","center"),t.HorAlign==at.Right&&o.writeAttributeString("fo:text-align","right"),t.HorAlign==at.Width&&o.writeAttributeString("fo:text-align","justify"),o.writeEndElement()),o.writeStartElement("style:text-properties"),o.writeAttributeString("fo:color",this.getColorString(t.FontColor)),o.writeAttributeString("style:font-name",t.FontName),t.FontSize+`pt`);o.writeAttributeString("fo:font-size",e),o.writeAttributeString("fo:font-size-asian",e),o.writeAttributeString("fo:font-size-complex",e),t.Italic&&(o.writeAttributeString("fo:font-style","italic"),o.writeAttributeString("fo:font-style-asian","italic"),o.writeAttributeString("fo:font-style-complex","italic")),t.Underline&&(o.writeAttributeString("style:text-underline-style","solid"),o.writeAttributeString("style:text-underline-width","auto"),o.writeAttributeString("style:text-underline-color","font-color")),t.Bold&&(o.writeAttributeString("fo:font-weight","bold"),o.writeAttributeString("fo:font-weight-asian","bold"),o.writeAttributeString("fo:font-weight-complex","bold")),0!=t.Angle&&o.writeAttributeString("style:text-rotation-angle",t.Angle.toString()),o.writeEndElement(),o.writeEndElement()}o.writeStartElement("style:style"),o.writeAttributeString("style:name","parEnd"),o.writeAttributeString("style:family","paragraph"),o.writeAttributeString("style:parent-style-name","Table_20_Contents"),o.writeStartElement("style:text-properties");let s="1pt";o.writeAttributeString("fo:font-size",s),o.writeAttributeString("fo:font-size-asian",s),o.writeAttributeString("fo:font-size-complex",s),o.writeEndElement(),o.writeEndElement(),o.writeStartElement("style:style"),o.writeAttributeString("style:name","fr1"),o.writeAttributeString("style:family","graphic"),o.writeAttributeString("style:parent-style-name","Graphics"),o.writeStartElement("style:graphic-properties"),o.writeAttributeString("style:vertical-pos","middle"),o.writeAttributeString("style:vertical-rel","paragraph"),o.writeAttributeString("style:horizontal-pos","center"),o.writeAttributeString("style:horizontal-rel","paragraph"),o.writeAttributeString("fo:background-color","transparent"),o.writeAttributeString("style:background-transparency","100%"),o.writeAttributeString("style:shadow","none"),o.writeAttributeString("style:mirror","none"),o.writeAttributeString("fo:clip","rect(0cm 0cm 0cm 0cm)"),o.writeAttributeString("draw:luminance","0%"),o.writeAttributeString("draw:contrast","0%"),o.writeAttributeString("draw:red","0%"),o.writeAttributeString("draw:green","0%"),o.writeAttributeString("draw:blue","0%"),o.writeAttributeString("draw:gamma","100%"),o.writeAttributeString("draw:color-inversion","false"),o.writeAttributeString("draw:image-opacity","100%"),o.writeAttributeString("draw:color-mode","standard"),o.writeEndElement(),o.writeEndElement(),o.writeEndElement(),o.writeStartElement("office:body"),o.writeStartElement("office:text"),o.writeStartElement("office:forms"),o.writeAttributeString("form:automatic-focus","false"),o.writeAttributeString("form:apply-design-mode","false"),o.writeEndElement(),o.writeStartElement("text:sequence-decls"),o.writeStartElement("text:sequence-decl"),o.writeAttributeString("text:display-outline-level","0"),o.writeAttributeString("text:name","Illustration"),o.writeEndElement(),o.writeStartElement("text:sequence-decl"),o.writeAttributeString("text:display-outline-level","0"),o.writeAttributeString("text:name","Table"),o.writeEndElement(),o.writeStartElement("text:sequence-decl"),o.writeAttributeString("text:display-outline-level","0"),o.writeAttributeString("text:name","Text"),o.writeEndElement(),o.writeStartElement("text:sequence-decl"),o.writeAttributeString("text:display-outline-level","0"),o.writeAttributeString("text:name","Drawing"),o.writeEndElement(),o.writeEndElement(),l=it.create2(Boolean,this.matrix.coordY.countItems,this.matrix.coordX.countItems),o.writeStartElement("table:table"),o.writeAttributeString("table:name","Table1"),o.writeAttributeString("table:style-name","Table1");for(let t=0;t<this.matrix.coordX.countItems-1;t++)o.writeStartElement("table:table-column"),o.writeAttributeString("table:style-name",nt.format("Table1.{0}",this.getColumnName(t))),o.writeEndElement();let g=Math.max(this.matrix.coordY.countItems/200,1),p=0;for(let s=1;s<this.matrix.coordY.countItems;s++){let t=s/g|0;t>p&&(p=t,this.invokeExporting2(s,this.matrix.coordY.countItems,this.currentPassNumber,this.maximumPassNumber)),o.writeStartElement("table:table-row"),o.writeAttributeString("table:style-name",`Table1.`+(a[s-1]+1));for(let a=1;a<this.matrix.coordX.countItems;a++){let n=this.matrix.cells.gett(s-1,a-1);if(l[s][a])o.writeStartElement("table:covered-table-cell");else if(null!=n){for(let e=0;e<=n.height;e++)for(let t=0;t<=n.width;t++)l[s+e][a+t]=!0;let t=h[s-1][a-1],r=this.getParagraphStyleNumber(s-1,a-1);if(o.writeStartElement("table:table-cell"),o.writeAttributeString("table:style-name",`cell`+(t+1)),0<n.width&&o.writeAttributeString("table:number-columns-spanned",(n.width+1).toString()),0<n.height&&o.writeAttributeString("table:number-rows-spanned",(n.height+1).toString()),o.writeAttributeString("office:value-type","string"),n.component.is(et)&&!n.component.isExportAsImage(J.a.StiExportFormat.Odt)&&null!=n.text){let t=n.text,i=(0!=this.paragraphStyleList[r][Z.System.StiObject.stimulsoft]().as(ar).Angle&&(t=t[Z.System.StiObject.stimulsoft]().replaceAll("\n"," ")),J.c.StiExportUtils.splitString(t,!0));for(let e=0;e<i.length;e++){let t=i[e];o.writeStartElement("text:p"),o.writeAttributeString("text:style-name",`par`+(r+1)),o.writeString(t),o.writeEndElement()}}if(n.component.isExportAsImage(J.a.StiExportFormat.Odt)){let i=n.component.as(pt);if(null!=i){let t=this.imageResolution,e={ref:t},r=i.getImage(e);if(t=e.ref,null!=r){let t=this.imageCache.addImageIntRaw(r,r.imageFormat),e=this.matrix.coordX.getByIndex(a+n.width,c)-this.matrix.coordX.getByIndex(a-1,c),i=this.matrix.coordY.getByIndex(s+n.height,m)-this.matrix.coordY.getByIndex(s-1,m);o.writeStartElement("text:p"),o.writeAttributeString("text:style-name","Table_20_Contents"),o.writeStartElement("draw:frame"),o.writeAttributeString("draw:style-name","fr1"),o.writeAttributeString("draw:name",`Picture`+(t+1)),o.writeAttributeString("text:anchor-type","paragraph"),o.writeAttributeString("svg:width",this.doubleToString(e)),o.writeAttributeString("svg:height",this.doubleToString(i)),o.writeAttributeString("draw:z-index","0"),o.writeStartElement("draw:image"),o.writeAttributeString("xlink:href",nt.format("Pictures/{0:D5}.jpg",t+1)),o.writeAttributeString("xlink:type","simple"),o.writeAttributeString("xlink:show","embed"),o.writeAttributeString("xlink:actuate","onLoad"),o.writeEndElement(),o.writeEndElement(),o.writeEndElement()}}}}else{let t=h[s-1][a-1];o.writeStartElement("table:table-cell"),o.writeAttributeString("table:style-name",`cell`+(t+1))}o.writeEndElement()}o.writeEndElement()}return o.writeEndElement(),o.writeStartElement("text:p"),o.writeAttributeString("text:style-name","parEnd"),o.writeEndElement(),o.writeEndElement(),o.writeEndElement(),o.writeFullEndElement(),o.writeEndDocument(),o.flush(),t}exportOdt(i,r,t){if(null==Z.Base[["St","iL","ic","en","se"].join("")].key&&console.warn("You are using a trial version of the Stimulsoft product!"),J.a.StiLogService.write(this[Z.System.StiObject.stimulsoft]().getType(),"Export report to ODT format"),null==t)throw new Error("The 'settings' argument cannot be equal in null.");this.report=i;let n=t.pageRange;this.usePageHeadersAndFooters=t.usePageHeadersAndFooters,this.removeEmptySpaceAtBottom=t.removeEmptySpaceAtBottom,this.imageResolution=t.imageResolution,this.imageQuality=t.imageQuality,this.xmlIndentation=-1,this.imageQuality<0&&(this.imageQuality=0),1<this.imageQuality&&(this.imageQuality=1),this.imageResolution<10&&(this.imageResolution=10),this.imageResolution=this.imageResolution/100;try{this.imageCache=new J.a.StiImageCache(Z.StiOptions.Export.OpenDocumentWriter.allowImageComparer,!0,s.Jpeg,this.imageQuality,!1),this.cellStyleList=[],this.paragraphStyleList=[],this.currentPassNumber=0,this.maximumPassNumber=3+(Z.StiOptions.Export.OpenDocumentWriter.divideSegmentPages?1:0);let t=n.getSelectedPages(i.renderedPages);if(Z.StiOptions.Export.OpenDocumentWriter.divideSegmentPages&&(t=J.c.StiSegmentPagesDivider.divide(t,this),this.currentPassNumber++),this.isStopped)return;let e=new p;if(e.begin(r,!0),this.matrix=new J.c.StiMatrix(t,!0,this),this.currentPassNumber=2+(Z.StiOptions.Export.OpenDocumentWriter.divideSegmentPages?1:0),e.addFile("content.xml",this.writeContent()),e.addFile("mimetype",this.writeMimetype()),e.addFile("meta.xml",this.writeMeta()),e.addFile("META-INF/manifest.xml",this.writeManifest()),e.addFile("settings.xml",this.writeSettings()),e.addFile("styles.xml",this.writeStyles(t)),0<this.imageCache.imagePackedStore.length)for(let t=0;t<this.imageCache.imagePackedStore.length;t++)e.addFile(nt.format("Pictures/{0:D5}.jpg",t+1),this.writeImage(t));e.end()}finally{null!=this.matrix&&(this.matrix.clear(),this.matrix=null),this.cellStyleList[Z.System.StiObject.stimulsoft]().clear(),this.cellStyleList=null,this.paragraphStyleList[Z.System.StiObject.stimulsoft]().clear(),this.paragraphStyleList=null,this.imageCache.clear(),this.imageCache=null,i.renderedPages.cacheMode&&J.c.StiMatrix.GCCollect()}}}}let E=J.a.Components.StiLinePrimitive,c=J.a.Components.StiPrintOnType,X=Z.System.Drawing.Font,T=Z.Base.Drawing.StiBorderSide,ot=Z.Base.Drawing.StiPenStyle,g=Z.Base.Drawing.StiHtmlTagsState,lt=Z.Base.Drawing.StiBrush,U=Z.Base.Drawing.StiHtmlState,G=Z.Base.Drawing.StiTextRenderer,L=J.a.Components.StiShape,A=J.a.Components.StiRichText,P=Z.Base.Drawing.StiBorderSides,Q=J.a.Components.StiImage,y=J.a.Components.StiVerticalLineShapeType,x=J.a.Components.StiHorizontalLineShapeType,F=J.a.Components.StiTopAndBottomLineShapeType,k=J.a.Components.StiLeftAndRightLineShapeType,B=J.a.Components.StiRectangleShapeType,D=J.a.Components.StiDiagonalDownLineShapeType,I=J.a.Components.StiDiagonalUpLineShapeType,R=J.a.Components.StiOvalShapeType,N=J.a.Components.IStiBrush,dt=J.a.Components.IStiFont,wt=J.a.Components.IStiTextBrush,ut=J.a.Components.IStiTextHorAlignment,ht=J.a.Components.IStiTextOptions,St=J.a.Components.IStiVertAlignment,z=J.a.Components.IStiBorder,j=J.a.Components.IStiIgnoreBorderWhenExport,ft=Z.Base.Drawing.StiAdvancedBorder,bt=J.a.Components.IStiText,V=J.a.Components.IStiExportImage,Y=J.a.Components.IStiBreakable,M=Z.Base.Drawing.StiHorAlignment,Et=J.a.Components.StiTextQuality,vt=J.a.Components.IStiHorAlignment,yt=Z.System.StiNumber;{class sr{}class or{}class lr extends J.c.StiExportService{constructor(){super(...arguments),this.multipleFiles=!1,this.sw=null,this.colorList=null,this.fontList=null,this.styleList=null,this.unicodeMapArray=null,this.codePageToFont=null,this.charsetCount=0,this.fontToCodePages=null,this.baseFontNumber=0,this.sw2=null,this.usePageHeadersAndFooters=!1,this.imageResolution=.96,this.imageQuality=.75,this.imageFormat=J.a.StiExportFormat.Rtf,this.imageCodec=null,this.useStyles=!1,this.bookmarkList=null,this.usedBookmarks=null,this.removeEmptySpaceAtBottom=Z.StiOptions.Export.RichText.removeEmptySpaceAtBottom,this.hiToTwips=14.4,this.frameCorrectValue=38,this.matrix=null}implements(){let t=[J.c.IStiRtfExportService];return(this.implements=()=>t)()}get defaultExtension(){return"rtf"}get exportFormat(){return J.a.StiExportFormat.Rtf}get groupCategory(){return"Word"}get position(){return J.c.StiExportPosition.Rtf}get exportNameInMenu(){return e.get("Export","ExportTypeRtfFile")}getFilter(){return e.get("FileFilters","RtfFiles")}exportTo(t,e,i){this.exportRtf(t,e,i[Z.System.StiObject.stimulsoft]().as(J.c.StiRtfExportSettings))}exportToAsync(e,i,t,r){setTimeout(async()=>{try{await J.c.StiExportImageHelper.convertAllImages(i,Z.System.Drawing.Imaging.ImageFormat.Png,!1,this.exportFormat),this.exportTo(i,t,r),null!=i&&null!=i.preparedExportImages&&(i.preparedExportImages.clear(),i.preparedExportImages=null)}catch(t){if(o.log(t,i,`Export Error`).isImportant)return e(o.getMessage(t))}e()},0)}getColorNumberInt(e,i){if(0<e.length)for(let t=0;t<e.length;t++)if(i.equals(e[t]))return t;e.push(i);let t=e.length-1;return t}getColorNumber(t,e){return this.getColorNumberInt(t,e).toString()}getFontNumber(i,r){if(0<i.length)for(let e=0;e<i.length;e++){let t=i[e];if(t.name==r.name)return e*(0==this.charsetCount?1:this.charsetCount)}i.push(r);let t=i.length-1;return t*(0==this.charsetCount?1:this.charsetCount)}getFontNumber2(i,r,n){if(0<i.length)for(let e=0;e<i.length;e++){let t=i[e];if(t.name==r.name)return e*(0==this.charsetCount?1:this.charsetCount)+this.getCharsetIndex(n)}i.push(r);let t=i.length-1;return t*(0==this.charsetCount?1:this.charsetCount)+this.getCharsetIndex(n)}getCharsetIndex(e){let i=0;for(let t=0;t<J.c.StiEncode.codePagesTableSize;t++)if(J.c.StiEncode.codePagesTable[t][2]==e){i=t+1;break}if(0==this.charsetCount)return this.codePageToFont[i]=1,0;return this.codePageToFont[i]}getFontNumber3(i,r){if(0<i.length)for(let e=0;e<i.length;e++){let t=i[e];if(t.name==r)return e*(0==this.charsetCount?1:this.charsetCount)}i.push(new X(r,8));let t=i.length-1;return t*(0==this.charsetCount?1:this.charsetCount)}getStyleNumber(i,r){if(0<i.length)for(let e=0;e<i.length;e++){let t=i[e];if(t.alignment==r.alignment&&t.name==r.name&&t.fontNumber==r.fontNumber&&t.fontSize==r.fontSize&&t.bold==r.bold&&t.italic==r.italic&&t.underline==r.underline&&t.textColor==r.textColor&&t.rightToLeft==r.rightToLeft)return e+1}i.push(r);let t=i.length-1;return t+1}getLineStyle(t,e){let i="";if(null!=t&&t.style!=ot.None){switch(t.style){case ot.Solid:i+="\\brdrs";break;case ot.Dot:i+="\\brdrdot";break;case ot.Dash:i+="\\brdrdash";break;case ot.DashDot:i+="\\brdrdashd";break;case ot.DashDotDot:i+="\\brdrdashdd";break;case ot.Double:i+="\\brdrdb";break}i=(i=(i+="\\brdrw")+15*t.size)+nt.format("\\brdrcf{0}",this.getColorNumber(e,t.color))}return i}convertStringToBookmark(e){let i="";for(let t of e.split(""))tt.isLetterOrDigit(t)&&(i+=t);return i}compareExcellSheetNames(t,e){let i=t,r=(nt.isNullOrEmpty(i)&&(i=""),e);return nt.isNullOrEmpty(r)&&(r=""),i==r}convertTextWithHtmlTagsToRtfText(t,e){let i=e,r=new g(t.font.bold,t.font.italic,t.font.underline,t.font.strikeout,t.font.sizeInPoints,t.font.name,lt.toColor(t.textBrush),lt.toColor(t.brush),!1,!1,0,0,t.lineSpacing,t.horAlignment),n=new U(r,0),a=G.parseHtmlToStates(i,n),s=(this.baseFontNumber=this.getFontNumber(this.fontList,t.font),lr.getLineHeightInTwips(t.lineSpacing)),o=r;for(let t=0;t<a.length;t++){let e=a[t],i=e.ts,r="",n=null;if(Z.StiOptions.Engine.htmlAllowListItemSecondLineIndent&&0<i.indent&&0<t&&"\n"==a[t-1].text.toString()){let t=Math.trunc(20+53*i.fontSize*i.indent);r+=nt.format("\\fi-{0}\\li{0}",t)}if(i.bold!=o.bold&&(r+=i.bold?"\\b":"\\b0"),i.italic!=o.italic&&(r+=i.italic?"\\i":"\\i0"),i.underline!=o.underline&&(r+=i.underline?"\\ul":"\\ul0"),i.strikeout!=o.strikeout&&(r+=i.strikeout?"\\strike":"\\strike0"),i.superscript!=o.superscript&&(r+=i.superscript?"\\super":"\\nosupersub"),i.subscript!=o.subscript&&(r+=i.subscript?"\\sub":"\\nosupersub"),i.fontColor!=o.fontColor&&(r+=nt.format("\\cf{0}",this.getColorNumberInt(this.colorList,i.fontColor))),i.backColor!=o.backColor&&(r+=nt.format("\\chshdng0\\chcbpat{0}",this.getColorNumber(this.colorList,i.backColor))),i.fontSize!=o.fontSize&&(r+=nt.format("\\fs{0}",Math.trunc(2*i.fontSize))),i.letterSpacing!=o.letterSpacing&&(r+=nt.format("\\expnd{0}",Math.trunc(i.letterSpacing*i.fontSize*3.8+Z.StiOptions.Export.RichText.spaceBetweenCharacters))),i.lineHeight!=o.lineHeight&&(r+=lr.getLineHeightInTwips(i.lineHeight)),i.textAlign!=o.textAlign){let t="\\ql";i.textAlign==at.Center&&(t="\\qc"),i.textAlign==at.Right&&(t="\\qr"),i.textAlign==at.Width&&(t="\\qj"),"\n"==e.text.toString()?n=t:r+=t}if(i.fontName!=o.fontName&&(this.baseFontNumber=this.getFontNumber3(this.fontList,i.fontName),r+=nt.format("{0}{1}","",String.fromCharCode(256+this.baseFontNumber))),0<r.length&&(s=s+r[Z.System.StiObject.stimulsoft]().replaceAll("\\","")+" "),"\n"==e.text.toString())s+="\n",null!=n&&(s,n[Z.System.StiObject.stimulsoft]().replaceAll("\\",""));else{let t=s[s.length-1];" "!=t&&"\n"!=t&&"?"!=t&&" "!=t&&(s+=" "),s+=G.prepareStateText(e.text)}o=i}return s}static getLineHeightInTwips(t){let e=Z.StiOptions.Export.RichText.lineSpacing;return nt.format("{0}sl{1}{0}slmult1","",Math.round(240*e*t))}replacePardInRtf(e){let i="",r=0,n=0,a=!1,s=0;while(s<e.length){let t=e[s++];if(i+=t,"{"==t){r++;continue}if("}"==t){--r<n&&(a=!1);continue}if("\\"==t){if(s<e.length&&("{"==e[s]||"}"==e[s])){s++;continue}s+2<e.length&&"s"==e[s]&&"h"==e[s+1]&&"p"==e[s+2]&&"{"==e[s-2]&&(a=!0,n=r),!a&&s+3<e.length&&"p"==e[s]&&"a"==e[s+1]&&"r"==e[s+2]&&"d"==e[s+3]&&(s+=4,i+="pard\\intbl")}}return i}getImageString(t,e,i,r){let n="jpeg",a=(t.imageFormat==Z.System.Drawing.Imaging.ImageFormat.Png&&(n="png"),t.bytes),s="";if(s+="{"+nt.format("\\pict\\picscalex{0}\\picscaley{1}\\picwgoal{2}\\pichgoal{3}\\{4}blip ",100,100,i,r,n),null!=a)for(let e=0;e<a.length;e++){let t=a[e];s+=(15<t?"":"0")+t.toString(16)}return s+="}"}drawLine(t,e,i,r,n,a){0!=n.a&&(this.sw.write("{\\shp{\\*"),this.sw.write(nt.format("\\shpinst\\shpleft{0}\\shptop{1}\\shpright{2}\\shpbottom{3}",t<i?t:i,e<r?e:r,i<t?t:i,r<e?e:r)),this.sw.write("\\shpwr3"),this.sw.write("{\\sp{\\sn shapeType}{\\sv 20}}"),this.sw.write("{\\sp{\\sn fFlipH}{\\sv "+(t<i?"0":"1")+"}}"),this.sw.write("{\\sp{\\sn fFlipV}{\\sv "+(e<r?"0":"1")+"}}"),this.sw.write("{\\sp{\\sn fFilled}{\\sv 0}}"),this.sw.write("{\\sp{\\sn lineColor}{\\sv "+nt.format("{0}",65536*n.b+256*n.g+n.r)+"}}"),this.sw.write("{\\sp{\\sn lineWidth}{\\sv "+a+"}}"),this.sw.write("{\\sp{\\sn fLine}{\\sv 1}}"),this.sw.writeLine("}}"))}fillRect(t,e){0!=e.a&&(this.sw.write("{\\shp{\\*"),this.sw.write(nt.format("\\shpinst\\shpleft{0}\\shptop{1}\\shpright{2}\\shpbottom{3}",t.x,t.y,t.x+t.width,t.y+t.height)),this.sw.write("\\shpwr3"),this.sw.write("{\\sp{\\sn shapeType}{\\sv 1}}"),this.sw.write("{\\sp{\\sn fFlipH}{\\sv 0}}"),this.sw.write("{\\sp{\\sn fFlipV}{\\sv 0}}"),this.sw.write("{\\sp{\\sn fillColor}{\\sv "+nt.format("{0}",65536*e.b+256*e.g+e.r)+"}}"),this.sw.write("{\\sp{\\sn fFilled}{\\sv 1}}"),this.sw.write("{\\sp{\\sn fLine}{\\sv 0}}"),this.sw.writeLine("}}"))}checkShape1(t){return!!(t.shapeType.is2(y)||t.shapeType.is2(x)||t.shapeType.is2(F)||t.shapeType.is2(k)||t.shapeType.is2(B))}renderShape1(o,l,h){let c=o.component,m=c.as(L);if(null!=m)if(1==this.checkShape1(m)){let t=c.as(N),e="",i=rt.transparent;if(0!=(i=null!=t?lt.toColor(t.brush):i).a){let t=this.getColorNumber(this.colorList,i);e=nt.format("\\cbpat{0}",t)}let r="",n=m.borderColor;if(0!=n.a){let t=this.getColorNumber(this.colorList,n);r=nt.format("\\brdrcf{0}",t)}let a=14*m.size,s=nt.format("\\brdrs\\brdrw{0}",a);this.sw.write("\\fs1"),m.shapeType.is(y)&&(0!=i.a&&this.sw.write(e),0!=n.a)&&(this.sw.writeLine(" \\par}"),this.sw.write("{"),this.sw.write(nt.format("\\nowrap\\posx{0}\\posy{1}\\absw{2}\\absh{3}",o.x+l,o.y,Math.trunc((o.width-2*this.frameCorrectValue-a)/2),o.height)),this.sw.write("\\brdrr"+s+r+"\\fs1")),m.shapeType.is(x)&&(0!=i.a&&this.sw.write(e),0!=n.a)&&(this.sw.writeLine(" \\par}"),this.sw.write("{"),this.sw.write(nt.format("\\nowrap\\posx{0}\\posy{1}\\absw{2}\\absh{3}",o.x+l,o.y,o.width-h,Math.trunc((o.height+a)/2))),this.sw.write("\\brdrb"+s+r+"\\fs1")),m.shapeType.is(F)&&(0!=i.a&&this.sw.write(e),this.sw.write("\\brdrt"+s+r),this.sw.write("\\brdrb"+s+r),this.sw.writeLine("\\fs1")),m.shapeType.is(k)&&(0!=i.a&&this.sw.write(e),this.sw.write("\\brdrl"+s+r),this.sw.write("\\brdrr"+s+r),this.sw.writeLine("\\fs1")),m.shapeType.is(B)&&(0!=i.a&&this.sw.write(e),this.sw.write("\\box"+s+r),this.sw.writeLine("\\fs1"))}else this.renderImage12(c,o.width-h,o.height)}checkShape2(t){return!!(t.shapeType.is2(y)||t.shapeType.is2(x)||t.shapeType.is2(F)||t.shapeType.is2(k)||t.shapeType.is2(B)||t.shapeType.is2(D)||t.shapeType.is2(I)||t.shapeType.is2(R))}renderShape2(a){let s=a.component,o=s.as(L);if(null!=o)if(1==this.checkShape2(o)){let t=s.as(N),e=rt.transparent,i=(null!=t&&(e=lt.toColor(t.brush)),o.borderColor),r=8400*o.size,n=nt.format("{0}",r);o.shapeType.is(y)&&(this.fillRect(a,e),this.drawLine(Math.trunc(a.x+a.width/2),a.y,Math.trunc(a.x+a.width/2),a.y+a.height,i,n)),o.shapeType.is(x)&&(this.fillRect(a,e),this.drawLine(a.x,Math.trunc(a.y+a.height/2),a.x+a.width,Math.trunc(a.y+a.height/2),i,n)),o.shapeType.is(F)&&(this.fillRect(a,e),this.drawLine(a.x,a.y,a.x+a.width,a.y,i,n),this.drawLine(a.x,a.y+a.height,a.x+a.width,a.y+a.height,i,n)),o.shapeType.is(k)&&(this.fillRect(a,e),this.drawLine(a.x,a.y,a.x,a.y+a.height,i,n),this.drawLine(a.x+a.width,a.y,a.x+a.width,a.y+a.height,i,n)),o.shapeType.is(B)&&(this.sw.write("{\\shp{\\*"),this.sw.write(nt.format("\\shpinst\\shpleft{0}\\shptop{1}\\shpright{2}\\shpbottom{3}",a.x,a.y,a.x+a.width,a.y+a.height)),this.sw.write("\\shpwr3"),this.sw.write("{\\sp{\\sn shapeType}{\\sv 1}}"),this.sw.write("{\\sp{\\sn fFlipH}{\\sv 0}}"),this.sw.write("{\\sp{\\sn fFlipV}{\\sv 0}}"),0!=e.a?(this.sw.write("{\\sp{\\sn fillColor}{\\sv "+nt.format("{0}",65536*e.b+256*e.g+e.r)+"}}"),this.sw.write("{\\sp{\\sn fFilled}{\\sv 1}}")):this.sw.write("{\\sp{\\sn fFilled}{\\sv 0}}"),0!=i.a?(this.sw.write("{\\sp{\\sn lineColor}{\\sv "+nt.format("{0}",65536*i.b+256*i.g+i.r)+"}}"),this.sw.write("{\\sp{\\sn lineWidth}{\\sv "+n+"}}"),this.sw.write("{\\sp{\\sn fLine}{\\sv 1}}")):this.sw.write("{\\sp{\\sn fLine}{\\sv 0}}"),this.sw.writeLine("}}")),o.shapeType.is(R)&&(this.sw.write("{\\shp{\\*"),this.sw.write(nt.format("\\shpinst\\shpleft{0}\\shptop{1}\\shpright{2}\\shpbottom{3}",a.x,a.y,a.x+a.width,a.y+a.height)),this.sw.write("\\shpwr3"),this.sw.write("{\\sp{\\sn shapeType}{\\sv 3}}"),this.sw.write("{\\sp{\\sn fFlipH}{\\sv 0}}"),this.sw.write("{\\sp{\\sn fFlipV}{\\sv 0}}"),0!=e.a?(this.sw.write("{\\sp{\\sn fillColor}{\\sv "+nt.format("{0}",65536*e.b+256*e.g+e.r)+"}}"),this.sw.write("{\\sp{\\sn fFilled}{\\sv 1}}")):this.sw.write("{\\sp{\\sn fFilled}{\\sv 0}}"),0!=i.a?(this.sw.write("{\\sp{\\sn lineColor}{\\sv "+nt.format("{0}",65536*i.b+256*i.g+i.r)+"}}"),this.sw.write("{\\sp{\\sn lineWidth}{\\sv "+n+"}}"),this.sw.write("{\\sp{\\sn fLine}{\\sv 1}}")):this.sw.write("{\\sp{\\sn fLine}{\\sv 0}}"),this.sw.writeLine("}}")),o.shapeType.is(D)&&(this.fillRect(a,e),this.drawLine(a.x,a.y,a.x+a.width,a.y+a.height,i,n)),o.shapeType.is(I)&&(this.fillRect(a,e),this.drawLine(a.x,a.y+a.height,a.x+a.width,a.y,i,n))}else this.renderImage12(s,a.width,a.height)}checkArabic(t){if(Z.StiOptions.Export.RichText.convertDigitsToArabic)return J.c.StiExportUtils.convertDigitsToArabic(t,Z.StiOptions.Export.RichText.arabicDigitsType);return t}unicodeToRtfString(t,e){let i=t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=1<(t=(t=(t=(t=e?this.checkArabic(t):t)[Z.System.StiObject.stimulsoft]().replaceAll("\\","\\\\"))[Z.System.StiObject.stimulsoft]().replaceAll("{","\\{"))[Z.System.StiObject.stimulsoft]().replaceAll("}","\\}")).length&&"\t"==t[0]?t[Z.System.StiObject.stimulsoft]().insert(0,"\t\t"):t)[Z.System.StiObject.stimulsoft]().replaceAll("\n\t","\n\t\t\t"))[Z.System.StiObject.stimulsoft]().replaceAll("\n","\\par "))[Z.System.StiObject.stimulsoft]().replaceAll("","\\"))[Z.System.StiObject.stimulsoft]().replaceAll("","{\\field{\\*\\fldinst {PAGE}}}"))[Z.System.StiObject.stimulsoft]().replaceAll("","{\\field{\\*\\fldinst {NUMPAGES}}}"))[Z.System.StiObject.stimulsoft]().replaceAll("","{\\field{\\*\\fldinst {"))[Z.System.StiObject.stimulsoft]().replaceAll(""," }}{\\fldrslt {"))[Z.System.StiObject.stimulsoft]().replaceAll("","{\\*\\bkmkstart "))[Z.System.StiObject.stimulsoft]().replaceAll("","}{\\*\\bkmkend "))[Z.System.StiObject.stimulsoft]().replaceAll("","}"),r=null,s=(-1==i.indexOf("")?(r=[])[0]=i:r=i.split(""),"");for(let t=0;t<r.length;t++){let a=r[t],i=(0!=t&&(this.baseFontNumber=a.charCodeAt(0)-256,this.baseFontNumber<0&&(this.baseFontNumber=0),a=a.substr(2)),0);while(i<a.length){let r=i,t="",e=1;while(i<a.length&&0==J.c.StiEncode.unicodeToCodePageArray[a.charCodeAt(i)])t+=a[i],i++;if(i<a.length){e=J.c.StiEncode.unicodeToCodePageArray[a.charCodeAt(i)],t+=a[i],i++;while(i<a.length&&(0==J.c.StiEncode.unicodeToCodePageArray[a.charCodeAt(i)]||J.c.StiEncode.unicodeToCodePageArray[a.charCodeAt(i)]==e))t+=a[i],i++}let n=J.c.StiEncode.encode(t,e);s+="\\f"+(this.baseFontNumber+this.codePageToFont[e]).toString()+" ";for(let i=0;i<n.length;i++){let t=a.charCodeAt(r+i),e=n.charCodeAt(i);63==e&&J.c.StiEncode.unicodeToCodePageArray[t]<2?s+="\\u"+t.toString()+"?":s+=127<e?"\\'"+e.toString(16):String.fromCharCode(e)}}}return s}deleteToken(e,i){let r;do{if(-1<(r=e.indexOf(i))){let t=r+i.length;while(t<e.length&&tt.isDigit(e[t]))t++;e=e[Z.System.StiObject.stimulsoft]().remove(r,t-r)}}while(-1!=r);return e}getRtfString(t){let s="",e=t.as(A);if(null!=e&&""!=e.text){let l=[],h=[],c,o=[],m;if(-1==(s=e.text).trimStart().toLowerCase().indexOf("rtf"))return s;let r=s.indexOf("\\ansicpg"),t=s.indexOf("\\'");if(-1!=r&&-1!=t&&tt.isDigit(s,r+8)){r+=8;let t=0;while(r+t<s.length&&tt.isDigit(s,r+t))t++;let e=parseInt(s.substr(r,t)),i=null;try{i=u.getEncoding(e)}catch(t){}if(null!=i){let t="";r=0;while(r<s.length)if(r<s.length-4&&"\\"==s[r]&&"'"==s[r+1]){let e=[];while(r<s.length-4&&"\\"==s[r]&&"'"==s[r+1]){let t=lr.parseHexTwoCharToInt(s[r+2],s[r+3]);e.push(t<256?t:"?".charCodeAt(0)),r+=4}0<e.length&&(t+=i.getString(e))}else t+=s[r],"\\"==s[r]&&r<s.length-2&&"\\"==s[r+1]&&(t+="\\",r++),r++;s=t}}if(-1!=(r=s.indexOf("{\\fonttbl"))){r+=9;while(r<s.length&&"}"!=s[r]){while(r<s.length&&"{"!=s[r])r++;let t=0,e=r;do{"{"==s[e]&&t++,"}"==s[e]&&t--,e++}while(0<t);l.push(s.substr(r,e-r)),r=e;while(r<s.length&&"{"!=s[r]&&"}"!=s[r])r++}s=s[Z.System.StiObject.stimulsoft]().remove(0,r+1)}for(let o=0;o<l.length;o++){let i=l[o],r;do{if(-1!=(r=i.indexOf("{\\*"))){let t=0,e=r;do{"{"==i[e]&&t++,"}"==i[e]&&t--,e++}while(0<t);" "!=(i=i[Z.System.StiObject.stimulsoft]().remove(r,e-r))[r-1]&&" "!=i[r]&&(i=i[Z.System.StiObject.stimulsoft]().insert(r," "))}}while(-1!=r);r=i.indexOf(" ");let t=i.length-r-2,e=(";"==i[r+1+t-1]&&t--,i.substr(r+1,t)),n=(c=new X(e,10),0);if(0<(r=i.indexOf("\\fcharset"))){r+=9;let t="";while(tt.isDigit(i[r]))t+=i[r],r++;let e=yt.tryParse(t,!1);n=e.result,e.successfully||(n=0)}let a=this.getFontNumber2(this.fontList,c,n).toString(),s=(h.push(a),"");r=i.indexOf("\\f"),r+=2;while(tt.isDigit(i[r]))s+=i[r],r++;l[o]=s}if(-1!=(r=s.indexOf("{\\colortbl"))){r+=10;while(r<s.length&&"}"!=s[r]){while(r<s.length&&";"!=s[r]&&"\\"!=s[r])r++;let t=r;while(t<s.length&&";"!=s[t]&&"}"!=s[t])t++;o.push(s.substr(r,t+1-r)),";"==s[t]&&t++,r=t;while(r<s.length&&";"!=s[r]&&"\\"!=s[r]&&"}"!=s[r])r++}s=s[Z.System.StiObject.stimulsoft]().remove(0,r+1)}for(let s=0;s<o.length;s++){let a=o[s];if(";"!=a){let t,e,i,r,n;t=a.indexOf("\\red")+4,n="";while(tt.isDigit(a[t]))n+=a[t],t++;e=n,t=a.indexOf("\\green")+6,n="";while(tt.isDigit(a[t]))n+=a[t],t++;i=n,t=a.indexOf("\\blue")+5,n="";while(tt.isDigit(a[t]))n+=a[t],t++;r=n,m=rt.fromArgb2(parseInt(e),parseInt(i),parseInt(r)),o[s]=this.getColorNumber(this.colorList,m)}else o[s]=this.getColorNumber(this.colorList,rt.transparent)}if(-1!=(r=s.indexOf("{\\stylesheet"))){let t=0,e=r;do{"{"==s[e]&&t++,"}"==s[e]&&t--,e++}while(0<t);s=s[Z.System.StiObject.stimulsoft]().remove(0,e)}if(-1!=(r=s.indexOf("{\\*\\generator"))){let t=0,e=r;do{"{"==s[e]&&t++,"}"==s[e]&&t--,e++}while(0<t);s=s[Z.System.StiObject.stimulsoft]().remove(0,e)}let n=0,a;do{if(-1!=(n=s.indexOf("\\f",n)))if(1==tt.isDigit(s[n+2])){let e=n+=2;a="";while(tt.isDigit(s[e]))a+=s[e],e++;let i=a;for(let t=0;t<l.length;t++)l[t]==i&&(s=s.substr(0,n)+h[t]+s.substr(e));n=e}else n+=2}while(-1!=n);if(0<o.length){n=0;let i=3;do{if(-1!=(n=s.indexOf("\\cf",n)))if(1==tt.isDigit(s[n+i])){let t=n+=i;a="";while(tt.isDigit(s[t]))a+=s[t],t++;let e=parseInt(a);e<o.length&&(s=s.substr(0,n)+o[e]+s.substr(t)),n=t}else n+=i}while(-1!=n);n=0,i=6;do{if(-1!=(n=s.indexOf("\\cbpat",n)))if(1==tt.isDigit(s[n+i])){let t=n+=i;a="";while(tt.isDigit(s[t]))a+=s[t],t++;let e=parseInt(a);e<o.length&&(s=s.substr(0,n)+o[e]+s.substr(t)),n=t}else n+=i}while(-1!=n);n=0,i=10;do{if(-1!=(n=s.indexOf("\\highlight",n)))if(1==tt.isDigit(s[n+i])){let t=n+=i;a="";while(tt.isDigit(s[t]))a+=s[t],t++;let e=parseInt(a);e<o.length&&(s=s.substr(0,n)+o[e]+s.substr(t)),n=t}else n+=i}while(-1!=n)}r=s.length-1;while("}"!=s[r])r--;r--;while("\r"==s[r]||"\n"==s[r]||" "==s[r])r--;if((s=(s=s.substr(0,r+1)).endsWith("\\par")?s.substr(0,s.length-"\\par".length):s).endsWith("\\par }")&&(s=s.substr(0,s.length-"\\par }".length)+"}"),s=this.deleteToken(s,"\\viewkind"),s=this.deleteToken(s,"\\uc"),nt.isNullOrWhiteSpace(s))return"";while("\r"==s[0]||"\n"==s[0])s=s[Z.System.StiObject.stimulsoft]().remove(0,1);"\\pard"==s.substr(0,5)&&(s=s[Z.System.StiObject.stimulsoft]().remove(0,5)),s=this.deleteToken(s,"\\formprot"),s=this.deleteToken(s,"\\pagebb");let i="";for(let e=0;e<s.length;e++){let t=s.charCodeAt(e);i+=255<t?nt.format("\\u{0}{1}",t,"?"):s[e]}s=i}let i=0,r=0;while(r<s.length){let t=s[r++];if("{"==t){i++;continue}if("}"==t){i--;continue}if("\\"==t&&r<s.length&&("{"==s[r]||"}"==s[r])){r++;continue}}return i<0&&(s=nt.fill("{",-i)+s),0<i&&(s+=nt.fill("}",i)),s}static parseHexTwoCharToInt(t,e){return 16*this.parseHexCharToInt(t)+this.parseHexCharToInt(e)}static parseHexCharToInt(t){if("0"<=t&&t<="9")return t.charCodeAt(0)-"0".charCodeAt(0);if("a"==t||"A"==t)return 10;if("b"==t||"B"==t)return 11;if("c"==t||"C"==t)return 12;if("d"==t||"D"==t)return 13;if("e"==t||"E"==t)return 14;if("f"==t||"F"==t)return 15;return 256}makeHorAlignString(t,e){let i=0,r="\\ql"+(0!=i?nt.format("\\ri{0}",i):"");return(t==at.Left&&1==e||t==at.Right&&0==e)&&(r="\\qr"+(0!=i?nt.format("\\li{0}",i):"")),t==at.Center&&(r="\\qc"+(0!=i?nt.format("\\ri{0}",i):"")),r=t==at.Width?"\\qj":r}getRtfStyleFromComponent(a){if(null!=a){let t=a.as(dt),e=a.as(wt),i=a.as(ut),r=a.as(ht),n=new or;return n.name=a.name,null!=a.componentStyle&&0<a.componentStyle.length&&(n.name=a.componentStyle),null!=t&&(n.fontNumber=this.getFontNumber(this.fontList,t.font),n.fontSize=$.round2(2*t.font.sizeInPoints,0),n.bold=t.font.bold,n.italic=t.font.italic,n.underline=t.font.underline),null!=e&&(n.textColor=this.getColorNumberInt(this.colorList,lt.toColor(e.textBrush))),null!=i&&(n.alignment=i.horAlignment),null!=r&&(n.rightToLeft=r.textOptions.rightToLeft),this.getStyleNumber(this.styleList,n)}return 0}renderStartDoc(){this.sw.write("{\\rtf1"),this.sw.writeLine(nt.format("\\ansi\\ansicpg{0}",1252)),this.sw.writeLine("{\\fonttbl");for(let r=0;r<this.fontList.length;r++){let i=this.fontList[r];for(let e=0;e<this.charsetCount;e++){let t=J.c.StiEncode.codePagesTable[this.fontToCodePages[e]][2];this.sw.write("{"),this.sw.write(nt.format("\\f{0}\\fcharset{1} {2};",r*this.charsetCount+e,1==t?0:t,i.name)),this.sw.writeLine("}")}}this.sw.writeLine("}"),this.sw.writeLine("{\\colortbl");for(let e=0;e<this.colorList.length;e++){let t=this.colorList[e];rt.transparent.equals(t)?this.sw.writeLine(";"):this.sw.writeLine(nt.format("\\red{0}\\green{1}\\blue{2};",t.r,t.g,t.b))}if(this.sw.writeLine("}"),this.useStyles){this.sw.writeLine("{\\stylesheet");for(let e=0;e<this.styleList.length;e++){this.sw.write("{");let t=this.styleList[e];this.sw.write(nt.format("\\s{0}\\sbasedon0\\snext{0} ",e+1)),-1!=t.fontNumber&&(this.sw.write(nt.format("\\f{0}",t.fontNumber)),this.sw.write(nt.format("\\fs{0}",t.fontSize)),t.bold&&this.sw.write("\\b"),t.italic&&this.sw.write("\\i"),t.underline)&&this.sw.write("\\ul"),-1!=t.textColor&&this.sw.write(nt.format("\\cf{0}",t.textColor)),this.sw.write(this.makeHorAlignString(t.alignment,t.rightToLeft)),t.rightToLeft?this.sw.write("\\rtlpar"):this.sw.write("\\ltrpar"),this.sw.write(nt.format(" {0};",t.name)),this.sw.writeLine("}")}this.sw.writeLine("}")}this.sw.writeLine("{\\info{\\doccomm "+J.c.StiExportUtils.getReportVersion(this.report)+"}}"),this.sw.write("\\viewkind1"),this.sw.write(nt.format("\\deftab{0}",Math.round(20*this.hiToTwips))),this.sw.write("\\nouicompat")}renderEndDoc(){this.sw.writeLine(""),this.sw.writeLine("}")}renderPageHeader(t){let e=Z.StiOptions.Export.RichText.useTemplatePageSize,i=(this.pageHeight=Math.round(this.hiToTwips*t.unit.convertToHInches(t.pageHeight*(e?1:t.segmentPerHeight))),this.pageWidth=Math.round(this.hiToTwips*t.unit.convertToHInches(t.pageWidth*(e?1:t.segmentPerWidth))),Math.round(this.hiToTwips*t.unit.convertToHInches(t.margins.left))),r=Math.round(this.hiToTwips*t.unit.convertToHInches(t.margins.right)),n=Math.round(this.hiToTwips*t.unit.convertToHInches(t.margins.top)),a=Math.round(this.hiToTwips*t.unit.convertToHInches(t.margins.bottom))-Z.StiOptions.Export.RichText.bottomMarginCorrection;a<0&&(a=0),31500<this.pageWidth&&(this.pageWidth=31500),31500<this.pageHeight&&(this.pageHeight=31500),this.sw.write("\\sectd"),t.orientation==S.Landscape&&this.sw.write("\\lndscpsxn"),this.sw.write(nt.format("\\paperw{0}\\paperh{1}",this.pageWidth,this.pageHeight)),this.sw.writeLine(nt.format("\\margl{0}\\margr{1}\\margt{2}\\margb{3}\\headery{2}\\footery{3}",i,r,n,a))}renderPageFooter(){Z.StiOptions.Export.RichText.useNewPageCommandInsteadOfNewSection?this.sw.writeLine("\\page\\par"):this.sw.writeLine("\\sect")}renderTextAngle1(t){let i=t.as(ht);if(null!=i){let t=i.textOptions.angle,e=225<t&&t<315?2:45<t&&t<135?1:0;switch(e){case 1:this.sw.write("\\frmtxbtlr");break;case 2:this.sw.write("\\frmtxtbrl");break;default:this.sw.write("\\frmtxlrtb");break}}}renderTextAngle2(t){let i=t.as(ht);if(null!=i){let t=i.textOptions.angle,e=225<t&&t<315?2:45<t&&t<135?1:0;switch(e){case 1:this.sw.write("\\cltxbtlr");break;case 2:this.sw.write("\\cltxtbrl");break;default:this.sw.write("\\cltxlrtb");break}}}renderHorAlign12(t){let e=t.as(ut),i=t.as(ht),r=null!=i&&i.textOptions.rightToLeft;if(null!=e){let t=this.makeHorAlignString(e.horAlignment,r);this.sw.write(nt.format("{0}",t))}}renderVerAlign2(t){let e=t.as(St);null!=e&&(e.vertAlignment==st.Top&&this.sw.write("\\clvertalt"),e.vertAlignment==st.Center&&this.sw.write("\\clvertalc"),e.vertAlignment==st.Bottom)&&this.sw.write("\\clvertalb")}renderBorder1(t){let e=t.as(z);if(null!=e&&!t.is(j))if(e.border.is(ft)){let t=e.border;t.isLeftBorderSidePresent&&0!=t.leftSide.color.a&&this.sw.write("\\brdrl"+this.getLineStyle(t.leftSide,this.colorList)),t.isRightBorderSidePresent&&0!=t.rightSide.color.a&&this.sw.write("\\brdrr"+this.getLineStyle(t.rightSide,this.colorList)),t.isTopBorderSidePresent&&0!=t.topSide.color.a&&this.sw.write("\\brdrt"+this.getLineStyle(t.topSide,this.colorList)),t.isBottomBorderSidePresent&&0!=t.bottomSide.color.a&&this.sw.write("\\brdrb"+this.getLineStyle(t.bottomSide,this.colorList))}else{let t=e.border.color;if(0!=t.a){let t=this.getLineStyle(new T(e.border.color,e.border.size,e.border.style),this.colorList);0<(e.border.side&P.Left)&&this.sw.write("\\brdrl"+t),0<(e.border.side&P.Right)&&this.sw.write("\\brdrr"+t),0<(e.border.side&P.Top)&&this.sw.write("\\brdrt"+t),0<(e.border.side&P.Bottom)&&this.sw.write("\\brdrb"+t)}}}renderBorder2(t){let e=t.as(z);if(null!=e&&!t.is(j))if(e.border.is(ft)){let t=e.border;t.isLeftBorderSidePresent&&0!=t.leftSide.color.a&&this.sw.write("\\clbrdrl"+this.getLineStyle(t.leftSide,this.colorList)),t.isRightBorderSidePresent&&0!=t.rightSide.color.a&&this.sw.write("\\clbrdrr"+this.getLineStyle(t.rightSide,this.colorList)),t.isTopBorderSidePresent&&0!=t.topSide.color.a&&this.sw.write("\\clbrdrt"+this.getLineStyle(t.topSide,this.colorList)),t.isBottomBorderSidePresent&&0!=t.bottomSide.color.a&&this.sw.write("\\clbrdrb"+this.getLineStyle(t.bottomSide,this.colorList))}else{let t=e.border.color;if(0!=t.a){let t=this.getLineStyle(new T(e.border.color,e.border.size,e.border.style),this.colorList);0<(e.border.side&P.Left)&&this.sw.write("\\clbrdrl"+t),0<(e.border.side&P.Right)&&this.sw.write("\\clbrdrr"+t),0<(e.border.side&P.Top)&&this.sw.write("\\clbrdrt"+t),0<(e.border.side&P.Bottom)&&this.sw.write("\\clbrdrb"+t)}}}renderBorder2Table(e,i,r,n,t,a=!1){let s=!0,o=!0;for(let t=0;t<r+1;t++)null==this.matrix.bordersY.gett(e-1+t,i-1)&&(s=!1),null==this.matrix.bordersY.gett(e-1+t,i-1+n+1)&&(o=!1);let l=!0,h=!0;for(let t=0;t<n+1;t++)null==this.matrix.bordersX.gett(e-1,i-1+t)&&(l=!1),null==this.matrix.bordersX.gett(e-1+r+1,i-1+t)&&(h=!1);a&&e<this.matrix.coordY.countItems&&this.matrix.linePlacement[e]==J.c.StiTableLineInfo.HeaderAP&&(h=!1);let c="";if(s&&(c+="\\clbrdrl"+this.getLineStyle(this.matrix.bordersY.gett(e-1,i-1),this.colorList)),o&&(c+="\\clbrdrr"+this.getLineStyle(this.matrix.bordersY.gett(e-1,i-1+n+1),this.colorList)),l&&(c+="\\clbrdrt"+this.getLineStyle(this.matrix.bordersX.gett(e-1,i-1),this.colorList)),h&&(c+="\\clbrdrb"+this.getLineStyle(this.matrix.bordersX.gett(e-1+r+1,i-1),this.colorList)),t)return c;return 0<c.length&&this.sw.write(c),null}renderBorder2TableGetValues(t,e,i){let r=P.None,n="";return null!=this.matrix.bordersY.gett(t-1,e-1)&&(r|=P.Left),null!=this.matrix.bordersY.gett(t-1,e-1+1)&&(r|=P.Right),null!=this.matrix.bordersX.gett(t-1,e-1)&&(n+="\\clbrdrt"+this.getLineStyle(this.matrix.bordersX.gett(t-1,e-1),this.colorList),r|=P.Top),null!=this.matrix.bordersX.gett(t-1+1,e-1)&&(n+="\\clbrdrb"+this.getLineStyle(this.matrix.bordersX.gett(t-1+1,e-1),this.colorList),r|=P.Bottom),i.ref=n,r}renderBrush1(t){let i=t.as(N);if(null!=i&&!t.isExportAsImage(J.a.StiExportFormat.Rtf)){let e=lt.toColor(i.brush);if(0!=e.a){let t=this.getColorNumber(this.colorList,e);this.sw.write(nt.format("\\cbpat{0}",t))}}}renderBrush2(t){let e=t.as(N);if(null!=e&&!t.isExportAsImage(J.a.StiExportFormat.Rtf)){let t=lt.toColor(e.brush);this.sw.write("{\\sp{\\sn fillColor}{\\sv "),this.sw.write(nt.format("{0}",65536*t.b+256*t.g+t.r)),this.sw.write("}}"),0!=t.a?this.sw.write("{\\sp{\\sn fFilled}{\\sv 1}} "):this.sw.write("{\\sp{\\sn fFilled}{\\sv 0}} ")}}renderTextBrush12(t){let e=t.as(wt);if(null!=e){let t=this.getColorNumber(this.colorList,lt.toColor(e.textBrush));this.sw.write(nt.format("\\cf{0}",t))}}renderTextFont12(t){let e=t.as(dt);null!=e&&(this.baseFontNumber=this.getFontNumber(this.fontList,e.font),this.sw.write(nt.format("\\f{0}",this.baseFontNumber)),this.sw.write(nt.format("\\fs{0}",Math.round(2*e.font.sizeInPoints))),e.font.bold&&this.sw.write("\\b"),e.font.italic&&this.sw.write("\\i"),e.font.underline&&this.sw.write("\\ul"),this.sw.write(nt.format("\\sl{0}\\slmult1",Math.round(240*Z.StiOptions.Export.RichText.lineSpacing*(t.is(et)?t.lineSpacing:1)))),0!=Z.StiOptions.Export.RichText.spaceBetweenCharacters)&&this.sw.write(nt.format("\\expndtw{0}",Z.StiOptions.Export.RichText.spaceBetweenCharacters))}renderText12(s){let o=s.as(bt),l=s.as(ht);if(null!=o&&!s.isExportAsImage(J.a.StiExportFormat.Rtf)){let t=o.text,e=s.as(et),i=(null!=e&&e.checkAllowHtmlTags()&&(t=this.convertTextWithHtmlTagsToRtfText(e,t)),t=s.is(et)&&s.textQuality==Et.Wysiwyg&&!nt.isNullOrEmpty(t)&&t.endsWith(G.StiForceWidthAlignTag)?t.substr(0,t.length-G.StiForceWidthAlignTag.length):t),r=null!=l&&null!=l.textOptions&&l.textOptions.rightToLeft,n=this.unicodeToRtfString(i,r),a=[];for(let t=0;t<n.length;t++)a[t]=n.charCodeAt(t);this.sw.flush(),this.sw2.write(a,0,a.length)}}renderImage12(t,n,a){let s=t.as(V);if(null!=s){let e=this.imageResolution,i=s.as(pt),r=null;if(t.isExportAsImage(J.a.StiExportFormat.Rtf)){let t={ref:e};r=null!=i&&i.isExportAsImage(J.a.StiExportFormat.Rtf)?i.getImage(t,this.imageFormat):s.getImage(t),e=t.ref}null!=r&&this.sw.write(this.getImageString(r,e,n,a))}}renderRtf12(n,a=0){let t=n.as(A);if(null!=t)if(0<a){this.sw.flush();let t=this.sw.baseStream.position,e=it.create(Number,t-(a+1)),i=(this.sw.baseStream.position=a+1,this.sw.baseStream.read(e,0,e.length),u.ASCII.getString(e)),r=this.getRtfString(n);r=(r=(r=r[Z.System.StiObject.stimulsoft]().replaceAll("pardpar",""))[Z.System.StiObject.stimulsoft]().replaceAll("\\pard",""))[Z.System.StiObject.stimulsoft]().replaceAll("","\\pard"+i+"\\par"),this.sw.write(r)}else{let t=this.getRtfString(n)[Z.System.StiObject.stimulsoft]().replaceAll("\\pard","");this.sw.write(t)}}renderImage3(t,n,a,s){let o=t.as(pt);if(null!=o){let e=this.imageResolution,i=o.as(pt),r=null;if(t.isExportAsImage(J.a.StiExportFormat.Rtf)){let t={ref:e};r=null!=i&&i.isExportAsImage(J.a.StiExportFormat.Rtf)?o.getImage(t,this.imageFormat):o.getImage(t),e=t.ref}null!=r&&(n+=this.getImageString(r,e,a,s))}}renderRtf3(e,i){let t=e.as(A);if(null!=t){let t=this.getRtfString(e)[Z.System.StiObject.stimulsoft]().replaceAll("\\pard","\\par");i+=t}}renderText3(n,a){let s=n.as(bt),o=n.as(ht);if(null!=s&&!n.isExportAsImage(J.a.StiExportFormat.Rtf)){let t=s.text,e=t=n.is(et)&&n.textQuality==Et.Wysiwyg&&!nt.isNullOrEmpty(t)&&t.endsWith(G.StiForceWidthAlignTag)?t.substr(0,t.length-G.StiForceWidthAlignTag.length):t,i=null!=o&&null!=o.textOptions&&o.textOptions.rightToLeft,r=this.unicodeToRtfString(e,i);a+=r}}renderTextFont3(t,e){let i=t.as(dt);null!=i&&(e+="\\f",this.baseFontNumber=this.getFontNumber(this.fontList,i.font),e=(e=e+this.baseFontNumber.toString()+"\\fs")+Math.round(2*i.font.sizeInPoints),i.font.bold,i.font.italic&&(e+="\\i"),i.font.underline&&(e+="\\ul"),e+=nt.format("\\sl{0}\\slmult1",Math.round(240*Z.StiOptions.Export.RichText.lineSpacing*(t.is(et)?t.lineSpacing:1))),0!=Z.StiOptions.Export.RichText.spaceBetweenCharacters)&&(e+=nt.format("\\expndtw{0}",Z.StiOptions.Export.RichText.spaceBetweenCharacters))}renderTextBrush3(t,e){let i=t.as(wt);if(null!=i){let t=this.getColorNumber(this.colorList,lt.toColor(i.textBrush));e=e+"\\cf"+t}}renderBrush3(t,e){let i=t.as(N);if(null!=i&&!t.isExportAsImage(J.a.StiExportFormat.Rtf)){let t=this.getColorNumber(this.colorList,lt.toColor(i.brush));e=e+"\\cbpat"+t}}renderBorder3(t,e){let i=t.as(z);if(null!=i&&!t.is(j))if(i.border.is(ft)){let t=i.border;t.isLeftBorderSidePresent&&0!=t.leftSide.color.a&&(e+="\\brdrl"+this.getLineStyle(t.leftSide,this.colorList)),t.isRightBorderSidePresent&&0!=t.rightSide.color.a&&(e+="\\brdrr"+this.getLineStyle(t.rightSide,this.colorList)),t.isTopBorderSidePresent&&0!=t.topSide.color.a&&(e+="\\brdrt"+this.getLineStyle(t.topSide,this.colorList)),t.isBottomBorderSidePresent&&0!=t.bottomSide.color.a&&(e+="\\brdrb"+this.getLineStyle(t.bottomSide,this.colorList))}else{let t=i.border.color;if(0!=t.a){let t=this.getLineStyle(new T(i.border.color,i.border.size,i.border.style),this.colorList);0<(i.border.side&P.Left)&&(e+="\\brdrl"+t),0<(i.border.side&P.Right)&&(e+="\\brdrr"+t),0<(i.border.side&P.Top)&&(e+="\\brdrt"+t),0<(i.border.side&P.Bottom)&&(e+="\\brdrb"+t)}}}renderStyle12(e){let t=e.as(et);if(this.useStyles&&null!=t){let t=this.getRtfStyleFromComponent(e);this.sw.write(nt.format("\\s{0}",t))}}writeFromMatrix(m,g,p){let d=this.matrix.coordX.countItems,w=this.matrix.coordX.getKeys(),u=this.matrix.coordY.getKeys(),S=[];for(let e=1;e<this.matrix.coordX.countItems;e++){let t=this.matrix.coordX.getByIndex(e,w);S[e]=Math.round(t*this.hiToTwips)}let f=it.create2(Number,this.matrix.coordY.countItems,this.matrix.coordX.countItems),b=it.create2(Number,this.matrix.coordY.countItems,this.matrix.coordX.countItems),E="",v=0,y=Math.max(this.matrix.coordY.countItems/200,1),x=0;for(let c=1;c<this.matrix.coordY.countItems;c++){let t=Math.trunc(c/y),e=(t>x&&(x=t,this.invokeExporting2(c,this.matrix.coordY.countItems,this.currentPassNumber,this.maximumPassNumber)),Math.round((this.matrix.coordY.getByIndex(c,u)-this.matrix.coordY.getByIndex(c-1,u))*this.hiToTwips)),o=c-1>=m&&c-1<=g&&0==v,r=(0<v&&v--,0!=p||this.matrix.linePlacement[c-1]!=J.c.StiTableLineInfo.PageHeader&&this.matrix.linePlacement[c-1]!=J.c.StiTableLineInfo.PageFooter&&this.matrix.linePlacement[c-1]!=J.c.StiTableLineInfo.Trash||(o=!1),100005),n=[],a=!1,s=Z.StiOptions.Export.RichText.useCanBreakProperty;if(o)for(let t=1;t<d;t++){let i=this.matrix.cells.gett(c-1,t-1);if(0<=f[c][t]&&null!=i&&null!=i.component){if(null!=i.component.tagValue){let t=i.component.tagValue.toString().toLowerCase();-1!=t.indexOf("rtfparagraph")&&(n.push(i),o=!1),-1!=t.indexOf("rtfnewpage")&&(a=!0)}let t=i.component.as(Y),e=(null==t||t.canBreak||(s=!1),null);i.component.is(et)&&(e=i.component.margins),i.component.is(A)&&(e=i.component.margins),null!=(e=i.component.is(Q)?i.component.margins:e)&&(e.top<r&&(r=e.top),0<i.height)&&(r=0)}}a&&this.sw.writeLine("}\\fs2\\page\\par{"),this.usePageHeadersAndFooters||(s=!1),r*=this.hiToTwips;let l=Math.round(r);if(o){if(this.usePageHeadersAndFooters&&this.matrix.linePlacement[c-1]==J.c.StiTableLineInfo.HeaderAP){let t=this.matrix.parentBandName[c-1],e=t.indexOf("");(t=-1!=e?t.substr(0,e):t)!=E&&(E=t,this.sw.writeLine("}\\fs2\\par{"))}let t=this.usePageHeadersAndFooters&&this.matrix.linePlacement[c-1]!=J.c.StiTableLineInfo.Empty||!Z.StiOptions.Export.RichText.lineHeightExactly;this.sw.write("\\trowd"),this.usePageHeadersAndFooters&&!Z.StiOptions.Export.RichText.forceLineHeight||this.sw.write(nt.format("\\trrh{0}{1}",t?"":"-",e)),s||this.sw.write("\\trkeep"),this.sw.write("\\ltrrow"),this.usePageHeadersAndFooters&&this.matrix.linePlacement[c-1]==J.c.StiTableLineInfo.HeaderAP&&this.sw.write("\\trhdr")}let h="",i=0;for(let s=1;s<d;s++){let a=this.matrix.cells.gett(c-1,s-1);if(0<=f[c][s]){if(i++,h+="{",null!=a){let t=a.cellStyle,n=!1,e=(null!=t.textOptions&&(n=t.textOptions.rightToLeft),t.font);if(this.baseFontNumber=this.getFontNumber(this.fontList,e),this.useStyles){let t=this.getRtfStyleFromComponent(a.component);h+=nt.format("\\s{0}",t)}n?h+="\\rtlpar":h+="\\ltrpar",h+=this.makeHorAlignString(t.horAlignment,n);let i=this.getColorNumber(this.colorList,t.textColor),r=(h=(h=(h+=nt.format("\\cf{0}",i))+nt.format("\\f{0}",this.baseFontNumber))+nt.format("\\fs{0}",Math.round(2*e.sizeInPoints)),e.bold&&(h+="\\b"),e.italic&&(h+="\\i"),e.underline&&(h+="\\ul"),h+=nt.format("\\sl{0}\\slmult1",Math.round(240*Z.StiOptions.Export.RichText.lineSpacing*(a.component.is(et)?a.component.lineSpacing:1))),0!=Z.StiOptions.Export.RichText.spaceBetweenCharacters&&(h+=nt.format("\\expndtw{0}",Z.StiOptions.Export.RichText.spaceBetweenCharacters)),this.matrix.bookmarks.gett(c-1,s-1));if(null!=r&&o&&!this.usedBookmarks.containsKey(r)){this.usedBookmarks.set(r,r);let t=this.convertStringToBookmark(r);h+=this.unicodeToRtfString(""+t+""+t+"",!1)}if(!a.component.is(A)){let i=a.text;if(null!=i&&0<i.length&&!a.component.isExportAsImage(J.a.StiExportFormat.Rtf)){let t=a.component.as(et),r=i;if(null!=t&&t.checkAllowHtmlTags()&&(r=this.convertTextWithHtmlTagsToRtfText(t,i)),this.usePageHeadersAndFooters){let i=a.component.tagValue;if(null!=i&&0<i.length)if(Z.StiOptions.Export.RichText.usePageRefField&&this.bookmarkList.containsKey(i))r=""+"PAGEREF "+this.convertStringToBookmark(i)+""+a.text+"";else if(-1==i.toLowerCase().indexOf("rtfnewpage")&&(-1!=i.indexOf("#PageNumber#")||-1!=i.indexOf("#TotalPageCount#")||-1!=i.indexOf("#PageRef"))){(r=i)[Z.System.StiObject.stimulsoft]().replaceAll("#PageNumber#",""),r[Z.System.StiObject.stimulsoft]().replaceAll("#TotalPageCount#","");let e=0;while(-1!=(e=i.indexOf("#PageRef",e))){let t=e+8;while(t<i.length&&"#"!=i[t])t++;r[Z.System.StiObject.stimulsoft]().replaceAll(i.substr(e,t+1-e),""+"PAGEREF "+i+""+a.text+""),e+=8}}}if(null!=a.component.hyperlinkValue){let e=a.component.hyperlinkValue.toString().trim();if(0<e.length&&!e.StartsWith("javascript:")){let t=r;0==t.length&&(t=e),r=e.startsWith("#")?(e=e.substr(1),""+'HYPERLINK \\l "'+this.convertStringToBookmark(e)+'"'+""+t+""):""+'HYPERLINK "'+e+'"'+""+t+""}}let e=this.unicodeToRtfString(r,n);h+=nt.format(" {0}",e)}}if(a.component.is(A)){let t=a.component;if(null!=t){let t=this.getRtfString(a.component),i=(nt.isNullOrEmpty(a.text)&&(t=""),this.replacePardInRtf(t));if(null!=a.component.hyperlinkValue){let e=a.component.hyperlinkValue.toString().trim();if(0<e.length&&!e.startsWith("javascript:")){let t=i;0==t.length&&(t=e),i=e.StartsWith("#")?(e=e.substr(1),""+'HYPERLINK \\\\l "'+this.convertStringToBookmark(e)+'"'+""+t+""):""+'HYPERLINK "'+e+'"'+""+t+""}}i[Z.System.StiObject.stimulsoft]().replaceAll("","\\"),i[Z.System.StiObject.stimulsoft]().replaceAll("","{\\field{\\*\\fldinst {PAGE}}}"),i[Z.System.StiObject.stimulsoft]().replaceAll("","{\\field{\\*\\fldinst {NUMPAGES}}}"),i[Z.System.StiObject.stimulsoft]().replaceAll("","{\\field{\\*\\fldinst {"),i[Z.System.StiObject.stimulsoft]().replaceAll(""," }}{\\fldrslt {"),i[Z.System.StiObject.stimulsoft]().replaceAll("","{\\*\\bkmkstart "),i[Z.System.StiObject.stimulsoft]().replaceAll("","}{\\*\\bkmkend "),i[Z.System.StiObject.stimulsoft]().replaceAll("","}"),h+=i}}else{let n=a.component.as(V);if(null!=n){let e=this.imageResolution,i=n.as(pt),r=null;if(a.component.isExportAsImage(J.a.StiExportFormat.Rtf)){let t={ref:e};r=null!=i&&i.isExportAsImage(J.a.StiExportFormat.Rtf)?i.getImage(t,this.imageFormat):n.getImage(t),e=t.ref}if(null!=r){let t=this.matrix.getRealImageData(a,r),i=(null!=t&&(r=t),this.getImageString(r,e,Math.round((this.matrix.coordX.getByIndex(s+a.width,w)-this.matrix.coordX.getByIndex(s-1,w))*this.hiToTwips),Math.round((this.matrix.coordY.getByIndex(c+a.height,u)-this.matrix.coordY.getByIndex(c-1,u))*this.hiToTwips)));if(null!=a.component.hyperlinkValue){let e=a.component.hyperlinkValue.toString().trim();if(0<e.length&&!e.startsWith("javascript:")){let t=i;i=e.startsWith("#")?(e=e.substr(1),"{\\field{\\*\\fldinst {"+'HYPERLINK \\\\l "'+this.convertStringToBookmark(e)+'"'+" }}{\\fldrslt {"+t+"}}}"):"{\\field{\\*\\fldinst {"+'HYPERLINK "'+e+'"'+" }}{\\fldrslt {"+t+"}}}"}}h=h+i+"\\f0\\fs2"}}}if(2!=b[c][s]){for(let e=0;e<=a.height;e++){for(let t=0;t<=a.width;t++)f[c+e][s+t]=-1;f[c+e][s]=a.width}if(0<a.height){b[c][s]=1;for(let t=1;t<=a.height;t++)b[c+t][s]=2}}}else if(0==b[c][s]&&Z.StiOptions.Export.RichText.forceEmptyCellsOptimization){let r={ref:null},n=this.renderBorder2TableGetValues(c,s,r);if(0==(n&P.Right)){let i=0;while(s+i+1<d&&null==this.matrix.cells.gett(c-1,s+i+1-1)&&0==f[c][s+i+1]&&0==b[c][s+i+1]){let t={ref:null},e=this.renderBorder2TableGetValues(c,s+i+1,t);if(0<(e&P.Left))break;if((e&(P.Top|P.Bottom))!=(n&(P.Top|P.Bottom)))break;if(r.ref!=t.ref)break;if(i++,0<(e&P.Right))break}if(0<i){for(let t=1;t<=i;t++)f[c][s+t]=-1;f[c][s]=i}}}h+="\\cell}"}if(64<=i)break}if(o){i=0;for(let r=1;r<d;r++){if(1==b[c][r]&&this.sw.write("\\clvmgf"),2==b[c][r]&&this.sw.write("\\clvmrg"),0<=f[c][r])if(i++,2==b[c][r]){let t=c;while(2==b[t][r])t--;let e=this.matrix.cells.gett(t-1,r-1);this.renderBorder2Table(t,r,e.height,e.width,!1)}else{let i=this.matrix.cells.gett(c-1,r-1);if(null!=i){let t=i.cellStyle;if(this.renderVerAlign2(i.component),this.renderBorder2Table(c,r,i.height,i.width,!1),this.renderTextAngle2(i.component),!i.component.isExportAsImage(J.a.StiExportFormat.Rtf)){let e=t.color;if(0!=e.a){let t=this.getColorNumber(this.colorList,e);this.sw.write(nt.format("\\clcbpat{0}",t))}let n=i.component.as(et),a=i.component.as(A);if(null!=n||null!=a){let t=Z.StiOptions.Export.RichText.rightMarginCorrection,e=0,i=0,r=0;null!=n&&(e=Math.round(n.margins.left*this.hiToTwips),i=Math.round((n.margins.right-t)*this.hiToTwips),r=Math.round(n.margins.top*this.hiToTwips)),null!=a&&(e=Math.round(a.margins.left*this.hiToTwips),i=Math.round((a.margins.right-t)*this.hiToTwips),r=Math.round(a.margins.top*this.hiToTwips)),r>l&&(r=l),0<e&&this.sw.write(nt.format("\\clpadt{0}\\clpadft3",e)),0<i&&this.sw.write(nt.format("\\clpadr{0}\\clpadfr3",i)),0<r&&this.sw.write(nt.format("\\clpadl{0}\\clpadfl3",r))}}}else this.renderBorder2Table(c,r,0,f[c][r],!1,this.usePageHeadersAndFooters)}if(0<=f[c][r]&&this.sw.write(nt.format("\\cellx{0}",S[r+f[c][r]])),64<=i)break}this.sw.write("\\pard\\intbl ");let e=[];for(let t=0;t<h.length;t++)e[t]=h.charCodeAt(t);this.sw.flush(),this.sw2.write(e,0,e.length),this.sw.writeLine("\\row")}for(let l of n){this.sw.write("\\pard{"),h="",v=l.height;let o=l.text;if(!l.component.is(A)&&null!=o&&0<o.length&&!l.component.isExportAsImage(J.a.StiExportFormat.Rtf)){let t=l.cellStyle,e=!1,i=(null!=t.textOptions&&(e=t.textOptions.rightToLeft),t.font);if(this.baseFontNumber=this.getFontNumber(this.fontList,i),this.useStyles){let t=this.getRtfStyleFromComponent(l.component);h+=nt.format("\\s{0}",t)}e?h+="\\rtlpar":h+="\\ltrpar",h+=this.makeHorAlignString(t.horAlignment,e);let r=this.getColorNumber(this.colorList,t.textColor),n=(h=(h=(h+=nt.format("\\cf{0}",r))+nt.format("\\f{0}",this.baseFontNumber))+nt.format("\\fs{0}",Math.round(2*i.sizeInPoints)),i.bold&&(h+="\\b"),i.italic&&(h+="\\i"),i.underline&&(h+="\\ul"),h+=nt.format("\\sl{0}\\slmult1",Math.round(240*Z.StiOptions.Export.RichText.lineSpacing*(l.component.is(et)?l.component.lineSpacing:1))),0!=Z.StiOptions.Export.RichText.spaceBetweenCharacters&&(h+=nt.format("\\expndtw{0}",Z.StiOptions.Export.RichText.spaceBetweenCharacters)),o),a=l.component.as(et);if(null!=a&&a.checkAllowHtmlTags()&&(n=this.convertTextWithHtmlTagsToRtfText(a,o)),null!=l.component.hyperlinkValue){let e=l.component.hyperlinkValue.toString().trim();if(0<e.length&&!e.startsWith("javascript:")){let t=n;0==t.length&&(t=e),n=e.startsWith("#")?(e=e.substr(1),""+'HYPERLINK \\\\l "'+this.convertStringToBookmark(e)+'"'+""+t+""):""+'HYPERLINK "'+e+'"'+""+t+""}}let s=this.unicodeToRtfString(n,e);h+=nt.format(" {0}",s)}if(l.component.is(A)){let t=l.component;if(null!=t){let t=this.getRtfString(l.component),i=t=nt.isNullOrEmpty(l.text)?"":t;if(null!=l.component.hyperlinkValue){let e=l.component.hyperlinkValue.toString().trim();if(0<e.length&&!e.startsWith("javascript:")){let t=i;0==t.length&&(t=e),i=e.startsWith("#")?(e=e.substr(1),""+'HYPERLINK \\\\l "'+this.convertStringToBookmark(e)+'"'+""+t+""):""+'HYPERLINK "'+e+'"'+""+t+""}}i[Z.System.StiObject.stimulsoft]().replaceAll("","\\"),i[Z.System.StiObject.stimulsoft]().replaceAll("","{\\field{\\*\\fldinst {PAGE}}}"),i[Z.System.StiObject.stimulsoft]().replaceAll("","{\\field{\\*\\fldinst {NUMPAGES}}}"),i[Z.System.StiObject.stimulsoft]().replaceAll("","{\\field{\\*\\fldinst {"),i[Z.System.StiObject.stimulsoft]().replaceAll(""," }}{\\fldrslt {"),i[Z.System.StiObject.stimulsoft]().replaceAll("","{\\*\\bkmkstart "),i[Z.System.StiObject.stimulsoft]().replaceAll("","}{\\*\\bkmkend "),i[Z.System.StiObject.stimulsoft]().replaceAll("","}"),h+=i}}else{let i=l.component.as(V);if(null!=i){let n=this.imageResolution,e=i.as(pt),a=null;if(l.component.isExportAsImage(J.a.StiExportFormat.Rtf)){let t={ref:n};a=null!=e&&e.isExportAsImage(J.a.StiExportFormat.Rtf)?e.getImage(t,this.imageFormat):i.getImage(t),n=t.ref}if(null!=a){let t=this.matrix.getRealImageData(l,a),i=(null!=t&&(a=t),this.getImageString(a,n,Math.round((this.matrix.coordX.getByIndex(l.left+1+l.width,w)-this.matrix.coordX.getByIndex(l.left,w))*this.hiToTwips),Math.round((this.matrix.coordY.getByIndex(l.top+1+l.height,u)-this.matrix.coordY.getByIndex(l.top,u))*this.hiToTwips)));if(null!=l.component.hyperlinkValue){let e=l.component.hyperlinkValue.toString().trim();if(0<e.length&&!e.startsWith("javascript:")){let t=i;i=e.startsWith("#")?(e=e.substr(1),"{\\field{\\*\\fldinst {"+'HYPERLINK \\\\l "'+this.convertStringToBookmark(e)+'"'+" }}{\\fldrslt {"+t+"}}}"):"{\\field{\\*\\fldinst {"+'HYPERLINK "'+e+'"'+" }}{\\fldrslt {"+t+"}}}"}}let e=l.cellStyle.horAlignment;if(l.component.is(ut)){let t=l.component.as(vt);null!=t&&(t.horAlignment==M.Left&&(e=at.Left),t.horAlignment==M.Center&&(e=at.Center),t.horAlignment==M.Right)&&(e=at.Right)}let r=!1;null!=l.cellStyle.textOptions&&(r=l.cellStyle.textOptions.rightToLeft),h=(h+=this.makeHorAlignString(e,r))+i}}h+="\\f0\\fs2"}let e=[];for(let t=0;t<h.length;t++)e[t]=h.charCodeAt(t);this.sw.flush(),this.sw2.write(e,0,e.length),h.trim().endsWith("\\par")||this.sw.write("\\par"),this.sw.writeLine("}")}}}exportRtf2(t,e,i){let r=new J.c.StiRtfExportSettings;r.exportMode=i,this.exportRtf(t,e,r)}exportRtf(h,t,e){if(J.a.StiLogService.write(this[Z.System.StiObject.stimulsoft]().getType(),"Export report to Rtf format"),null==Z.Base[["St","iL","ic","en","se"].join("")].key&&console.warn("You are using a trial version of the Stimulsoft product!"),null==e)throw"The 'settings' argument cannot be equal in null.";this.report=h;let i=e.exportMode,r=e.pageRange,n=(this.usePageHeadersAndFooters=e.usePageHeadersAndFooters,this.removeEmptySpaceAtBottom=e.removeEmptySpaceAtBottom,this.imageResolution=e.imageResolution,this.imageQuality=e.imageQuality,e.storeImagesAsPng),m=(this.unicodeMapArray=[],this.codePageToFont=it.create(Number,J.c.StiEncode.codePagesTableSize+1),this.fontToCodePages=it.create(Number,J.c.StiEncode.codePagesTableSize+1),this.charsetCount=0,this.useStyles=!0,this.imageQuality<0&&(this.imageQuality=0),1<this.imageQuality&&(this.imageQuality=1),this.imageResolution<10&&(this.imageResolution=10),this.imageResolution=this.imageResolution/100,this.imageFormat=n?J.a.StiExportFormat.ImagePng:J.a.StiExportFormat.Rtf,12),g=1,p=1;this.colorList=[],this.fontList=[],this.styleList=[],this.sw=new W(t,u.getEncoding(1252)),this.sw2=t;for(let t=0;t<65536;t++)this.unicodeMapArray[t]=0;this.bookmarkList=new C,this.usedBookmarks=new C,this.currentPassNumber=0,this.maximumPassNumber=(i==J.c.StiRtfExportMode.Table?4:2)+(Z.StiOptions.Export.RichText.divideSegmentPages?1:0);let d=r.getSelectedPages(h.renderedPages);Z.StiOptions.Export.RichText.divideSegmentPages&&(d=J.c.StiSegmentPagesDivider.divide(d,this),this.currentPassNumber++),J.c.StiExportUtils.checkPassive(d);for(let t of d.list){d.getPage(t),this.invokeExporting(t,d,this.currentPassNumber,this.maximumPassNumber);for(let o of t.components.list)if(o.enabled){let t=o.as(wt),e=(null!=t&&this.getColorNumberInt(this.colorList,lt.toColor(t.textBrush)),o.as(N)),i=(null!=e&&this.getColorNumber(this.colorList,lt.toColor(e.brush)),o.as(z));if(null!=i&&!o.is(j)){let t=i.border.as(ft);null!=t?(this.getColorNumber(this.colorList,t.leftSide.color),this.getColorNumber(this.colorList,t.rightSide.color),this.getColorNumber(this.colorList,t.topSide.color),this.getColorNumber(this.colorList,t.bottomSide.color)):this.getColorNumber(this.colorList,i.border.color)}let r=o.as(L),n=(null!=r&&this.getColorNumber(this.colorList,r.borderColor),o.as(dt)),a=(null!=n&&this.getFontNumber(this.fontList,n.font),o.as(A)),s=(null!=a&&(this.getRtfString(o),this.getColorNumber(this.colorList,a.backColor)),o.as(et));if(null!=s){let t=s.text,e=(s.checkAllowHtmlTags()&&(t=this.convertTextWithHtmlTagsToRtfText(s,s.text)),this.checkArabic(t));for(let t=0;t<e.length;t++)this.unicodeMapArray[e.charCodeAt(t)]=1;this.getRtfStyleFromComponent(o)}if(Z.StiOptions.Export.RichText.usePageRefField&&null!=o.bookmarkValue){let t=o.bookmarkValue.toString();null!=t&&0<t.length&&(this.bookmarkList.containsKey(t)||this.bookmarkList.add(t,t))}}}i==J.c.StiRtfExportMode.Table&&this.getFontNumber3(this.fontList,"Arial");for(let t=0;t<65536;t++)0!=this.unicodeMapArray[t]&&(this.codePageToFont[J.c.StiEncode.unicodeToCodePageArray[t]]=1);this.codePageToFont[1]=1;for(let t=1;t<J.c.StiEncode.codePagesTableSize+1;t++)0!=this.codePageToFont[t]&&(this.codePageToFont[t]=this.charsetCount,this.fontToCodePages[this.charsetCount]=t-1,this.charsetCount++);this.codePageToFont[0]=this.codePageToFont[1];for(let e=0;e<this.styleList.length;e++){let t=this.styleList[e];t.fontNumber=t.fontNumber*this.charsetCount,this.styleList[e]=t}if(this.renderStartDoc(),this.currentPassNumber++,i==J.c.StiRtfExportMode.Table){this.sw.writeLine("\\nolead"),this.sw.writeLine("\\afs16");let i=d,l=(d=null,!1),n=0;while(n<i.length){(d=new f(h,h.renderedPages)).cacheMode=h.renderedPages.cacheMode,d.addV2Internal(i.getPageWithoutCache(n));let t=i.getPageWithoutCache(n).excelSheetValue;while(n<i.length-1&&this.compareExcellSheetNames(i.getPageWithoutCache(n+1).excelSheetValue,t)&&i.getPageWithoutCache(n+1).orientation==i.getPageWithoutCache(n).orientation)n++,d.addV2Internal(i.getPageWithoutCache(n));let e=d.getByIndex(0);if(null!=e){d.getPage(e),Z.StiOptions.Export.RichText.useNewPageCommandInsteadOfNewSection&&0!=n||this.renderPageHeader(e);let r=Z.StiOptions.Export.RichText.divideBigCells&&!Z.StiOptions.Export.RichText.useCanBreakProperty;if(this.usePageHeadersAndFooters){let i=new f(h,h.renderedPages);if(i.cacheMode=h.renderedPages.cacheMode,i.addV2Internal(d.getByIndex(0)),this.matrix=new J.c.StiMatrix(i,r,this),this.isStopped)return;this.matrix.scanComponentsPlacement(!1,!0);let a=!1,s,o;o=Math.max(this.matrix.coordY.countItems-1-1,0);while(this.matrix.linePlacement[o]!=J.c.StiTableLineInfo.PageHeader&&0<o)o--;if(this.matrix.linePlacement[o]==J.c.StiTableLineInfo.PageHeader){s=0;while(this.matrix.linePlacement[s]!=J.c.StiTableLineInfo.PageHeader)s++;this.sw.writeLine("{"),this.sw.writeLine("{\\header "),this.writeFromMatrix(s,o,!0),this.sw.writeLine("}"),l=!0}else{let e=!1;if(1<d.length&&null!=d.getByIndex(1)){let t=this.matrix;if((i=new f(h,h.renderedPages)).cacheMode=h.renderedPages.cacheMode,i.addV2Internal(d.getByIndex(1)),this.matrix=new J.c.StiMatrix(i,r,this),this.isStopped)return;this.matrix.scanComponentsPlacement(!1,!0),o=Math.max(this.matrix.coordY.countItems-1-1,0);while(this.matrix.linePlacement[o]!=J.c.StiTableLineInfo.PageHeader&&0<o)o--;if(this.matrix.linePlacement[o]==J.c.StiTableLineInfo.PageHeader){s=0;while(this.matrix.linePlacement[s]!=J.c.StiTableLineInfo.PageHeader)s++;let r=c.AllPages,n=!1;for(let i=s;i<o;i++){for(let e=0;e<this.matrix.coordX.countItems-1;e++){let t=this.matrix.cells.gett(i,e);if(null!=t&&null!=t.component){r=t.component.printOn,n=!0;break}}if(n)break}(n=n&&r==c.ExceptFirstAndLastPage||r==c.ExceptFirstPage)&&(this.sw.writeLine("\\titlepg "),a=!0),this.sw.writeLine("{"),this.sw.writeLine("{\\header "),this.writeFromMatrix(s,o,!0),this.sw.writeLine("}"),l=!0,e=!0}else this.sw.writeLine("{");this.matrix=t}else this.sw.writeLine("{");!e&&l&&this.sw.writeLine("{\\header \\fs2 }")}s=0;while(this.matrix.linePlacement[s]!=J.c.StiTableLineInfo.PageFooter&&s<this.matrix.coordY.countItems-1-1)s++;if(this.matrix.linePlacement[s]==J.c.StiTableLineInfo.PageFooter){o=this.matrix.coordY.countItems-1-1;while(this.matrix.linePlacement[o]!=J.c.StiTableLineInfo.PageFooter)o--;a&&(this.sw.writeLine("{\\footerf "),this.writeFromMatrix(s,o,!0),this.sw.writeLine("}")),this.sw.writeLine("{\\footer "),this.writeFromMatrix(s,o,!0),this.sw.writeLine("}"),l=!0}else l&&this.sw.writeLine("{\\footer \\fs2 }");this.matrix=new J.c.StiMatrix(d,r,this),this.matrix.scanComponentsPlacement(!0,!0),o=this.matrix.coordY.countItems-1-1,this.currentPassNumber=Z.StiOptions.Export.RichText.divideSegmentPages?4:3,this.writeFromMatrix(0,o,!1)}else{if(this.matrix=new J.c.StiMatrix(d,r,this),this.isStopped)return;this.sw.writeLine("{"),this.currentPassNumber=Z.StiOptions.Export.RichText.divideSegmentPages?4:3,this.writeFromMatrix(0,this.matrix.coordY.countItems-1-1,!0)}this.sw.writeLine("\\pard\\fs2 \\par"),this.sw.writeLine("}")}n<i.length-1&&this.renderPageFooter(),n++}}else{this.sw.writeLine("\\nolead");for(let c of d.list){if(d.getPage(c),this.invokeExporting(c,d,this.currentPassNumber,this.maximumPassNumber),this.isStopped)return;this.renderPageHeader(c),this.sw.writeLine("{");let e=Math.round(this.pageHeight/(m/p))+2,l=[];for(let t=0;t<e;t++)l.push(new C);let h=new C;for(let o of c.components.list)if(o.enabled){let t=c.unit.convertToHInches(o.left),e=c.unit.convertToHInches(o.top),i=c.unit.convertToHInches(o.right),r=c.unit.convertToHInches(o.bottom),n=new sr;n.x=Math.round(t*this.hiToTwips*g),n.y=Math.round(e*this.hiToTwips*p),n.width=Math.round(i*this.hiToTwips*g)-n.x,n.height=Math.round(r*this.hiToTwips*p)-n.y,n.component=o,n.x++,n.y++;while(1){let t=nt.format("{0}:{1}:{2}:{3}",n.x,n.y,n.width,n.height);if(!h.contains(t)){h.set(t,t);break}n.width++}let a=n.x,s=Math.round(e/(m/p));s<0&&(s=0);while(s>l.length-1)l.push(new C);while(-1!=l[s].indexOfKey(a))a++;l[s].add(a,n)}switch(i){case J.c.StiRtfExportMode.Frame:this.sw.writeLine("\\nowidctlpar\\phmrg\\pvmrg\\nowrap");for(let o=0;o<l.length;o++)if(0<l[o].count){this.sw.write("\\pard");for(let s=0;s<l[o].count;s++){let t=l[o].getByIndex(s),e=t.component;if(0==e.width||0==e.height)continue;if(e.is(E))continue;let i=0,r=0,n=e.as(z),a=(null==n||e.is(j)||(0<(n.border.side&P.Left)&&(i+=this.frameCorrectValue,r+=this.frameCorrectValue),0<(n.border.side&P.Right)&&(r+=this.frameCorrectValue)),this.sw.flush(),this.sw.baseStream.position);this.sw.write("{"),this.sw.write(nt.format("\\nowrap\\posx{0}\\posy{1}\\absw{2}\\absh{3}",t.x+i,t.y,t.width-r,t.height)),this.renderTextAngle1(e),this.renderBorder1(e),this.renderBrush1(e),this.renderStyle12(e),this.renderHorAlign12(e),this.renderTextBrush12(e),this.renderTextFont12(e),e.is(et)&&this.renderText12(e),e.is(A)?this.renderRtf12(e,a):e.is(L)?this.renderShape1(t,i,r):this.renderImage12(e,t.width-r,t.height),this.sw.writeLine(" \\par}")}}for(let a=0;a<l.length;a++)if(0<l[a].count){this.sw.write("\\pard");for(let n=0;n<l[a].count;n++){let t=l[a].getByIndex(n),e=t.component;if(0==e.width||0==e.height)continue;if(!e.is(E))continue;let i=0,r=e.as(z);null==r||e.is(j)||0<(r.border.side&P.Left)&&(i+=this.frameCorrectValue),this.sw.write("{"),this.sw.write(nt.format("\\nowrap\\posx{0}\\posy{1}\\absw{2}\\absh{3}",t.x+i,t.y,t.width,t.height)),this.renderBorder1(e),this.sw.writeLine("\\fs0\\par}")}}break;case J.c.StiRtfExportMode.WinWord:for(let n=0;n<l.length;n++)if(0<l[n].count)for(let r=0;r<l[n].count;r++){let t=l[n].getByIndex(r),e=t.component,i=e.as(L);e.is(L)&&null!=i&&1==this.checkShape2(i)?this.renderShape2(t):(this.sw.write("{\\shp{\\*"),this.sw.write(nt.format("\\shpinst\\shpleft{0}\\shptop{1}\\shpright{2}\\shpbottom{3}",t.x,t.y,t.x+t.width,t.y+t.height)),this.sw.write("\\shpwr3"),this.sw.write("{\\sp{\\sn dxTextLeft}{\\sv 0}}"),this.sw.write("{\\sp{\\sn dyTextTop}{\\sv 0}}"),this.sw.write("{\\sp{\\sn dxTextRight}{\\sv 0}}"),this.sw.write("{\\sp{\\sn dyTextBottom}{\\sv 0}}"),this.renderBrush2(e),this.sw.write("{\\sp{\\sn fLine}{\\sv 0}}"),this.sw.write("{\\shptxt\\trowd\\trqc"),this.sw.write(nt.format("\\trrh-{0}",t.height)),this.renderVerAlign2(e),this.renderBorder2(e),this.renderTextAngle2(e),this.sw.write(nt.format("\\cellx{0}\\intbl",t.width)),this.renderHorAlign12(e),this.renderTextBrush12(e),this.renderTextFont12(e),e.is(A)||this.renderText12(e),e.is(A)?this.renderRtf12(e):this.renderImage12(e,t.width,t.height),this.sw.writeLine("\\cell\\row\\pard\\par}}}"))}break;case J.c.StiRtfExportMode.TabbedText:for(let o=0;o<l.length;o++){if(0<l[o].count&&this.sw.write("\\pard{"),0<l[o].count){let a="",s="";for(let n=0;n<l[o].count;n++){let t=l[o].getByIndex(n),e=t.component,i=t.x,r=e.as(ut);null!=r&&(0<(r.horAlignment&at.Center)&&(i=t.x+Math.round(t.width/2)-1,a+="\\tqc"),0<(r.horAlignment&at.Right))&&(i=t.x+t.width-28,a+="\\tqr"),a=(a+="\\tx")+i,s+="\\tab",this.renderBorder3(e,s),this.renderBrush3(e,s),this.renderTextFont3(e,s),this.renderTextBrush3(e,s),e.is(A)||this.renderText3(e,s),e.is(A)?this.renderRtf3(e,s):this.renderImage3(e,s,t.width,t.height)}this.sw.write(a);let e=[];for(let t=0;t<s.length;t++)e[t]=s.charCodeAt(t);this.sw.flush(),this.sw2.write(e,0,e.length)}0<l[o].count&&this.sw.writeLine("\\par}")}break}this.sw.writeLine("}"),c!=d.getByIndex(d.length-1)&&this.renderPageFooter()}}this.renderEndDoc(),this.sw.flush(),null!=this.matrix&&(this.matrix.clear(),this.matrix=null),this.colorList=null,this.fontList=null,this.styleList=null,this.unicodeMapArray=null,this.codePageToFont=null,this.fontToCodePages=null,this.imageCodec=null,this.bookmarkList=null,this.usedBookmarks=null,h.renderedPages.cacheMode&&J.c.StiMatrix.GCCollect()}}J.c.StiRtfExportService=lr}let i=J.c.StiTxtBorderType,ct=Z.System.Text.StringBuilder;{class hr extends J.c.StiExportService{constructor(){super(...arguments),this.multipleFiles=!1,this.borderCodes=[6,9,12,10,5,3,13,11,14,7,15,1,2,4,8],this.firstEscapeCodeIndex=63742,this.ltrMark=" 0E",this.useFullVerticalBorder=!0,this.useFullHorizontalBorder=!0}implements(){let t=[J.c.IStiTxtExportService];return(this.implements=()=>t)()}get defaultExtension(){return"txt"}exportTo(t,e,i){this.exportTxt(t,e,i)}get exportFormat(){return J.a.StiExportFormat.Text}get groupCategory(){return"Word"}get position(){return J.c.StiExportPosition.Txt}get exportNameInMenu(){return e.get("Export","ExportTypeTxtFile")}getFilter(){return e.get("FileFilters","TxtFiles")}getBorderChar(t,e){if(this.useFullVerticalBorder)switch(e){case i.UnicodeSingle:return"─│┌┐└┘├┤┬┴┼ ─  ".charCodeAt(t);case i.UnicodeDouble:return"═║╔╗╚╝╠╣╦╩╬ ═  ".charCodeAt(t);default:return"-|+++++++++ -  ".charCodeAt(t)}else switch(e){case i.UnicodeSingle:return"─│┌┐└┘├┤┬┴┼    ".charCodeAt(t);case i.UnicodeDouble:return"═║╔╗╚╝╠╣╦╩╬    ".charCodeAt(t);default:return"-|+++++++++    ".charCodeAt(t)}}lineFill(e,t,i,r){let n=this.borderCodes[t-1];for(let t=0;t<r;t++)-1==this.borderCodes.indexOf(e[i+t])?32==e[i+t]&&(e[i+t]=n):e[i+t]|=n}lineFillChar(e,i,r,n){for(let t=0;t<n;t++)e[r+t]=i}checkWordWrap(t,e,i,r){let a=e.ref;if(this.useEscapeCodes)for(let t=0;t<a.length;t++){let e=a[t],r=new ct(e);if(J.c.StiBidirectionalConvert.stringContainArabicOrHebrew(e)){let t=e.length;while(tt.isWhitespace(e,t-1))t--;r.insert(t,"<#ltrMark>")}let n=0;while(n<r.length){if("<"==r.charAt(n)&&n<r.length+1&&"#"==r.charAt(n+1)){let t=n,e=new ct;while("<"==r.charAt(t)&&t<r.length+1&&"#"==r.charAt(t+1)){while(t<r.length&&">"!=r.charAt(t))e.append(r.charAt(t)),t++;if(e.append(">"),++t>r.length-1)break}t>r.length-1?0<n?(n--,e.insert(0,r[n])):e.append(String.fromCharCode(65535)):(e.append(r.charAt(t)),t++);let i=this.getEscapeNumber(this.escapeCodesList,e.toString());r.remove(n,t-n),r.insert(n,String.fromCharCode(this.firstEscapeCodeIndex-i))}n++}r.length!=a[t].length&&(a[t]=r.toString())}else for(let n=0;n<a.length;n++)if(J.c.StiBidirectionalConvert.stringContainArabicOrHebrew(a[n])){let t=a[n],e=t.length-1;while(tt.isWhitespace(t,e))e--;let i=t.charAt(e)+this.ltrMark,r=this.getEscapeNumber(this.escapeCodesList,i);e==t.length-1?a[n]=t.substring(0,e)+String.fromCharCode(this.firstEscapeCodeIndex-r):a[n]=t.substring(0,e)+String.fromCharCode(this.firstEscapeCodeIndex-r)+t.substring(e+1)}let l=i,n=(this.useFullVerticalBorder?this.needVerticalBorders[t.left+t.width]&&l--:!this.useFullTextBoxWidth&&1<l&&l--,!1),s=t.component.as(ht);if(n=null!=s?s.textOptions.wordWrap:n){let o=a.slice();for(let s=0;s<o.length;s++){let a=o[s];if(a.length>l-1&&1<l){let e=it.create(Number,a.length),i=0,r=0;while(" "==a.charAt(r))e[r]=i,r++;for(let t=r;t<a.length;t++)" "==a.charAt(t)&&i++,e[t]=i;let t=l-1-1,n=t;if(0<e[t])if(e[t]!=e[t+1]){n=t++;while(" "==a.charAt(t))t++}else{while(" "!=a.charAt(t))t--;n=t++;while(" "==a.charAt(n))n--}else t++;o[s]=a.substring(0,n+1),o[Z.System.StiObject.stimulsoft]().insert(s+1,a.substr(t,a.length-t))}}o.length>a.length&&(a=o)}if(r)for(let t=0;t<a.length;t++)a[t].length>l&&(a[t]=a[t].substring(0,l));e.ref=a}checkGrow(t,e,i){while(t.length<=i)t.push([]),e.push(!1)}addCharsToLine(e,i,r,n){for(let t=0;t<r;t++)e[i].push(n)}getStyleNumber(i,r){if(0<i.length)for(let e=0;e<i.length;e++){let t=i[e];if(t.Bold==r.Bold&&t.Italic==r.Italic&&t.Underline==r.Underline&&t.Codes==r.Codes)return e}i.push(r);let t=i.length-1;return t}getEscapeNumber(e,i){if(0<e.length)for(let t=0;t<e.length;t++)if(e[t]==i)return t+1;e.push(i);let t=e.length;return t}getEscapeNames(t,e){let i=this.styleList[t],r=this.styleList[e],n=new ct;return!i.Bold&&r.Bold&&n.append("<#b>"),i.Bold&&!r.Bold&&n.append("<#/b>"),!i.Italic&&r.Italic&&n.append("<#i>"),i.Italic&&!r.Italic&&n.append("<#/i>"),!i.Underline&&r.Underline&&n.append("<#u>"),i.Underline&&!r.Underline&&n.append("<#/u>"),n}exportTxt(t,e,i){if(null==Z.Base[["St","iL","ic","en","se"].join("")].key&&console.warn("You are using a trial version of the Stimulsoft product!"),J.a.StiLogService.write(this[Z.System.StiObject.stimulsoft]().getType(),"Export report to Text format"),this.report=t,null==i)throw new Error("The 'settings' argument cannot be equal in null.");let r=i.pageRange,n=i.encoding,a=i.drawBorder,s=i.borderType,o=i.killSpaceLines,l=i.killSpaceGraphLines,h=i.putFeedPageCode,u=i.cutLongLines,c=i.zoomX,m=i.zoomY,g=(this.useEscapeCodes=i.useEscapeCodes,this.useFullTextBoxWidth=Z.StiOptions.Export.Text.useFullTextBoxWidth,this.useFullVerticalBorder=Z.StiOptions.Export.Text.useFullVerticalBorder,this.useFullHorizontalBorder=Z.StiOptions.Export.Text.useFullHorizontalBorder,9.7),p=18,d=(0==o&&(l=!1),0==a&&(l=!1),this.useFullVerticalBorder&&(this.useFullTextBoxWidth=!1),new K),w=null!=n?new W(d,n):new W(d),S=r.getSelectedPages(t.renderedPages),f=0,b=(this.styleList=[],new cr),E=(this.getStyleNumber(this.styleList,b),this.escapeCodesList=[],this.currentPassNumber=0,this.maximumPassNumber=3,new J.c.StiMatrix(S,!1,this));if(this.isStopped)return;this.needVerticalBorders=it.create(Boolean,E.coordX.countItems);for(let i=1;i<E.coordX.countItems;i++){let e=!1;for(let t=1;t<E.coordY.countItems;t++)if(null!=E.bordersY.gett(t-1,i)){e=!0;break}this.needVerticalBorders[i-1]=e}this.needHorizontalBorders=it.create(Boolean,E.coordY.countItems);for(let i=1;i<E.coordY.countItems;i++){let e=!1;for(let t=1;t<E.coordX.countItems;t++)if(null!=E.bordersX.gett(i,t-1)){e=!0;break}this.needHorizontalBorders[i-1]=e}let v=E.coordX.getKeys(),y=E.coordY.getKeys(),x=it.create(Number,E.coordX.countItems);for(let i=1;i<E.coordX.countItems;i++){let t=E.coordX.getByIndex(i,v),e=E.coordX.getByIndex(i-1,v);x[i-1]=Math.round((t-e)/(g/c)),this.useFullVerticalBorder&&this.needVerticalBorders[i-1]&&x[i-1]++}let A=it.create2(Boolean,E.coordY.countItems,E.coordX.countItems),T=it.create2(Number,E.coordY.countItems,E.coordX.countItems),F=it.create2(Number,E.coordY.countItems,E.coordX.countItems);for(let s=1;s<E.coordY.countItems;s++)for(let a=1;a<E.coordX.countItems;a++)if(!A[s-1][a-1]){let n=E.cells.gett(s-1,a-1);if(T[s-1][a-1]=x[a-1],null!=n){if(0<n.width)for(let t=0;t<n.width;t++)T[s-1][a-1]+=x[a-1+1+t];if(null!=n.component){if(null!=n.component){let e=n.component.tagValue;if(!nt.isNullOrWhiteSpace(e)){e=e.trim();let t=parseInt(e);!isNaN(t)&&0<t&&(T[s-1][a-1]=t,this.useFullVerticalBorder)&&this.needVerticalBorders[a-1+n.width]&&T[s-1][a-1]++}}let r=n.text,i=n.component.as(gt);if(null!=i&&null!=i.checkedValue){let t=!1,e=!1;"boolean"==typeof i.checkedValue&&(i.checkedValue?t=!0:e=!0),"string"==typeof i.checkedValue&&("True"==i.checkedValue?t=!0:e=!0),t&&(r=Z.StiOptions.Export.Text.checkBoxTextForTrue),e&&(r=Z.StiOptions.Export.Text.checkBoxTextForFalse)}if(!n.component.isExportAsImage(J.a.StiExportFormat.Text)&&!nt.isNullOrEmpty(r)){if(n.component.is(et)&&n.component.checkAllowHtmlTags()){let t=new U(""),e=G.parseHtmlToStates(r,t),i=new ct;for(let t of e)i.append(G.prepareStateText(t.text));r=i.toString()}let t=J.c.StiExportUtils.splitString(r[Z.System.StiObject.stimulsoft]().replaceAll("\r",""),!1),e={ref:t},i=(this.checkWordWrap(n,e,T[s-1][a-1],u),(t=e.ref).length);F[s-1][a-1]=i}}for(let e=0;e<=n.height;e++){for(let t=0;t<=n.width;t++)A[s-1+e][a-1+t]=!0;T[s-1+e][a-1]=T[s-1][a-1]}}}let C=it.create(Number,E.coordY.countItems);for(let r=f=1;r<E.coordY.countItems;r++){let t=E.coordY.getByIndex(r,y),e=E.coordY.getByIndex(r-1,y),i=Math.round((t-e)/(p/m));i<1&&(i=1);for(let e=1;e<E.coordX.countItems;e++){let t=E.cells.gett(r-1,e-1);null!=t&&t.height<1&&F[r-1][e-1]>i&&(i=F[r-1][e-1])}this.useFullHorizontalBorder&&this.needHorizontalBorders[r-1]&&i++,C[r-1]=i,f+=i}f++;let P=[],L=[],k=[];for(let t=0;t<f;t++)P.push([]),L.push([]),k.push(!1);A=it.create2(Boolean,E.coordY.countItems,E.coordX.countItems);let B=a?1:0,D=new et;D.vertAlignment=st.Center,D.horAlignment=at.Center,this.currentPassNumber=2;for(let w=1;w<E.coordY.countItems;w++){this.invokeExporting2(w,E.coordY.countItems,this.currentPassNumber,this.maximumPassNumber);for(let t=0;t<E.horizontalPageBreaks.length;t++)E.horizontalPageBreaks[t]==w-1&&(k[B-(a&&1<w&&this.needHorizontalBorders[w-1-1]?1:0)]=!0);let d=a?1:0;for(let p=1;p<E.coordX.countItems;p++){let c=E.cells.gett(w-1,p-1),m=T[w-1][p-1],g=C[w-1];if(!A[w-1][p-1]){let s=0,o=0,i=0;if(null!=c){s=c.width,o=c.height;for(let e=0;e<=c.width;e++)for(let t=0;t<=c.height;t++)A[w-1+t][p-1+e]=!0;if(0<c.height)for(let t=0;t<c.height;t++)g+=C[w-1+1+t];if(this.useFullHorizontalBorder&&this.needHorizontalBorders[w-1+o]&&g--,null!=c.component){let e=c.component.as(et);if(null!=e){let t=new cr;t.Bold=e.font.bold,t.Italic=e.font.italic,t.Underline=e.font.underline,t.Codes=null,i=this.getStyleNumber(this.styleList,t)}let r=c.text,h=c.component.as(gt);if(null!=h&&null!=h.checkedValue){let t=!1,e=!1;"boolean"==typeof h.checkedValue&&(h.checkedValue?t=!0:e=!0),"string"==typeof h.checkedValue&&("True"==h.checkedValue?t=!0:e=!0),t&&(r=Z.StiOptions.Export.Text.checkBoxTextForTrue),e&&(r=Z.StiOptions.Export.Text.checkBoxTextForFalse)}if(!c.component.isExportAsImage(J.a.StiExportFormat.Text)&&!nt.isNullOrEmpty(r)){if(c.component.is(et)&&c.component.checkAllowHtmlTags()){let t=new U(""),e=G.parseHtmlToStates(r,t),i=new ct;for(let t of e)i.append(G.prepareStateText(t.text));r=i.toString()}let o=J.c.StiExportUtils.splitString(r[Z.System.StiObject.stimulsoft]().replaceAll("\r",""),!1),t={ref:o},l=(this.checkWordWrap(c,t,T[w-1][p-1],u),o=t.ref,0),e=c.component.as(St);null!=(e=null!=h?D:e)&&o.length<g&&(0<(e.vertAlignment&st.Center)&&(l=$.trunc((g-o.length)/2)),0<(e.vertAlignment&st.Bottom))&&(l=g-o.length);for(let s=0;s<o.length;s++){let t=0,e=m,i=(this.useFullVerticalBorder?this.needVerticalBorders[c.left+c.width]&&e--:!this.useFullTextBoxWidth&&1<e&&e--,c.component.as(ut)),r=(null!=(i=null!=h?D:i)&&(i.horAlignment==at.Center&&(t=$.trunc((e-o[s].length)/2)),i.horAlignment==at.Right)&&(t=e-o[s].length),d+t),n=B+l+s,a=(r=r<0?0:r)+o[s].length;this.checkGrow(P,k,n),P[n].length<a&&this.addCharsToLine(P,n,a-P[n].length,32);for(let e=0;e<o[s].length;e++){let t=o[s].charCodeAt(e);t<32&&(t+=65280),P[n][r+e]=t}}}}}else this.useFullHorizontalBorder&&this.needHorizontalBorders[w-1]&&g--;this.useFullHorizontalBorder||g--;for(let e=0;e<g;e++){L[B+e].length<d+m&&this.addCharsToLine(L,B+e,d+m-L[B+e].length,0);let t=m;this.useFullVerticalBorder?null!=c&&this.needVerticalBorders[c.left+c.width]&&t--:!this.useFullTextBoxWidth&&1<t&&t--,this.lineFillChar(L[B+e],i,d,t)}if(a){let e=d+m-1;for(let t=-1;t<=g;t++)this.checkGrow(P,k,B+t),P[B+t].length<e+1&&this.addCharsToLine(P,B+t,e+1-P[B+t].length,32);let i=!0,r=!0;for(let t=0;t<o+1;t++)null==E.bordersY.gett(w-1+t,p-1)&&(i=!1),null==E.bordersY.gett(w-1+t,p-1+s+1)&&(r=!1);let n=!0,a=!0;for(let t=0;t<s+1;t++)null==E.bordersX.gett(w-1,p-1+t)&&(n=!1),null==E.bordersX.gett(w-1+o+1,p-1+t)&&(a=!1);if(n&&(this.lineFill(P[B-1],14,d-1,1),this.lineFill(P[B-1],1,d,m-1),this.lineFill(P[B-1],13,d+m-1,1)),i){this.lineFill(P[B-1],15,d-1,1);for(let t=0;t<g;t++)this.lineFill(P[B+t],2,d-1,1);this.lineFill(P[B+g],12,d-1,1)}if(r){this.lineFill(P[B-1],15,d+m-1,1);for(let t=0;t<g;t++)this.lineFill(P[B+t],2,d+m-1,1);this.lineFill(P[B+g],12,d+m-1,1)}a&&(this.lineFill(P[B+g],14,d-1,1),this.lineFill(P[B+g],1,d,m-1),this.lineFill(P[B+g],13,d+m-1,1))}}d+=m}B+=C[w-1]}if(a){let e=!0;for(let t=0;t<P.length;t++)if(0<P[t].length&&32!=P[t][0]){e=!1;break}if(e)for(let t=0;t<P.length;t++)0<P[t].length&&P[t][Z.System.StiObject.stimulsoft]().removeRange(0,1),0<L[t].length&&L[t][Z.System.StiObject.stimulsoft]().removeRange(0,1)}if(!(Z.Base.vAeXc.eMAio.UUyjq()||Z.Base.vAeXc.eMAio.lAtWS()||(Z.Base.vAeXc.eMAio.rdCzm()||Z.Base.vAeXc.eMAio.CWsHL()||Z.Base.vAeXc.eMAio.tnNVR())&&Z.System.NodeJs.isStandaloneVersion)){let t=(E.coordX.getByIndex(E.coordX.countItems-1,v)-E.coordX.getByIndex(0,v))/(g/c),e=Math.max(1,$.trunc(t/2-10));w.writeLine(nt.fill(" ",e)+"---=== TRIAL ===---\r\n")}let I=P.length-1;while(0<I&&0==P[I].length)I--;let R=0;for(let n=0;n<P.length;n++){if(0<P[n].length){for(let t=0;t<this.borderCodes.length;t++){let e=this.borderCodes[t],i=this.getBorderChar(t,s);for(let t=0;t<P[n].length;t++)P[n][t]==e&&(P[n][t]=i)}if(Z.StiOptions.Export.Text.trimTrailingSpaces,l){let i=this.getBorderChar(1,s),r=!0;for(let e=0;e<P[n].length;e++){let t=P[n][e];t!=i&&32!=t&&(r=!1)}r&&(P[n]=[])}h&&k[n]&&(this.useEscapeCodes&&w.write(this.getEscapeNames(R,0).toString()),R=0,w.write("\f")),this.useEscapeCodes}let r=P[n];if(!o&&n<=I||0<r.length){let t=r.length;if(Z.StiOptions.Export.Text.trimTrailingSpaces)while(0<t&&32==r[t-1])t--;let i="";for(let e=0;e<t;e++){let t=r[e];65280<=t&&(t-=65280),i+=String.fromCharCode(t)}Z.StiOptions.Export.Text.removeLastNewLineMarker&&n==I?w.write(i):w.writeLine(i)}}let N=new ct;this.useEscapeCodes&&N.append(this.getEscapeNames(R,0)),h&&N.append("\f"),0<N.length&&w.write(N.toString()),w.flush(),this.useEscapeCodes,d.writeTo(e),d.close(),this.needVerticalBorders=null,this.needHorizontalBorders=null,this.styleList=null,this.escapeCodesList=null}}J.c.StiTxtExportService=hr;class cr{}}let xt=J.a.Components.StiRectanglePrimitive,l=Z.System.Globalization.UnicodeCategory,h=Z.Base.Drawing.StiTextOptions,At=Z.Base.Drawing.RectangleD,Tt=Z.Base.Drawing.StiTextDrawing,Ft=Z.Base.Drawing.StiGradientBrush,Ct=J.a.Components.StiContainer;{class mr{get right(){return this.x+this.width}get bottom(){return this.y+this.height}}class gr extends J.c.StiExportService{constructor(){super(...arguments),this.defaultExtension="xps",this.groupCategory="Document",this.position=J.c.StiExportPosition.Xps,this.exportNameInMenu=e.get("Export","ExportTypeXpsFile"),this.multipleFiles=!1,this.hiToDpi=96/100,this.xmlIndentation=1,this.precision_digits=3,this.reduceFontSize=!0,this.useImageComparer=!0,this.imageQuality=.75,this.imageResolution=96,this.fontCorrectValue=1.333333*this.hiToDpi,this.exportRtfTextAsImage=!0}get exportFormat(){return J.a.StiExportFormat.Xps}exportTo(t,e,i){this.exportXps(t,e,i),this.invokeExporting2(100,100,1,1)}exportToAsync(e,i,t,r){setTimeout(async()=>{try{await J.c.StiExportImageHelper.convertAllImages(i,Z.System.Drawing.Imaging.ImageFormat.Jpeg,!1,this.exportFormat),this.exportTo(i,t,r),null!=i&&null!=i.preparedExportImages&&(i.preparedExportImages.clear(),i.preparedExportImages=null)}catch(t){if(o.log(t,i,`Export Error`).isImportant)return e(o.getMessage(t))}e()},0)}getFilter(){return e.get("FileFilters","XpsFiles")}isWordWrapSymbol(t,e){let i=" ";return e<t.length-1&&(i=t[e+1]),this.isWordWrapSymbol2(t[e],i)}isWordWrapSymbol2(t,e){let i=tt.getUnicodeCategory(t),r=tt.getUnicodeCategory(e);return i==l.OpenPunctuation||i==l.ClosePunctuation&&r!=l.OtherPunctuation||i==l.DashPunctuation||i==l.InitialQuotePunctuation||i==l.FinalQuotePunctuation||i==l.SpaceSeparator}floatToString(t){let e=this.precision_digits,i=(Math.abs(t)<1&&(e=this.precision_digits+2),$.round2(t,e));return Z.System.Internals.formatNumber(i,"G")}prepareData(){this.pdfFont=new J.c.PdfFonts,this.pdfFont.standardPdfFonts=!1,this.pdfFont.maxSymbols=32767,this.pdfFont.fontList=[],this.imageCache=new J.a.StiImageCache(this.useImageComparer,!0,s.Jpeg,this.imageQuality)}getTabsSize(t,e,i){if(null==t||null==t.textOptions)return 0;let r=i,n=750/e,a=n*t.textOptions.distanceBetweenTabs,s=n*t.textOptions.firstTabOffset+a;if(i<s)r=s;else if(0<t.textOptions.distanceBetweenTabs){let t=Math.trunc((i-s)/a);t++,r=s+t*a}return r-i}static convertToEscapeSequence(i){let r=""+String.fromCharCode(13)+String.fromCharCode(10)+String.fromCharCode(8)+String.fromCharCode(12),n="rnbf",a,s;if(null==i)return"";s="";for(let e=0;e<i.length;e++){a=!1;for(let t=0;t<r.length;t++)if(i[e]==r[t]){s+="\\"+n[t],a=!0;break}a||(s+=i[e])}return s}getLineStyleDash(t){switch(t){case ot.Dot:return"1.1 1.1";case ot.Dash:return"3 1";case ot.DashDot:return"3 1 1 1";case ot.DashDotDot:return"3 1 1 1 1 1";default:return""}}checkGraphicsForTextRenderer(){}writeContentTypes(){let t=new K,e=new w(u.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?d.None:d.Indented,e.writeStartDocument(),e.writeStartElement("Types"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/content-types"),e.writeStartElement("Default"),e.writeAttributeString("Extension","jpg"),e.writeAttributeString("ContentType","image/jpeg"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","png"),e.writeAttributeString("ContentType","image/png"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","rels"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-package.relationships+xml"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","xml"),e.writeAttributeString("ContentType","application/xml"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","fdseq"),e.writeAttributeString("ContentType","application/vnd.ms-package.xps-fixeddocumentsequence+xml"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","fpage"),e.writeAttributeString("ContentType","application/vnd.ms-package.xps-fixedpage+xml"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","ttf"),e.writeAttributeString("ContentType","application/vnd.ms-opentype"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","fdoc"),e.writeAttributeString("ContentType","application/vnd.ms-package.xps-fixeddocument+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/docProps/core.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-package.core-properties+xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeMainRels(){let t=new K,e=new w(u.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?d.None:d.Indented,e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId1"),e.writeAttributeString("Type","http://schemas.microsoft.com/xps/2005/06/fixedrepresentation"),e.writeAttributeString("Target","FixedDocSeq.fdseq"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId2"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties"),e.writeAttributeString("Target","docProps/core.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeDocPropsCore(t){let e=new K,i=new w(u.UTF8,e),r=(i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?d.None:d.Indented,i.writeStartDocument(),i.writeStartElement("cp:coreProperties"),i.writeAttributeString("xmlns:cp","http://schemas.openxmlformats.org/package/2006/metadata/core-properties"),i.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),i.writeAttributeString("xmlns:dcterms","http://purl.org/dc/terms/"),i.writeAttributeString("xmlns:dcmitype","http://purl.org/dc/dcmitype/"),i.writeAttributeString("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance"),_.now.toString("yyyy-MM-ddTHH:mm:ssZ"));return i.writeStartElement("dcterms:created"),i.writeAttributeString("xsi:type","dcterms:W3CDTF"),i.writeString(r),i.writeEndElement(),i.writeStartElement("dcterms:modified"),i.writeAttributeString("xsi:type","dcterms:W3CDTF"),i.writeString(r),i.writeEndElement(),nt.isNullOrEmpty(t.reportName)||i.writeElementString("dc:title",t.reportName),nt.isNullOrEmpty(t.reportAlias)||i.writeElementString("dc:subject",t.reportAlias),nt.isNullOrEmpty(t.reportDescription)||i.writeElementString("dc:description",t.reportDescription),i.writeElementString("dc:creator",J.c.StiExportUtils.getReportVersion(t)),i.writeFullEndElement(),i.writeEndDocument(),i.flush(),e}writeFixedDocSeq(){let t=new K,e=new w(u.Unicode,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?d.None:d.Indented,e.writeStartElement("FixedDocumentSequence"),e.writeAttributeString("xmlns","http://schemas.microsoft.com/xps/2005/06"),e.writeStartElement("DocumentReference"),e.writeAttributeString("Source","/Documents/1/FixedDoc.fdoc"),e.writeEndElement(),e.writeFullEndElement(),e.flush(),t}writeFixedDoc(t){let e=new K,r=new w(u.Unicode,e);r.indentation=this.xmlIndentation<0?0:this.xmlIndentation,r.formatting=this.xmlIndentation<0?d.None:d.Indented,r.writeStartElement("FixedDocument"),r.writeAttributeString("xmlns","http://schemas.microsoft.com/xps/2005/06");for(let i=0;i<t.length;i++){r.writeStartElement("PageContent"),r.writeAttributeString("Source",`Pages/${i+1}.fpage`);let e=[];for(let t of this.pageBookmarks.keys)this.pageBookmarks.get(t).value==i&&e.push(t);if(0<e.length){r.writeStartElement("PageContent.LinkTargets");for(let t of e)r.writeStartElement("LinkTarget"),r.writeAttributeString("Name",t),r.writeEndElement();r.writeFullEndElement()}r.writeFullEndElement()}return r.writeFullEndElement(),r.flush(),e}writePage(e,s){let t=new K,o=new w(u.Unicode,t),r=(o.indentation=this.xmlIndentation<0?0:this.xmlIndentation,o.formatting=this.xmlIndentation<0?d.None:d.Indented,this.hiToDpi*s.unit.convertToHInches(e.pageHeight*e.segmentPerHeight)),n=this.hiToDpi*s.unit.convertToHInches(e.pageWidth*e.segmentPerWidth),l=this.hiToDpi*s.unit.convertToHInches(e.margins.left),i=this.hiToDpi*s.unit.convertToHInches(e.margins.right),h=this.hiToDpi*s.unit.convertToHInches(e.margins.top),a=this.hiToDpi*s.unit.convertToHInches(e.margins.bottom);if(o.writeStartElement("FixedPage"),o.writeAttributeString("xmlns","http://schemas.microsoft.com/xps/2005/06"),o.writeAttributeString("Width",this.floatToString(n)),o.writeAttributeString("Height",this.floatToString(r)),o.writeAttributeString("xml:lang","en-EN"),o.writeStartElement("Canvas"),this.writeHyperlinksData(o,e,!1),null!=e.brush){let t=new mr;t.x=0,t.y=0,t.width=n,t.height=r,t.component=new Ct,t.component.brush=e.brush,t.component.border=null,this.writeBorderFill(o,t)}this.writeWatermark(o,e.watermark,!0,n,r);for(let a of e.components.list){let t=0<a.width&&0<a.height;if(a.enabled&&t){let t=this.hiToDpi*s.unit.convertToHInches(a.left),e=this.hiToDpi*s.unit.convertToHInches(a.top),i=this.hiToDpi*s.unit.convertToHInches(a.right),r=this.hiToDpi*s.unit.convertToHInches(a.bottom),n=new mr;n.x=t,n.y=e,n.width=i-t,n.height=r-e,n.y+=h,n.x+=l,(n.component=a).is(L)||this.writeBorderFill(o,n),a.is(et)&&!a.isExportAsImage(J.a.StiExportFormat.Xps)&&this.writeText(o,n),a.isExportAsImage(J.a.StiExportFormat.Xps)&&this.writeImage(o,n),this.writeBorderStroke(o,n)}}if(null!=e.border){let t=new mr;t.x=l,t.y=h,t.width=n-l-i,t.height=r-h-a,t.component=new Ct,t.component.border=e.border,this.writeBorderStroke(o,t)}if(this.writeWatermark(o,e.watermark,!1,n,r),!(Z.Base.vAeXc.eMAio.UUyjq()||Z.Base.vAeXc.eMAio.lAtWS()||(Z.Base.vAeXc.eMAio.rdCzm()||Z.Base.vAeXc.eMAio.CWsHL()||Z.Base.vAeXc.eMAio.tnNVR())&&Z.System.NodeJs.isStandaloneVersion)){let t=n/794*1.75,e=r/1123*1.75,i=(t>e?t=e:e=t,o.writeStartElement("Canvas"),o.writeAttributeString("RenderTransform",nt.format("{0},0,0,{1},{2},{3}",this.floatToString(t),this.floatToString(e),this.floatToString(n/2),this.floatToString(r/2))),o.writeStartElement("Canvas"),o.writeAttributeString("RenderTransform","0.707,-0.707,0.707,0.707,0,0"),o.writeStartElement("Path"),o.writeAttributeString("Stroke",nt.format("#{0:X8}",1080321124)),o.writeAttributeString("StrokeThickness",this.floatToString(15)),o.writeAttributeString("StrokeStartLineCap","Round"),o.writeAttributeString("StrokeEndLineCap","Round"),o.writeAttributeString("StrokeLineJoin","Round"),"");i=(i=(i+="M 40,0 L 40,100 M 0,100 L 80,100 ")+"M 100,0 L 100,70 M 100,45 L 120,65 L 130,72 L 140,68 "+"M 170,0 L 170,70 M 169,100 L 171,100 ")+"M 215,60 L 222,69 L 232,71 L 255,70 L 265,60 L 265,5 L 270,0 M 265,44 L 220,31 L 212,20 L 212,10 L 225,0 L 235,0 L 250,5 L 265,18 "+"M 310,0 L 310,100 ",o.writeAttributeString("Data",i),o.writeAttributeString("RenderTransform","1,0,0,-1,-155,50"),o.writeFullEndElement(),o.writeFullEndElement(),o.writeFullEndElement()}return o.writeEndElement(),o.writeFullEndElement(),o.flush(),t}writeBorderFill(u,S){let t=rt.transparent,f=S.component.as(N),e=(null!=f&&null!=f.brush&&(t=lt.toColor(f.brush)),S.component.as(A));if(0!=(t=null!=e?e.backColor:t).a){if(u.writeStartElement("Path"),u.writeAttributeString("Data",nt.format("M {0},{1} L {0},{3} L {2},{3} L {2},{1} Z ",this.floatToString(S.x),this.floatToString(S.y),this.floatToString(S.x+S.width),this.floatToString(S.y+S.height))),S.component.is(et)||S.component.is(Q)||this.writeHyperlinksData(u,S.component,!1),u.writeStartElement("Path.Fill"),null!=f&&null!=f.brush&&f.brush.is(Ft)){let t=f.brush,e=1,i=1,r=t.angle,n=(r<0&&(r+=360),270<=r&&r<360&&(r=360-r,i=-1),180<=r&&r<270&&(r-=180,i=-1,e=-1),90<=r&&r<180&&(r=180-r,e=-1),r=r*Math.PI/180,S.x+S.width/2),a=S.y+S.height/2,s=Math.sqrt(S.width*S.width+S.height*S.height)/2,o=Math.atan2(S.height,S.width),l=Math.PI/2-r+o,h=s*Math.sin(l),c=h*Math.cos(r)*e,m=h*Math.sin(r)*i,g=n-c,p=n+c,d=a-m,w=a+m;u.writeStartElement("LinearGradientBrush"),u.writeAttributeString("MappingMode","Absolute"),u.writeAttributeString("StartPoint",this.floatToString(g)+`,`+this.floatToString(d)),u.writeAttributeString("EndPoint",this.floatToString(p)+`,`+this.floatToString(w)),u.writeStartElement("LinearGradientBrush.GradientStops"),u.writeStartElement("GradientStop"),u.writeAttributeString("Color",nt.format("#{0:X8}",t.startColor.toArgb())),u.writeAttributeString("Offset","0"),u.writeEndElement(),u.writeStartElement("GradientStop"),u.writeAttributeString("Color",nt.format("#{0:X8}",t.endColor.toArgb())),u.writeAttributeString("Offset","1"),u.writeEndElement(),u.writeEndElement()}else u.writeStartElement("SolidColorBrush"),u.writeAttributeString("Color",nt.format("#{0:X8}",t.toArgb()));u.writeEndElement(),u.writeEndElement(),u.writeFullEndElement()}else!this.writeHyperlinksData(u,S.component,!0)||S.component.is(et)||S.component.is(Q)||(u.writeStartElement("Path"),u.writeAttributeString("Data",nt.format("M {0},{1} L {0},{3} L {2},{3} L {2},{1} Z ",this.floatToString(S.x),this.floatToString(S.y),this.floatToString(S.x+S.width),this.floatToString(S.y+S.height))),this.writeHyperlinksData(u,S.component,!1),u.writeEndElement())}writeBorderStroke(i,r){let n=r.component.as(z);if(null==n)return;if(n.border.dropShadow&&null!=n.border.shadowBrush){let e=lt.toColor(n.border.shadowBrush);if(0!=e.a){let t=n.border.shadowSize;i.writeStartElement("Path"),i.writeAttributeString("Data",nt.format("M {0},{4} L {1},{4} L {1},{3} L {2},{3} L {2},{5} L {0},{5} Z ",this.floatToString(r.x+t),this.floatToString(r.x+r.width),this.floatToString(r.x+r.width+t),this.floatToString(r.y+t),this.floatToString(r.y+r.height),this.floatToString(r.y+r.height+t))),i.writeStartElement("Path.Fill"),i.writeStartElement("SolidColorBrush"),i.writeAttributeString("Color",nt.format("#{0:X8}",e.toArgb())),i.writeEndElement(),i.writeEndElement(),i.writeFullEndElement()}}let a=n.border.as(ft),s=null!=a,t=new xt,o=(r.component.is(xt)&&(t=r.component),n.border.isLeftBorderSidePresent&&t.leftSide),l=n.border.isRightBorderSidePresent&&t.rightSide,h=n.border.isTopBorderSidePresent&&t.topSide,c=n.border.isBottomBorderSidePresent&&t.bottomSide,e=n.border.side!=P.None&&n.border.style!=ot.None,m=(s&&(e=a.side!=P.None),.9),g=new T(n.border.color,n.border.size,n.border.style),p=0;if(g.style==ot.Double&&(p=m),e){let e="";if(o){s&&(g=a.leftSide,p=g.style==ot.Double?m:0);let t=nt.format("M {0},{1} L {2},{3} ",this.floatToString(r.x-p),this.floatToString(r.y-p),this.floatToString(r.x-p),this.floatToString(r.y+p+r.height));g.style==ot.Double&&(t+=nt.format("M {0},{1} L {2},{3} ",this.floatToString(r.x+p),this.floatToString(r.y+(h?p:-p)),this.floatToString(r.x+p),this.floatToString(r.y+(c?-p:p)+r.height))),s?this.writeBorderSide(i,g,t):e+=t}if(l){s&&(g=a.rightSide,p=g.style==ot.Double?m:0);let t=nt.format("M {0},{1} L {2},{3} ",this.floatToString(r.x+p+r.width),this.floatToString(r.y-p),this.floatToString(r.x+p+r.width),this.floatToString(r.y+p+r.height));g.style==ot.Double&&(t+=nt.format("M {0},{1} L {2},{3} ",this.floatToString(r.x-p+r.width),this.floatToString(r.y+(h?p:-p)),this.floatToString(r.x-p+r.width),this.floatToString(r.y+(c?-p:p)+r.height))),s?this.writeBorderSide(i,g,t):e+=t}if(h){s&&(g=a.topSide,p=g.style==ot.Double?m:0);let t=nt.format("M {0},{1} L {2},{3} ",this.floatToString(r.x-p),this.floatToString(r.y-p),this.floatToString(r.x+p+r.width),this.floatToString(r.y-p));g.style==ot.Double&&(t+=nt.format("M {0},{1} L {2},{3} ",this.floatToString(r.x+(o?p:-p)),this.floatToString(r.y+p),this.floatToString(r.x+(l?-p:p)+r.width),this.floatToString(r.y+p))),s?this.writeBorderSide(i,g,t):e+=t}if(c){s&&(g=a.bottomSide,p=g.style==ot.Double?m:0);let t=nt.format("M {0},{1} L {2},{3} ",this.floatToString(r.x-p),this.floatToString(r.y+p+r.height),this.floatToString(r.x+p+r.width),this.floatToString(r.y+p+r.height));g.style==ot.Double&&(t+=nt.format("M {0},{1} L {2},{3} ",this.floatToString(r.x+(o?p:-p)),this.floatToString(r.y-p+r.height),this.floatToString(r.x+(l?-p:p)+r.width),this.floatToString(r.y-p+r.height))),s?this.writeBorderSide(i,g,t):e+=t}s||this.writeBorderSide(i,new T(n.border.color,n.border.size,n.border.style),e)}}writeBorderSide(t,e,i){let r=e.size,n=.9*(r=e.style==ot.Double?1:r),a=e.color,s=this.getLineStyleDash(e.style);t.writeStartElement("Path"),t.writeAttributeString("Stroke",nt.format("#{0:X8}",a.toArgb())),t.writeAttributeString("StrokeThickness",n.toString()),t.writeAttributeString("StrokeStartLineCap","Square"),t.writeAttributeString("StrokeEndLineCap","Square"),""!=s&&(t.writeAttributeString("StrokeDashArray",s),t.writeAttributeString("StrokeDashCap","Flat")),t.writeAttributeString("Data",i),t.writeFullEndElement()}writeHyperlinksData(e,i,r){let n=!1;if(null!=i.bookmarkValue&&""!=i.bookmarkValue){let t=J.a.StiNameValidator.correctName(i.bookmarkValue.toString(),null,this.report);r||this.pageBookmarks.containsKey(t)||(e.writeAttributeString("Name",t),this.pageBookmarks.set(t,this.indexPage)),n=!0}if(null!=i.hyperlinkValue&&0<i.hyperlinkValue.toString().trim().length&&!i.hyperlinkValue.toString().trim().startsWith("javascript:")){let t=i.hyperlinkValue.toString().trim();r||(t.startsWith("#")?(t=J.a.StiNameValidator.correctName(t.substr(1),null,this.report),e.writeAttributeString("FixedPage.NavigateUri",`../FixedDoc.fdoc#`+t)):e.writeAttributeString("FixedPage.NavigateUri",t)),n=!0}return n}writeText(A,T){let F=T.component.as(bt),C=T.component.as(et),P=T.component.as(dt),L=T.component.as(wt),k=T.component.as(ht),B=T.component.as(ut),D=T.component.as(St),I=null!=k&&k.textOptions.wordWrap,R=null!=B&&B.horAlignment==at.Width,N=null!=k&&null!=k.textOptions&&k.textOptions.rightToLeft,M=0,O=0,H=0,W=0;if(null!=P&&(H=this.pdfFont.getFontNumber(P.font),W=P.font.sizeInPoints*this.fontCorrectValue,this.pageFonts.set(H,H)),null!=F){let p=rt.transparent,d=(null!=L&&(p=lt.toColor(L.textBrush)),1),t=(null!=P&&(d=P.font.sizeInPoints),J.a.StiDpiHelper.graphicsScale),e=d*this.fontCorrectValue*this.pdfFont.tmASC/1e3*t,i=d*this.fontCorrectValue*this.pdfFont.tmDESC/1e3*-1*t,r=d*this.fontCorrectValue*this.pdfFont.tmExternal/1e3*t,a=d*this.fontCorrectValue*this.pdfFont.UnderscoreSize/1e3*t,s=d*this.fontCorrectValue*this.pdfFont.UnderscorePosition/1e3*t,o=d*this.fontCorrectValue*this.pdfFont.StrikeoutSize/1e3*t,l=d*this.fontCorrectValue*this.pdfFont.StrikeoutPosition/1e3*t,w=(e-i+r)*C.lineSpacing,c=e,n=i,h=C.margins.left,m=C.margins.right,g=C.margins.top,u=C.margins.bottom,S=T.x+h,f=T.y+u,b=T.width-h-m,E=T.height-g-u,v=2,y=1,x=(S+=v,b-=2*v,f+=y,E-=2*y,F.text);if(x=x[Z.System.StiObject.stimulsoft]().replaceAll("\r",""),0<b&&0<x.length){A.writeStartElement("Canvas"),A.writeAttributeString("Clip",nt.format("M {0},{1} L {0},{3} L {2},{3} L {2},{1} Z ",this.floatToString(T.x),this.floatToString(T.y),this.floatToString(T.x+T.width),this.floatToString(T.y+T.height))),this.writeHyperlinksData(A,T.component,!1);let m=null;if(R){let t=C.page.unit.convertRectangleToHInches(T.component.componentToPage(T.component.clientRectangle));t=C.convertTextMargins(t,!1),(t=C.convertTextBorders(t,!1)).width/=J.a.StiDpiHelper.deviceCapsScale,t.height/=J.a.StiDpiHelper.deviceCapsScale,this.checkGraphicsForTextRenderer(),m=Tt.splitTextWordwrapWidth(x,null,C.font,t),I=!1}else m=J.c.StiExportUtils.splitString(x,!0);M=m.length;let e=S,i=f,r=b,n=E;if(null!=k&&0!=(O=k.textOptions.angle)){if(45<O&&O<135||225<O&&O<315){let t=b;b=E,E=t}S=-b/2,f=-E/2}if(A.writeStartElement("Canvas"),0!=O){let t=-O*Math.PI/180;A.writeAttributeString("RenderTransform",nt.format("{0},{1},{2},{3},{4},{5}",this.floatToString(Math.cos(t)),this.floatToString(Math.sin(t)),this.floatToString(-Math.sin(t)),this.floatToString(Math.cos(t)),this.floatToString(e+r/2),this.floatToString(i+n/2)))}if(I)for(let h=0;h<m.length;h++){let r=m[h],n="",a=0;while(a<r.length)if(tt.isWhitespace(r[a]))n+=r[a],a++;else{let t="";while(a<r.length&&!tt.isWhitespace(r[a]))t+=r[a],a++;let e=J.c.StiBidirectionalConvert2.convertString(t,!1),i=(n+=e,t.length-e.length);0<i&&(n+=nt.fill(String.fromCharCode(0),i))}let e=it.create(Number,r.length);for(let t=0;t<r.length;t++)e[t]=this.pdfFont.UnicodeMap[n.charCodeAt(t)];let s=it.create(Number,r.length),o=it.create(Number,r.length),i=0,l=0;for(let t=0;t<e.length;t++)32<=e[t]&&(l+=this.pdfFont.Widths[e[t]-32]),"\t"==String.fromCharCode(e[t])&&(l+=this.getTabsSize(k,d,l)),s[t]=l,this.isWordWrapSymbol(n,t)&&0<t&&i++,o[t]=i;let t=l*(d*this.fontCorrectValue)/1e3;if(t>b){let t=r.length-1,e=Math.trunc(1e3*b/(d*this.fontCorrectValue));while(s[t]>e&&0<t)t--;let i=t;if(0<o[t]){if(o[t]!=o[t+1])i=t++;else{while(!this.isWordWrapSymbol(n,t))t--;i=t-1;while(tt.isWhitespace(n[i])&&0<i)i--}while(tt.isWhitespace(n[t]))t++}else t++;m[h]=R?r.substr(0,i+1)+"a":r.substr(0,i+1),m[Z.System.StiObject.stimulsoft]().insert(h+1,r.substr(t,r.length-t).trimStart())}}for(let i=0;i<m.length;i++){let t=m[i],e=J.c.StiBidirectionalConvert2.convertString(t,N);m[i]=e}if(null!=D){let t=w,e=m.length*t,i=D.vertAlignment;(i=0!=O&&90!=O&&180!=O&&270!=O?st.Center:i)==st.Top&&(f+=c),i==st.Center&&(f+=(E-e)/2+c),i==st.Bottom&&(f+=E-e+c)}let g=it.create2(Number,m.length,3);for(let c=0;c<m.length;c++){let h=m[c];if(0<h.length){let r=it.create(Number,h.length),n=0;for(let e=0;e<h.length;e++){let t=h.charCodeAt(e);if(32<=t&&(n+=this.pdfFont.Widths[this.pdfFont.UnicodeMap[t]-32]),"\t"==String.fromCharCode(t)){let t=this.getTabsSize(k,d,n);n+=t,r[e]=t/10}}n=n*(d*this.fontCorrectValue)/1e3,"{"==(h=gr.convertToEscapeSequence(h))[0]&&(h="{}"+h);let e=S,t=f+w*c;if(null!=B){let t=B.horAlignment;if(R&&(0<h.length&&"a"==h[h.length-1]?h=h.substr(0,h.length-1):t=at.Left),null!=k&&null!=k.textOptions&&k.textOptions.rightToLeft&&(t==at.Left?t=at.Right:t==at.Right&&(t=at.Left)),t==at.Center&&(e+=(b-n)/2),t==at.Right&&(e+=b-n),t==at.Width){let i=0;for(let t=0;t<h.length;t++)" "==h[t]&&i++;if(0<i&&(c!=m.length-1||R)){let e=(b-n)/i*100/(d*this.fontCorrectValue);if(0<e){e+=this.pdfFont.Widths[0]/10;for(let t=0;t<h.length;t++)" "==h[t]&&(r[t]=e)}}}}g[c][0]=e,g[c][1]=t,g[c][2]=n;let i=this.pdfFont.fontList[H],a=i.Name,s=a=Z.StiOptions.Export.useAlternativeFontNames&&Z.StiOptions.Export.alternativeFontNames.containsKey(a)?Z.StiOptions.Export.alternativeFontNames.get(a):a,o=(s=s[Z.System.StiObject.stimulsoft]().replaceAll(" ","_"),(i.Bold||i.Italic)&&(i.Bold&&(s+="_Bold"),i.Italic)&&(s+="_Italic"),!1),l="";for(let t=0;t<r.length-1;t++)0!=r[t]&&(l=(l+=",")+this.floatToString(r[t]),o=!0),t!=r.length-1-1&&(l+=";");A.writeStartElement("Glyphs"),A.writeAttributeString("BidiLevel","0"),A.writeAttributeString("Fill",nt.format("#{0:X8}",p.toArgb())),A.writeAttributeString("FontUri",nt.format("/Resources/{0}.ttf",s)),A.writeAttributeString("FontRenderingEmSize",this.floatToString(W)),A.writeAttributeString("StyleSimulations","None"),A.writeAttributeString("OriginX",this.floatToString(e)),A.writeAttributeString("OriginY",this.floatToString(t)),A.writeAttributeString("UnicodeString",h),A.writeAttributeString("Indices",o?l:""),A.writeFullEndElement()}}if(null!=P&&P.font.underline){let e=.09*d,i=.115*-d;0!=this.pdfFont.UnderscoreSize&&(e=a,i=s),e<.1&&(e=.1);for(let t=0;t<m.length;t++)0!=g[t][2]&&(A.writeStartElement("Path"),A.writeAttributeString("Stroke",nt.format("#{0:X8}",p.toArgb())),A.writeAttributeString("StrokeThickness",nt.format("{0}",this.floatToString(e))),A.writeAttributeString("Data",nt.format("M {0},{2} L {1},{2}",this.floatToString(g[t][0]),this.floatToString(g[t][0]+g[t][2]),this.floatToString(g[t][1]-i))),A.writeFullEndElement())}if(null!=P&&P.font.strikeout){let e=.09*d,i=.4*d;0!=this.pdfFont.StrikeoutSize&&(e=o,i=l),e<.1&&(e=.1);for(let t=0;t<m.length;t++)0!=g[t][2]&&(A.writeStartElement("Path"),A.writeAttributeString("Stroke",nt.format("#{0:X8}",p.toArgb())),A.writeAttributeString("StrokeThickness",nt.format("{0}",this.floatToString(e))),A.writeAttributeString("Data",nt.format("M {0},{2} L {1},{2}",this.floatToString(g[t][0]),this.floatToString(g[t][0]+g[t][2]),this.floatToString(g[t][1]-i))),A.writeFullEndElement())}A.writeFullEndElement(),A.writeFullEndElement()}if(F.linesOfUnderline!=ot.None){let s=T.y+u+y,o=!0,l=!0;if(null!=D){let t=w*(M=0==M?1:M),e=D.vertAlignment;(e=0!=O&&90!=O&&180!=O&&270!=O?st.Center:e)==st.Top&&(s+=c,o=!1),e==st.Center&&(s+=(E-t)/2+c),e==st.Bottom&&(s+=E-w+c,l=!1)}s+=-n;let h=T.component.as(z);if(null!=h){let t=h.border.size,e=.9*t,i=h.border.color,r=this.getLineStyleDash(F.linesOfUnderline),n="",a=s;if(o)while(a-w>T.y+g)a-=w;while(a<T.y+T.height-u-(l?0:w))n+=nt.format("M {0},{1} L {2},{3} ",this.floatToString(T.x),this.floatToString(a),this.floatToString(T.x+T.width),this.floatToString(a)),a+=w;A.writeStartElement("Path"),A.writeAttributeString("Stroke",nt.format("#{0:X8}",i.toArgb())),A.writeAttributeString("StrokeThickness",e.toString()),A.writeAttributeString("StrokeStartLineCap","Square"),A.writeAttributeString("StrokeEndLineCap","Square"),""!=r&&(A.writeAttributeString("StrokeDashArray",r),A.writeAttributeString("StrokeDashCap","Flat")),A.writeAttributeString("Data",n),A.writeFullEndElement()}}}}writeImage(t,e){let i=e.component.as(pt);if(null==i||!e.component.isExportAsImage(J.a.StiExportFormat.Xps))return;let r={ref:this.imageResolution/100},n=i.getImage(r,J.a.StiExportFormat.Xps);if(null==n)return;let a=this.imageCache.addImageInt(n),s=-1;this.pageImages.set(a,a),-1!=s&&this.pageImages.set(s,s),t.writeStartElement("Path"),this.writeHyperlinksData(t,e.component,!1),t.writeAttributeString("Data",nt.format("M {0},{1} L {0},{3} L {2},{3} L {2},{1} Z ",this.floatToString(e.x),this.floatToString(e.y),this.floatToString(e.x+e.width),this.floatToString(e.y+e.height))),-1!=s&&(t.writeStartElement("Path.OpacityMask"),t.writeStartElement("ImageBrush"),t.writeAttributeString("ImageSource",nt.format("/Resources/Images/image_{0}.png",s)),t.writeAttributeString("Viewbox",nt.format("{0},{1},{2},{3}",0,0,n.width,n.height)),t.writeAttributeString("TileMode","None"),t.writeAttributeString("ViewboxUnits","Absolute"),t.writeAttributeString("ViewportUnits","Absolute"),t.writeAttributeString("Viewport",nt.format("0,0,{0},{0}",1)),t.writeStartElement("ImageBrush.Transform"),t.writeStartElement("MatrixTransform"),t.writeAttributeString("Matrix",nt.format("{0},{1},{2},{3},{4},{5}",this.floatToString(e.width),0,0,this.floatToString(e.height),this.floatToString(e.x),this.floatToString(e.y))),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),t.writeEndElement()),t.writeStartElement("Path.Fill"),t.writeStartElement("ImageBrush"),t.writeAttributeString("ImageSource",nt.format("/Resources/Images/image_{0}.jpg",a)),t.writeAttributeString("Viewbox",nt.format("{0},{1},{2},{3}",0,0,n.width,n.height)),t.writeAttributeString("TileMode","None"),t.writeAttributeString("ViewboxUnits","Absolute"),t.writeAttributeString("ViewportUnits","Absolute"),t.writeAttributeString("Viewport",nt.format("0,0,{0},{0}",1)),t.writeStartElement("ImageBrush.Transform"),t.writeStartElement("MatrixTransform"),t.writeAttributeString("Matrix",nt.format("{0},{1},{2},{3},{4},{5}",this.floatToString(e.width),0,0,this.floatToString(e.height),this.floatToString(e.x),this.floatToString(e.y))),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),t.writeFullEndElement()}writeWatermark(t,e,i,r,n){if(null==e||nt.isNullOrEmpty(e.text)||e.showBehind!=i)return;let a=new mr;a.x=0,a.y=0,a.width=r,a.height=n,a.component=new et(new At(a.x,a.y,a.width,a.height)),a.component.text=e.text,a.component.textBrush=e.textBrush,a.component.font=e.font,a.component.textOptions=new h,a.component.textOptions.angle=e.angle,a.component.horAlignment=at.Center,a.component.vertAlignment=st.Center,this.writeText(t,a)}writePageRels(){let t=new K,n=new w(u.UTF8,t),a=(n.indentation=this.xmlIndentation<0?0:this.xmlIndentation,n.formatting=this.xmlIndentation<0?d.None:d.Indented,n.writeStartDocument(),n.writeStartElement("Relationships"),n.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),[]);this.pageFonts.values.copyTo(a,0);for(let r=0;r<a.length;r++){let t=this.pdfFont.fontList[a[r]],e=t.Name,i=e=Z.StiOptions.Export.useAlternativeFontNames&&Z.StiOptions.Export.alternativeFontNames.containsKey(e)?Z.StiOptions.Export.alternativeFontNames.get(e):e;i=i[Z.System.StiObject.stimulsoft]().replaceAll(" ","_"),(t.Bold||t.Italic)&&(t.Bold&&(i+="_Bold"),t.Italic)&&(i+="_Italic"),n.writeStartElement("Relationship"),n.writeAttributeString("Id",`rId`+(r+1)),n.writeAttributeString("Type","http://schemas.microsoft.com/xps/2005/06/required-resource"),n.writeAttributeString("Target",`../../../Resources/${i}.ttf`),n.writeEndElement()}let i=it.create(Number,this.pageImages.count);this.pageImages.values.copyTo(i,0);for(let e=0;e<i.length;e++){n.writeStartElement("Relationship"),n.writeAttributeString("Id",`rId`+(this.pageFonts.count+e+1)),n.writeAttributeString("Type","http://schemas.microsoft.com/xps/2005/06/required-resource");let t="jpg";this.imageCache.imageFormatStore[i[e]]==s.Png&&(t="png"),n.writeAttributeString("Target",`../../../Resources/Images/image_${i[e]}.`+t),n.writeEndElement()}return n.writeFullEndElement(),n.writeEndDocument(),n.flush(),t}writeResourceImage(t){let e=new K,i=this.imageCache.imagePackedStore[t];return e.write(i,0,i.length),e}writeRecourceFont(t){let e=new K,i=(this.pdfFont.currentFont=t,this.pdfFont.fontList[t]),r=this.pdfFont.getFontDataBuf(i.Font,this.report);if(0<(null==(r=null==r?J.a.Resources.RobotoFont.getContent():r)?void 0:r.length)&&this.reduceFontSize){let t=this.pdfFont.reduceFontSize(r,i.Name,!0);null!=t&&(r=t)}return 0<(null==r?void 0:r.length)&&e.write(r,0,r.length),e}exportXps(e,t,i){if(null==Z.Base[["St","iL","ic","en","se"].join("")].key&&console.warn("You are using a trial version of the Stimulsoft product!"),J.a.StiLogService.write(this[Z.System.StiObject.stimulsoft]().getType(),"Export report to Microsoft XML Paper Specification format"),null==i)throw"ArgumentNullException";this.report=e;let r=i.pageRange,n=(this.imageResolution=i.imageResolution,this.imageQuality=i.imageQuality,this.exportRtfTextAsImage=i.exportRtfTextAsImage,this.imageQuality<0&&(this.imageQuality=0),1<this.imageQuality&&(this.imageQuality=1),this.imageResolution<10&&(this.imageResolution=10),this.xmlIndentation=1,this.useImageComparer=Z.StiOptions.Export.Xps.allowImageComparer,this.reduceFontSize=Z.StiOptions.Export.Xps.reduceFontFileSize,q.currentCulture);try{q.currentCulture=JSON.parse(JSON.stringify(q.cultures["en-US"])),q.currentCulture.numberFormat.numberDecimalSeparator=".";let i=r.getSelectedPages(e.renderedPages);if(this.isStopped)return;this.prepareData();for(let e of i.list){if(i.getPage(e),i.cacheMode&&this.invokeExporting(e,i,0,2),null!=e.watermark&&!nt.isNullOrEmpty(e.watermark.text)){null!=e.watermark.font&&this.pdfFont.getFontNumber(e.watermark.font);let t=J.c.StiBidirectionalConvert2.convertString(e.watermark.text,!1);this.pdfFont.storeUnicodeSymbolsInMap(t)}for(let n of e.components.list)if(n.enabled){let t=n.as(dt),r=(null!=t&&this.pdfFont.getFontNumber(t.font),n.as(ht));if(n.is(et)&&!n.isExportAsImage(J.a.StiExportFormat.Xps)){let t=n,e=null!=r.textOptions&&r.textOptions.rightToLeft,i=J.c.StiBidirectionalConvert2.convertString(t.text,e);this.pdfFont.storeUnicodeSymbolsInMap(i)}}}this.pdfFont.InitFontsData(e);let a=new p;a.begin(t,!0),a.addFile("[Content_Types].xml",this.writeContentTypes()),a.addFile("_rels/.rels",this.writeMainRels()),a.addFile("docProps/core.xml",this.writeDocPropsCore(e)),a.addFile("FixedDocSeq.fdseq",this.writeFixedDocSeq()),this.pageFonts=new C,this.pageImages=new C,this.pageBookmarks=new C,this.indexPage=0;for(let t of i.list){if(i.getPage(t),this.invokeExporting(t,i,1,2),this.isStopped)return;if(a.addFile(`Documents/1/Pages/${this.indexPage+1}.fpage`,this.writePage(t,e)),(0<this.pageFonts.count||0<this.pageImages.count)&&a.addFile(`Documents/1/Pages/_rels/${this.indexPage+1}.fpage.rels`,this.writePageRels()),this.pageFonts.clear(),this.pageImages.clear(),this.isStopped)return;this.indexPage++}if(a.addFile("Documents/1/FixedDoc.fdoc",this.writeFixedDoc(i)),0<this.pdfFont.fontList.length)for(let n=0;n<this.pdfFont.fontList.length;n++){let t=this.pdfFont.fontList[n],e=t.Name,i=e=Z.StiOptions.Export.useAlternativeFontNames&&Z.StiOptions.Export.alternativeFontNames.containsKey(e)?Z.StiOptions.Export.alternativeFontNames.get(e):e,r=(i=i[Z.System.StiObject.stimulsoft]().replaceAll(" ","_"),(t.Bold||t.Italic)&&(t.Bold&&(i+="_Bold"),t.Italic)&&(i+="_Italic"),this.writeRecourceFont(n));0<r.length&&a.addFile(`Resources/${i}.ttf`,r)}if(0<this.imageCache.imagePackedStore.length)for(let e=0;e<this.imageCache.imagePackedStore.length;e++){let t="jpg";this.imageCache.imageFormatStore[e]==s.Png&&(t="png"),a.addFile(`Resources/Images/image_${e}.`+t,this.writeResourceImage(e))}a.end()}finally{q.currentCulture=n,this.pdfFont.clear(),this.pdfFont=null,this.pageFonts=null,this.pageImages=null,this.imageCache.clear(),this.pageBookmarks.clear(),this.pageBookmarks=null}}}J.c.StiXpsExportService=gr}let Pt=J.c.StiExportService,Lt=J.a.Dashboard.IStiDashboard;J.c.StiCsvExportService=class extends Pt{constructor(){super(...arguments),this.multipleFiles=!1}implements(){let t=[J.c.IStiCsvExportService];return(this.implements=()=>t)()}get defaultExtension(){return"csv"}get exportFormat(){return J.a.StiExportFormat.Csv}get groupCategory(){return"Data"}get position(){return J.c.StiExportPosition.Data}get exportNameInMenu(){return e.get("Export","ExportTypeCsvFile")}exportTo(t,e,i){this.exportCsv(t,e,i[Z.System.StiObject.stimulsoft]().as(J.c.StiDataExportSettings))}get getFilter(){return e.get("FileFilters","CsvFiles")}compareExcellSheetNames(t,e){let i=t,r=(null!=i&&0!=i.length||(i=""),e);return null!=r&&0!=r.length||(r=""),i==r}exportCsv(i,t,e){if(J.a.StiLogService.write(this[Z.System.StiObject.stimulsoft]().getType(),"Export report to Csv format"),null==Z.Base[["St","iL","ic","en","se"].join("")].key&&console.warn("You are using a trial version of the Stimulsoft product!"),!i.isDocument&&i.getCurrentPage().is(Lt))return;if(null==e)throw new Error("The 'settings' argument cannot be equal in null.");let r=e.pageRange,n=e.separator,a=e.encoding,s=e.skipColumnHeaders,o=e.dataExportMode,l=("\\t"==n&&(n="\t"),r.getSelectedPages(i.renderedPages)),h=(this.currentPassNumber=0,this.maximumPassNumber=2,this.writer=new W(t,a),0);while(h<l.count){let t=new f(i,i.renderedPages),e=(t.cacheMode=i.renderedPages.cacheMode,t.addV2Internal(l.getPageWithoutCache(h)),l.getPageWithoutCache(h).excelSheetValue);while(h<l.count-1&&this.compareExcellSheetNames(l.getPageWithoutCache(h+1).excelSheetValue,e))h++,t.addV2Internal(l.getPageWithoutCache(h));h++;let r=new J.c.StiMatrix(t,!1,this,null,o);if(r.scanComponentsPlacement(!1),this.isStopped)return;if(r.prepareDocument(this,o),!s){for(let e=0;e<r.fields.length;e++){let t=r.fields[e].name[Z.System.StiObject.stimulsoft]().replaceAll('"','""');-1==t.indexOf(n)&&-1==t.indexOf('"')&&-1==t.indexOf("\n")||(t='"'+t+'"'),this.writer.write(t),e<r.fields.length-1&&this.writer.write(n)}this.writer.writeLine("")}this.currentPassNumber++;for(let i=0;i<r.dataArrayLength;i++){if(this.invokeExporting2(i,r.dataArrayLength-1,this.currentPassNumber,this.maximumPassNumber),this.isStopped)return;for(let e=0;e<r.fields.length;e++){let t=r.fields[e].dataArray[i];""!=(t=null==t?"":t)&&(-1==t.indexOf(n)&&-1==t.indexOf('"')&&-1==t.indexOf("\n")||(t='"'+(t=t[Z.System.StiObject.stimulsoft]().replaceAll('"','""'))+'"'),this.writer.write(t)),e<r.fields.length-1&&this.writer.write(n)}this.writer.writeLine("")}r.clear(),this.currentPassNumber++,this.maximumPassNumber+=2}this.writer.flush()}},J.c.StiDataExportService=class extends J.c.StiExportService{constructor(){super(...arguments),this.multipleFiles=!1}implements(){let t=[J.c.IStiDataExportService];return(this.implements=()=>t)()}get defaultExtension(){if(this.exportSettings.is(J.c.StiDbfExportSettings))return"dbf";if(this.exportSettings.is(J.c.StiDifExportSettings))return"dif";if(this.exportSettings.is(J.c.StiSylkExportSettings))return"slk";if(this.exportSettings.is(J.c.StiXmlExportSettings))return"xml";if(this.exportSettings.is(J.c.StiJsonExportSettings))return"json";if(this.exportSettings.is(J.c.StiDataExportSettings)){let t=this.exportSettings.dataType;if(t==J.c.StiDataType.Dbf)return"dbf";if(t==J.c.StiDataType.Dif)return"dif";if(t==J.c.StiDataType.Sylk)return"slk";if(t==J.c.StiDataType.Xml)return"xml";if(t==J.c.StiDataType.Json)return"json"}return"csv"}get exportFormat(){if(this.exportSettings.is(J.c.StiCsvExportSettings))return J.a.StiExportFormat.Csv;if(this.exportSettings.is(J.c.StiDbfExportSettings))return J.a.StiExportFormat.Dbf;if(this.exportSettings.is(J.c.StiDifExportSettings))return J.a.StiExportFormat.Dif;if(this.exportSettings.is(J.c.StiSylkExportSettings))return J.a.StiExportFormat.Sylk;if(this.exportSettings.is(J.c.StiXmlExportSettings))return J.a.StiExportFormat.Xml;if(this.exportSettings.is(J.c.StiJsonExportSettings))return J.a.StiExportFormat.Json;if(this.exportSettings.is(J.c.StiDataExportSettings)){let t=this.exportSettings.dataType;if(t==J.c.StiDataType.Csv)return J.a.StiExportFormat.Csv;if(t==J.c.StiDataType.Dbf)return J.a.StiExportFormat.Dbf;if(t==J.c.StiDataType.Dif)return J.a.StiExportFormat.Dif;if(t==J.c.StiDataType.Sylk)return J.a.StiExportFormat.Sylk;if(t==J.c.StiDataType.Xml)return J.a.StiExportFormat.Xml;if(t==J.c.StiDataType.Json)return J.a.StiExportFormat.Json}return J.a.StiExportFormat.Data}get groupCategory(){return"Data"}get position(){return J.c.StiExportPosition.Data}get exportNameInMenu(){return e.get("Export","ExportTypeDataFile")}exportTo(t,e,i){this.exportData(t,e,i)}getFilter(){return e.get("FileFilters","CsvFiles")}exportData(e,i,r){null==Z.Base[["St","iL","ic","en","se"].join("")].key&&console.warn("You are using a trial version of the Stimulsoft product!");let t=null!=(this.exportSettings=r)?r.dataType:J.c.StiDataType.Csv;if(t==J.c.StiDataType.Dbf||r.is2(J.c.StiDbfExportSettings)){let t=new J.c.StiDbfExportService;t.exportDbf(e,i,r)}else if(t==J.c.StiDataType.Dif||r.is2(J.c.StiDifExportSettings)){let t=new J.c.StiDifExportService;t.exportDif(e,i,r)}else if(t==J.c.StiDataType.Sylk||r.is2(J.c.StiSylkExportSettings)){let t=new J.c.StiSylkExportService;t.exportSylk(e,i,r)}else if(t==J.c.StiDataType.Xml||r.is2(J.c.StiXmlExportSettings)){let t=new J.c.StiXmlExportService;t.exportXml(e,i,r)}else if(t==J.c.StiDataType.Json){let t=new J.c.StiJsonExportService;t.exportJson(e,i,r)}else{let t=new J.c.StiCsvExportService;t.exportCsv(e,i,r)}}};{class pr extends Pt{constructor(){super(...arguments),this.separator=q.currentCulture.numberFormat.numberDecimalSeparator,this.multipleFiles=!1}implements(){let t=[J.c.IStiDbfExportService];return(this.implements=()=>t)()}get defaultExtension(){return"dbf"}get exportFormat(){return J.a.StiExportFormat.Dbf}get groupCategory(){return"Data"}get position(){return J.c.StiExportPosition.Data}get exportNameInMenu(){return e.get("Export","ExportTypeDbfFile")}exportTo(t,e,i){this.exportDbf(t,e,i[Z.System.StiObject.stimulsoft]().as(J.c.StiDataExportSettings))}get getFilter(){return e.get("FileFilters","DbfFiles")}prepareData(t){let e=t,i=0;while(i<=e.length-2&&"0"==e[i]&&"."!=e[i+1])e[Z.System.StiObject.stimulsoft]().insert(i," ",1),i++;return e}getBytes(e,i){let r=[];for(let t=0;t<e;t++)r[t]=i>>8*t;return r}exportDbf(t,e,i){if(J.a.StiLogService.write(this[Z.System.StiObject.stimulsoft]().getType(),"Export report to Dbf format"),null==Z.Base[["St","iL","ic","en","se"].join("")].key&&console.warn("You are using a trial version of the Stimulsoft product!"),!t.isDocument&&t.getCurrentPage().is(Lt))return;if(null==i)throw"The 'settings' argument cannot be equal in null.";let r=i.pageRange,n=i.codePage,a=i.dataExportMode,s=0;for(let t=0;t<pr.codePageCodes.length;t++)if(pr.codePageCodes[t][1]==n){s=t;break}let o=0==s?u.Default:u.getEncoding(pr.codePageCodes[s][1]),l=r.getSelectedPages(t.renderedPages),h=(J.c.StiExportUtils.checkPassive(l),this.currentPassNumber=0,this.maximumPassNumber=3,new J.c.StiMatrix(l,!1,this));if(h.scanComponentsPlacement(!1),this.isStopped)return;h.prepareDocument(this,a);let c=0;for(let n=0;n<h.fields.length;n++){let r=0;for(let i=0;i<h.dataArrayLength;i++){let t=h.fields[n].dataArray[i],e=(t=null==t?"":t).length;e>r&&(r=e)}0==r&&(r=1),h.fields[n].info[0]==J.c.StiExportDataType.String&&0==h.fields[n].info[1]&&(h.fields[n].info[1]=r),c+=h.fields[n].info[1];let e=new ct;if(h.fields[n].info[0]==J.c.StiExportDataType.Float||h.fields[n].info[0]==J.c.StiExportDataType.Double){let t=h.fields[n].info[1]-h.fields[n].info[2]-1;0<t&&e.append("0",t),e.append("."),e.append("0",h.fields[n].info[2])}h.fields[n].info[0]!=J.c.StiExportDataType.Int&&h.fields[n].info[0]!=J.c.StiExportDataType.Long||e.append("0",h.fields[n].info[1]),1<e.length&&e.append(";-"+e.toString().substr(1,e.length-1)),h.fields[n].formatString=e.toString()}c++;let m=new C;for(let r=0;r<h.fields.length;r++){let t=h.fields[r].name.toUpperCase(),e="",i=0;while(1){if(!m.contains(t+e))break;i++,e=i[Z.System.StiObject.stimulsoft]().toString(),10<t.length+e.length&&(t=t.substr(0,10-e.length))}t+=e,h.fields[r].name=t,m.add(t,t)}let g=32+32*h.fields.length+1,p=it.create(Number,g),d=(p[0]=3,_.now);p[1]=d.year-100*Math.trunc(d.year/100),p[2]=d.month,p[3]=d.day,this.getBytes(4,h.dataArrayLength)[Z.System.StiObject.stimulsoft]().copyTo(p,4),this.getBytes(2,g)[Z.System.StiObject.stimulsoft]().copyTo(p,8),this.getBytes(2,c)[Z.System.StiObject.stimulsoft]().copyTo(p,10);for(let r=0;r<h.fields.length;r++){let t=32+32*r,e=h.fields[r].name.toUpperCase(),i=o.getBytes(e);i[Z.System.StiObject.stimulsoft]().copyTo(p,t),p[t+11]="C".charCodeAt(0),h.fields[r].info[0]!=J.c.StiExportDataType.Int&&h.fields[r].info[0]!=J.c.StiExportDataType.Long&&h.fields[r].info[0]!=J.c.StiExportDataType.Float&&h.fields[r].info[0]!=J.c.StiExportDataType.Double||(p[t+11]="N".charCodeAt(0)),h.fields[r].info[0]==J.c.StiExportDataType.Date&&(p[t+11]="D".charCodeAt(0)),h.fields[r].info[0]==J.c.StiExportDataType.Bool&&(p[t+11]="L".charCodeAt(0)),p[t+16]=h.fields[r].info[1],p[t+17]=h.fields[r].info[2]}p[29]=pr.codePageCodes[s][0],p[g-1]=13,this.writer2=e,this.writer2.write(p,0,g),p=it.create(Number,c),this.currentPassNumber=2;for(let a=0;a<h.dataArrayLength;a++){if(this.invokeExporting2(a,h.dataArrayLength,this.currentPassNumber,this.maximumPassNumber),this.isStopped)return;let n=1;for(let e=0;e<h.fields.length;e++){let i=h.fields[e].dataArray[a],r=(null==i&&(i=""),h.fields[e].info[1]);switch(h.fields[e].info[0]){case J.c.StiExportDataType.String:(i=i.length>r?i[Z.System.StiObject.stimulsoft]().remove(r,i.length-r):i).length<r&&(i+=nt.fill(" ",r-i.length));break;case J.c.StiExportDataType.Int:case J.c.StiExportDataType.Long:{let t=yt.tryParse(i.split(".").join(",").split(",").join(this.separator),!1),e=t.result;t.successfully?(i=this.prepareData(e.toString())).length>r&&(i=i[Z.System.StiObject.stimulsoft]().remove(0,i.length-r)):e=0}break;case J.c.StiExportDataType.Float:case J.c.StiExportDataType.Double:{let t=yt.tryParse(i.split(".").join(",").split(",").join(this.separator)),e=t.result;t.successfully?(i=this.prepareData(e.toString().split(this.separator).join("."))).length>r&&(i=i[Z.System.StiObject.stimulsoft]().remove(0,i.length-r)):e=0}break;case J.c.StiExportDataType.Date:{let t="        ";if(nt.isNullOrEmpty(i)||nt.isNullOrEmpty(i.trimEnd()))i=t;else{let t=_.tryParse(i),e=t.result;t.successfully?i=this.prepareData(e.toString("yyyyMMdd")):e=_.minValue}}break;case J.c.StiExportDataType.Bool:{let t=i[Z.System.StiObject.stimulsoft]().toBoolean();i=t?"T":"F"}break}let t=o.getBytes(i);t[Z.System.StiObject.stimulsoft]().copyTo(p,n);for(let t=i.length;t<h.fields[e].info[1];t++)p[n+t]=" ".charCodeAt(0);n+=h.fields[e].info[1]}p[0]=32,this.writer2.write(p,0,p.length)}p[0]=26,this.writer2.write(p,0,1),this.writer2.flush(),(o=null)!=h&&(h.clear(),h=null)}}pr.copePageNames=["Default","437  U.S. MS-DOS","620  Mazovia (Polish) MS-DOS","737  Greek MS-DOS (437G)","850  International MS-DOS","852  Eastern European MS-DOS","861  Icelandic MS-DOS","865  Nordic MS-DOS","866  Russian MS-DOS","895  Kamenicky (Czech) MS-DOS","857  Turkish MS-DOS","1250  EasternEuropean MS-DOS","1251  Russian Windows","1252  Windows ANSI","1253  Greek Windows","1254  Turkish Windows","10000  Standard Macintosh","10006  Greek Macintosh","10007  Russian Macintosh","10029  Eastern European Macintosh"],pr.codePageCodes=[[0,0],[1,437],[105,620],[106,737],[2,850],[100,852],[103,861],[102,865],[101,866],[104,895],[107,857],[200,1250],[201,1251],[3,1252],[203,1253],[202,1254],[4,1e4],[152,10006],[150,10007],[151,10029]],J.c.StiDbfExportService=pr}J.c.StiDifExportService=class extends Pt{implements(){let t=[J.c.IStiDifExportService];return(this.implements=()=>t)()}get defaultExtension(){return"dif"}get exportFormat(){return J.a.StiExportFormat.Dif}get groupCategory(){return"Data"}get position(){return J.c.StiExportPosition.Data}get exportNameInMenu(){return e.get("Export","ExportTypeDifFile")}exportTo(t,e,i){this.exportDif(t,e,i[Z.System.StiObject.stimulsoft]().as(J.c.StiDataExportSettings))}exportDif(t,e,i){if(J.a.StiLogService.write(this[Z.System.StiObject.stimulsoft]().getType(),"Export report to Dif format"),null==Z.Base[["St","iL","ic","en","se"].join("")].key&&console.warn("You are using a trial version of the Stimulsoft product!"),!t.isDocument&&t.getCurrentPage().is(Lt))return;if(null==i)throw"The 'settings' argument cannot be equal in null.";let r=i.pageRange,n=i.exportDataOnly,a=i.encoding,s=(this.writer=new W(e,a),r.getSelectedPages(t.renderedPages)),o=(J.c.StiExportUtils.checkPassive(s),this.currentPassNumber=0,this.maximumPassNumber=3,n?J.c.StiDataExportMode.Data|J.c.StiDataExportMode.Headers:J.c.StiDataExportMode.AllBands),l=new J.c.StiMatrix(s,!0,this,null,o);if(l.scanComponentsPlacement(!1),this.isStopped)return;if(this.writer.writeLine("TABLE"),this.writer.writeLine("0,1"),this.writer.writeLine('"EXCEL"'),this.writer.writeLine("VECTORS"),this.writer.writeLine(nt.format("0,{0}",l.coordX.countItems-1)),this.writer.writeLine('""'),this.writer.writeLine("TUPLES"),this.writer.writeLine(nt.format("0,{0}",l.coordY.countItems-1)),this.writer.writeLine('""'),this.writer.writeLine("DATA"),this.writer.writeLine("0,0"),this.writer.writeLine('""'),this.currentPassNumber=2,n){l.prepareDocument(this,o);for(let r=0;r<l.dataArrayLength;r++){if(this.invokeExporting2(r,l.dataArrayLength-1,this.currentPassNumber,this.maximumPassNumber),this.isStopped)return;this.writer.writeLine("-1,0"),this.writer.writeLine("BOT");for(let i=0;i<l.fields.length;i++){let t=l.fields[i].dataArray[r],e=(null==t&&(t=""),l.fields[i].info[0]!=J.c.StiExportDataType.String);e?(this.writer.writeLine(`0,`+t),this.writer.writeLine("V")):(this.writer.writeLine("1,0"),this.writer.writeLine(`"${t}"`))}}}else for(let a=0;a<l.coordY.countItems-1;a++){if(this.invokeExporting2(a,l.coordY.countItems-1,this.currentPassNumber,this.maximumPassNumber),this.isStopped)return;this.writer.writeLine("-1,0"),this.writer.writeLine("BOT");for(let n=0;n<l.coordX.countItems-1;n++){let e=null,i="",r=l.cells.gett(a,n);if(null!=r){null==(e=r.text)&&(e="");let t=r.component.as(et);null!=t&&(i=t.format)}null==e&&(e="");let t=!1;(t=nt.isNullOrEmpty(i)||"C"!=i[0]&&"N"!=i[0]&&"P"!=i[0]&&"D"!=i[0]&&"T"!=i[0]?t:!0)?(this.writer.writeLine(`0,`+e),this.writer.writeLine("V")):(this.writer.writeLine("1,0"),this.writer.writeLine(`"{text}"`))}}this.writer.writeLine("-1,0"),this.writer.writeLine("EOD"),this.writer.flush(),null!=l&&(l.clear(),l=null)}},J.c.StiJsonExportService=class extends Pt{implements(){let t=[J.c.IStiJsonExportService];return(this.implements=()=>t)()}get defaultExtension(){return"json"}get exportFormat(){return J.a.StiExportFormat.Json}get groupCategory(){return"Data"}get position(){return J.c.StiExportPosition.Data}get exportNameInMenu(){return e.get("Export","ExportTypeJsonFile")}exportTo(t,e,i){this.exportJson(t,e,i[Z.System.StiObject.stimulsoft]().as(J.c.StiDataExportSettings))}exportJson(t,e,i){if(J.a.StiLogService.write(this[Z.System.StiObject.stimulsoft]().getType(),"Export report to Json format"),null==Z.Base[["St","iL","ic","en","se"].join("")].key&&console.warn("You are using a trial version of the Stimulsoft product!"),null==i)throw"The 'settings' argument cannot be equal in null.";let r=i.dataExportMode,a=q.currentCulture.numberFormat.numberDecimalSeparator,n=(this.currentPassNumber=0,this.maximumPassNumber=3,J.a.StiPagesRange.All.getSelectedPages(t.renderedPages)),s=(J.c.StiExportUtils.checkPassive(n),new J.c.StiMatrix(n,!1,this));if(s.scanComponentsPlacement(!1),this.isStopped)return;s.prepareDocument(this,r);let o=new C;for(let r=0;r<s.fields.length;r++){let t=s.fields[r].name,e="",i=0;while(1){if(!o.contains(t+e))break;i++,e=i[Z.System.StiObject.stimulsoft]().toString()}t+=e,s.fields[r].name=t,o.add(t,t)}let l=[];this.currentPassNumber=2;for(let t=0;t<s.dataArrayLength;t++){if(this.invokeExporting2(t,s.dataArrayLength,this.currentPassNumber,this.maximumPassNumber),this.isStopped)return;let n={};for(let r=0;r<s.fields.length;r++){let i=s.fields[r].dataArray[t];switch(s.fields[r].info[0]){case J.c.StiExportDataType.Long:case J.c.StiExportDataType.Int:{let t=yt.tryParse(i,!1),e=t.result;if(t.successfully){n[s.fields[r].name]=e;continue}}break;case J.c.StiExportDataType.Float:case J.c.StiExportDataType.Double:{let t=yt.tryParse(i.split(".").join(",").split(",").join(a)),e=t.result;if(t.successfully){n[s.fields[r].name]=e;continue}}break;case J.c.StiExportDataType.Date:{let t=_.tryParse(i),e=t.result;if(t.successfully){n[s.fields[r].name]=e.toString();continue}}break}n[s.fields[r].name]=i}l.push(n)}let h={},c=J.a.StiNameValidator.correctName(nt.isNullOrWhiteSpace(t.reportAlias)?t.reportName:t.reportAlias),m=(nt.isNullOrWhiteSpace(i.tableName)||(c=i.tableName),nt.isNullOrWhiteSpace(c)&&(c="Table1"),h[c]=l,JSON.stringify(h,null,4)),g=u.UTF8.getBytes(m);e.write(g,0,g.length),e.flush(),null!=s&&(s.clear(),s=null)}};{class dr{equals(t){return this.name==t.name&&this.bold==t.bold&&this.italic==t.italic&&this.underlined==t.underlined&&this.height==t.height&&this.color==t.color}constructor(t,e,i,r,n,a){this.name=t,this.bold=e,this.italic=i,this.underlined=r,this.height=n,this.color=a}}J.c.StiSylkExportService=class extends Pt{constructor(){super(...arguments),this.formatList=null,this.fontList=null,this.colorHash=null,this.hiToTwips=14.4*1.02,this.twipsToColinfo=2.438*.921,this.twipsToSymbols=.0094563*.92,this.colorTableSize=64,this.colorTable=[0,16711422,16711680,65280,255,16776960,16711935,65535,0,16711422,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443]}implements(){let t=[J.c.IStiSylkExportService];return(this.implements=()=>t)()}get defaultExtension(){return"slk"}get exportFormat(){return J.a.StiExportFormat.Sylk}get groupCategory(){return"Data"}get position(){return J.c.StiExportPosition.Data}get exportNameInMenu(){return e.get("Export","ExportTypeSylkFile")}exportTo(t,e,i){this.exportSylk(t,e,i[Z.System.StiObject.stimulsoft]().as(J.c.StiDataExportSettings))}getFontNumber(e){if(4<this.fontList.length)for(let t=4;t<this.fontList.length;t++)if(this.fontList[t].equals(e))return t;this.fontList.push(e);let t=this.fontList.length-1;return t}getFormatNumber(e){if(0<this.formatList.length)for(let t=0;t<this.formatList.length;t++)if(this.formatList[t]==e)return t;this.formatList.push(e);let t=this.formatList.length-1;return t}getColorIndex(r){if(rt.transparent.equals(r))return 0;let t=r.toArgb();if(this.colorHash.containsKey(t))return this.colorHash.get(t);let n=768,a=0;for(let i=0;i<this.colorTableSize;i++){let t=this.colorTable[i],e=Math.abs(r.r-(t>>16&255))+Math.abs(r.g-(t>>8&255))+Math.abs(r.b-(255&t));e<n&&(a=i,n=e)}return a++,this.colorHash.set(t,a),a}exportSylk(t,e,i){if(J.a.StiLogService.write(this[Z.System.StiObject.stimulsoft]().getType(),"Export report to Sylk format"),null==Z.Base[["St","iL","ic","en","se"].join("")].key&&console.warn("You are using a trial version of the Stimulsoft product!"),!t.isDocument&&t.getCurrentPage().is(Lt))return;if(null==i)throw"The 'settings' argument cannot be equal in null.";let r=i.pageRange,n=i.exportDataOnly,a=i.encoding,s=(this.fontList=[],new dr("Arial",!1,!1,!1,200,0)),o=(this.getFontNumber(s),this.getFontNumber(s),this.getFontNumber(s),this.getFontNumber(s),this.colorHash=new C,this.formatList=[],this.getFormatNumber("General"),new K),l=(this.writer=new W(o,a),r.getSelectedPages(t.renderedPages)),h=(J.c.StiExportUtils.checkPassive(l),this.currentPassNumber=0,this.maximumPassNumber=3,n?J.c.StiDataExportMode.Data|J.c.StiDataExportMode.Headers:J.c.StiDataExportMode.AllBands),c=new J.c.StiMatrix(l,!0,this,null,h);if(this.isStopped)return;if(n){c.scanComponentsPlacement(!0,!1);let e=0,n=new C,a=null,i=c.coordY.getKeys();for(let r=0;r<c.coordY.countItems-1;r++){let t=!1;if(c.linePlacement[r]==J.c.StiTableLineInfo.HeaderD||c.linePlacement[r]==J.c.StiTableLineInfo.HeaderAP){let e=c.parentBandName[r],i=e.indexOf("");if(-1!=i){let t=e.substr(0,i);t!=a&&(a=t,n.clear())}n.containsKey(e)||(t=!0,n.add(e,e))}if(c.linePlacement[r]==J.c.StiTableLineInfo.Data||t){for(let t=0;t<c.coordX.countItems-1;t++)c.cells.sett(e,t,c.cells.gett(r,t)),null!=c.cells.gett(e,t)&&(c.cells.gett(e,t).top=e),0!=e&&null==c.bordersX.gett(r,t)||c.bordersX.sett(e,t,c.bordersX.gett(r,t)),c.bordersX.sett(e+1,t,c.bordersX.gett(r+1,t)),c.bordersY.sett(e,t,c.bordersY.gett(r,t)),c.bookmarks.sett(e,t,c.bookmarks.gett(r,t));c.bordersY.sett(e,c.coordX.countItems-1,c.bordersY.gett(r,c.coordX.countItems-1));let t=c.coordY.getByIndex(r+1,i)-c.coordY.getByIndex(r,i);c.coordY.setByIndex(e+1,c.coordY.getByIndex(e,i)+t),e++}}let r=c.coordY.countItems-1-e;if(0<r)for(let t=0;t<r;t++)c.coordY.removeAt(e+1)}this.currentPassNumber=2;for(let s=0;s<c.coordY.countItems-1;s++){if(this.invokeExporting2(s,c.coordY.countItems-1,this.currentPassNumber,this.maximumPassNumber),this.isStopped)return;let P=0;for(let t=0;t<c.coordX.countItems-1;t++){let E=null,e=null,v=null,y=null,x=null,A=0,T=!1,F=!1,C=(0<P&&(F=!0,P--),c.cells.gett(s,t));if(null!=C){let n=C.component.as(et),i=(null==(E=nt.isNullOrEmpty(C.text)?E:C.text)&&(E=""),"");for(let t=0;t<E.length;t++){let e=E.charCodeAt(t);if(e<32){let t=nt.format("{0}{1}",String.fromCharCode(32+(e>>4&15)),String.fromCharCode(48+(15&e)));i+=t}else i+=String.fromCharCode(e)}E=J.c.StiExportUtils.trimEndWhiteSpace(i),x=C.cellStyle.font,A=this.getColorIndex(C.cellStyle.textColor),rt.transparent.equals(C.cellStyle.color)||C.cellStyle.color.r+C.cellStyle.color.g+C.cellStyle.color.b<544&&(F=!0,P=C.width);let r="",a=(null!=n&&(r=n.format),!1),t=!1,s=!1,o=!1,l=!1,h="",c=2,m=0,g="$",p=!1,d=!1,w=null!=n&&n.hideZeros,u=null,S=null,e=null!=r?r.indexOf("|"):-1;if(-1!=e&&(u=J.c.StiExportUtils.getPositivePattern(r.charCodeAt(e+1)-"A".charCodeAt(0)),S=J.c.StiExportUtils.getNegativePattern(r.charCodeAt(e+2)-"A".charCodeAt(0)),r=r.substr(0,e)),!nt.isNullOrEmpty(r)&&("C"==r[0]&&(a=!0),"N"==r[0]&&(t=!0),"P"==r[0]&&(s=!0),"D"==r[0]&&(o=!0),"T"==r[0]&&(l=!0),1<r.length)&&(a||t||s)){let e=1;if(tt.isDigit(r[e])){let t="";while(e<r.length&&tt.isDigit(r[e]))t+=r[e],e++;c=Number.parseInt(t)}e<r.length&&"G"==r[e]&&(e++,m=3),e<r.length&&"("==r[e]&&(e++,d=!0),e<r.length&&("+"==r[e]||"-"==r[e])&&("+"==r[e]&&(p=!0),++e<r.length)&&(g=r.substr(e))}if(a||t||s)if(-1!=e){let t=new ct,e=(1<m&&(t.append("#,"),t.append("#",m-1)),t.append("0"),0<c&&(t.append("."),t.append("0",c)),t.toString()),i=u.split("n").join(e).split("$").join(`"${g}"`),r=S.split("n").join(e).split("$").join(`"${g}"`);h=i+";"+r+(w?";":"")}else{let t=new ct,e=(a&&1==p&&(t.append('"'),t.append(g),t.append('"')),1<m&&(t.append("#,"),t.append("#",m-1)),t.append("0"),0<c&&(t.append("."),t.append("0",c)),a&&0==p&&(t.append('"'),t.append(g),t.append('"')),s&&t.append("%"),h=t.toString(),(d?"(":"-")+h+(d?")":""));null!=n&&n.hideZeros?h=h+";"+e+";":d&&(h=h+";"+e)}o&&(h="dd/mm/yyyy"),""!=(h=l?"[$-F400]h:mm:ss\\ AM/PM":h)&&(y=nt.format("P{0};",this.getFormatNumber(h)));let f="G0",b=(t&&(f=nt.format("F{0}",c)),a&&(f=nt.format("${0}",c)),s&&(f=nt.format("%{0}",c)),"L");if(C.cellStyle.horAlignment==at.Right&&(b="R"),C.cellStyle.horAlignment==at.Center&&(b="C"),C.cellStyle.horAlignment==at.Width&&(b="X"),v=nt.format("F{0}{1};",f,b),null!=n&&null!=n.excelDataValue&&"-"!=n.excelDataValue){let i=0,t=n.excelDataValue,e=q.currentCulture.numberFormat.numberDecimalSeparator,r=t.split(".").join(",").split(",").join(e);T=!0;try{if(o||l){let t=_.tryParse(r),e=t.result;t.successfully?i=o?e.subtract(new _(1900,1,1)).days+1+1:e.timeOfDay.totalSeconds/86400:T=!1}else{let t=yt.tryParse(r);i=t.result,t.successfully||(T=!1)}}catch(t){T=!1}T&&(E=i.toString().split(",").join("."))}}let i=null!=c.bordersX.gett(s,t),r=null!=c.bordersX.gett(s,t+1),n=null!=c.bordersX.gett(s,t),a=null!=c.bordersX.gett(s+1,t);if(i||r||n||a||null!=x||F){let t=0;null!=x&&(t=this.getFontNumber(new dr(x.name,x.bold,x.italic,x.underline,Math.trunc(20*x.sizeInPoints),A))),e=nt.format("S{0}{1}{2}{3}{4}{5}{6}{7};",null!=x&&x.bold?"D":"",null!=x&&x.italic?"I":"",i?"L":"",r?"R":"",n?"T":"",a?"B":"",F?"S":"",null!=x?nt.format("M{0}",t+1):"")}null==v&&null==e&&null==E&&null==y||(this.writer.writeLine(nt.format("F;{0}{1}{2}Y{3};X{4}",y,v,e,s+1,t+1)),nt.isNullOrEmpty(E))||(T?this.writer.writeLine(`C;K`+E):this.writer.writeLine(`C;K"${E}"`))}}this.writer.flush(),this.writer=new W(e,a),this.writer.writeLine("ID;PWXL;N;E");for(let t=0;t<this.formatList.length;t++)this.writer.writeLine(`P;P`+this.formatList[t]);for(let i=0;i<this.fontList.length;i++){let t=this.fontList[i],e="P;";e+=nt.format("{0}{1};M{2}",i<4?"F":"E",t.name,t.height),(t.bold||t.italic||t.underlined)&&(e+=";S",t.bold&&(e+="B"),t.italic&&(e+="I"),t.underlined)&&(e+="U"),0!=t.color&&(e+=nt.format(";L{0}",t.color)),this.writer.writeLine(e)}this.writer.writeLine("F;P0;DG0G8;M255"),this.writer.writeLine(nt.format("B;Y{0};X{1};D0 0 {2} {3}",c.coordY.countItems-1,c.coordX.countItems-1,c.coordY.countItems-2,c.coordX.countItems-2));let m=c.coordX.getKeys();for(let r=1;r<c.coordX.countItems;r++){let t=c.coordX.getByIndex(r,m),e=c.coordX.getByIndex(r-1,m),i=Math.trunc(Math.round((t-e)*this.hiToTwips*this.twipsToSymbols));0==i&&i++,this.writer.writeLine(`F;W${r} ${r} `+i)}let g=c.coordY.getKeys();for(let e=1;e<c.coordY.countItems;e++){let t=Math.round((c.coordY.getByIndex(e,g)-c.coordY.getByIndex(e-1,g))*this.hiToTwips);0==t&&t++,this.writer.writeLine(`F;M${t};R`+e)}this.writer.flush(),o.writeTo(e),this.writer.writeLine("E"),this.writer.flush(),null!=c&&(c.clear(),c=null),this.formatList=null,this.fontList=null,this.colorHash=null}}}let kt=Z.System.Data.DataSet,Bt=Z.System.Data.DataTable,Dt=Z.System.Data.DataColumn;J.c.StiXmlExportService=class extends Pt{implements(){let t=[J.c.IStiXmlExportService];return(this.implements=()=>t)()}get defaultExtension(){return"xml"}get exportFormat(){return J.a.StiExportFormat.Xml}get groupCategory(){return"Data"}get position(){return J.c.StiExportPosition.Data}get exportNameInMenu(){return e.get("Export","ExportTypeXmlFile")}exportTo(t,e,i){this.exportXml(t,e,i[Z.System.StiObject.stimulsoft]().as(J.c.StiDataExportSettings))}exportXml(t,e,i){if(J.a.StiLogService.write(this[Z.System.StiObject.stimulsoft]().getType(),"Export report to Xml format"),null==Z.Base[["St","iL","ic","en","se"].join("")].key&&console.warn("You are using a trial version of the Stimulsoft product!"),!t.isDocument&&t.getCurrentPage().is(Lt))return;if(null==i)throw"The 'settings' argument cannot be equal in null.";let r=i.dataExportMode,a=q.currentCulture.numberFormat.numberDecimalSeparator,n=(this.currentPassNumber=0,this.maximumPassNumber=3,J.a.StiPagesRange.All.getSelectedPages(t.renderedPages)),s=(J.c.StiExportUtils.checkPassive(n),new J.c.StiMatrix(n,!1,this));if(s.scanComponentsPlacement(!1),this.isStopped)return;s.prepareDocument(this,r);let o=new C;for(let r=0;r<s.fields.length;r++){let t=s.fields[r].name,e=(t=t.toUpperCase(),""),i=0;while(1){if(!o.contains(t+e))break;i++,e=i.toString()}t+=e,s.fields[r].name=t,o.add(t,t)}let l=J.a.StiNameValidator.correctName(nt.isNullOrWhiteSpace(t.reportAlias)?t.reportName:t.reportAlias),h=(nt.isNullOrWhiteSpace(l)&&(l="Report"),new kt(l)),c=(h.enforceConstraints=!1,new Bt);nt.isNullOrWhiteSpace(i.tableName)||(c.tableName=i.tableName);for(let t=0;t<s.fields.length;t++)switch(s.fields[t].info[0]){case J.c.StiExportDataType.String:c.columns.add(new Dt(s.fields[t].name,String));break;case J.c.StiExportDataType.Int:case J.c.StiExportDataType.Long:case J.c.StiExportDataType.Float:case J.c.StiExportDataType.Double:c.columns.add(new Dt(s.fields[t].name,Number));break;case J.c.StiExportDataType.Date:c.columns.add(new Dt(s.fields[t].name,_));break}h.tables.add(c),this.currentPassNumber=2;for(let t=0;t<s.dataArrayLength;t++){if(this.invokeExporting2(t,s.dataArrayLength,this.currentPassNumber,this.maximumPassNumber),this.isStopped)return;let n=c.newRow();for(let r=0;r<s.fields.length;r++){let i=s.fields[r].dataArray[t];switch(s.fields[r].info[0]){case J.c.StiExportDataType.String:n.sett(r,i);break;case J.c.StiExportDataType.Int:case J.c.StiExportDataType.Long:{let t=yt.tryParse(i.split(".").join(",").split(",").join(a),!1),e=t.result;t.successfully&&n.sett(r,e)}break;case J.c.StiExportDataType.Float:case J.c.StiExportDataType.Double:{let t=yt.tryParse(i.split(".").join(",").split(",").join(a)),e=t.result;t.successfully&&n.sett(r,e)}break;case J.c.StiExportDataType.Date:{let t=_.tryParse(i),e=t.result;t.successfully&&n.sett(r,e)}break}}c.rows.add(n)}this.writeDataSetToStream(h,e,i),null!=s&&(s.clear(),s=null)}writeDataSetToStream(t,e,i){let r=new w(u.UTF8,e);r.indentation=1,r.formatting=d.Indented,r.writeRaw(t.writeXml(!1)),t.dispose(),r.flush()}},J.c.StiBmpHelper=class{static dwByte(t,e,i){t[e]=i}static dwByte2(t,e,i,r){this.dwByte(t,e,i),this.dwByte(t,e+1,r)}static dwWord(t,e,i){t[e+0]=255&i,t[e+1]=i>>8&255}static dwDWord(t,e,i){t[e+0]=255&i,t[e+1]=i>>8&255,t[e+2]=i>>16&255,t[e+3]=i>>24&255}static saveToStream(n,t,o,e){let l=n.width,h=n.height,i=4*l,c=[],a=0;for(let t=0;t<h;t++)for(let t=0;t<l;t++){let t=n.imageData[a++],e=n.imageData[a++],i=n.imageData[a++],r=n.imageData[a++];c.push(i),c.push(e),c.push(t),c.push(r)}let m=0,g=null,r;if(t==J.c.StiPcxPaletteType.Monochrome){let a=it.create2(Number,h+1,l+1);for(let e=0;e<h;e++)for(let t=0;t<l;t++)a[e][t]=128;let s=[[1,9,3,11],[13,5,15,7],[4,12,2,10],[16,8,14,6]];for(let n=0;n<h;n++){let t=n*i;for(let r=0;r<l;r++){let e=Math.trunc(.3*c[t+2]+.59*c[t+1]+.11*c[t+0]),i=(t+=4,0);if(o==J.c.StiMonochromeDitheringType.None&&(i=128<=e?255:0),o==J.c.StiMonochromeDitheringType.FloydSteinberg){e+=a[n][r]-128,i=128<=e?255:0;let t=e-i;a[n][r+1]+=Math.trunc(7/16*t),0!=r&&(a[n+1][r-1]+=Math.trunc(3/16*t)),a[n+1][r+0]+=Math.trunc(5/16*t),a[n+1][r+1]+=Math.trunc(1/16*t)}o==J.c.StiMonochromeDitheringType.Ordered&&(i=Math.trunc(e>=255/17*s[3&r][3&n]?255:0)),a[n][r]=i}}m=4*(Math.trunc((l-1)/32)+1),r=m*h,g=[];for(let n=0;n<h;n++){let e=128,i=(h-1-n)*m,r=0;for(let t=0;t<l;t++)0!=a[n][t]&&(r|=e),0==(e>>=1)&&(g[i]=r,r=0,e=128,i++);128!=e&&(g[i]=r)}}if(t==J.c.StiPcxPaletteType.Color){let e=(4-3*l%4)%4,t=l<<2,r=h;g=[];do{let i=t*(r-1);for(let e=0;e<l;e++){let t=e<<2;g.push(c[i+t]),g.push(c[i+t+1]),g.push(c[i+t+2])}for(let t=0;t<e;t++)g.push(0)}while(--r)}let s=62,p=s+r,d=it.create(Number,s);this.dwByte2(d,0,66,77),this.dwDWord(d,2,p),this.dwDWord(d,6,0),this.dwDWord(d,10,62),this.dwDWord(d,14,40),this.dwDWord(d,18,l),this.dwDWord(d,22,h),this.dwWord(d,26,1),t==J.c.StiPcxPaletteType.Monochrome&&this.dwWord(d,28,1),t==J.c.StiPcxPaletteType.Color&&this.dwByte(d,28,24),this.dwDWord(d,30,0),this.dwDWord(d,34,r),this.dwDWord(d,38,3937),this.dwDWord(d,42,3937),this.dwDWord(d,46,0),this.dwDWord(d,50,0),this.dwDWord(d,54,0),this.dwDWord(d,58,16777215),e.write(d,0,s),e.write(g,0,r),e.flush()}};{class wr{constructor(t,e,i){this.exports={},this.netsize=256,this.prime1=499,this.prime2=491,this.prime3=487,this.prime4=503,this.minpicturebytes=3*this.prime4,this.maxnetpos=this.netsize-1,this.netbiasshift=4,this.ncycles=100,this.intbiasshift=16,this.intbias=1<<this.intbiasshift,this.gammashift=10,this.gamma=1<<this.gammashift,this.betashift=10,this.beta=this.intbias>>this.betashift,this.betagamma=this.intbias<<this.gammashift-this.betashift,this.initrad=this.netsize>>3,this.radiusbiasshift=6,this.radiusbias=1<<this.radiusbiasshift,this.initradius=this.initrad*this.radiusbias,this.radiusdec=30,this.alphabiasshift=10,this.initalpha=1<<this.alphabiasshift,this.radbiasshift=8,this.radbias=1<<this.radbiasshift,this.alpharadbshift=this.alphabiasshift+this.radbiasshift,this.alpharadbias=1<<this.alpharadbshift,this.netindex=[],this.bias=[],this.freq=[],this.radpower=[];let r,n;for(this.thepicture=t,this.lengthcount=e,this.samplefac=i,this.network=new Array(this.netsize),r=0;r<this.netsize;r++)this.network[r]=new Array(4),(n=this.network[r])[0]=n[1]=n[2]=(r<<this.netbiasshift+8)/this.netsize,this.freq[r]=this.intbias/this.netsize,this.bias[r]=0}colorMap(){let i=[],r=new Array(this.netsize);for(let t=0;t<this.netsize;t++)r[this.network[t][3]]=t;let n=0;for(let e=0;e<this.netsize;e++){let t=r[e];i[n++]=this.network[t][0],i[n++]=this.network[t][1],i[n++]=this.network[t][2]}return i}inxbuild(){let t,e,i,r,n,a,s,o;for(s=0,o=0,t=0;t<this.netsize;t++){for(n=this.network[t],i=t,r=n[1],e=t+1;e<this.netsize;e++)(a=this.network[e])[1]<r&&(i=e,r=a[1]);if(a=this.network[i],t!=i&&(e=a[0],a[0]=n[0],n[0]=e,e=a[1],a[1]=n[1],n[1]=e,e=a[2],a[2]=n[2],n[2]=e,e=a[3],a[3]=n[3],n[3]=e),r!=s){for(this.netindex[s]=o+t>>1,e=s+1;e<r;e++)this.netindex[e]=t;s=r,o=t}}for(this.netindex[s]=o+this.maxnetpos>>1,e=s+1;e<256;e++)this.netindex[e]=this.maxnetpos}learn(){let t,e,i,r,n,a,s,o,l,h,c,m,g,p;for(this.lengthcount<this.minpicturebytes&&(this.samplefac=1),this.alphadec=30+(this.samplefac-1)/3,m=this.thepicture,g=0,p=this.lengthcount,c=this.lengthcount/(3*this.samplefac),h=c/this.ncycles|0,o=this.initalpha,a=this.initradius,(s=a>>this.radiusbiasshift)<=1&&(s=0),t=0;t<s;t++)this.radpower[t]=o*((s*s-t*t)*this.radbias/(s*s));l=this.lengthcount<this.minpicturebytes?3:this.lengthcount%this.prime1!=0?3*this.prime1:this.lengthcount%this.prime2!=0?3*this.prime2:this.lengthcount%this.prime3!=0?3*this.prime3:3*this.prime4,t=0;while(t<c)if(i=(255&m[g+0])<<this.netbiasshift,r=(255&m[g+1])<<this.netbiasshift,n=(255&m[g+2])<<this.netbiasshift,e=this.contest(i,r,n),this.altersingle(o,e,i,r,n),0!==s&&this.alterneigh(s,e,i,r,n),(g+=l)>=p&&(g-=this.lengthcount),t++,0===h&&(h=1),t%h==0)for(o-=o/this.alphadec,a-=a/this.radiusdec,(s=a>>this.radiusbiasshift)<=1&&(s=0),e=0;e<s;e++)this.radpower[e]=o*((s*s-e*e)*this.radbias/(s*s))}map(t,e,i){let r,n,a,s,o,l,h;o=1e3,h=-1,r=this.netindex[e],n=r-1;while(r<this.netsize||0<=n)r<this.netsize&&(l=this.network[r],(a=l[1]-e)>=o?r=this.netsize:(r++,a<0&&(a=-a),(s=l[0]-t)<0&&(s=-s),(a+=s)<o&&((s=l[2]-i)<0&&(s=-s),(a+=s)<o)&&(o=a,h=l[3]))),0<=n&&(l=this.network[n],(a=e-l[1])>=o?n=-1:(n--,a<0&&(a=-a),(s=l[0]-t)<0&&(s=-s),(a+=s)<o&&((s=l[2]-i)<0&&(s=-s),(a+=s)<o)&&(o=a,h=l[3])));return h}process(){return this.learn(),this.unbiasnet(),this.inxbuild(),this.colorMap()}unbiasnet(){let t;for(t=0;t<this.netsize;t++)this.network[t][0]>>=this.netbiasshift,this.network[t][1]>>=this.netbiasshift,this.network[t][2]>>=this.netbiasshift,this.network[t][3]=t}alterneigh(t,e,i,r,n){let a,s,o,l,h,c,m;(o=e-t)<-1&&(o=-1),(l=e+t)>this.netsize&&(l=this.netsize),a=e+1,s=e-1,c=1;while(a<l||s>o){if(h=this.radpower[c++],a<l){m=this.network[a++];try{m[0]-=h*(m[0]-i)/this.alpharadbias,m[1]-=h*(m[1]-r)/this.alpharadbias,m[2]-=h*(m[2]-n)/this.alpharadbias}catch(t){}}if(s>o){m=this.network[s--];try{m[0]-=h*(m[0]-i)/this.alpharadbias,m[1]-=h*(m[1]-r)/this.alpharadbias,m[2]-=h*(m[2]-n)/this.alpharadbias}catch(t){}}}}altersingle(t,e,i,r,n){let a=this.network[e];a[0]-=t*(a[0]-i)/this.initalpha,a[1]-=t*(a[1]-r)/this.initalpha,a[2]-=t*(a[2]-n)/this.initalpha}contest(t,e,i){let r,n,a,s,o,l,h,c,m,g;for(c=~(1<<31),m=c,l=-1,h=l,r=0;r<this.netsize;r++)g=this.network[r],(n=g[0]-t)<0&&(n=-n),(a=g[1]-e)<0&&(a=-a),n+=a,(a=g[2]-i)<0&&(a=-a),(n+=a)<c&&(c=n,l=r),(s=n-(this.bias[r]>>this.intbiasshift-this.netbiasshift))<m&&(m=s,h=r),o=this.freq[r]>>this.betashift,this.freq[r]-=o,this.bias[r]+=o<<this.gammashift;return this.freq[l]+=this.beta,this.bias[l]-=this.betagamma,h}}class ur{constructor(t,e,i,r){this.exports={},this.EOF=-1,this.BITS=12,this.HSIZE=5003,this.maxbits=this.BITS,this.maxmaxcode=1<<this.BITS,this.htab=[],this.codetab=[],this.hsize=this.HSIZE,this.free_ent=0,this.clear_flg=!1,this.cur_accum=0,this.cur_bits=0,this.masks=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],this.accum=[],this.imgW=t,this.imgH=e,this.pixAry=i,this.initCodeSize=Math.max(2,r)}char_out(t,e){this.accum[this.a_count++]=t,254<=this.a_count&&this.flush_char(e)}cl_block(t){this.cl_hash(this.hsize),this.free_ent=this.ClearCode+2,this.clear_flg=!0,this.output(this.ClearCode,t)}cl_hash(e){for(let t=0;t<e;++t)this.htab[t]=-1}compress(t,e){let i,r,n,a,s,o,l;for(this.g_init_bits=t,this.clear_flg=!1,this.n_bits=this.g_init_bits,this.maxcode=this.MAXCODE(this.n_bits),this.ClearCode=1<<t-1,this.EOFCode=this.ClearCode+1,this.free_ent=this.ClearCode+2,this.a_count=0,a=this.nextPixel(),l=0,i=this.hsize;i<65536;i*=2)++l;l=8-l,o=this.hsize,this.cl_hash(o),this.output(this.ClearCode,e);t:while((n=this.nextPixel())!=this.EOF){if(i=(n<<this.maxbits)+a,r=n<<l^a,this.htab[r]==i){a=this.codetab[r];continue}if(0<=this.htab[r]){s=o-r,0===r&&(s=1);do{if((r-=s)<0&&(r+=o),this.htab[r]==i){a=this.codetab[r];continue t}}while(0<=this.htab[r])}this.output(a,e),a=n,this.free_ent<this.maxmaxcode?(this.codetab[r]=this.free_ent++,this.htab[r]=i):this.cl_block(e)}this.output(a,e),this.output(this.EOFCode,e)}encode(t){t.writeByte(this.initCodeSize),this.remaining=this.imgW*this.imgH,this.curPixel=0,this.compress(this.initCodeSize+1,t),t.writeByte(0)}flush_char(t){0<this.a_count&&(t.writeByte(this.a_count),t.writeBytes(this.accum,0,this.a_count),this.a_count=0)}MAXCODE(t){return(1<<t)-1}nextPixel(){if(0===this.remaining)return this.EOF;--this.remaining;let t=this.pixAry[this.curPixel++];return 255&t}output(t,e){this.cur_accum&=this.masks[this.cur_bits],0<this.cur_bits?this.cur_accum|=t<<this.cur_bits:this.cur_accum=t,this.cur_bits+=this.n_bits;while(8<=this.cur_bits)this.char_out(255&this.cur_accum,e),this.cur_accum>>=8,this.cur_bits-=8;if((this.free_ent>this.maxcode||this.clear_flg)&&(this.clear_flg?(this.maxcode=this.MAXCODE(this.n_bits=this.g_init_bits),this.clear_flg=!1):(++this.n_bits,this.n_bits==this.maxbits?this.maxcode=this.maxmaxcode:this.maxcode=this.MAXCODE(this.n_bits))),t==this.EOFCode){while(0<this.cur_bits)this.char_out(255&this.cur_accum,e),this.cur_accum>>=8,this.cur_bits-=8;this.flush_char(e)}}}class Sr{constructor(){this.chr={},this.bin=[];for(let t=0;t<256;t++)this.chr[t]=String.fromCharCode(t)}getData(){let e="",i=this.bin.length;for(let t=0;t<i;t++)e+=this.chr[this.bin[t]];return e}writeByte(t){this.bin.push(t)}writeUTFBytes(i){for(let t=i.length,e=0;e<t;e++)this.writeByte(i.charCodeAt(e))}writeBytes(i,r,n){for(let t=n||i.length,e=r||0;e<t;e++)this.writeByte(i[e])}}class fr{constructor(){this.exports={},this.transparent=null,this.repeat=-1,this.delay=0,this.started=!1,this.usedEntry=[],this.palSize=7,this.dispose=-1,this.closeStream=!1,this.firstFrame=!0,this.sizeSet=!1,this.sample=10,this.comment=""}setDelay(t){this.delay=Math.round(t/10)}setDispose(t){0<=t&&(this.dispose=t)}setRepeat(t){0<=t&&(this.repeat=t)}setTransparent(t){this.transparent=t}setComment(t){this.comment=t}addFrame(t,e){if(null===t||!this.started||null===this.out)throw new Error("Please call start method before calling addFrame");let i=!0;try{e?t instanceof Array?t.length==this.width*this.height*4?this.image=t:(console.log("Please set the correct size: ImageData length mismatch"),i=!1):(console.log("Please provide correct input"),i=!1):(this.image=t.getImageData(0,0,t.canvas.width,t.canvas.height).data,this.sizeSet||this.setSize(t.canvas.width,t.canvas.height)),this.getImagePixels(),this.analyzePixels(),this.firstFrame&&(this.writeLSD(),this.writePalette(),0<=this.repeat)&&this.writeNetscapeExt(),this.writeGraphicCtrlExt(),""!==this.comment&&this.writeCommentExt(),this.writeImageDesc(),this.firstFrame||this.writePalette(),this.writePixels(),this.firstFrame=!1}catch(t){i=!1}return i}download(e){if(null===this.out||0==this.closeStream)console.log("Please call start method and add frames and call finish method before calling download");else{e=void 0!==e?e.endsWith(".gif")?e:e+".gif":"download.gif";let t=document.createElement("a");t.download=e,t.href=URL.createObjectURL(new Blob([new Uint8Array(this.out.bin)],{type:"image/gif"})),t.click()}}finish(){if(!this.started)return!1;let e=!0;this.started=!1;try{this.out.writeByte(59),this.closeStream=!0}catch(t){e=!1}return e}reset(){this.transIndex=0,this.image=null,this.pixels=null,this.indexedPixels=null,this.colorTab=null,this.closeStream=!1,this.firstFrame=!0}setFrameRate(t){15!=t&&(this.delay=Math.round(100/t))}setQuality(t){this.sample=t=t<1?1:t}setSize(t,e){if(this.started&&!this.firstFrame)return;this.width=t,this.height=e,this.width<1&&(this.width=320),this.height<1&&(this.height=240),this.sizeSet=!0}start(){this.reset();let e=!0;this.closeStream=!1,this.out=new Sr;try{this.out.writeUTFBytes("GIF89a")}catch(t){e=!1}return this.started=e}cont(){this.reset();let t=!0;return this.closeStream=!1,this.out=new Sr,this.started=t}analyzePixels(){let t=this.pixels.length,i=t/3,r=(this.indexedPixels=[],new wr(this.pixels,t,this.sample)),n=(this.colorTab=r.process(),0);for(let e=0;e<i;e++){let t=r.map(255&this.pixels[n++],255&this.pixels[n++],255&this.pixels[n++]);this.usedEntry[t]=!0,this.indexedPixels[e]=t}this.pixels=null,this.colorDepth=8,this.palSize=7,null!==this.transparent&&(this.transIndex=this.findClosest(this.transparent))}findClosest(t){if(null===this.colorTab)return-1;let s=(16711680&t)>>16,o=(65280&t)>>8,l=255&t,h=0,c=256*256*256,e=this.colorTab.length;for(let a=0;a<e;){let t=s-(255&this.colorTab[a++]),e=o-(255&this.colorTab[a++]),i=l-(255&this.colorTab[a]),r=t*t+e*e+i*i,n=a/3;this.usedEntry[n]&&r<c&&(c=r,h=n),a++}return h}getImagePixels(){let r=this.width,t=this.height,n=(this.pixels=[],this.image),a=0;for(let i=0;i<t;i++)for(let e=0;e<r;e++){let t=i*r*4+4*e;this.pixels[a++]=n[t],this.pixels[a++]=n[t+1],this.pixels[a++]=n[t+2]}}writeGraphicCtrlExt(){this.out.writeByte(33),this.out.writeByte(249),this.out.writeByte(4);let t,e;e=null===this.transparent?t=0:(t=1,2),0<=this.dispose&&(e=7&this.dispose),e<<=2,this.out.writeByte(0|e|0|t),this.WriteShort(this.delay),this.out.writeByte(this.transIndex),this.out.writeByte(0)}writeCommentExt(){this.out.writeByte(33),this.out.writeByte(254),this.out.writeByte(this.comment.length),this.out.writeUTFBytes(this.comment),this.out.writeByte(0)}writeImageDesc(){this.out.writeByte(44),this.WriteShort(0),this.WriteShort(0),this.WriteShort(this.width),this.WriteShort(this.height),this.firstFrame?this.out.writeByte(0):this.out.writeByte(128|0|0|0|this.palSize)}writeLSD(){this.WriteShort(this.width),this.WriteShort(this.height),this.out.writeByte(128|112|0|this.palSize),this.out.writeByte(0),this.out.writeByte(0)}writeNetscapeExt(){this.out.writeByte(33),this.out.writeByte(255),this.out.writeByte(11),this.out.writeUTFBytes("NETSCAPE"+"2.0"),this.out.writeByte(3),this.out.writeByte(1),this.WriteShort(this.repeat),this.out.writeByte(0)}writePalette(){this.out.writeBytes(this.colorTab);let e=3*256-this.colorTab.length;for(let t=0;t<e;t++)this.out.writeByte(0)}WriteShort(t){this.out.writeByte(255&t),this.out.writeByte(t>>8&255)}writePixels(){let t=new ur(this.width,this.height,this.indexedPixels,this.colorDepth);t.encode(this.out)}stream(){return this.out}setProperties(t,e){this.started=t,this.firstFrame=e}}J.c.StiGifHelper=class{static saveToStream(n,t,o,e){let i=n.width,r=n.height,l=4*i,h=[],a=0;for(let t=0;t<r;t++)for(let t=0;t<i;t++){let t=n.imageData[a++],e=n.imageData[a++],i=n.imageData[a++],r=n.imageData[a++];h.push(i),h.push(e),h.push(t),h.push(r)}let c=null;if(t==J.c.StiPcxPaletteType.Monochrome){let a=it.create2(Number,r+1,i+1);for(let e=0;e<r;e++)for(let t=0;t<i;t++)a[e][t]=128;let s=[[1,9,3,11],[13,5,15,7],[4,12,2,10],[16,8,14,6]];for(let n=0;n<r;n++){let t=n*l;for(let r=0;r<i;r++){let e=Math.trunc(.3*h[t+2]+.59*h[t+1]+.11*h[t+0]),i=(t+=4,0);if(o==J.c.StiMonochromeDitheringType.None&&(i=128<=e?255:0),o==J.c.StiMonochromeDitheringType.FloydSteinberg){e+=a[n][r]-128,i=128<=e?255:0;let t=e-i;a[n][r+1]+=Math.trunc(7/16*t),0!=r&&(a[n+1][r-1]+=Math.trunc(3/16*t)),a[n+1][r+0]+=Math.trunc(5/16*t),a[n+1][r+1]+=Math.trunc(1/16*t)}o==J.c.StiMonochromeDitheringType.Ordered&&(i=Math.trunc(e>=255/17*s[3&r][3&n]?255:0)),a[n][r]=i}}c=[];for(let e=0;e<r;e++)for(let t=0;t<i;t++)c.push(a[e][t]),c.push(a[e][t]),c.push(a[e][t]),c.push(0)}if(t==J.c.StiPcxPaletteType.Color){c=[];let n=0;for(let t=0;t<r;t++)for(let t=0;t<i;t++){let t=h[n++],e=h[n++],i=h[n++],r=h[n++];c.push(i),c.push(e),c.push(t),c.push(r)}}let s=new fr,m=(s.start(),s.width=n.width,s.height=n.height,s.addFrame(c,!0),s.finish(),s.stream().bin);e.writeBytes(m)}}}let It=J.a.Import.BitConverter,Rt=Z.Base.CompoundDocument.BinaryWriter,Nt=Z.Base.CompoundDocument.CompoundDocument;{class Ht{static EncryptPackage(t,e,i){let r=new J.d.StiOfficeEncryptionInfo,n=r.keyEncryptors[0],a=(r.keyData.saltValue=this.getRandomBytes(16),n.saltValue=this.getRandomBytes(16),n.keyValue=this.getRandomBytes(n.keyBits/8),this.GetHashProvider(n)),s=this.GetPasswordHashSpinPrepending(a,n.saltValue,e,n.spinCount,n.hashSize),o=this.EncryptData(t,r,a),l=this.getRandomBytes(64),h=(this.SetHMAC(r,a,l,o),n.verifierHashInput=this.getRandomBytes(16),n.verifierHash=a.computeHash(n.verifierHashInput),this.GetFinalHash(a,this.BlockKey_HashInput,s)),c=this.GetFinalHash(a,this.BlockKey_HashValue,s),m=this.GetFinalHash(a,this.BlockKey_KeyValue,s),g=new K,p=(this.EncryptAgileFromKey(n,h,n.verifierHashInput,0,n.verifierHashInput.length,n.saltValue,g),n.encryptedVerifierHashInput=g.toArray(),g.close(),g=new K,this.EncryptAgileFromKey(n,c,n.verifierHash,0,n.verifierHash.length,n.saltValue,g),n.encryptedVerifierHashValue=g.toArray(),g.close(),g=new K,this.EncryptAgileFromKey(n,m,n.keyValue,0,n.keyValue.length,n.saltValue,g),n.encryptedKeyValue=g.toArray(),g.close(),new Nt);this.MakeDataSpaces(p),p.Storage.DataStreams.add("EncryptionInfo",r.saveToBinary()),p.Storage.DataStreams.add("EncryptedPackage",o),p.Save(i)}static EncryptData(r,n,a){let s=n.keyEncryptors[0],o=0,l=0,h=new K;h.write(It.getBytesInt32(r.length),0,4),h.writeByte(0),h.writeByte(0),h.writeByte(0),h.writeByte(0);while(o<r.length){let t=4096<r.length-o?4096:r.length-o,e=[],i=(it.copy2(n.keyData.saltValue,0,e,0,n.keyData.saltSize),it.copy2(It.getBytesInt32(l),0,e,n.keyData.saltSize,4),a.computeHash(e));this.EncryptAgileFromKey(s,s.keyValue,r,o,t,i,h),o+=t,l++}return h.flush(),h.toArray()}static SetHMAC(t,e,i,r){let n=this.GetFinalHash(e,this.BlockKey_HmacKey,t.keyData.saltValue),a=new K,s=(this.EncryptAgileFromKey(t.keyEncryptors[0],t.keyEncryptors[0].keyValue,i,0,i.length,n,a),t.dataIntegrity.encryptedHmacKey=a.toArray(),a.close(),this.GetHmacProvider(t.keyEncryptors[0],i)),o=s.computeHash(r);a=new K,n=this.GetFinalHash(e,this.BlockKey_HmacValue,t.keyData.saltValue),this.EncryptAgileFromKey(t.keyEncryptors[0],t.keyEncryptors[0].keyValue,o,0,o.length,n,a),t.dataIntegrity.encryptedHmacValue=a.toArray(),a.close()}static MakeDataSpaces(t){let e=new Z.Base.CompoundDocument.StoragePart,i=(t.Storage.SubStorage.add(""+"DataSpaces",e),e.DataStreams.add("Version",Ht.CreateVersionStream()),e.DataStreams.add("DataSpaceMap",this.CreateDataSpaceMap()),new Z.Base.CompoundDocument.StoragePart),r=(e.SubStorage.add("DataSpaceInfo",i),i.DataStreams.add("StrongEncryptionDataSpace",Ht.CreateStrongEncryptionDataSpaceStream()),new Z.Base.CompoundDocument.StoragePart),n=(e.SubStorage.add("TransformInfo",r),new Z.Base.CompoundDocument.StoragePart);r.SubStorage.add("StrongEncryptionTransform",n),n.DataStreams.add("Primary",Ht.CreateTransformInfoPrimary())}static CreateStrongEncryptionDataSpaceStream(){let t="StrongEncryptionTransform",e=new Rt;return e.writeInt32(8),e.writeInt32(1),e.writeInt32(2*t.length),e.write(Z.System.Text.Encoding.Unicode.getBytes(t+"\0")),e.flush(),e.toArray()}static CreateVersionStream(){let t=new Rt;return t.writeInt16(60),t.writeInt16(0),t.write(u.Unicode.getBytes("Microsoft.Container.DataSpaces")),t.writeInt32(1),t.writeInt32(1),t.writeInt32(1),t.flush(),t.toArray()}static CreateDataSpaceMap(){let t=new Rt,e=(t.writeInt32(8),t.writeInt32(1),"EncryptedPackage"),i="StrongEncryptionDataSpace";return t.writeInt32(2*(e.length+i.length)+22),t.writeInt32(1),t.writeInt32(0),t.writeInt32(2*e.length),t.write(u.Unicode.getBytes(e)),t.writeInt32(2*i.length),t.write(u.Unicode.getBytes(i+"\0")),t.flush(),t.toArray()}static CreateTransformInfoPrimary(){let t=new Rt,e="{FF9A3F03-56EF-4613-BDD5-5A41C1D07246}",i="Microsoft.Container.EncryptionTransform";return t.writeInt32(2*e.length+12),t.writeInt32(1),t.writeInt32(2*e.length),t.write(u.Unicode.getBytes(e)),t.writeInt32(2*i.length),t.write(u.Unicode.getBytes(i+"\0")),t.writeInt32(1),t.writeInt32(1),t.writeInt32(1),t.writeInt32(0),t.writeInt32(0),t.writeInt32(0),t.writeInt32(4),t.flush(),t.toArray()}static GetHashProvider(t){switch(t.hashAlgorithm){case J.d.StiOfficeHashAlgorithm.SHA512:return new Z.System.Crypt.SHA512;default:throw new Error(nt.format("Hash provider is unsupported. {0}",t.hashAlgorithm))}}static GetHmacProvider(t,e){switch(t.hashAlgorithm){case J.d.StiOfficeHashAlgorithm.SHA512:return new Z.System.Crypt.HMACSHA512(e);default:throw new Error(nt.format("Hash method {0} not supported.",t.hashAlgorithm))}}static IsPasswordValid(t,e){let i=t.computeHash(e.verifierHashInput);for(let t=0;t<i.length;t++)if(e.verifierHash[t]!=i[t])return!1;return!0}static EncryptAgileFromKey(t,e,i,r,n,a,s){let o=new Z.ExternalLibrary.aesjs.ModeOfOperation.cbc(this.FixHashSize(e,t.keyBits/8),this.FixHashSize(a,16,54)),l=n%t.blockSize==0?n:n+(t.blockSize-n%t.blockSize),h=it.create(Number,l),c=(it.copy2(i,r,h,0,n),o.encrypt(h)),m=[];for(let t=0;t<c.length;t++)m[t]=c[t];s.write(m)}static GetFinalHash(t,e,i){let r=it.create(Number,i.length+e.length),n=(it.copy3(i,r),it.copy2(e,0,r,i.length,e.length),t.computeHash(r));return n}static GetPasswordHashSpinPrepending(e,t,i,r,n){let a=it.create(Number,4+n),s=e.computeHash(this.CombinePassword(t,i));for(let t=0;t<r;t++)it.copy(It.getBytesInt32(t),0,a,4),it.copy2(s,0,a,4,s.length),s=e.computeHash(a);return s}static FixHashSize(i,r,n=0){if(i.length==r)return i;if(i.length<r){let e=[];it.copy(i,0,e,i.length);for(let t=i.length;t<r;t++)e[t]=n;return e}{let t=[];return it.copy(i,0,t,r),t}}static CombinePassword(t,e){""==e&&(e="VelvetSweatshop");let i=u.Unicode.getBytes(e),r=[];return it.copy(t,0,r,t.length),it.copy2(i,0,r,t.length,i.length),r}static getRandomBytes(e){let i=[],r=0;for(let t=0;t<e;t++){do{r=65535*Math.random()&255}while(0==r);i.push(r)}return i}}Ht.BlockKey_HashInput=[254,167,210,118,59,75,158,121],Ht.BlockKey_HashValue=[215,170,15,109,48,97,52,78],Ht.BlockKey_KeyValue=[20,110,11,231,171,172,208,214],Ht.BlockKey_HmacKey=[95,178,173,1,12,185,225,246],Ht.BlockKey_HmacValue=[160,103,127,2,178,44,132,51],J.d.StiOfficeEncryptedPackageHelper=Ht}{let e;(a=e=J.d.StiOfficeCipherAlgorithm||(J.d.StiOfficeCipherAlgorithm={}))[a["AES"]=0]="AES",a[a["RC2"]=1]="RC2",a[a["RC4"]=2]="RC4",a[a["DES"]=3]="DES",a[a["DESX"]=4]="DESX",a[a["TRIPLE_DES"]=5]="TRIPLE_DES",a[a["TRIPLE_DES_112"]=6]="TRIPLE_DES_112";let r;(n=r=J.d.StiOfficeChainingMode||(J.d.StiOfficeChainingMode={}))[n["ChainingModeCBC"]=0]="ChainingModeCBC",n[n["ChainingModeCFB"]=1]="ChainingModeCFB";let i;(t=i=J.d.StiOfficeHashAlgorithm||(J.d.StiOfficeHashAlgorithm={}))[t["SHA1"]=0]="SHA1",t[t["SHA256"]=1]="SHA256",t[t["SHA384"]=2]="SHA384",t[t["SHA512"]=3]="SHA512",t[t["MD5"]=4]="MD5",t[t["MD4"]=5]="MD4",t[t["MD2"]=6]="MD2",t[t["RIPEMD128"]=7]="RIPEMD128",t[t["RIPEMD160"]=8]="RIPEMD160",t[t["WHIRLPOOL"]=9]="WHIRLPOOL";class br{constructor(){this.saltSize=16,this.blockSize=16,this.keyBits=256,this.hashSize=64,this.cipherAlgorithm=e.AES,this.cipherChaining=r.ChainingModeCBC,this.hashAlgorithm=i.SHA512,this.saltValue=null}}J.d.StiOfficeKeyDataInfo=br;class Er{constructor(){this.encryptedHmacKey=null,this.encryptedHmacValue=null}}J.d.StiOfficeDataIntegrityInfo=Er;class vr extends br{constructor(){super(...arguments),this.spinCount=1e5,this.encryptedVerifierHashInput=null,this.encryptedVerifierHashValue=null,this.encryptedKeyValue=null}}J.d.StiOfficeKeyEncryptorInfo=vr;class yr{saveToXml(){return u.UTF8.getString(this.saveToBytes())}saveToBinary(){let t=this.saveToBytes(),e=0,i=(239==t[0]&&187==t[1]&&191==t[2]&&(e=3),it.create(Number,8+t.length-e));return i[0]=4,i[2]=4,i[4]=64,it.copy2(t,e,i,8,t.length-e),i}saveToBytes(){let t=new K,e=new w(u.UTF8,t);e.indentation=0,e.formatting=d.None,e.writeStartDocument(),e.writeStartElement("encryption"),e.writeAttributeString("xmlns","http://schemas.microsoft.com/office/2006/encryption"),e.writeAttributeString("xmlns:p","http://schemas.microsoft.com/office/2006/keyEncryptor/password"),e.writeAttributeString("xmlns:c","http://schemas.microsoft.com/office/2006/keyEncryptor/certificate"),e.writeStartElement("keyData"),e.writeAttributeString("saltSize",this.keyData.saltSize.toString()),e.writeAttributeString("blockSize",this.keyData.blockSize.toString()),e.writeAttributeString("keyBits",this.keyData.keyBits.toString()),e.writeAttributeString("hashSize",this.keyData.hashSize.toString()),e.writeAttributeString("cipherAlgorithm",yr.getCipherAlgorithmString(this.keyData.cipherAlgorithm)),e.writeAttributeString("cipherChaining",r[this.keyData.cipherChaining]),e.writeAttributeString("hashAlgorithm",yr.getHashAlgorithmString(this.keyData.hashAlgorithm)),e.writeAttributeString("saltValue",Z.System.Convert.toBase64String(this.keyData.saltValue)),e.writeEndElement(),e.writeStartElement("dataIntegrity"),e.writeAttributeString("encryptedHmacKey",Z.System.Convert.toBase64String(this.dataIntegrity.encryptedHmacKey)),e.writeAttributeString("encryptedHmacValue",Z.System.Convert.toBase64String(this.dataIntegrity.encryptedHmacValue)),e.writeEndElement(),e.writeStartElement("keyEncryptors");for(let t of this.keyEncryptors)e.writeStartElement("keyEncryptor"),e.writeAttributeString("uri","http://schemas.microsoft.com/office/2006/keyEncryptor/password"),e.writeStartElement("p:encryptedKey"),e.writeAttributeString("spinCount",t.spinCount.toString()),e.writeAttributeString("saltSize",t.saltSize.toString()),e.writeAttributeString("blockSize",t.blockSize.toString()),e.writeAttributeString("keyBits",t.keyBits.toString()),e.writeAttributeString("hashSize",t.hashSize.toString()),e.writeAttributeString("cipherAlgorithm",yr.getCipherAlgorithmString(t.cipherAlgorithm)),e.writeAttributeString("cipherChaining",r[t.cipherChaining]),e.writeAttributeString("hashAlgorithm",yr.getHashAlgorithmString(t.hashAlgorithm)),e.writeAttributeString("saltValue",Z.System.Convert.toBase64String(t.saltValue)),e.writeAttributeString("encryptedVerifierHashInput",Z.System.Convert.toBase64String(t.encryptedVerifierHashInput)),e.writeAttributeString("encryptedVerifierHashValue",Z.System.Convert.toBase64String(t.encryptedVerifierHashValue)),e.writeAttributeString("encryptedKeyValue",Z.System.Convert.toBase64String(t.encryptedKeyValue)),e.writeEndElement(),e.writeEndElement();e.writeEndElement(),e.writeEndElement(),e.writeEndDocument(),e.flush();let i=t.toArray();return e.close(),i}static getCipherAlgorithmString(t){if(t==e.TRIPLE_DES)return"3DES";if(t==e.TRIPLE_DES_112)return"3DES_112";return e[t]}static getHashAlgorithmString(t){if(t==i.RIPEMD128)return"RIPEMD-128";if(t==i.RIPEMD160)return"RIPEMD-160";if(t==i.SHA1)return"SHA-1";return i[t]}constructor(t=!0){this.keyData=new br,this.dataIntegrity=new Er,this.keyEncryptors=[new vr],this.keyData=new br,this.dataIntegrity=new Er,this.keyEncryptors=[],t&&this.keyEncryptors.push(new vr)}}J.d.StiOfficeEncryptionInfo=yr}J.c.StiPcxHelper=class{static dwByte(t,e,i){t[e]=i}static dwByte2(t,e,i,r){this.dwByte(t,e,i),this.dwByte(t,e+1,r)}static dwByte3(t,e,i,r,n){this.dwByte2(t,e,i,r),this.dwByte(t,e+2,n)}static dwWord(t,e,i){t[e+0]=255&i,t[e+1]=i>>8&255}static dwEncodedData(t,e,i){1==i&&192!=(192&e)||t.writeByte(192|i),t.writeByte(e)}static saveToStream(n,t,o,i){let l=n.width,r=n.height,h=4*l,c=[],a=0;for(let t=0;t<r;t++)for(let t=0;t<l;t++){let t=n.imageData[a++],e=n.imageData[a++],i=n.imageData[a++],r=n.imageData[a++];c.push(i),c.push(e),c.push(t),c.push(r)}let m=0,g=null;if(t==J.c.StiPcxPaletteType.Monochrome){let a=it.create2(Number,r+1,l+1);for(let e=0;e<r;e++)for(let t=0;t<l;t++)a[e][t]=128;let s=[[1,9,3,11],[13,5,15,7],[4,12,2,10],[16,8,14,6]];for(let n=0;n<r;n++){let t=n*h;for(let r=0;r<l;r++){let e=Math.trunc(.3*c[t+2]+.59*c[t+1]+.11*c[t+0]),i=(t+=4,0);if(o==J.c.StiMonochromeDitheringType.None&&(i=128<=e?255:0),o==J.c.StiMonochromeDitheringType.FloydSteinberg){e+=a[n][r]-128,i=128<=e?255:0;let t=e-i;a[n][r+1]+=Math.trunc(7/16*t),0!=r&&(a[n+1][r-1]+=Math.trunc(3/16*t)),a[n+1][r+0]+=Math.trunc(5/16*t),a[n+1][r+1]+=Math.trunc(1/16*t)}o==J.c.StiMonochromeDitheringType.Ordered&&(i=Math.trunc(e>=255/17*s[3&r][3&n]?255:0)),a[n][r]=i}}m=2*(Math.trunc((l-1)/16)+1),g=[];for(let n=0;n<r;n++){let e=128,i=n*m,r=0;for(let t=0;t<l;t++)0!=a[n][t]&&(r|=e),0==(e>>=1)&&(g[i]=r,r=0,e=128,i++);128!=e&&(g[i]=r)}}if(t==J.c.StiPcxPaletteType.Color){m=2*(Math.trunc((l-1)/2)+1),g=it.create(Number,3*m*r);for(let t=0;t<r;t++){let e=t*h,i=3*m*t;for(let t=0;t<l;t++)g[i+0*m]=c[e+2],g[i+1*m]=c[e+1],g[i+2*m]=c[e+0],e+=4,i+=1}}let e=it.create(Number,128),s=(this.dwByte(e,0,10),this.dwByte(e,1,5),this.dwByte(e,2,1),t==J.c.StiPcxPaletteType.Monochrome&&this.dwByte(e,3,1),t==J.c.StiPcxPaletteType.Color&&this.dwByte(e,3,8),this.dwWord(e,4,0),this.dwWord(e,6,0),this.dwWord(e,8,l-1),this.dwWord(e,10,r-1),this.dwWord(e,12,72),this.dwWord(e,14,72),this.dwByte3(e,16,0,0,0),this.dwByte3(e,19,255,255,255),this.dwByte(e,64,0),t==J.c.StiPcxPaletteType.Monochrome&&this.dwByte(e,65,1),t==J.c.StiPcxPaletteType.Color&&this.dwByte(e,65,3),this.dwWord(e,66,m),this.dwWord(e,68,1),i.write(e,0,128),1),p=g[0];for(let e=1;e<g.length;e++){let t=g[e];p==t?63!=++s&&(e+1)%m!=0||(this.dwEncodedData(i,p,s),s=0):(0!=s&&this.dwEncodedData(i,p,s),p=t,s=1)}0!=s&&this.dwEncodedData(i,p,s),i.flush()}},J.c.StiTiffHelper=class{static toTiffImage(t,e,i){let a=0,r=258,s=0,o=[],n,l="canvas-to-tiff 0.4\0",h=!1,c=96,m=96,g=t.length,p=r+g,d=new ArrayBuffer(p),w=new Uint8Array(d),u=new DataView(d),S=0,f=new Date,b;return v(h?18761:19789),v(42),y(8),F(),T(254,4,1,0),T(256,4,1,e),T(257,4,1,i),T(258,3,4,a,8),T(259,3,1,1),T(262,3,1,2),T(273,4,1,r,0),T(277,3,1,4),T(279,4,1,g),T(282,5,1,a,8),T(283,5,1,a,8),T(296,3,1,2),T(305,2,l.length,a,A(l)),T(306,2,20,a,20),T(338,3,1,2),C(),y(524296),y(524296),y(c),y(1),y(m),y(1),x(l),b=f.getFullYear()+":"+E(f.getMonth()+1)+":"+E(f.getDate())+" ",x(b+=E(f.getHours())+":"+E(f.getMinutes())+":"+E(f.getSeconds())),w.set(t,r),new Uint8Array(d);function E(t){return 1===(t+="").length?"0"+t:t}function v(t){u.setUint16(S,t,h),S+=2}function y(t){u.setUint32(S,t,h),S+=4}function x(t){let e=0;while(e<t.length)u.setUint8(S++,255&t.charCodeAt(e++));1&S&&S++}function A(t){let e=t.length;return 1&e?e+1:e}function T(t,e,i,r,n=null){v(t),v(e),y(i),n&&(a+=n,o.push(S)),1!==i||3!==e||n?y(r):(v(r),v(0)),s++}function F(t=null){n=t||S,S+=2}function C(){u.setUint16(n,s,h),y(0);let r=14+12*s;for(let t=0,e,i;t<o.length;t++)e=o[t],i=u.getUint32(e,h),u.setUint32(e,i+r,h)}}static saveToStream(n,t,o,e){let i=n.width,r=n.height,l=4*i,h=[],a=0;for(let t=0;t<r;t++)for(let t=0;t<i;t++){let t=n.imageData[a++],e=n.imageData[a++],i=n.imageData[a++],r=n.imageData[a++];h.push(i),h.push(e),h.push(t),h.push(r)}let c=null;if(t==J.c.StiPcxPaletteType.Monochrome){let a=it.create2(Number,r+1,i+1);for(let e=0;e<r;e++)for(let t=0;t<i;t++)a[e][t]=128;let s=[[1,9,3,11],[13,5,15,7],[4,12,2,10],[16,8,14,6]];for(let n=0;n<r;n++){let t=n*l;for(let r=0;r<i;r++){let e=Math.trunc(.3*h[t+2]+.59*h[t+1]+.11*h[t+0]),i=(t+=4,0);if(o==J.c.StiMonochromeDitheringType.None&&(i=128<=e?255:0),o==J.c.StiMonochromeDitheringType.FloydSteinberg){e+=a[n][r]-128,i=128<=e?255:0;let t=e-i;a[n][r+1]+=Math.trunc(7/16*t),0!=r&&(a[n+1][r-1]+=Math.trunc(3/16*t)),a[n+1][r+0]+=Math.trunc(5/16*t),a[n+1][r+1]+=Math.trunc(1/16*t)}o==J.c.StiMonochromeDitheringType.Ordered&&(i=Math.trunc(e>=255/17*s[3&r][3&n]?255:0)),a[n][r]=i}}c=[];for(let e=0;e<r;e++)for(let t=0;t<i;t++)c.push(a[e][t]),c.push(a[e][t]),c.push(a[e][t]),c.push(255)}if(t==J.c.StiPcxPaletteType.Color){c=[];let n=0;for(let t=0;t<r;t++)for(let t=0;t<i;t++){let t=h[n++],e=h[n++],i=h[n++],r=h[n++];c.push(i),c.push(e),c.push(t),c.push(r)}}let s=this.toTiffImage(c,i,r);e.writeBytes(s)}};let Mt=Z.System.Drawing.ColorTranslator,Ot=Z.System.IO.TextWriter,Ht=(J.c.StiHtml5ExportService=class extends J.c.StiExportService{implements(){let t=[J.c.IStiHtml5ExportService];return(this.implements=()=>t)()}get defaultExtension(){if(this.compressToArchive)return"zip";return"html"}get exportFormat(){return J.a.StiExportFormat.Html5}get groupCategory(){return"Web"}get position(){return J.c.StiExportPosition.Html5}get exportNameInMenu(){return e.get("Export","ExportTypeHtml5File")}exportTo(t,e,i){let r=new Ot,n=new J.c.StiHtmlTextWriter(r);this.exportHtml(t,n,i),e.write(u.UTF8.getBytes(r.getStringBuilder().toString()))}getFilter(){if(this.compressToArchive)return e.get("FileFilters","ZipArchives");return e.get("FileFilters","HtmlFiles")}renderPage(t,e){let i=J.c.StiSvgHelper.saveToString(t,e,!1,this.imageResolution);this.htmlWriter.write(i),this.htmlWriter.flush()}renderStartDoc(t,e){this.htmlWriter.write("<!DOCTYPE html>"),this.htmlWriter.writeLine(),this.htmlWriter.indent++,this.htmlWriter.writeFullBeginTag("head"),this.htmlWriter.writeLine(),this.htmlWriter.indent++,this.htmlWriter.writeFullBeginTag("title"),this.htmlWriter.write(this.report.reportAlias),this.htmlWriter.writeEndTag("title"),this.htmlWriter.writeLine(),this.htmlWriter.writeBeginTag("meta"),this.htmlWriter.writeAttribute("charset",e.webName),this.htmlWriter.writeEndTag("meta"),this.htmlWriter.writeLine(),this.htmlWriter.indent--,this.htmlWriter.writeEndTag("head"),this.htmlWriter.writeLine(),this.htmlWriter.writeBeginTag("body"),this.htmlWriter.writeAttribute("bgcolor",Mt.toHtml(rt.lightBlue)),this.htmlWriter.writeAttribute("style","text-align:center;"),this.htmlWriter.write(">"),this.htmlWriter.indent++,this.htmlWriter.writeLine()}renderEndDoc(){this.htmlWriter.indent--,this.htmlWriter.writeEndTag("body"),this.htmlWriter.indent--,this.htmlWriter.writeLine(),this.htmlWriter.writeEndTag("html"),this.htmlWriter.writeLine(),this.htmlWriter.writeLine("\x3c!-- "+J.c.StiExportUtils.getReportVersion(this.report)+" --\x3e")}exportHtml(e,i,t){if(null==Z.Base[["St","iL","ic","en","se"].join("")].key&&console.warn("You are using a trial version of the Stimulsoft product!"),J.a.StiLogService.write(this[Z.System.StiObject.stimulsoft]().getType(),"Export report to Html format"),null==t)throw new Error("The 'settings' argument cannot be equal in null.");this.imageFormat=t.imageFormat,this.imageResolution=t.imageResolution,this.imageQuality=t.imageQuality,this.compressToArchive=t.compressToArchive;let r=t.continuousPages,n=(this.htmlWriter=i,t.pageRange.getSelectedPages(e.renderedPages));try{if(this.report=e,1==this.renderAsDocument&&this.renderStartDoc(n,t.encoding),!(Z.Base.vAeXc.eMAio.UUyjq()||(Z.Base.vAeXc.eMAio.rdCzm()||Z.Base.vAeXc.eMAio.CWsHL())&&Z.System.NodeJs.isStandaloneVersion)){let t=nt.format("{3}{0}{2}{4}{1}",String.fromCharCode(114),String.fromCharCode(108),String.fromCharCode(105),String.fromCharCode(84),String.fromCharCode(97));i.write('<div style="FONT-SIZE: 10px; COLOR: red; FONT-FAMILY: Arial"'+">"+"Stimulsoft Reports - "+t+" Version</div>")}this.htmlWriter.indent=0;for(let t of n.list)n.getPage(t),this.invokeExporting(t,n,0,1),this.renderPage(e,t),r&&this.htmlWriter.write("<br/>"),this.htmlWriter.writeLine();1==this.renderAsDocument&&this.renderEndDoc(),this.htmlWriter.flush()}finally{e=null}}constructor(){super(),this.renderAsDocument=!0,this.multipleFiles=!1,this.fileName="",this.htmlWriter=null,this.imageQuality=.75,this.imageResolution=96,this.compressToArchive=!1}},J.d.StiOfficeEncryptedPackageHelper),Wt=J.d.StiOfficeImageFormatHelper,zt=Z.System.Collections.List,Ut=J.a.Dashboard.StiDashboardExport,Xt=Z.System.Drawing.Image,Gt=Z.System.Drawing.Size,mt=Z.System.Drawing.Rectangle,O=J.a.Components.StiImageRotation;{class xr extends J.c.StiExportService{constructor(){super(...arguments),this.matrix=null,this.fontList=null,this.fillList=null,this.borderList=null,this.xfList=null,this.sstList=null,this.sstHash=null,this.sstHashIsTags=null,this.imageList=null,this.formatList=null,this.sstCount=0,this.sheetNameList=null,this.imageListOffset=0,this.printAreasList=null,this.matrixList=null,this.firstPageIndexList=null,this.hyperlinkList=null,this.minRowList=null,this.maxRowList=null,this.useOnePageHeaderAndFooter=!1,this.dataExportMode=J.c.StiDataExportMode.AllBands,this.exportObjectFormatting=!0,this.exportEachPageToSheet=!1,this.exportHorizontalPageBreaks=!1,this.imageResolution=1,this.imageQuality=.75,this.imageFormat=J.a.ImageFormat.Jpeg,this.imageResolutionMode=J.c.StiImageResolutionMode.Auto,this.imageCache=null,this.restrictEditing=J.c.StiExcelRestrictEditing.No,this.protectionPassword=null,this.exportCache=null,this.reportCulture=null,this.englishCulture=new q("en-US"),this.docCompanyString=null,this.docLastModifiedString=null,this.xmlIndentation=1,this.wrongUrlSymbols=" \"#'*,;<>[^`{|}",this.netTicksPerDay=1e3*1e3*60*60*24,this.refChars="ABCDEFGHIJKLMNOPQRSTUVWXYZ",this.HiToTwips=14.4/20*1.01,this.TwipsToColinfo=2.438*.976*.075}implements(){let t=[J.c.IStiExcelExportService];return(this.implements=()=>t)()}get exportFormat(){return J.a.StiExportFormat.Excel}exportTo(e,t,i){if(null==this.exportCache){let t=i;this.exportCache=new J.c.StiExportImageCache(t.imageFormat,!0,new J.a.StiImageCache(Z.StiOptions.Export.Excel.AllowImageComparer,!0,t.imageFormat,t.imageQuality,!1),Math.max(t.imageResolution,10)/100,e)}this.exportExcel(e,t,i)}exportToAsync(i,r,n,a){setTimeout(async()=>{var e;try{let t=a;if(this.exportCache=new J.c.StiExportImageCache(t.imageFormat,!0,new J.a.StiImageCache(Z.StiOptions.Export.Excel.AllowImageComparer,!0,t.imageFormat,t.imageQuality,!1),Math.max(t.imageResolution,10)/100,r),await J.c.StiExportImageHelper.convertAllImages(r,Z.System.Drawing.Imaging.ImageFormat.Jpeg,!1,this.exportFormat,this.exportCache),!r.isDocument&&null!=(e=r.getCurrentPage())&&e.is(Lt))return await Ut.export(r,n,a),void i();this.exportTo(r,n,a),null!=r&&null!=r.preparedExportImages&&(r.preparedExportImages.clear(),r.preparedExportImages=null)}catch(t){if(o.log(t,r,`Export Error`).isImportant)return i(o.getMessage(t))}i()},0)}getLineStyle(t){let e=ot.None,i=0,r=1.5,n=3;switch(null!=t&&(e=t.style,i=t.size),e){case ot.Solid:if(i>n)return"thick";if(i>r)return"medium";return"thin";case ot.Dot:if(i>r)return"dotted";return"hair";case ot.Dash:if(i>r)return"mediumDashed";return"dashed";case ot.DashDot:if(i>r)return"mediumDashDot";return"dashDot";case ot.DashDotDot:if(i>r)return"mediumDashDotDot";return"dashDotDot";case ot.Double:return"double";default:return null}}getRefString(t,e){let i=$.trunc(t/26),r=$.trunc(t%26),n=new ct;return 0<i&&n.append(this.refChars.charAt(i-1)),n.append(this.refChars.charAt(r)),n.append((e+1).toString()),n.toString()}getRefAbsoluteString(t,e){let i=$.trunc(t/26),r=$.trunc(t%26),n=new ct;return n.append("$"),0<i&&n.append(this.refChars.charAt(i-1)),n.append(this.refChars.charAt(r)),n.append("$"),n.append((e+1).toString()),n.toString()}floatToString(t){let e=t.toString()[Z.System.StiObject.stimulsoft]().replaceAll(",",".");return e}stringToUrl(i){let r=new ct;for(let e=0;e<i.length;e++){let t=i.charAt(e);if("'"==t)continue;t.charCodeAt(0)<32||-1!=this.wrongUrlSymbols.indexOf(t)?r.append(nt.format("%{0:x2}",t.charCodeAt(0))):r.append(t)}return r.toString()}getFontNumber(e){if(0<this.fontList.length)for(let t=0;t<this.fontList.length;t++)if(this.fontList[t][Z.System.StiObject.stimulsoft]().equals(e))return t;this.fontList.push(e);let t=this.fontList.length-1;return t}getFillNumber(e){if(0<this.fillList.length)for(let t=0;t<this.fillList.length;t++)if(this.fillList[t][Z.System.StiObject.stimulsoft]().equals(e))return t;this.fillList.push(e);let t=this.fillList.length-1;return t}getBorderNumber(e){if(0<this.borderList.length)for(let t=0;t<this.borderList.length;t++)if(this.borderList[t][Z.System.StiObject.stimulsoft]().equals(e))return t;this.borderList.push(e);let t=this.borderList.length-1;return t}getXFNumber(e){if(0<this.xfList.length)for(let t=0;t<this.xfList.length;t++)if(this.xfList[t].equalDataXF(e))return t;this.xfList.push(e);let t=this.xfList.length-1;return t}getSSTNumber(t){if(this.sstCount++,0<this.sstList.length&&this.sstHash.containsKey(t))return this.sstHash.get(t);this.sstList.push(t);let e=this.sstList.length-1;return this.sstHash.add(t,e),e}getFormatNumber(e){if(0<this.formatList.length)for(let t=0;t<this.formatList.length;t++)if(this.formatList[t]==e)return t+164;this.formatList.push(e);let t=this.formatList.length-1;return t+164}convert(t){return t*this.HiToTwips}convertToEMU(t){return Math.round(914400*t/100*.93385)}compareExcellSheetNames(t,e){let i=t,r=(null!=i&&0!=i.length||(i=""),e);return null!=r&&0!=r.length||(r=""),i==r}prepareData(){this.fontList=new Array,this.fillList=new Array,this.borderList=new Array,this.xfList=new Array,this.sstList=[],this.sstHash=new C,this.sstHashIsTags=new C,this.imageList=[],this.formatList=[],this.sheetNameList=[],this.sstCount=0,this.printAreasList=[],this.matrixList=[],this.firstPageIndexList=[],this.minRowList=[],this.maxRowList=[],null!=this.exportCache?this.imageCache=this.exportCache.imageCache:this.imageCache=new J.a.StiImageCache(Z.StiOptions.Export.Excel.AllowImageComparer,!0,this.imageFormat,this.imageQuality,!1);let t=new Ar("Arial",!1,!1,!1,!1,10,rt.black,1,0),e=(this.getFontNumber(t),new Tr("none",rt.transparent,rt.black)),i=(this.getFillNumber(e),e=new Tr("gray125",rt.transparent,rt.black),this.getFillNumber(e),new Fr(null,null,null,null)),r=(this.getBorderNumber(i),new Cr(0,0,0,0,0,at.Left,st.Bottom,0,!1,!1,!1));this.getXFNumber(r)}writeContentTypes(){let t=new K,e=new w(u.UTF8,t);e.writeStartDocument(),e.writeStartElement("Types"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/content-types"),e.writeStartElement("Default"),e.writeAttributeString("Extension","rels"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-package.relationships+xml"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","xml"),e.writeAttributeString("ContentType","application/xml"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","jpeg"),e.writeAttributeString("ContentType","image/jpeg"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","png"),e.writeAttributeString("ContentType","image/png"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","vml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.vmlDrawing"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/docProps/app.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.extended-properties+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/docProps/core.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-package.core-properties+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/xl/workbook.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"),e.writeEndElement();for(let t=0;t<this.sheetNameList.length;t++)e.writeStartElement("Override"),e.writeAttributeString("PartName",nt.format("/xl/worksheets/sheet{0}.xml",t+1)),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"),e.writeEndElement();e.writeStartElement("Override"),e.writeAttributeString("PartName","/xl/styles.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"),e.writeEndElement();for(let t=0;t<this.sheetNameList.length;t++)e.writeStartElement("Override"),e.writeAttributeString("PartName",nt.format("/xl/drawings/drawing{0}.xml",t+1)),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.drawing+xml"),e.writeEndElement();return 0<this.sstList.length&&(e.writeStartElement("Override"),e.writeAttributeString("PartName","/xl/sharedStrings.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"),e.writeEndElement()),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeMainRels(){let t=new K,e=new w(u.UTF8,t);return e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId1"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument"),e.writeAttributeString("Target","xl/workbook.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId2"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties"),e.writeAttributeString("Target","docProps/core.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId3"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties"),e.writeAttributeString("Target","docProps/app.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeDocPropsApp(){let t=new K,e=new w(u.UTF8,t);e.writeStartDocument(),e.writeStartElement("Properties"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"),e.writeAttributeString("xmlns:vt","http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"),e.writeElementString("Application",J.c.StiExportUtils.getReportVersion(this.report)),e.writeElementString("DocSecurity","0"),e.writeElementString("ScaleCrop","false"),e.writeElementString("Company",null==this.docCompanyString?"":this.docCompanyString),e.writeElementString("LinksUpToDate","false"),e.writeElementString("SharedDoc","false"),e.writeElementString("HyperlinksChanged","false"),e.writeElementString("AppVersion","12.0000"),e.writeStartElement("HeadingPairs"),e.writeStartElement("vt:vector"),e.writeAttributeString("size","4"),e.writeAttributeString("baseType","variant"),e.writeStartElement("vt:variant"),e.writeElementString("vt:lpstr","Worksheets"),e.writeEndElement(),e.writeStartElement("vt:variant"),e.writeElementString("vt:i4",this.sheetNameList.length.toString()),e.writeEndElement(),e.writeStartElement("vt:variant"),e.writeElementString("vt:lpstr","Named Ranges"),e.writeEndElement(),e.writeStartElement("vt:variant"),e.writeElementString("vt:i4",this.sheetNameList.length.toString()),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("TitlesOfParts"),e.writeStartElement("vt:vector"),e.writeAttributeString("size",(2*this.sheetNameList.length).toString()),e.writeAttributeString("baseType","lpstr");for(let t=0;t<this.sheetNameList.length;t++)e.writeElementString("vt:lpstr",this.sheetNameList[t]);for(let t=0;t<this.sheetNameList.length;t++)e.writeElementString("vt:lpstr",nt.format("'{0}'!Print_Area",this.sheetNameList[t]));return e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeDocPropsCore(){let t,e,i,r,n=new K,a=new w(u.UTF8,n),s=(a.writeStartDocument(),a.writeStartElement("cp:coreProperties"),a.writeAttributeString("xmlns:cp","http://schemas.openxmlformats.org/package/2006/metadata/core-properties"),a.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),a.writeAttributeString("xmlns:dcterms","http://purl.org/dc/terms/"),a.writeAttributeString("xmlns:dcmitype","http://purl.org/dc/dcmitype/"),a.writeAttributeString("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance"),nt.format("{0}{1}",_.now.toString("yyyy-MM-dd"),_.now.toString("THH:mm:ssZ")));return a.writeElementString("dc:title",null!=(t=this.report.reportName)?t:""),a.writeElementString("dc:subject",null!=(e=this.report.reportAlias)?e:""),a.writeElementString("dc:creator",null!=(i=this.report.reportAuthor)?i:""),a.writeElementString("dc:description",null!=(r=this.report.reportDescription)?r:""),null!=this.docLastModifiedString&&a.writeElementString("cp:lastModifiedBy",this.docLastModifiedString),a.writeStartElement("dcterms:created"),a.writeAttributeString("xsi:type","dcterms:W3CDTF"),a.writeString(s),a.writeEndElement(),a.writeStartElement("dcterms:modified"),a.writeAttributeString("xsi:type","dcterms:W3CDTF"),a.writeString(s),a.writeEndElement(),a.writeElementString("cp:contentStatus",Z.StiVersion.platform()),a.writeFullEndElement(),a.writeEndDocument(),a.flush(),n}writeWorkbookRels(){let t=new K,e=new w(u.UTF8,t);e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships");for(let t=0;t<this.sheetNameList.length;t++)e.writeStartElement("Relationship"),e.writeAttributeString("Id",nt.format("rId{0}",t+1)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet"),e.writeAttributeString("Target",nt.format("worksheets/sheet{0}.xml",t+1)),e.writeEndElement();return e.writeStartElement("Relationship"),e.writeAttributeString("Id",nt.format("rId{0}",this.sheetNameList.length+2)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles"),e.writeAttributeString("Target","styles.xml"),e.writeEndElement(),0<this.sstCount&&(e.writeStartElement("Relationship"),e.writeAttributeString("Id",nt.format("rId{0}",this.sheetNameList.length+3)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings"),e.writeAttributeString("Target","sharedStrings.xml"),e.writeEndElement()),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeWorkbook(){let t=new K,r=new w(u.UTF8,t);r.writeStartDocument(),r.writeStartElement("workbook"),r.writeAttributeString("xmlns","http://schemas.openxmlformats.org/spreadsheetml/2006/main"),r.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),r.writeStartElement("fileVersion"),r.writeAttributeString("appName","xl"),r.writeAttributeString("lastEdited","4"),r.writeAttributeString("lowestEdited","4"),r.writeAttributeString("rupBuild","4505"),r.writeEndElement(),r.writeStartElement("workbookPr"),r.writeAttributeString("defaultThemeVersion","124226"),r.writeEndElement(),r.writeStartElement("bookViews"),r.writeStartElement("workbookView"),r.writeAttributeString("xWindow","120"),r.writeAttributeString("yWindow","15"),r.writeAttributeString("windowWidth","18975"),r.writeAttributeString("windowHeight","11955"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("sheets");for(let t=0;t<this.sheetNameList.length;t++)r.writeStartElement("sheet"),r.writeAttributeString("name",this.sheetNameList[t]),r.writeAttributeString("sheetId",nt.format("{0}",t+1)),r.writeAttributeString("r:id",nt.format("rId{0}",t+1)),r.writeEndElement();r.writeEndElement(),r.writeStartElement("definedNames");for(let i=0;i<this.sheetNameList.length;i++){let t=this.printAreasList[i],e=(1048575<t.height&&(t.height=1048575),16383<t.width&&(t.width=16383),this.getRefAbsoluteString(t.width,t.height));r.writeStartElement("definedName"),r.writeAttributeString("name","_xlnm.Print_Area"),r.writeAttributeString("localSheetId",i.toString()),r.writeString(nt.format("'{0}'!$A$1:{1}",this.sheetNameList[i],e)),r.writeEndElement()}return r.writeEndElement(),r.writeStartElement("calcPr"),r.writeAttributeString("calcId","124519"),r.writeEndElement(),r.writeFullEndElement(),r.writeEndDocument(),r.flush(),t}writeSheetRels(t){let e,i=new K,r=new w(u.UTF8,i);if(r.writeStartDocument(),r.writeStartElement("Relationships"),r.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),0<this.imageList.length-this.imageListOffset&&(r.writeStartElement("Relationship"),r.writeAttributeString("Id","rId1"),r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing"),r.writeAttributeString("Target",`../drawings/drawing${t+1}.xml`),r.writeEndElement()),0<this.hyperlinkList.length)for(let t=0;t<this.hyperlinkList.length;t++)r.writeStartElement("Relationship"),r.writeAttributeString("Id",nt.format("rId{0}",2+t)),r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"),r.writeAttributeString("Target",this.hyperlinkList[t]),r.writeAttributeString("TargetMode","External"),r.writeEndElement();let n=null==(e=this.report.parentReport)?void 0:e.getCurrentPage(),a=this.report.isDocument&&null!=n&&n.is(Lt);return Z.Base.vAeXc.eMAio.UUyjq()&&!a||Z.Base.vAeXc.eMAio.lAtWS()&&a||(Z.Base.vAeXc.eMAio.rdCzm()||Z.Base.vAeXc.eMAio.CWsHL()&&!a||Z.Base.vAeXc.eMAio.tnNVR()&&a)&&Z.System.NodeJs.isStandaloneVersion||(r.writeStartElement("Relationship"),r.writeAttributeString("Id","dId1"),r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing"),r.writeAttributeString("Target","../drawings/vmlDrawingAdditional.vml"),r.writeEndElement()),r.writeFullEndElement(),r.writeEndDocument(),r.flush(),i}writeSheet(t,e){let N,M,i,r=new K,O=new w(u.UTF8,r),H=(O.writeStartDocument(),O.writeStartElement("worksheet"),O.writeAttributeString("xmlns","http://schemas.openxmlformats.org/spreadsheetml/2006/main"),O.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),Z.StiOptions.Export.Excel.FitToOnePageWide&&(O.writeStartElement("sheetPr"),O.writeStartElement("pageSetUpPr"),O.writeAttributeString("fitToPage","1"),O.writeEndElement(),O.writeEndElement()),this.matrix=this.matrixList[t],this.minRowList[t]),n=this.maxRowList[t],a=this.matrix.coordX.countItems,s=new Gt(a-2,n-H-1),W=(s.width<0&&(s.width=0),s.height<0&&(s.height=0),this.printAreasList.push(s),[]),o=(O.writeStartElement("dimension"),O.writeAttributeString("ref",nt.format("{0}:{1}",this.getRefString(0,0),this.getRefString(s.width,s.height))),O.writeEndElement(),0),l=0;if(Z.StiOptions.Export.Excel.AllowFreezePanes)for(let i=H;i<n;i++)for(let t=0;t<a-1;t++){let e=this.matrix.cells.gett(i,t);if(null!=e&&null!=e.component&&(e.component.locked||null!=e.component.tagValue&&e.component.tagValue.toString().contains("excelfreezepanes"))){let t=e.component.componentPlacement;if(null!=t&&0<t.length&&(t.startsWith("rt")||t.startsWith("ph")||t.startsWith("h"))){o=e.left,l=e.top+e.height+1;break}}}O.writeStartElement("sheetViews"),O.writeStartElement("sheetView"),Z.StiOptions.Export.Excel.ColumnsRightToLeft&&O.writeAttributeString("rightToLeft","1"),Z.StiOptions.Export.Excel.ShowGridLines||O.writeAttributeString("showGridLines","0"),O.writeAttributeString("tabSelected","1"),O.writeAttributeString("workbookViewId","0"),0==o&&0==l?(O.writeStartElement("selection"),O.writeAttributeString("activeCell","A1"),O.writeAttributeString("sqref","A1")):0==o?(O.writeStartElement("pane"),O.writeAttributeString("ySplit",l.toString()),O.writeAttributeString("topLeftCell",this.getRefString(o,l)),O.writeAttributeString("activePane","bottomLeft"),O.writeAttributeString("state","frozen"),O.writeEndElement(),O.writeStartElement("selection"),O.writeAttributeString("pane","bottomLeft"),
O.writeAttributeString("activeCell",this.getRefString(0,l)),O.writeAttributeString("sqref",this.getRefString(0,l))):(O.writeStartElement("pane"),O.writeAttributeString("xSplit",o.toString()),O.writeAttributeString("ySplit",l.toString()),O.writeAttributeString("topLeftCell",this.getRefString(o,l)),O.writeAttributeString("activePane","bottomRight"),O.writeAttributeString("state","frozen"),O.writeEndElement(),O.writeStartElement("selection"),O.writeAttributeString("pane","topRight"),O.writeAttributeString("activeCell",this.getRefString(o,0)),O.writeAttributeString("sqref",this.getRefString(o,0)),O.writeEndElement(),O.writeStartElement("selection"),O.writeAttributeString("pane","bottomLeft"),O.writeAttributeString("activeCell",this.getRefString(0,l)),O.writeAttributeString("sqref",this.getRefString(0,l)),O.writeEndElement(),O.writeStartElement("selection"),O.writeAttributeString("pane","bottomRight"),O.writeAttributeString("activeCell",this.getRefString(o,l)),O.writeAttributeString("sqref",this.getRefString(o,l))),O.writeEndElement(),O.writeEndElement(),O.writeEndElement(),O.writeStartElement("sheetFormatPr"),O.writeAttributeString("defaultRowHeight","15"),O.writeEndElement();let z=0,h=lt.toColor(e.brush);if(!h.equals(rt.white)&&0!=h.a){let t=new Tr("solid",h,rt.transparent),e=this.getFillNumber(t),i=new Cr(0,0,e,0,0,at.Left,st.Bottom,0,!1,!1,!1);z=this.getXFNumber(i)}let U=this.matrix.coordX.getKeys(),X=this.matrix.coordY.getKeys();if(this.exportObjectFormatting&&1<a){O.writeStartElement("cols");for(let r=0;r<a-1;r++){let t=this.matrix.coordX.getByIndex(r+1,U),e=this.matrix.coordX.getByIndex(r,U),i=this.convert(t-e)*this.TwipsToColinfo;O.writeStartElement("col"),O.writeAttributeString("min",(r+1).toString()),O.writeAttributeString("max",(r+1).toString()),O.writeAttributeString("width",i.toString()),O.writeAttributeString("customWidth","1"),0<z&&O.writeAttributeString("style",z.toString()),O.writeEndElement()}0<z&&(O.writeStartElement("col"),O.writeAttributeString("min",a.toString()),O.writeAttributeString("max","16384"),O.writeAttributeString("width","8.7265625"),O.writeAttributeString("style",z.toString()),O.writeEndElement()),O.writeEndElement()}let G=it.create2(Boolean,n+1,a),j=it.create2(Number,n+1,a),V=[],Y=[];O.writeStartElement("sheetData");for(let R=H;R<n;R++){let t=this.matrix.coordY.getByIndex(R+1,X)-this.matrix.coordY.getByIndex(R,X);O.writeStartElement("row"),O.writeAttributeString("r",(R+1-H).toString()),O.writeAttributeString("spans",`1:`+(a-1)),this.exportObjectFormatting&&(O.writeAttributeString("ht",this.convert(t).toString()),O.writeAttributeString("customHeight","1"));for(let I=0;I<a-1;I++){let D=this.matrix.cells.gett(R,I);if(G[R]&&0==G[R][I]&&null!=D){G[R][I]=!0;let p=D.component.as(et),d=D.text,t=D.component.as(gt),w=!1,e=!1,r=(null!=t&&null!=t.excelDataValue&&0<t.excelDataValue.length&&(w=!0,d=t.excelDataValue),null);if(null!=D.component.hyperlinkValue&&0<(r=D.component.hyperlinkValue.toString().trim()).length&&!r.startsWith("javascript:")){let t=d,e=(null!=t&&0!=t.length||(t=r),new Lr(R-H,R-H+D.height,I,I+D.width)),i=new kr(e,t,r);Y.push(i)}let n=!1,i=!1,u=(i&&(n=!0),!1),a=D.component.as(pt);if(!n&&!e&&null!=a&&a.isExportAsImage(this.exportFormat)){let a=new mt,s=new Gt(0,0),i=this.exportCache.getImageIndex(D.component,null,D.componentId);if(null!=i){s.width=this.imageCache.imageSizeStore[i].width,s.height=this.imageCache.imageSizeStore[i].height;let t=[],e=this.matrix.getRealImageData(D,new Xt,t);null!=e&&0<t.length&&(a.x=t[0],a.y=t[1]),a.width=this.matrix.coordX.getByIndex(D.left+D.width+1,U)-this.matrix.coordX.getByIndex(D.left,U),a.height=this.matrix.coordY.getByIndex(D.top+D.height+1,X)-this.matrix.coordY.getByIndex(D.top,X)}else{let r=null,n=this.imageFormat;if(this.imageResolutionMode!=J.c.StiImageResolutionMode.Exactly&&D.component.is(Q)){let t=D.component,i=t.getImage(this.imageResolution);if(null!=i){r=i,n=Wt.correctImageFormat(this.imageFormat,r.imageFormat),s.width=r.width,s.height=r.height;let t=[],e=this.matrix.getRealImageData(D,i,t);null!=e&&0<t.length&&(a.x=t[0],a.y=t[1]),a.width=this.matrix.coordX.getByIndex(D.left+D.width+1,U)-this.matrix.coordX.getByIndex(D.left,U),a.height=this.matrix.coordY.getByIndex(D.top+D.height+1,X)-this.matrix.coordY.getByIndex(D.top,X)}}else{let e=J.d.StiOfficeImageFormatHelper.getImageAndTag(D.component,J.a.StiExportFormat.Excel,this.imageResolution,this.imageFormat,this.reportCulture,this.englishCulture);if(null!=e){let t=this.matrix.getRealImageData(D,e);null!=t&&(e=t),n=Wt.correctImageFormat(this.imageFormat,e.imageFormat)}}null!=r&&(i=this.imageCache.addImageInt(r,n))}if(null!=i){let t=new Pr(R-H,0,I,0,R-H+1+D.height,0,I+1+D.width,0,i,r,D.component,a,s);this.imageList.push(t),u=!0,n=!0}}let s=!1;if(null!=D.component&&null!=D.component.tagValue){let t=D.component.tagValue.toString().toLowerCase();-1!=t.indexOf("exceltext")&&(s=!0,W.push(this.getRefString(I,R)))}let o="",l=(null!=p&&(o=p.format),!1),h=!1,c=!1,m=!1,g=!1,S=!1,f=!1,b="",E=2,v=0,y=this.reportCulture.numberFormat.currencySymbol,x=0==this.reportCulture.numberFormat.currencyPositivePattern||2==this.reportCulture.numberFormat.currencyPositivePattern,A=!1,T=null!=p&&p.hideZeros,F=null,C=null,P=o.indexOf("|");if(-1!=P&&(F=J.c.StiExportUtils.getPositivePattern(o.charCodeAt(P+1)-65),C=J.c.StiExportUtils.getNegativePattern(o.charCodeAt(P+2)-65),o=o.substr(0,P)),null!=o&&0<o.length)if("C"==o[0]?l=!0:"N"==o[0]?h=!0:"P"==o[0]?c=!0:"D"==o[0]?m=!0:"T"==o[0]?g=!0:"U"==o[0]&&(S=!0),1==o.length)f=!0;else if(l||h||c){let e=1;if(tt.isDigit(o[e])){let t=new ct;while(e<o.length&&tt.isDigit(o[e]))t.append(o[e]),e++;E=parseInt(t.toString())}e<o.length&&"G"==o[e]&&(e++,v=3),e<o.length&&"("==o[e]&&(e++,A=!0),e<o.length&&("."==o[e]||","==o[e])&&e++,e<o.length&&("+"==o[e]||"-"==o[e])&&("+"==o[e]&&(x=!0),e++,y=e<o.length?o.substring(e):"")}if(l||h||c||m||g||(f=!0),l&&(f=f&&!1),T&&!nt.isNullOrEmpty(o)&&(f&&h&&(v=3),f=!1),s&&(f=!0),m||g){let t=o.substring(1);switch(t){case"d":b=this.reportCulture.dateTimeFormat.shortDatePattern;break;case"D":b=this.reportCulture.dateTimeFormat.longDatePattern;break;case"f":b=this.reportCulture.dateTimeFormat.longDatePattern+" "+this.reportCulture.dateTimeFormat.shortTimePattern;break;case"F":b=this.reportCulture.dateTimeFormat.fullDateTimePattern;break;case"g":b=this.reportCulture.dateTimeFormat.shortDatePattern+" "+this.reportCulture.dateTimeFormat.shortTimePattern;break;case"G":b=this.reportCulture.dateTimeFormat.shortDatePattern+" "+this.reportCulture.dateTimeFormat.longTimePattern;break;case"m":case"M":b=this.reportCulture.name.includes("en")||this.reportCulture.name.includes("us")?"MMMM d":"d MMMM";break;case"s":b="yyyy-MM-dd\\THH:mm:ss";break;case"t":b=this.reportCulture.dateTimeFormat.shortTimePattern;break;case"T":b=this.reportCulture.dateTimeFormat.longTimePattern;break;case"u":b="yyyy-MM-dd HH:mm:ss\\Z";break;case"y":case"Y":b=this.reportCulture.dateTimeFormat.yearMonthPattern;break;default:b=t;break}let e=(b=b[Z.System.StiObject.stimulsoft]().replaceAll(" ","\\ ")).indexOf("'");while(-1!=e){let t=b.indexOf("'",e+1);if(-1==t)break;b=b.substr(0,e)+b.substr(e+1,t-e-1)+b.substr(t+1),e=b.indexOf("'",t-2)}}else if(!f)if(-1!=P){let t=new ct,e=(1<v&&(t.append("#,"),t.appendCount("#",v-1)),t.append("0"),0<E&&(t.append("."),t.appendCount("0",E)),t.toString()),i=F[Z.System.StiObject.stimulsoft]().replaceAll("n",e)[Z.System.StiObject.stimulsoft]().replaceAll("$",'"'+y+'"'),r=C[Z.System.StiObject.stimulsoft]().replaceAll("n",e)[Z.System.StiObject.stimulsoft]().replaceAll("$",'"'+y+'"');b=i+";"+r+(T?";":"")}else{let t=new ct,e=(l&&1==x&&(t.append('"'),t.append(y),t.append('"')),1<v&&(t.append("#,"),t.appendCount("#",v-1)),t.append("0"),0<E&&(t.append("."),t.appendCount("0",E)),l&&0==x&&(t.append('"'),t.append(y),t.append('"')),c&&t.append("%"),b=t.toString(),(A?"(":"-")+b+(A?")":""));T?b=b+";"+e+";":A&&(b=b+";"+e)}let L=0,k=(f?(h&&(L=4),c&&(L=10),m&&(L=14),g&&(L=21),s&&(L=49)):L=this.getFormatNumber(b),z);if(this.exportObjectFormatting){let i=D.cellStyle,t=new Ar(i.font.name,i.font.bold,i.font.italic,i.font.underline,i.font.strikeout,Math.round(i.font.sizeInPoints),i.textColor,1,0),r=(w&&(t=new Ar(Z.StiOptions.Export.CheckBoxReplacementForExcelValue.Font.name,Z.StiOptions.Export.CheckBoxReplacementForExcelValue.Font.bold,Z.StiOptions.Export.CheckBoxReplacementForExcelValue.Font.italic,Z.StiOptions.Export.CheckBoxReplacementForExcelValue.Font.underline,Z.StiOptions.Export.CheckBoxReplacementForExcelValue.Font.strikeout,Math.round(Z.StiOptions.Export.CheckBoxReplacementForExcelValue.Font.sizeInPoints),i.textColor,1,0)),new Tr("solid",i.color,i.color));if(u){let e=i.color;if(this.imageResolutionMode==J.c.StiImageResolutionMode.Exactly)((e=lt.toColor(null==(N=D.component.page)?void 0:N.brush)).equals(rt.empty)||e.equals(rt.white))&&(e=rt.transparent);else if(e.equals(rt.empty)||e.equals(rt.transparent)){let t=lt.toColor(null==(M=D.component.page)?void 0:M.brush);t.equals(rt.empty)||t.equals(rt.transparent)||(e=t)}r=new Tr("solid",e,e)}let e=!0,n=!0;for(let t=0;t<D.height+1;t++)null==this.matrix.bordersY.gett(D.top+t,D.left)&&(e=!1),null==this.matrix.bordersY.gett(D.top+t,D.left+D.width+1)&&(n=!1);let a=!0,s=!0;for(let t=0;t<D.width+1;t++)null==this.matrix.bordersX.gett(D.top,D.left+t)&&(a=!1),null==this.matrix.bordersX.gett(D.top+D.height+1,D.left+t)&&(s=!1);let o=new Fr(e?this.matrix.bordersY.gett(D.top,D.left):null,n?this.matrix.bordersY.gett(D.top,D.left+D.width+1):null,a?this.matrix.bordersX.gett(D.top,D.left):null,s?this.matrix.bordersX.gett(D.top+D.height+1,D.left):null),l=!1,h=(null!=i.textOptions&&(l=i.textOptions.rightToLeft),!1),c=(null!=i.textOptions&&(h=i.textOptions.wordWrap),nt.isNullOrEmpty(d)||(-1==d.indexOf("\r")&&-1==d.indexOf("\n")||(h=!0),null==p)||!p.checkAllowHtmlTags()||-1==d.indexOf("<br")&&-1==d.indexOf("<ul")&&-1==d.indexOf("<ol")&&-1==d.indexOf("<p")||(h=!0),0);if(null!=i.textOptions){let t=Math.ceil(i.textOptions.angle);0<=t&&t<=90&&(c=t),270<=t&&t<360&&(c=360-t+90)}let m=this.restrictEditing==J.c.StiExcelRestrictEditing.ExceptEditableFields&&null!=D.component&&D.component.is(et)&&D.component.editable,g=new Cr(L,this.getFontNumber(t),this.getFillNumber(r),this.getBorderNumber(o),0,w?Z.StiOptions.Export.CheckBoxReplacementForExcelValue.HorAlignment:i.horAlignment,w?Z.StiOptions.Export.CheckBoxReplacementForExcelValue.VertAlignment:i.vertAlignment,c,h,l,m);k=this.getXFNumber(g)}if(O.writeStartElement("c"),O.writeAttributeString("r",this.getRefString(I,R-H)),O.writeAttributeString("s",k.toString()),this.exportObjectFormatting){for(let e=0;e<=D.width;e++)for(let t=0;t<=D.height;t++)G[R+t][I+e]=!0,j[R+t][I+e]=k;if(0<D.width||0<D.height){let t=new Lr(R-H,R-H+D.height,I,I+D.width);V.push(t)}}else G[R][I]=!0,j[R][I]=k;let B=null;if(null!=p&&(B=p.excelDataValue,h)&&""==B&&" "==d&&(d=""),!(n||nt.isNullOrEmpty(d)&&nt.isNullOrEmpty(B))){let n=!1,a=!1,s=0;if(!nt.isNullOrEmpty(B)&&"-"!=B){let i=B,t=i,e=t.indexOf("."),r=t.indexOf(",");if(t=(t=-1!=e&&-1!=r?t[Z.System.StiObject.stimulsoft]().replaceAll(r<e?",":".",""):t).trim()[Z.System.StiObject.stimulsoft]().replaceAll(",","."),!nt.isNullOrEmpty(t)){a=!0;try{if(m||g){if(a=!1,Z.StiOptions.Export.Excel.AllowExportDateTime&&"Q"!=b&&"QI"!=b&&"YQ"!=b&&"YQI"!=b){let n=null;try{q.currentCulture=this.reportCulture;let{result:t,successfully:e}=_.tryParse(i);e&&(n=t)}finally{q.currentCulture=this.englishCulture}if(null!=n){let t=new Date(1900,0,1,0,0,0),e=_.dateToNetTicks(n.jsDate),i=_.dateToNetTicks(t),r=(e-i)/this.netTicksPerDay;59<(s=r+1)&&s++,a=!0}}}else this.checkForNumber(t)&&(s=parseFloat(t),isNaN(s))&&(a=!1,s=0)}catch(t){a=!1}}S&&(a=!1),i!=d&&i.startsWith("=")&&(n=!0),a||null!=d||(d=i)}if(n){let t=p.excelDataValue[Z.System.StiObject.stimulsoft]().replaceAll("\r","")[Z.System.StiObject.stimulsoft]().replaceAll("\t"," ").substring(1);Z.StiOptions.Export.Excel.TrimTrailingSpaces&&(t=J.c.StiExportUtils.trimEndWhiteSpace(t)),O.writeElementString("f",t)}else if(1==a)O.writeElementString("v",s.toString()[Z.System.StiObject.stimulsoft]().replaceAll(",","."));else{let t=d[Z.System.StiObject.stimulsoft]().replaceAll("\r","")[Z.System.StiObject.stimulsoft]().replaceAll("\t"," "),e=(Z.StiOptions.Export.Excel.TrimTrailingSpaces&&(t=J.c.StiExportUtils.trimEndWhiteSpace(t)),0);null!=p&&p.checkAllowHtmlTags()?(t=this.convertAllowHtmlTagsToExcelString(p,t),e=this.getSSTNumber(t),this.sstHashIsTags.add(e,null)):e=this.getSSTNumber(t),O.writeAttributeString("t","s"),O.writeElementString("v",e.toString())}}O.writeEndElement()}else{let n=z,a=(G[R][I]&&(n=j[R][I]),null!=this.matrix.bordersY.gett(R+0,I+0)),s=null!=this.matrix.bordersY.gett(R+0,I+1),o=null!=this.matrix.bordersX.gett(R+0,I+0),l;try{l=null!=this.matrix.bordersX.gett(R+1,I+0)}catch(t){}if(a||s||o||l||0!=n){let t=new Fr(a?this.matrix.bordersY.gett(R+0,I+0):null,s?this.matrix.bordersY.gett(R+0,I+1):null,o?this.matrix.bordersX.gett(R+0,I+0):null,l?this.matrix.bordersX.gett(R+1,I+0):null),e=this.xfList[n],i=new Cr(e.FormatIndex,e.FontIndex,e.FillIndex,this.getBorderNumber(t),e.XFId,e.HorAlign,e.VertAlign,e.TextRotationAngle,e.TextWrapped,e.RightToLeft,e.Editable),r=this.getXFNumber(i);this.exportObjectFormatting||(r=0),O.writeStartElement("c"),O.writeAttributeString("r",this.getRefString(I,R-H)),O.writeAttributeString("s",r.toString()),O.writeEndElement()}}}O.writeEndElement()}if(O.writeEndElement(),this.restrictEditing!=J.c.StiExcelRestrictEditing.No){let t=this.calculateHash(this.protectionPassword);O.writeStartElement("sheetProtection"),null!=t&&O.writeAttributeString("password",t),O.writeAttributeString("sheet","1"),O.writeAttributeString("objects","1"),O.writeAttributeString("scenarios","1"),O.writeEndElement()}if(0<V.length&&(this.dataExportMode==J.c.StiDataExportMode.AllBands||this.exportObjectFormatting)){O.writeStartElement("mergeCells"),O.writeAttributeString("count",V.length.toString());for(let e=0;e<V.length;e++){let t=V[e];O.writeStartElement("mergeCell"),O.writeAttributeString("ref",nt.format("{0}:{1}",this.getRefString(t.FirstColumn,t.FirstRow),this.getRefString(t.LastColumn,t.LastRow))),O.writeEndElement()}O.writeEndElement()}if(0<Y.length){let a=!1;for(let i=0;i<Y.length;i++){let t=Y[i],e=t.Bookmark;if(e.startsWith("#")){e=e.substring(1);for(let n=0;n<this.matrixList.length;n++){let t=this.matrixList[n].bookmarksTable;if(null!=t){let r=t.get(e);if(null!=r){let t=this.minRowList[n],e=this.maxRowList[n],i=r[Z.System.StiObject.stimulsoft]().as(Gt);if(i.height>=t&&i.height<e){a=!0;break}}}}}else a=!0;if(a)break}if(a){O.writeStartElement("hyperlinks");for(let t=0;t<Y.length;t++){let e=Y[t],s=e.Bookmark;if(s.startsWith("#")){s=s.substring(1);let a=!1;for(let n=0;n<this.matrixList.length;n++){let t=this.matrixList[n].bookmarksTable;if(null!=t){let r=t.get(s);if(null!=r){let t=this.minRowList[n],e=this.maxRowList[n],i=r[Z.System.StiObject.stimulsoft]().as(Gt);if(i.height>=t&&i.height<e){s=nt.format("'{0}'!{1}",this.sheetNameList[n],this.getRefString(i.width,i.height-t)),a=!0;break}}}}a&&(O.writeStartElement("hyperlink"),O.writeAttributeString("ref",this.getRefString(e.Range.FirstColumn,e.Range.FirstRow)),O.writeAttributeString("location",s),O.writeAttributeString("display",e.Description),O.writeEndElement())}else{let t=s;s.startsWith("file:\\\\\\")&&(t=s.substring(8),s="file:///"+t),s.startsWith("http:")&&(s=s[Z.System.StiObject.stimulsoft]().replaceAll(" ","")),O.writeStartElement("hyperlink"),O.writeAttributeString("ref",this.getRefString(e.Range.FirstColumn,e.Range.FirstRow)),O.writeAttributeString("r:id",nt.format("rId{0}",2+this.hyperlinkList.length)),O.writeAttributeString("display",t),O.writeEndElement(),this.hyperlinkList.push(this.stringToUrl(s))}}O.writeEndElement()}}O.writeStartElement("pageMargins"),O.writeAttributeString("left",this.floatToString(e.convertToHInches(e.unit,e.margins.left)/100)),O.writeAttributeString("right",this.floatToString(e.convertToHInches(e.unit,e.margins.right)/100)),O.writeAttributeString("top",this.floatToString(e.convertToHInches(e.unit,e.margins.top)/100)),O.writeAttributeString("bottom",this.floatToString(e.convertToHInches(e.unit,e.margins.bottom)/100)),O.writeAttributeString("header",this.floatToString(0)),O.writeAttributeString("footer",this.floatToString(0)),O.writeEndElement(),O.writeStartElement("pageSetup"),O.writeAttributeString("paperSize",nt.format("{0}",e.paperSize)),O.writeAttributeString("orientation",e.orientation==S.Portrait?"portrait":"landscape"),Z.StiOptions.Export.Excel.FitToOnePageWide&&O.writeAttributeString("fitToHeight","0"),O.writeEndElement();let c=null==(i=this.report.parentReport)?void 0:i.getCurrentPage(),m=this.report.isDocument&&null!=c&&c.is(Lt),g=(Z.Base.vAeXc.eMAio.UUyjq()&&!m||Z.Base.vAeXc.eMAio.lAtWS()&&m||(Z.Base.vAeXc.eMAio.rdCzm()||Z.Base.vAeXc.eMAio.CWsHL()&&!m||Z.Base.vAeXc.eMAio.tnNVR()&&m)&&Z.System.NodeJs.isStandaloneVersion||(O.writeStartElement("headerFooter"),O.writeStartElement("oddHeader"),O.writeRaw("&amp;C\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n&amp;G"),O.writeEndElement(),O.writeEndElement()),this.matrix.horizontalPageBreaks.length);if(this.exportHorizontalPageBreaks&&0<g){O.writeStartElement("rowBreaks"),O.writeAttributeString("count",g.toString()),O.writeAttributeString("manualBreakCount",g.toString());for(let t=0;t<g;t++)O.writeStartElement("brk"),O.writeAttributeString("id",nt.format("{0}",this.matrix.horizontalPageBreaks[t])),O.writeAttributeString("max",0==t?"16383":"8"),O.writeAttributeString("man","1"),O.writeEndElement();O.writeEndElement()}if(0<W.length){O.writeStartElement("ignoredErrors");for(let t in W)O.writeStartElement("ignoredError"),O.writeAttributeString("sqref",W[t]),O.writeAttributeString("numberStoredAsText","1"),O.writeEndElement();O.writeEndElement()}return this.imageList.length>this.imageListOffset&&(O.writeStartElement("drawing"),O.writeAttributeString("r:id","rId1"),O.writeEndElement()),Z.Base.vAeXc.eMAio.UUyjq()&&!m||Z.Base.vAeXc.eMAio.lAtWS()&&m||(Z.Base.vAeXc.eMAio.rdCzm()||Z.Base.vAeXc.eMAio.CWsHL()&&!m||Z.Base.vAeXc.eMAio.tnNVR()&&m)&&Z.System.NodeJs.isStandaloneVersion||(O.writeStartElement("legacyDrawingHF"),O.writeAttributeString("r:id","dId1"),O.writeEndElement()),O.writeFullEndElement(),O.writeEndDocument(),O.flush(),r}checkForNumber(t){let e=t.match(xr.regexCheckInteger1);if(null!=e)return!0;if(null!=(e=t.match(xr.regexCheckFloat1)))return!0;return!1}calculateHash(t){if(nt.isNullOrEmpty(t))return null;let e=u.Windows1252.getBytes(t),i=0,r=e.length;while(0<r--)i=(i^=e[r])>>14&1|i<<1&32767;return(i=((i^=32768|78<<8|75)^e.length)&65535).toString(16).toUpperCase()}prepareMatrix(t){let e=this.dataExportMode;if(Z.StiOptions.Export.Excel.AllowExportFootersInDataOnlyMode&&(e|=J.c.StiDataExportMode.Footers),this.matrix=new J.c.StiMatrix(t,Z.StiOptions.Export.Excel.DivideBigCells,this,null,e),this.useOnePageHeaderAndFooter){this.matrix.scanComponentsPlacement(!0,this.exportObjectFormatting);let r=this.matrix.coordX.countItems,e=this.matrix.coordY.countItems,n=this.matrix.coordY.getKeys(),t=0;while(this.matrix.linePlacement[t]!=J.c.StiTableLineInfo.PageHeader&&t<e-1)t++;if(this.matrix.linePlacement[t]==J.c.StiTableLineInfo.PageHeader){while(this.matrix.linePlacement[t]==J.c.StiTableLineInfo.PageHeader&&t<e-1)t++;while(t<e-1)this.matrix.linePlacement[t]==J.c.StiTableLineInfo.PageHeader&&(this.matrix.linePlacement[t]=J.c.StiTableLineInfo.Trash),t++}t=e-1;while(this.matrix.linePlacement[t]!=J.c.StiTableLineInfo.PageFooter&&0<t)t--;if(this.matrix.linePlacement[t]==J.c.StiTableLineInfo.PageFooter){while(this.matrix.linePlacement[t]==J.c.StiTableLineInfo.PageFooter&&0<t)t--;while(0<t)this.matrix.linePlacement[t]==J.c.StiTableLineInfo.PageFooter&&(this.matrix.linePlacement[t]=J.c.StiTableLineInfo.Trash),t--}this.matrix.allowModification(!0);let a=0,s=0;for(let i=0;i<e-1;i++){if(this.matrix.linePlacement[i]!=J.c.StiTableLineInfo.Trash){for(let e=0;e<r-1;e++){this.matrix.cells.sett(a,e,this.matrix.cells.gett(i,e));let t=this.matrix.cells.gett(a,e);null!=t&&(t.top=a,t.exportImage),this.matrix.bordersX.sett(a,e,this.matrix.bordersX.gett(i,e)),this.matrix.bordersY.sett(a,e,this.matrix.bordersY.gett(i,e)),this.matrix.bookmarks.sett(a,e,this.matrix.bookmarks.gett(i,e))}this.matrix.bordersY.sett(a,r-1,this.matrix.bordersY.gett(i,r-1));let t=this.matrix.coordY.getByIndex(i+1,n)-this.matrix.coordY.getByIndex(i,n);this.matrix.coordY.setByIndex(a+1,this.matrix.coordY.getByIndex(a,n)+t,n),a++}else s++;if(this.exportHorizontalPageBreaks)for(let t=0;t<this.matrix.horizontalPageBreaks.length;t++)this.matrix.horizontalPageBreaks[t]==i&&(this.matrix.horizontalPageBreaks[t]=this.matrix.horizontalPageBreaks[t]-(s-1))}for(let t=0;t<r-1;t++)this.matrix.bordersX.sett(a,t,this.matrix.bordersX.gett(e-1,t));n=this.matrix.coordY.getKeys();let i=e-1-a;if(0<i){let i=new zt;for(let e=0;e<a+1;e++){let t=this.matrix.coordY.getByIndex(e,n);i.add(t)}this.matrix.coordY=i}this.matrix.allowModification(!1)}if(this.dataExportMode!=J.c.StiDataExportMode.AllBands){this.matrix.scanComponentsPlacement(!0,this.exportObjectFormatting),this.matrix.allowModification(!0);let n=this.matrix.coordX.countItems,t=this.matrix.coordY.countItems,a=this.matrix.coordY.getKeys(),s=0,o=new C,e=new C,l=null,h=!1;for(let r=0;r<t-1;r++){let t=!1,i=this.matrix.parentBandName[r];if(this.matrix.linePlacement[r]==J.c.StiTableLineInfo.HeaderAP&&(h&&this.getParentBandName(r)==this.getParentBandName(r-1)?(t=!0,e.containsKey(i)||e.add(i,i)):e.containsKey(i)||(e.add(i,i),t=!0)),this.matrix.linePlacement[r]==J.c.StiTableLineInfo.HeaderD)if(h&&this.getParentBandName(r)==this.getParentBandName(r-1))t=!0,o.containsKey(i)||o.add(i,i);else{let e=i.indexOf("");if(-1!=e){let t=i.substring(0,e);t!=l&&(l=t,o.clear())}o.containsKey(i)||(t=!0,o.add(i,i))}if(h=t,this.matrix.linePlacement[r]==J.c.StiTableLineInfo.Data||this.matrix.linePlacement[r]==J.c.StiTableLineInfo.FooterD||t){for(let e=0;e<n-1;e++){this.matrix.cells.sett(s,e,this.matrix.cells.gett(r,e));let t=this.matrix.cells.gett(s,e);null!=t&&(t.top=s,t.exportImage),0!=s&&null==this.matrix.bordersX.gett(r,e)||this.matrix.bordersX.sett(s,e,this.matrix.bordersX.gett(r,e)),this.matrix.bordersX.sett(s+1,e,this.matrix.bordersX.gett(r+1,e)),this.matrix.bordersY.sett(s,e,this.matrix.bordersY.gett(r,e)),this.matrix.bookmarks.sett(s,e,this.matrix.bookmarks.gett(r,e))}this.matrix.bordersY.sett(s,n-1,this.matrix.bordersY.gett(r,n-1));let t=this.matrix.coordY.getByIndex(r+1,a)-this.matrix.coordY.getByIndex(r,a);this.matrix.coordY.setByIndex(s+1,this.matrix.coordY.getByIndex(s,a)+t,a),s++}}let i=t-1-s;if(0<i){let i=new zt;for(let e=0;e<s+1;e++){let t=this.matrix.coordY.getByIndex(e,a);i.add(t)}this.matrix.coordY=i}this.matrix.allowModification(!1)}}getParentBandName(t){let e=this.matrix.parentBandName[t],i=e.indexOf("");if(-1==i)return e;return e.substr(0,i)}convertAllowHtmlTagsToExcelString(t,e){let r=new w(u.UTF8),i=new g(t.font.bold,t.font.italic,t.font.underline,t.font.strikeout,t.font.sizeInPoints,t.font.name,lt.toColor(t.textBrush),lt.toColor(t.brush),!1,!1,0,0,1,t.horAlignment),n=new U(i,0),a=G.parseHtmlToStates(t.text,n);for(let i=0;i<a.length;i++){let t=a[i],e=(r.writeStartElement("r"),r.writeStartElement("rPr"),t.ts.bold&&r.writeElementString("b",null),t.ts.italic&&r.writeElementString("i",null),t.ts.underline&&r.writeElementString("u",null),t.ts.strikeout&&r.writeElementString("strike",null),t.ts.superscript&&(r.writeStartElement("vertAlign"),r.writeAttributeString("val","superscript"),r.writeEndElement()),t.ts.subscript&&(r.writeStartElement("vertAlign"),r.writeAttributeString("val","subscript"),r.writeEndElement()),r.writeStartElement("sz"),r.writeAttributeString("val",t.ts.fontSize.toString()),r.writeEndElement(),r.writeStartElement("color"),r.writeAttributeString("rgb",nt.format("{0:X8}",t.ts.fontColor.toArgb())),r.writeEndElement(),r.writeStartElement("rFont"),r.writeAttributeString("val",t.ts.fontName),r.writeEndElement(),r.writeEndElement(),G.prepareStateText(t.text).toString());nt.isNullOrEmpty(e)&&(e=" "),this.convertTextToExcelString(r,e),r.writeEndElement()}return r.flush(),r.close(),r.textWriter.getStringBuilder().toString()}convertTextToExcelString(t,e){t.writeStartElement("t"),0<e.length&&(tt.isWhitespace(e,e.length-1)||tt.isWhitespace(e,0)||-1!=e.indexOf("\n"))&&t.writeAttributeString("xml:space","preserve"),t.writeString(e),t.writeFullEndElement()}writeDrawingRels(t){let e=new K,i=new w(u.UTF8,e);i.writeStartDocument(),i.writeStartElement("Relationships"),i.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships");for(let e=this.imageListOffset;e<this.imageList.length;e++){let t=this.imageList[e];i.writeStartElement("Relationship"),i.writeAttributeString("Id",nt.format("rId{0}",e-this.imageListOffset+1)),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"),i.writeAttributeString("Target",nt.format("../media/image{0:D5}.{1}",t.ImageIndex+1,Wt.getImageFormatExtension(this.imageCache.imageFormatStore[t.ImageIndex]))),i.writeEndElement(),nt.isNullOrWhiteSpace(t.Hyperlink)||(i.writeStartElement("Relationship"),i.writeAttributeString("Id",nt.format("hId{0}",e-this.imageListOffset+1)),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"),i.writeAttributeString("Target",t.Hyperlink),i.writeAttributeString("TargetMode","External"),i.writeEndElement())}return i.writeFullEndElement(),i.writeEndDocument(),i.flush(),e}writeDrawing(t){let i,e=new K,r=new w(u.UTF8,e);r.writeStartDocument(),r.writeStartElement("xdr:wsDr"),r.writeAttributeString("xmlns:xdr","http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing"),r.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main");for(let t=this.imageListOffset;t<this.imageList.length;t++){let S=this.imageList[t],f=0,b=0,E=0,v=0,y=0,x=S.Component.as(Q);if(null!=x){let i=x.report.unit.convertToHInches(x.width),r=x.report.unit.convertToHInches(x.height);if(x.imageRotation==O.Rotate90CCW||x.imageRotation==O.Rotate90CW){let t=i;i=r,r=t}let n=S.ImageSize.width,a=S.ImageSize.height,s=S.OffsetAndSize.clone(),o=x.margins.left,l=x.margins.right,h=x.margins.top,c=x.margins.bottom,m=x.horAlignment,g=x.vertAlignment;if(x.imageRotation!=O.None){let t=M.Center,e=st.Center;x.imageRotation==O.Rotate90CW&&(m==M.Left&&(e=st.Bottom),m==M.Right&&(e=st.Top),g==st.Top&&(t=M.Left),g==st.Bottom&&(t=M.Right),o=x.margins.top,l=x.margins.bottom,h=x.margins.right,c=x.margins.left,y=-90,s.x=S.OffsetAndSize.y,s.y=r-(S.OffsetAndSize.x+S.OffsetAndSize.width),s.width=S.OffsetAndSize.height,s.height=S.OffsetAndSize.width),x.imageRotation==O.Rotate90CCW&&(m==M.Left&&(e=st.Top),m==M.Right&&(e=st.Bottom),g==st.Top&&(t=M.Right),g==st.Bottom&&(t=M.Left),o=x.margins.bottom,l=x.margins.top,h=x.margins.left,c=x.margins.right,y=90,s.x=i-(S.OffsetAndSize.y+S.OffsetAndSize.height),s.y=S.OffsetAndSize.x,s.width=S.OffsetAndSize.height,s.height=S.OffsetAndSize.width),x.imageRotation==O.Rotate180&&(m==M.Left&&(t=M.Right),m==M.Right&&(t=M.Left),g==st.Top&&(e=st.Bottom),g==st.Bottom&&(e=st.Top),o=x.margins.right,l=x.margins.left,h=x.margins.bottom,c=x.margins.top,y=180,s.x=i-(S.OffsetAndSize.x+S.OffsetAndSize.width),s.y=r-(S.OffsetAndSize.y+S.OffsetAndSize.height)),x.imageRotation==O.FlipHorizontal&&(m==M.Left&&(t=M.Right),m==M.Right&&(t=M.Left),e=g,o=x.margins.right,l=x.margins.left,s.x=i-(S.OffsetAndSize.x+S.OffsetAndSize.width)),x.imageRotation==O.FlipVertical&&(g==st.Top&&(e=st.Bottom),g==st.Bottom&&(e=st.Top),t=m,h=x.margins.bottom,c=x.margins.top,s.y=r-(S.OffsetAndSize.y+S.OffsetAndSize.height)),m=t,g=e}let p=i-o-l,d=r-h-c;if(x.stretch||null!=x.icon){if(x.aspectRatio){let t=Math.min(p/n,d/a),e=(p-n*t)/2,i=(d-a*t)/2;m==M.Left&&(l+=2*e),m==M.Right&&(o+=2*e),m==M.Center&&(o+=e,l+=e),g==st.Top&&(c+=2*i),g==st.Bottom&&(h+=2*i),g==st.Center&&(h+=i,c+=i),p-=2*e,d-=2*i}}else{p=n*x.multipleFactor,d=a*x.multipleFactor;let t=-(p-i)/2,e=-(d-r)/2;m==M.Left&&(l+=2*t),m==M.Right&&(o+=2*t),m==M.Center&&(o+=t,l+=t),g==st.Top&&(c+=2*e),g==st.Bottom&&(h+=2*e),g==st.Center&&(h+=e,c+=e)}let t=-s.x,e=s.x+s.width-i,w=-s.y,u=s.y+s.height-r;o+=t,l+=e,h+=w,c+=u,i-=t+e,r-=w+u,f=0|-Math.round(o/p*1e5),b=0|-Math.round(l/p*1e5),E=0|-Math.round(h/d*1e5),v=0|-Math.round(c/d*1e5)}r.writeStartElement("xdr:twoCellAnchor"),Z.StiOptions.Export.Excel.ImageMoveAndSizeWithCells||r.writeAttributeString("editAs","oneCell"),r.writeStartElement("xdr:from"),r.writeElementString("xdr:col",nt.format("{0}",S.FirstColumnIndex)),r.writeElementString("xdr:colOff",nt.format("{0}",S.FirstColumnOffset)),r.writeElementString("xdr:row",nt.format("{0}",S.FirstRowIndex)),r.writeElementString("xdr:rowOff",nt.format("{0}",S.FirstRowOffset)),r.writeEndElement(),r.writeStartElement("xdr:to"),r.writeElementString("xdr:col",nt.format("{0}",S.LastColumnIndex)),r.writeElementString("xdr:colOff",nt.format("{0}",S.LastColumnOffset)),r.writeElementString("xdr:row",nt.format("{0}",S.LastRowIndex)),r.writeElementString("xdr:rowOff",nt.format("{0}",S.LastRowOffset)),r.writeEndElement(),r.writeStartElement("xdr:pic"),r.writeStartElement("xdr:nvPicPr"),r.writeStartElement("xdr:cNvPr"),r.writeAttributeString("id",nt.format("{0}",t-this.imageListOffset+2)),r.writeAttributeString("name",nt.format("Picture {0}",t-this.imageListOffset+1)),r.writeAttributeString("descr",nt.format("image{0:D5}",t+1)),nt.isNullOrWhiteSpace(S.Hyperlink)||(r.writeStartElement("a:hlinkClick"),r.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),r.writeAttributeString("r:id",nt.format("hId{0}",t-this.imageListOffset+1)),r.writeEndElement()),r.writeEndElement(),r.writeStartElement("xdr:cNvPicPr"),r.writeStartElement("a:picLocks"),r.writeAttributeString("noChangeAspect","1"),r.writeEndElement(),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("xdr:blipFill"),r.writeStartElement("a:blip"),r.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),r.writeAttributeString("r:embed",nt.format("rId{0}",t-this.imageListOffset+1)),r.writeEndElement(),this.imageResolutionMode==J.c.StiImageResolutionMode.Exactly||null==x?(r.writeStartElement("a:stretch"),r.writeStartElement("a:fillRect"),r.writeEndElement()):(0==f&&0==b&&0==E&&0==v||(r.writeStartElement("a:srcRect"),0!=f&&r.writeAttributeString("l",f.toString()),0!=E&&r.writeAttributeString("t",E.toString()),0!=b&&r.writeAttributeString("r",b.toString()),0!=v&&r.writeAttributeString("b",v.toString()),r.writeEndElement()),r.writeStartElement("a:stretch")),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("xdr:spPr"),r.writeStartElement("a:xfrm"),this.imageResolutionMode!=J.c.StiImageResolutionMode.Exactly&&null!=x&&(0!=y&&r.writeAttributeString("rot",(0|Math.round(6e4*-y)).toString()),x.imageRotation==O.FlipHorizontal&&r.writeAttributeString("flipH","1"),x.imageRotation==O.FlipVertical)&&r.writeAttributeString("flipV","1"),r.writeStartElement("a:off"),r.writeAttributeString("x","1"),r.writeAttributeString("y","1"),r.writeEndElement(),r.writeStartElement("a:ext"),r.writeAttributeString("cx","2"),r.writeAttributeString("cy","2"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("a:prstGeom"),r.writeAttributeString("prst","rect"),r.writeStartElement("a:avLst"),r.writeEndElement(),r.writeEndElement();let e=null==(i=S.Component.as(z))?void 0:i.border;if(Z.StiOptions.Export.Excel.AllowNativeImageBorders&&null!=e&&!e.is(ft)&&e.isAllBorderSidesPresent&&!e.color.equals(rt.transparent)&&e.style!=ot.None){if(r.writeStartElement("a:ln"),r.writeAttributeString("w",nt.format("{0}",this.convertToEMU(e.getSize()))),r.writeStartElement("a:solidFill"),r.writeStartElement("a:srgbClr"),r.writeAttributeString("val",nt.format("{0:X8}",e.color.toArgb()).substr(2)),r.writeEndElement(),r.writeEndElement(),e.style!=ot.Solid){let t=this.getLineStyle(new T(e.color,e.size,e.style));r.writeStartElement("a:prstDash"),r.writeAttributeString("val",t),r.writeEndElement()}r.writeStartElement("a:round"),r.writeEndElement(),r.writeStartElement("a:headEnd"),r.writeEndElement(),r.writeStartElement("a:tailEnd"),r.writeEndElement(),r.writeEndElement()}r.writeEndElement(),r.writeEndElement(),r.writeStartElement("xdr:clientData"),r.writeEndElement(),r.writeEndElement()}return r.writeFullEndElement(),r.writeEndDocument(),r.flush(),e}writeStyles(){let t=new K,o=new w(u.UTF8,t);if(o.writeStartDocument(),o.writeStartElement("styleSheet"),o.writeAttributeString("xmlns","http://schemas.openxmlformats.org/spreadsheetml/2006/main"),0<this.formatList.length){o.writeStartElement("numFmts"),o.writeAttributeString("count",nt.format("{0}",this.formatList.length));for(let t=0;t<this.formatList.length;t++)o.writeStartElement("numFmt"),o.writeAttributeString("numFmtId",nt.format("{0}",164+t)),o.writeAttributeString("formatCode",this.formatList[t]),o.writeEndElement();o.writeEndElement()}o.writeStartElement("fonts"),o.writeAttributeString("count",nt.format("{0}",this.fontList.length));for(let e=0;e<this.fontList.length;e++){let t=this.fontList[e];o.writeStartElement("font"),t.Bold&&o.writeElementString("b",""),t.Italic&&o.writeElementString("i",""),t.Underlined&&o.writeElementString("u",""),t.Strikeout&&o.writeElementString("strike",""),o.writeStartElement("sz"),o.writeAttributeString("val",nt.format("{0}",t.Height)),o.writeEndElement(),o.writeStartElement("color"),o.writeAttributeString("rgb",nt.format("{0:X8}",t.Color.toArgb())),o.writeEndElement(),o.writeStartElement("name"),o.writeAttributeString("val",t.Name),o.writeEndElement(),o.writeStartElement("charset"),o.writeAttributeString("val",nt.format("{0}",t.Charset)),o.writeEndElement(),o.writeEndElement()}o.writeEndElement(),o.writeStartElement("fills"),o.writeAttributeString("count",nt.format("{0}",this.fillList.length));for(let e=0;e<this.fillList.length;e++){let t=this.fillList[e];o.writeStartElement("fill"),o.writeStartElement("patternFill"),o.writeAttributeString("patternType",t.Type),"solid"==t.Type&&(o.writeStartElement("fgColor"),o.writeAttributeString("rgb",nt.format("{0:X8}",t.FgColor.toArgb())),o.writeEndElement(),o.writeStartElement("bgColor"),o.writeAttributeString("indexed","64"),o.writeEndElement()),o.writeEndElement(),o.writeEndElement()}o.writeEndElement(),o.writeStartElement("borders"),o.writeAttributeString("count",nt.format("{0}",this.borderList.length));for(let e=0;e<this.borderList.length;e++){let t=this.borderList[e];o.writeStartElement("border"),this.writeBorderData(o,"left",t.BorderLeft),this.writeBorderData(o,"right",t.BorderRight),this.writeBorderData(o,"top",t.BorderTop),this.writeBorderData(o,"bottom",t.BorderBottom),this.writeBorderData(o,"diagonal",null),o.writeEndElement()}o.writeEndElement(),o.writeStartElement("cellStyleXfs"),o.writeAttributeString("count","1"),o.writeStartElement("xf"),o.writeAttributeString("numFmtId","0"),o.writeAttributeString("fontId","0"),o.writeAttributeString("fillId","0"),o.writeAttributeString("borderId","0"),o.writeEndElement(),o.writeEndElement(),o.writeStartElement("cellXfs"),o.writeAttributeString("count",nt.format("{0}",this.xfList.length));for(let s=0;s<this.xfList.length;s++){let i=this.xfList[s],t=this.fillList[i.FillIndex],e=i.FillIndex,r=(0==t.FgColor.a&&(e=0),o.writeStartElement("xf"),o.writeAttributeString("numFmtId",nt.format("{0}",i.FormatIndex)),o.writeAttributeString("fontId",nt.format("{0}",i.FontIndex)),o.writeAttributeString("fillId",nt.format("{0}",e)),o.writeAttributeString("borderId",nt.format("{0}",i.BorderIndex)),o.writeAttributeString("xfId",nt.format("{0}",i.XFId)),0!=i.FormatIndex&&o.writeAttributeString("applyNumberFormat","1"),0!=i.FontIndex&&o.writeAttributeString("applyFont","1"),0!=e&&o.writeAttributeString("applyFill","1"),0!=i.BorderIndex&&o.writeAttributeString("applyBorder","1"),o.writeAttributeString("applyAlignment","1"),i.Editable&&o.writeAttributeString("applyProtection","1"),i.HorAlign),n=i.VertAlign;if(0!=i.TextRotationAngle){let t=i.HorAlign,e=i.VertAlign;if(r=at.Center,n=st.Center,90==i.TextRotationAngle){switch(t){case at.Left:n=st.Bottom;break;case at.Right:n=st.Top;break}switch(e){case st.Top:r=at.Left;break;case st.Bottom:r=at.Right;break}}if(180==i.TextRotationAngle){switch(t){case at.Left:n=st.Top;break;case at.Right:n=st.Bottom;break}switch(e){case st.Top:r=at.Right;break;case st.Bottom:r=at.Left;break}}}o.writeStartElement("alignment");let a="left";switch(r){case at.Right:a="right";break;case at.Center:a="center";break;case at.Width:a="justify";break}if(o.writeAttributeString("horizontal",a),n!=st.Bottom){let t="";switch(n){case st.Top:t="top";break;case st.Center:t="center";break}o.writeAttributeString("vertical",t)}0!=i.TextRotationAngle&&o.writeAttributeString("textRotation",i.TextRotationAngle.toString()),i.TextWrapped&&o.writeAttributeString("wrapText","1"),i.RightToLeft&&o.writeAttributeString("readingOrder","2"),o.writeEndElement(),i.Editable&&(o.writeStartElement("protection"),o.writeAttributeString("locked","0"),o.writeEndElement()),o.writeEndElement()}return o.writeEndElement(),o.writeStartElement("cellStyles"),o.writeAttributeString("count","1"),o.writeStartElement("cellStyle"),o.writeAttributeString("name","Normal"),o.writeAttributeString("xfId","0"),o.writeAttributeString("builtinId","0"),o.writeEndElement(),o.writeEndElement(),o.writeStartElement("dxfs"),o.writeAttributeString("count","0"),o.writeEndElement(),o.writeStartElement("tableStyles"),o.writeAttributeString("count","0"),o.writeAttributeString("defaultTableStyle","TableStyleMedium9"),o.writeAttributeString("defaultPivotStyle","PivotStyleLight16"),o.writeEndElement(),o.writeFullEndElement(),o.writeEndDocument(),o.flush(),t}writeBorderData(i,t,r){if(i.writeStartElement(t),null!=r){let t=this.getLineStyle(r),e=r.color;""!=t&&(i.writeAttributeString("style",t),i.writeStartElement("color"),i.writeAttributeString("rgb",nt.format("{0:X8}",e.toArgb())),i.writeEndElement())}i.writeEndElement()}writeSST(){let t=new K,r=new w(u.UTF8,t);r.writeStartDocument(),r.writeStartElement("sst"),r.writeAttributeString("xmlns","http://schemas.openxmlformats.org/spreadsheetml/2006/main"),r.writeAttributeString("count",nt.format("{0}",this.sstCount)),r.writeAttributeString("uniqueCount",nt.format("{0}",this.sstList.length));for(let t=0;t<this.sstList.length;t++){r.writeStartElement("si");let e=this.sstList[t],i=new ct;for(let t=0;t<e.length;t++)(32<=e.charCodeAt(t)||"\n"==e.charAt(t))&&i.append(e.charAt(t));e=i.toString(),this.sstHashIsTags.containsKey(t)?r.writeRaw(e):this.convertTextToExcelString(r,e),r.writeEndElement()}return r.writeFullEndElement(),r.writeEndDocument(),r.flush(),t}writeAdditionalData(t,e){let i=new K,r=null;return r=e?Z.System.Convert.fromBase64String(t):u.ASCII.getBytes(t),i.write(r,0,r.length),i}writeImage(t){let e=new K,i=this.imageCache.imagePackedStore[t];return null!=i&&e.write(i,0,i.length),e}exportExcel(h,a,t){var s;null==Z.Base[["St","iL","ic","en","se"].join("")].key&&console.warn("You are using a trial version of the Stimulsoft product!"),J.a.StiLogService.write(this[Z.System.StiObject.stimulsoft]().getType(),"Export report to Excel 2007 format");let c=t.pageRange,m=(this.useOnePageHeaderAndFooter=t.useOnePageHeaderAndFooter,this.dataExportMode=t.dataExportMode,this.exportObjectFormatting=t.exportObjectFormatting,this.exportEachPageToSheet=t.exportEachPageToSheet,this.exportHorizontalPageBreaks=t.exportPageBreaks,this.imageResolution=t.imageResolution,this.imageQuality=t.imageQuality,this.docCompanyString=t.companyString,this.docLastModifiedString=t.lastModifiedString,this.restrictEditing=t.restrictEditing,this.protectionPassword=t.protectionPassword,t.encryptionPassword),g=(this.xmlIndentation=-1,this.imageResolution<10&&(this.imageResolution=10),this.imageResolution=this.imageResolution/100,null!=this.imageFormat&&this.imageFormat!=J.a.ImageFormat.Jpeg&&(this.imageFormat=J.a.ImageFormat.Png),this.dataExportMode!=J.c.StiDataExportMode.AllBands?this.useOnePageHeaderAndFooter=!1:this.exportObjectFormatting=!0,Z.StiOptions.Export.Excel.RestrictEditing>this.restrictEditing&&(this.restrictEditing=Z.StiOptions.Export.Excel.RestrictEditing),this.report=h,q.currentCulture);try{if(q.currentCulture=this.englishCulture,this.reportCulture=g,!nt.isNullOrWhiteSpace(h.culture))try{this.reportCulture=new q(h.culture)}catch(t){}let o=c.getSelectedPages(h.renderedPages),l=(this.currentPassNumber=0,this.maximumPassNumber=3,this.prepareData(),0);while(l<o.length){let e=new f(h,h.renderedPages),i=(e.cacheMode=h.renderedPages.cacheMode,e.addV2Internal(o.getPageWithoutCache(l)),l);if(!this.exportEachPageToSheet){let t=o.getPageWithoutCache(l).excelSheetValue;while(l<o.length-1&&this.compareExcellSheetNames(o.getPageWithoutCache(l+1).excelSheetValue,t))l++,e.addV2Internal(o.getPageWithoutCache(l))}let r=e.getByIndex(0).excelSheetValue,n=(null!=r&&""!=r||(r=nt.format("Page {0}",this.sheetNameList.length+1)),""),a=1,s=(this.prepareMatrix(e),0);do{this.firstPageIndexList.push(i),this.matrixList.push(this.matrix);let t=this.matrix.coordY.countItems-1;t-s>Z.StiOptions.Export.Excel.MaximumSheetHeight?t=s+Z.StiOptions.Export.Excel.MaximumSheetHeight:this.matrix=null,this.minRowList.push(s),this.maxRowList.push(t),s=t,null!=this.matrix||0<n.length?(n=nt.format(" part{0}",a++),24<r.length&&(r=r.substr(0,24))):30<r.length&&(r=r.substr(0,30)),this.sheetNameList.push(r+n)}while(null!=this.matrix);l++}let i=new C;for(let t=0;t<this.sheetNameList.length;t++){let e=this.sheetNameList[t];if(e=e[Z.System.StiObject.stimulsoft]().replaceAll("*","_")[Z.System.StiObject.stimulsoft]().replaceAll("\\","_")[Z.System.StiObject.stimulsoft]().replaceAll("/","_")[Z.System.StiObject.stimulsoft]().replaceAll("[","_")[Z.System.StiObject.stimulsoft]().replaceAll("]","_")[Z.System.StiObject.stimulsoft]().replaceAll(":","_")[Z.System.StiObject.stimulsoft]().replaceAll("?","_"),i.contains(e)){let t=1;while(i.contains(e+"-"+t.toString()))t++;e=e+"-"+t.toString()}i.add(e,e),this.sheetNameList[t]=e}let e=new p,t=null;nt.isNullOrWhiteSpace(m)?e.begin(a,!0):(t=new K,e.begin(t,!0)),this.currentPassNumber=2,this.imageListOffset=0;for(let t=0;t<this.matrixList.length;t++)this.hyperlinkList=[],e.addFile(nt.format("xl/worksheets/sheet{0}.xml",t+1),this.writeSheet(t,o.getByIndex(this.firstPageIndexList[t]))),e.addFile(nt.format("xl/worksheets/_rels/sheet{0}.xml.rels",t+1),this.writeSheetRels(t)),0<this.imageList.length-this.imageListOffset&&(e.addFile(nt.format("xl/drawings/_rels/drawing{0}.xml.rels",t+1),this.writeDrawingRels(t)),e.addFile(nt.format("xl/drawings/drawing{0}.xml",t+1),this.writeDrawing(t))),this.imageListOffset=this.imageList.length;if(e.addFile("[Content_Types].xml",this.writeContentTypes()),e.addFile("_rels/.rels",this.writeMainRels()),e.addFile("docProps/app.xml",this.writeDocPropsApp()),e.addFile("docProps/core.xml",this.writeDocPropsCore()),e.addFile("xl/_rels/workbook.xml.rels",this.writeWorkbookRels()),e.addFile("xl/workbook.xml",this.writeWorkbook()),e.addFile("xl/styles.xml",this.writeStyles()),0<this.sstList.length&&e.addFile("xl/sharedStrings.xml",this.writeSST()),0<this.imageCache.imagePackedStore.length)for(let t=0;t<this.imageCache.imagePackedStore.length;t++)e.addFile(nt.format("xl/media/image{0:D5}.{1}",t+1,Wt.getImageFormatExtension(this.imageCache.imageFormatStore[t])),this.writeImage(t));let r=null==(s=this.report.parentReport)?void 0:s.getCurrentPage(),n=this.report.isDocument&&null!=r&&r.is(Lt);Z.Base.vAeXc.eMAio.UUyjq()&&!n||Z.Base.vAeXc.eMAio.lAtWS()&&n||(Z.Base.vAeXc.eMAio.rdCzm()||Z.Base.vAeXc.eMAio.CWsHL()&&!n||Z.Base.vAeXc.eMAio.tnNVR()&&n)&&Z.System.NodeJs.isStandaloneVersion||(e.addFile("xl/media/imageAdditional.png",this.writeAdditionalData(J.c.StiExportUtils.additionalData,!0)),e.addFile("xl/drawings/_rels/vmlDrawingAdditional.vml.rels",this.writeAdditionalData('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="dId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image" Target="../media/imageAdditional.png"/></Relationships>',!1)),e.addFile("xl/drawings/vmlDrawingAdditional.vml",this.writeAdditionalData('<xml xmlns:v="urn:schemas-microsoft-com:vml"\r\n xmlns:o="urn:schemas-microsoft-com:office:office"\r\n xmlns:x="urn:schemas-microsoft-com:office:excel">\r\n <o:shapelayout v:ext="edit">\r\n  <o:idmap v:ext="edit" data="1"/>\r\n'+' </o:shapelayout><v:shapetype id="_x0000_t75" coordsize="21600,21600" o:spt="75"\r\n  o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f">\r\n  <v:stroke joinstyle="miter"/>\r\n  <v:formulas>'+'\r\n   <v:f eqn="if lineDrawn pixelLineWidth 0"/>\r\n   <v:f eqn="sum @0 1 0"/>\r\n   <v:f eqn="sum 0 0 @1"/>\r\n   <v:f eqn="prod @2 1 2"/>\r\n   <v:f eqn="prod @3 21600 pixelWidth"/>\r\n   <v:f eqn="prod @3 21600 pixelHeight"/>\r\n   <v:f eqn="sum @0 0 1"/>'+'\r\n   <v:f eqn="prod @6 1 2"/>\r\n   <v:f eqn="prod @7 21600 pixelWidth"/>\r\n   <v:f eqn="sum @8 21600 0"/>\r\n   <v:f eqn="prod @7 21600 pixelHeight"/>\r\n   <v:f eqn="sum @10 21600 0"/>\r\n  </v:formulas>\r\n  <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>'+'\r\n  <o:lock v:ext="edit" aspectratio="t"/>\r\n </v:shapetype><v:shape id="CH" o:spid="_x0000_s1027" type="#_x0000_t75"\r\n  style=\'position:absolute;margin-left:0;margin-top:0;width:365pt;height:298pt;\r\n  z-index:1\'>'+'\r\n  <v:imagedata o:relid="dId1" o:title="additional"/>\r\n  <o:lock v:ext="edit" rotation="t"/>\r\n </v:shape></xml>',!1))),e.end(),nt.isNullOrWhiteSpace(m)||(t.flush(),Ht.EncryptPackage(t.toArray(),m,a),t.close())}catch(t){}finally{q.currentCulture=g,null!=this.matrix&&(this.matrix.clear(),this.matrix=null),this.fontList=null,this.fillList=null,this.borderList=null,this.xfList=null,this.sstList=null,this.sstHash=null,this.sstHashIsTags=null,this.formatList=null,this.sheetNameList=null,this.imageList[Z.System.StiObject.stimulsoft]().clear(),this.imageList=null,this.imageCache.clear(),this.printAreasList=null,this.matrixList=null,this.firstPageIndexList=null,this.hyperlinkList=null,this.minRowList=null,this.maxRowList=null}}}xr.regexCheckInteger1=new RegExp("^[+-]?d+$"),xr.regexCheckFloat1=new RegExp("^[+-]?([0-9]+([.][0-9]*)?|[.][0-9]+)$"),J.c.StiExcelExportService=xr;class Ar{constructor(t,e,i,r,n,a,s,o,l){this.Name=t,this.Bold=e,this.Italic=i,this.Underlined=r,this.Strikeout=n,this.Height=a,this.Color=s,this.Charset=o,this.Family=l}equals(t){return this.Name==t.Name&&this.Bold==t.Bold&&this.Italic==t.Italic&&this.Underlined==t.Underlined&&this.Strikeout==t.Strikeout&&this.Height==t.Height&&this.Color.equals(t.Color)&&this.Charset==t.Charset&&this.Family==t.Family}}J.c.DataFont=Ar;class Tr{constructor(t,e,i){this.Type=t,this.FgColor=e,this.BgColor=i}equals(t){return this.Type==t.Type&&this.FgColor.equals(t.FgColor)&&this.BgColor.equals(t.BgColor)}}J.c.DataFill=Tr;class Fr{constructor(t,e,i,r){this.BorderLeft=t,this.BorderRight=e,this.BorderTop=i,this.BorderBottom=r}equals(t){return this.eq(this.BorderLeft,t.BorderLeft)&&this.eq(this.BorderRight,t.BorderRight)&&this.eq(this.BorderTop,t.BorderTop)&&this.eq(this.BorderBottom,t.BorderBottom)}eq(t,e){return null==t&&null==e||null!=t&&null!=e&&t[Z.System.StiObject.stimulsoft]().equals(e)}}J.c.DataBorder=Fr;class Cr{equalDataXF(t){if(this.FormatIndex!=t.FormatIndex||this.FontIndex!=t.FontIndex||this.FillIndex!=t.FillIndex||this.BorderIndex!=t.BorderIndex||this.XFId!=t.XFId||this.HorAlign!=t.HorAlign||this.VertAlign!=t.VertAlign||this.TextRotationAngle!=t.TextRotationAngle||this.TextWrapped!=t.TextWrapped||this.RightToLeft!=t.RightToLeft||this.Editable!=t.Editable)return!1;return!0}constructor(t,e,i,r,n,a,s,o,l,h,c){this.FormatIndex=t,this.FontIndex=e,this.FillIndex=i,this.BorderIndex=r,this.XFId=n,this.HorAlign=a,this.VertAlign=s,this.TextRotationAngle=o,this.TextWrapped=l,this.RightToLeft=h,this.Editable=c}}J.c.DataXF=Cr;class Pr{constructor(t,e,i,r,n,a,s,o,l,h,c,m,g){this.FirstRowIndex=t,this.FirstRowOffset=e,this.FirstColumnIndex=i,this.FirstColumnOffset=r,this.LastRowIndex=n,this.LastRowOffset=a,this.LastColumnIndex=s,this.LastColumnOffset=o,this.ImageIndex=l,this.Hyperlink=h,this.Component=c,this.OffsetAndSize=m,this.ImageSize=g}}J.c.ExcelImageData=Pr;class Lr{constructor(t,e,i,r){this.FirstRow=t,this.LastRow=e,this.FirstColumn=i,this.LastColumn=r}}J.c.CellRangeAddress=Lr;class kr{constructor(t,e,i){this.Range=t,this.Description=e,this.Bookmark=i}}J.c.HlinkData=kr,J.c.StiExcel2007ExportService=class extends xr{}}let b=Z.System.Drawing.ContentAlignment,jt=J.a.Components.StiRoundedRectanglePrimitive,Vt=Z.Base.Drawing.StiCapStyle,Yt=J.a.Components.StiVerticalLinePrimitive,qt=J.a.Components.StiHorizontalLinePrimitive;{class Br extends J.c.StiExportService{constructor(){super(...arguments),this.imageSlide=[],this.imageResolution=1,this.imageQuality=.75,this.imageCache=null,this.imageFormat=null,this.idCounter=2,this.hyperlinkList=null,this.xmlIndentation=-1,this.currentCulture=null,this.newCulture=null,this.imageResolutionMode=J.c.StiImageResolutionMode.Auto,this.exportCache=null,this.wrongUrlSymbols=" \"#'*,;<>[^`{|}"}implements(){let t=[J.c.IStiPowerPointExportService];return(this.implements=()=>t)()}get exportFormat(){return J.a.StiExportFormat.PowerPoint}exportTo(e,t,i){if(null==this.exportCache){let t=i;this.exportCache=new J.c.StiExportImageCache(t.imageFormat,!0,new J.a.StiImageCache(Z.StiOptions.Export.PowerPoint.AllowImageComparer,!0,t.imageFormat,t.imageQuality),Math.max(t.imageResolution,10)/100,e)}this.exportPowerPoint(e,t,i)}exportToAsync(i,r,n,a){setTimeout(async()=>{var e;try{let t=a;if(this.exportCache=new J.c.StiExportImageCache(t.imageFormat,!0,new J.a.StiImageCache(Z.StiOptions.Export.PowerPoint.AllowImageComparer,!0,t.imageFormat,t.imageQuality),Math.max(t.imageResolution,10)/100,r),await J.c.StiExportImageHelper.convertAllImages(r,Z.System.Drawing.Imaging.ImageFormat.Jpeg,!1,this.exportFormat,this.exportCache),!r.isDocument&&null!=(e=r.getCurrentPage())&&e.is(Lt))return await Ut.export(r,n,a),void i();this.exportTo(r,n,a),null!=r&&null!=r.preparedExportImages&&(r.preparedExportImages.clear(),r.preparedExportImages=null)}catch(t){if(o.log(t,r,`Export Error`).isImportant)return i(o.getMessage(t))}i()},0)}getLineStyle(t){switch(t){case ot.Solid:return"solid";case ot.Dot:return"sysDot";case ot.Dash:return"sysDash";case ot.DashDot:return"sysDashDot";case ot.DashDotDot:return"sysDashDotDot";case ot.Double:return"solid";default:return"solid"}}stringToUrl(t){let i=u.UTF8.getBytes(t),r=new ct;for(let e of i){let t=String.fromCharCode(e);e<32||127<e||-1!=this.wrongUrlSymbols.indexOf(t)?r.append(nt.format("%{0:x2}",e)):r.append(t)}return r.toString()}convertToEmu(t){return 0|Math.round(t/100*914400)}writeColor(e,i){if(e.writeStartElement("a:srgbClr"),e.writeAttributeString("val",nt.format("{0:X6}",16777215&i.toArgb())),255!=i.a){let t=i.a/256*1e5|0;e.writeStartElement("a:alpha"),e.writeAttributeString("val",t.toString()),e.writeEndElement()}e.writeEndElement()}writeContentTypes(e){let t=new K,i=new w(u.UTF8,t);i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?d.None:d.Indented,i.writeStartDocument(),i.writeStartElement("Types"),i.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/content-types");for(let t=0;t<11;t++)i.writeStartElement("Override"),i.writeAttributeString("PartName",`/ppt/slideLayouts/slideLayout${t+1}.xml`),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.slideLayout+xml"),i.writeEndElement();i.writeStartElement("Override"),i.writeAttributeString("PartName","/ppt/slideMasters/slideMaster1.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.slideMaster+xml"),i.writeEndElement(),i.writeStartElement("Override"),i.writeAttributeString("PartName","/ppt/presProps.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.presProps+xml"),i.writeEndElement();for(let t=0;t<e;t++)i.writeStartElement("Override"),i.writeAttributeString("PartName",`/ppt/slides/slide${t+1}.xml`),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.slide+xml"),i.writeEndElement();return i.writeStartElement("Override"),i.writeAttributeString("PartName","/ppt/theme/theme1.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.theme+xml"),i.writeEndElement(),i.writeStartElement("Default"),i.writeAttributeString("Extension","jpeg"),i.writeAttributeString("ContentType","image/jpeg"),i.writeEndElement(),i.writeStartElement("Default"),i.writeAttributeString("Extension","png"),i.writeAttributeString("ContentType","image/png"),i.writeEndElement(),i.writeStartElement("Default"),i.writeAttributeString("Extension","rels"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-package.relationships+xml"),i.writeEndElement(),i.writeStartElement("Default"),i.writeAttributeString("Extension","xml"),i.writeAttributeString("ContentType","application/xml"),i.writeEndElement(),i.writeStartElement("Override"),i.writeAttributeString("PartName","/ppt/presentation.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.presentation.main+xml"),i.writeEndElement(),i.writeStartElement("Override"),i.writeAttributeString("PartName","/docProps/app.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.extended-properties+xml"),i.writeEndElement(),i.writeStartElement("Override"),i.writeAttributeString("PartName","/ppt/tableStyles.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.tableStyles+xml"),i.writeEndElement(),i.writeStartElement("Override"),i.writeAttributeString("PartName","/ppt/viewProps.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.viewProps+xml"),i.writeEndElement(),i.writeStartElement("Override"),i.writeAttributeString("PartName","/docProps/core.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-package.core-properties+xml"),i.writeEndElement(),i.writeFullEndElement(),i.writeEndDocument(),i.flush(),t}writeMainRels(){let t=new K,e=new w(u.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?d.None:d.Indented,e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId1"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument"),e.writeAttributeString("Target","ppt/presentation.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId2"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties"),e.writeAttributeString("Target","docProps/core.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId3"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties"),e.writeAttributeString("Target","docProps/app.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeDocPropsApp(e){let t=new K,i=new w(u.UTF8,t);i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?d.None:d.Indented,i.writeStartDocument(),i.writeStartElement("Properties"),i.writeAttributeString("xmlns","http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"),i.writeAttributeString("xmlns:vt","http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"),i.writeElementString("Application",J.c.StiExportUtils.getReportVersion(this.report)),i.writeElementString("Slides",e.toString()),i.writeElementString("PresentationFormat","On-screen Show (4:3)"),i.writeElementString("TotalTime","0"),i.writeElementString("Words","0"),i.writeElementString("Paragraphs","0"),i.writeElementString("Notes","0"),i.writeElementString("HiddenSlides","0"),i.writeElementString("MMClips","0"),i.writeElementString("ScaleCrop","false"),i.writeStartElement("HeadingPairs"),i.writeStartElement("vt:vector"),i.writeAttributeString("size","4"),i.writeAttributeString("baseType","variant"),i.writeStartElement("vt:variant"),i.writeElementString("vt:lpstr","Theme"),i.writeEndElement(),i.writeStartElement("vt:variant"),i.writeElementString("vt:i4",e.toString()),i.writeEndElement(),i.writeStartElement("vt:variant"),i.writeElementString("vt:lpstr","Slide Titles"),i.writeEndElement(),i.writeStartElement("vt:variant"),i.writeElementString("vt:i4",e.toString()),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("TitlesOfParts"),i.writeStartElement("vt:vector"),i.writeAttributeString("size",(1+e).toString()),i.writeAttributeString("baseType","lpstr"),i.writeElementString("vt:lpstr","Office Theme");for(let t=0;t<e;t++)i.writeElementString("vt:lpstr",`Slide `+(t+1));return i.writeEndElement(),i.writeEndElement(),i.writeElementString("Company","Stimulsoft"),i.writeElementString("LinksUpToDate","false"),i.writeElementString("SharedDoc","false"),i.writeElementString("HyperlinksChanged","false"),i.writeElementString("AppVersion","12.0000"),i.writeFullEndElement(),i.writeEndDocument(),i.flush(),t}writeDocPropsCore(){let t,e,i,r,n=new K,a=new w(u.UTF8,n),s=(a.indentation=this.xmlIndentation<0?0:this.xmlIndentation,a.formatting=this.xmlIndentation<0?d.None:d.Indented,a.writeStartDocument(),a.writeStartElement("cp:coreProperties"),a.writeAttributeString("xmlns:cp","http://schemas.openxmlformats.org/package/2006/metadata/core-properties"),a.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),a.writeAttributeString("xmlns:dcterms","http://purl.org/dc/terms/"),a.writeAttributeString("xmlns:dcmitype","http://purl.org/dc/dcmitype/"),a.writeAttributeString("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance"),_.now.toString("yyyy-MM-ddTHH:mm:ssZ"));return a.writeElementString("dc:title",null!=(t=this.report.reportName)?t:""),a.writeElementString("dc:subject",null!=(e=this.report.reportAlias)?e:""),a.writeElementString("dc:creator",null!=(i=this.report.reportAuthor)?i:""),a.writeElementString("cp:keywords",""),a.writeElementString("dc:description",null!=(r=this.report.reportDescription)?r:""),a.writeElementString("cp:revision","1"),a.writeStartElement("dcterms:created"),a.writeAttributeString("xsi:type","dcterms:W3CDTF"),a.writeString(s),a.writeEndElement(),a.writeStartElement("dcterms:modified"),a.writeAttributeString("xsi:type","dcterms:W3CDTF"),a.writeString(s),a.writeEndElement(),a.writeFullEndElement(),a.writeEndDocument(),a.flush(),n}writeTableStyles(){let t=new K,e=new w(u.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?d.None:d.Indented,e.writeStartDocument(),e.writeStartElement("a:tblStyleLst"),e.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),e.writeAttributeString("def","{5C22544A-7EE6-4342-B048-85BDC9FD1C3A}"),e.writeEndElement(),e.writeEndDocument(),e.flush(),t}writePresProps(){let t=new K,e=new w(u.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?d.None:d.Indented,e.writeStartDocument(),e.writeStartElement("p:presentationPr"),e.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeAttributeString("xmlns:p","http://schemas.openxmlformats.org/presentationml/2006/main"),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeViewProps(){let t=new K,e=new w(u.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?d.None:d.Indented,e.writeStartDocument(),e.writeStartElement("p:viewPr"),e.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeAttributeString("xmlns:p","http://schemas.openxmlformats.org/presentationml/2006/main"),e.writeStartElement("p:normalViewPr"),e.writeAttributeString("showOutlineIcons","0"),e.writeStartElement("p:restoredLeft"),e.writeAttributeString("sz","15591"),e.writeAttributeString("autoAdjust","0"),e.writeEndElement(),e.writeStartElement("p:restoredTop"),e.writeAttributeString("sz","94675"),e.writeAttributeString("autoAdjust","0"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("p:slideViewPr"),e.writeStartElement("p:cSldViewPr"),e.writeStartElement("p:cViewPr"),e.writeAttributeString("varScale","1"),e.writeStartElement("p:scale"),e.writeStartElement("a:sx"),e.writeAttributeString("n","107"),e.writeAttributeString("d","100"),e.writeEndElement(),e.writeStartElement("a:sy"),e.writeAttributeString("n","107"),e.writeAttributeString("d","100"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("p:origin"),e.writeAttributeString("x","-1098"),e.writeAttributeString("y","-84"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("p:guideLst"),e.writeStartElement("p:guide"),e.writeAttributeString("orient","horz"),e.writeAttributeString("pos","2160"),e.writeEndElement(),e.writeStartElement("p:guide"),e.writeAttributeString("pos","2880"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("p:notesTextViewPr"),e.writeStartElement("p:cViewPr"),e.writeStartElement("p:scale"),e.writeStartElement("a:sx"),e.writeAttributeString("n","100"),e.writeAttributeString("d","100"),e.writeEndElement(),e.writeStartElement("a:sy"),e.writeAttributeString("n","100"),e.writeAttributeString("d","100"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("p:origin"),e.writeAttributeString("x","0"),e.writeAttributeString("y","0"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("p:gridSpacing"),e.writeAttributeString("cx","73736200"),e.writeAttributeString("cy","73736200"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeTheme(){let t=new K,e=new w(u.UTF8,t),i=(e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?d.None:d.Indented,e.writeStartDocument(),'<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"><a:themeElements><a:clrScheme name="Office"><a:dk1><a:sysClr val="windowText" lastClr="000000" /></a:dk1><a:lt1><a:sysClr val="window" lastClr="FFFFFF" /></a:lt1><a:dk2><a:srgbClr val="1F497D" /></a:dk2><a:lt2><a:srgbClr val="EEECE1" /></a:lt2><a:accent1><a:srgbClr val="4F81BD" /></a:accent1><a:accent2><a:srgbClr val="C0504D" /></a:accent2><a:accent3><a:srgbClr val="9BBB59" /></a:accent3><a:accent4>'+'<a:srgbClr val="8064A2" /></a:accent4><a:accent5><a:srgbClr val="4BACC6" /></a:accent5><a:accent6><a:srgbClr val="F79646" /></a:accent6><a:hlink><a:srgbClr val="0000FF" /></a:hlink><a:folHlink><a:srgbClr val="800080" /></a:folHlink></a:clrScheme><a:fontScheme name="Office"><a:majorFont><a:latin typeface="Calibri" /><a:ea typeface="" /><a:cs typeface="" /><a:font script="Jpan" typeface="ＭＳ Ｐゴシック" /><a:font script="Hang" typeface="맑은 고딕" /><a:font script="Hans" typeface="宋体" /><a:font script="Hant" typeface="新細明體" />'+'<a:font script="Arab" typeface="Times New Roman" /><a:font script="Hebr" typeface="Times New Roman" /><a:font script="Thai" typeface="Angsana New" /><a:font script="Ethi" typeface="Nyala" /><a:font script="Beng" typeface="Vrinda" /><a:font script="Gujr" typeface="Shruti" /><a:font script="Khmr" typeface="MoolBoran" /><a:font script="Knda" typeface="Tunga" /><a:font script="Guru" typeface="Raavi" /><a:font script="Cans" typeface="Euphemia" /><a:font script="Cher" typeface="Plantagenet Cherokee" /><a:font script="Yiii" typeface="Microsoft Yi Baiti" />'+'<a:font script="Tibt" typeface="Microsoft Himalaya" /><a:font script="Thaa" typeface="MV Boli" /><a:font script="Deva" typeface="Mangal" /><a:font script="Telu" typeface="Gautami" /><a:font script="Taml" typeface="Latha" /><a:font script="Syrc" typeface="Estrangelo Edessa" /><a:font script="Orya" typeface="Kalinga" /><a:font script="Mlym" typeface="Kartika" /><a:font script="Laoo" typeface="DokChampa" /><a:font script="Sinh" typeface="Iskoola Pota" /><a:font script="Mong" typeface="Mongolian Baiti" /><a:font script="Viet" typeface="Times New Roman" />'+'<a:font script="Uigh" typeface="Microsoft Uighur" /></a:majorFont><a:minorFont><a:latin typeface="Calibri" /><a:ea typeface="" /><a:cs typeface="" /><a:font script="Jpan" typeface="ＭＳ Ｐゴシック" /><a:font script="Hang" typeface="맑은 고딕" /><a:font script="Hans" typeface="宋体" /><a:font script="Hant" typeface="新細明體" /><a:font script="Arab" typeface="Arial" /><a:font script="Hebr" typeface="Arial" /><a:font script="Thai" typeface="Cordia New" /><a:font script="Ethi" typeface="Nyala" /><a:font script="Beng" typeface="Vrinda" />'+'<a:font script="Gujr" typeface="Shruti" /><a:font script="Khmr" typeface="DaunPenh" /><a:font script="Knda" typeface="Tunga" /><a:font script="Guru" typeface="Raavi" /><a:font script="Cans" typeface="Euphemia" /><a:font script="Cher" typeface="Plantagenet Cherokee" /><a:font script="Yiii" typeface="Microsoft Yi Baiti" /><a:font script="Tibt" typeface="Microsoft Himalaya" /><a:font script="Thaa" typeface="MV Boli" /><a:font script="Deva" typeface="Mangal" /><a:font script="Telu" typeface="Gautami" /><a:font script="Taml" typeface="Latha" />'+'<a:font script="Syrc" typeface="Estrangelo Edessa" /><a:font script="Orya" typeface="Kalinga" /><a:font script="Mlym" typeface="Kartika" /><a:font script="Laoo" typeface="DokChampa" /><a:font script="Sinh" typeface="Iskoola Pota" /><a:font script="Mong" typeface="Mongolian Baiti" /><a:font script="Viet" typeface="Arial" /><a:font script="Uigh" typeface="Microsoft Uighur" /></a:minorFont></a:fontScheme><a:fmtScheme name="Office"><a:fillStyleLst><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0">'+'<a:schemeClr val="phClr"><a:tint val="50000" /><a:satMod val="300000" /></a:schemeClr></a:gs><a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000" /><a:satMod val="300000" /></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000" /><a:satMod val="350000" /></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="1" /></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:shade val="51000" /><a:satMod val="130000" /></a:schemeClr></a:gs><a:gs pos="80000"><a:schemeClr val="phClr">'+'<a:shade val="93000" /><a:satMod val="130000" /></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="94000" /><a:satMod val="135000" /></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="0" /></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000" /><a:satMod val="105000" /></a:schemeClr></a:solidFill><a:prstDash val="solid" /></a:ln><a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr" /></a:solidFill>'+'<a:prstDash val="solid" /></a:ln><a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:prstDash val="solid" /></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000" /></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000" /></a:srgbClr></a:outerShdw></a:effectLst>'+'</a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000" /></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0" /></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000" /></a:lightRig></a:scene3d><a:sp3d><a:bevelT w="63500" h="25400" /></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:gradFill rotWithShape="1">'+'<a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000" /><a:satMod val="350000" /></a:schemeClr></a:gs><a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000" /><a:shade val="99000" /><a:satMod val="350000" /></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000" /><a:satMod val="255000" /></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000" /></a:path></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000" /><a:satMod val="300000" /></a:schemeClr>'+'</a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000" /><a:satMod val="200000" /></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000" /></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults /><a:extraClrSchemeLst /></a:theme>');return e.writeRaw(i),e.writeEndDocument(),e.flush(),t}writeSlideMasterRels(){let t=new K,e=new w(u.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?d.None:d.Indented,e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships");for(let t=0;t<11;t++)e.writeStartElement("Relationship"),e.writeAttributeString("Id",`rId`+(t+1)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout"),e.writeAttributeString("Target",`../slideLayouts/slideLayout${t+1}.xml`),e.writeEndElement();return e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId12"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme"),e.writeAttributeString("Target","../theme/theme1.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeSlideMaster(){let t=new K,e=new w(u.UTF8,t),i=(e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?d.None:d.Indented,e.writeStartDocument(),'<p:sldMaster xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:p="http://schemas.openxmlformats.org/presentationml/2006/main"><p:cSld><p:bg><p:bgRef idx="1001"><a:schemeClr val="bg1" /></p:bgRef></p:bg><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" />'+'<a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title Placeholder 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="274638" /><a:ext cx="8229600" cy="1143000" /></a:xfrm><a:prstGeom prst="rect"><a:avLst /></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert="horz" lIns="91440" tIns="45720" rIns="91440" bIns="45720" rtlCol="0" anchor="ctr">'+'<a:normAutofit /></a:bodyPr><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Text Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="1600200" /><a:ext cx="8229600" cy="4525963" /></a:xfrm><a:prstGeom prst="rect">'+'<a:avLst /></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert="horz" lIns="91440" tIns="45720" rIns="91440" bIns="45720" rtlCol="0"><a:normAutofit /></a:bodyPr><a:lstStyle /><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" />'+'<a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Date Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="2" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm>'+'<a:off x="457200" y="6356350" /><a:ext cx="2133600" cy="365125" /></a:xfrm><a:prstGeom prst="rect"><a:avLst /></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert="horz" lIns="91440" tIns="45720" rIns="91440" bIns="45720" rtlCol="0" anchor="ctr" /><a:lstStyle><a:lvl1pPr algn="l"><a:defRPr sz="1200"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr></a:lstStyle><a:p>'+'<a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Footer Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="3" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="3124200" y="6356350" /><a:ext cx="2895600" cy="365125" /></a:xfrm>'+'<a:prstGeom prst="rect"><a:avLst /></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert="horz" lIns="91440" tIns="45720" rIns="91440" bIns="45720" rtlCol="0" anchor="ctr" /><a:lstStyle><a:lvl1pPr algn="ctr"><a:defRPr sz="1200"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr></a:lstStyle><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Slide Number Placeholder 5" />'+'<p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="4" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="6553200" y="6356350" /><a:ext cx="2133600" cy="365125" /></a:xfrm><a:prstGeom prst="rect"><a:avLst /></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert="horz" lIns="91440" tIns="45720" rIns="91440" bIns="45720" rtlCol="0" anchor="ctr" /><a:lstStyle><a:lvl1pPr algn="r"><a:defRPr sz="1200"><a:solidFill><a:schemeClr val="tx1">'+'<a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr></a:lstStyle><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld><p:clrMap bg1="lt1" tx1="dk1" bg2="lt2" tx2="dk2" accent1="accent1" accent2="accent2" accent3="accent3" accent4="accent4" accent5="accent5" accent6="accent6" hlink="hlink" folHlink="folHlink" />'+'<p:sldLayoutIdLst><p:sldLayoutId id="2147483649" r:id="rId1" /><p:sldLayoutId id="2147483650" r:id="rId2" /><p:sldLayoutId id="2147483651" r:id="rId3" /><p:sldLayoutId id="2147483652" r:id="rId4" /><p:sldLayoutId id="2147483653" r:id="rId5" /><p:sldLayoutId id="2147483654" r:id="rId6" /><p:sldLayoutId id="2147483655" r:id="rId7" /><p:sldLayoutId id="2147483656" r:id="rId8" /><p:sldLayoutId id="2147483657" r:id="rId9" /><p:sldLayoutId id="2147483658" r:id="rId10" />'+'<p:sldLayoutId id="2147483659" r:id="rId11" /></p:sldLayoutIdLst><p:txStyles><p:titleStyle><a:lvl1pPr algn="ctr" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="0" /></a:spcBef><a:buNone /><a:defRPr sz="4400" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mj-lt" /><a:ea typeface="+mj-ea" /><a:cs typeface="+mj-cs" /></a:defRPr></a:lvl1pPr></p:titleStyle><p:bodyStyle>'+'<a:lvl1pPr marL="342900" indent="-342900" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="•" /><a:defRPr sz="3200" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl1pPr>'+'<a:lvl2pPr marL="742950" indent="-285750" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="–" /><a:defRPr sz="2800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl2pPr>'+'<a:lvl3pPr marL="1143000" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="•" /><a:defRPr sz="2400" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl3pPr>'+'<a:lvl4pPr marL="1600200" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="–" /><a:defRPr sz="2000" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl4pPr>'+'<a:lvl5pPr marL="2057400" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="»" /><a:defRPr sz="2000" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl5pPr>'+'<a:lvl6pPr marL="2514600" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="•" /><a:defRPr sz="2000" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl6pPr>'+'<a:lvl7pPr marL="2971800" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="•" /><a:defRPr sz="2000" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl7pPr>'+'<a:lvl8pPr marL="3429000" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="•" /><a:defRPr sz="2000" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl8pPr>'+'<a:lvl9pPr marL="3886200" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="•" /><a:defRPr sz="2000" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl9pPr>'+'</p:bodyStyle><p:otherStyle><a:defPPr><a:defRPr lang="ru-RU" /></a:defPPr><a:lvl1pPr marL="0" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl1pPr><a:lvl2pPr marL="457200" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1">'+'<a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl2pPr><a:lvl3pPr marL="914400" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl3pPr>'+'<a:lvl4pPr marL="1371600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl4pPr><a:lvl5pPr marL="1828800" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill>'+'<a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl5pPr><a:lvl6pPr marL="2286000" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl6pPr>'+'<a:lvl7pPr marL="2743200" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl7pPr><a:lvl8pPr marL="3200400" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill>'+'<a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl8pPr><a:lvl9pPr marL="3657600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl9pPr></p:otherStyle></p:txStyles></p:sldMaster>');return e.writeRaw(i),e.writeEndDocument(),e.flush(),t}writeSlideLayoutRels(){let t=new K,e=new w(u.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?d.None:d.Indented,e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId1"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster"),e.writeAttributeString("Target","../slideMasters/slideMaster1.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeSlideLayout(t,n){let i,e=new K,a=new w(u.UTF8,e);if(a.indentation=this.xmlIndentation<0?0:this.xmlIndentation,a.formatting=this.xmlIndentation<0?d.None:d.Indented,a.writeStartDocument(),a.writeStartElement("p:sldLayout"),a.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),a.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),a.writeAttributeString("xmlns:p","http://schemas.openxmlformats.org/presentationml/2006/main"),1==t){a.writeAttributeString("type","title"),a.writeAttributeString("preserve","1");let t='<p:cSld name="Title Slide"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ctrTitle" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="685800" y="2130425" /><a:ext cx="7772400" cy="1470025" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Subtitle 2" />'+'<p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="subTitle" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="1371600" y="3886200" /><a:ext cx="6400800" cy="1752600" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr marL="0" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" />'+'</a:schemeClr></a:solidFill></a:defRPr></a:lvl3pPr><a:lvl4pPr marL="1371600" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl5pPr><a:lvl6pPr marL="2286000" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl6pPr><a:lvl7pPr marL="2743200" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" />'+'</a:schemeClr></a:solidFill></a:defRPr></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl9pPr></a:lstStyle><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master subtitle style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Date Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr>'+'<p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Footer Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Slide Number Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr>'+'<p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>';a.writeRaw(t)}if(2==t){a.writeAttributeString("type","obj"),a.writeAttributeString("preserve","1");let t='<p:cSld name="Title and Content"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Content Placeholder 2" />'+'<p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph idx="1" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r>'+'<a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Date Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Footer Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr>'+'<p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Slide Number Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>';a.writeRaw(t)}if(3==t){a.writeAttributeString("type","secHead"),a.writeAttributeString("preserve","1");let t='<p:cSld name="Section Header"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="722313" y="4406900" /><a:ext cx="7772400" cy="1362075" /></a:xfrm></p:spPr><p:txBody><a:bodyPr anchor="t" /><a:lstStyle><a:lvl1pPr algn="l"><a:defRPr sz="4000" b="1" cap="all" /></a:lvl1pPr></a:lstStyle><a:p><a:r>'+'<a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Text Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="722313" y="2906713" /><a:ext cx="7772400" cy="1500187" /></a:xfrm></p:spPr><p:txBody><a:bodyPr anchor="b" /><a:lstStyle><a:lvl1pPr marL="0" indent="0"><a:buNone /><a:defRPr sz="2000"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0"><a:buNone />'+'<a:defRPr sz="1800"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0"><a:buNone /><a:defRPr sz="1600"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl3pPr><a:lvl4pPr marL="1371600" indent="0"><a:buNone /><a:defRPr sz="1400"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0"><a:buNone /><a:defRPr sz="1400"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl5pPr>'+'<a:lvl6pPr marL="2286000" indent="0"><a:buNone /><a:defRPr sz="1400"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl6pPr><a:lvl7pPr marL="2743200" indent="0"><a:buNone /><a:defRPr sz="1400"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0"><a:buNone /><a:defRPr sz="1400"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0"><a:buNone /><a:defRPr sz="1400"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl9pPr></a:lstStyle>'+'<a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Date Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Footer Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr>'+'<p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Slide Number Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>';a.writeRaw(t)}if(4==t){a.writeAttributeString("type","twoObj"),a.writeAttributeString("preserve","1");let t='<p:cSld name="Two Content"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Content Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr>'+'<p:nvPr><p:ph sz="half" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="1600200" /><a:ext cx="4038600" cy="4525963" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr><a:defRPr sz="2800" /></a:lvl1pPr><a:lvl2pPr><a:defRPr sz="2400" /></a:lvl2pPr><a:lvl3pPr><a:defRPr sz="2000" /></a:lvl3pPr><a:lvl4pPr><a:defRPr sz="1800" /></a:lvl4pPr><a:lvl5pPr><a:defRPr sz="1800" /></a:lvl5pPr><a:lvl6pPr><a:defRPr sz="1800" /></a:lvl6pPr><a:lvl7pPr><a:defRPr sz="1800" /></a:lvl7pPr><a:lvl8pPr><a:defRPr sz="1800" /></a:lvl8pPr><a:lvl9pPr><a:defRPr sz="1800" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" />'+'<a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Content Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph sz="half" idx="2" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="4648200" y="1600200" />'+'<a:ext cx="4038600" cy="4525963" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr><a:defRPr sz="2800" /></a:lvl1pPr><a:lvl2pPr><a:defRPr sz="2400" /></a:lvl2pPr><a:lvl3pPr><a:defRPr sz="2000" /></a:lvl3pPr><a:lvl4pPr><a:defRPr sz="1800" /></a:lvl4pPr><a:lvl5pPr><a:defRPr sz="1800" /></a:lvl5pPr><a:lvl6pPr><a:defRPr sz="1800" /></a:lvl6pPr><a:lvl7pPr><a:defRPr sz="1800" /></a:lvl7pPr><a:lvl8pPr><a:defRPr sz="1800" /></a:lvl8pPr><a:lvl9pPr><a:defRPr sz="1800" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" />'+'<a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Date Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" />'+'<a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Footer Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="7" name="Slide Number Placeholder 6" />'+'<p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>';a.writeRaw(t)}if(5==t){a.writeAttributeString("type","twoTxTwoObj"),a.writeAttributeString("preserve","1");let t='<p:cSld name="Comparison"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr><a:defRPr /></a:lvl1pPr></a:lstStyle><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Text Placeholder 2" />'+'<p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="1535113" /><a:ext cx="4040188" cy="639762" /></a:xfrm></p:spPr><p:txBody><a:bodyPr anchor="b" /><a:lstStyle><a:lvl1pPr marL="0" indent="0"><a:buNone /><a:defRPr sz="2400" b="1" /></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0"><a:buNone /><a:defRPr sz="2000" b="1" /></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0"><a:buNone /><a:defRPr sz="1800" b="1" /></a:lvl3pPr><a:lvl4pPr marL="1371600" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl5pPr>'+'<a:lvl6pPr marL="2286000" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl6pPr><a:lvl7pPr marL="2743200" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Content Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph sz="half" idx="2" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="2174875" />'+'<a:ext cx="4040188" cy="3951288" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr><a:defRPr sz="2400" /></a:lvl1pPr><a:lvl2pPr><a:defRPr sz="2000" /></a:lvl2pPr><a:lvl3pPr><a:defRPr sz="1800" /></a:lvl3pPr><a:lvl4pPr><a:defRPr sz="1600" /></a:lvl4pPr><a:lvl5pPr><a:defRPr sz="1600" /></a:lvl5pPr><a:lvl6pPr><a:defRPr sz="1600" /></a:lvl6pPr><a:lvl7pPr><a:defRPr sz="1600" /></a:lvl7pPr><a:lvl8pPr><a:defRPr sz="1600" /></a:lvl8pPr><a:lvl9pPr><a:defRPr sz="1600" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r>'+'<a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Text Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" sz="quarter" idx="3" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="4645025" y="1535113" /><a:ext cx="4041775" cy="639762" /></a:xfrm></p:spPr>'+'<p:txBody><a:bodyPr anchor="b" /><a:lstStyle><a:lvl1pPr marL="0" indent="0"><a:buNone /><a:defRPr sz="2400" b="1" /></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0"><a:buNone /><a:defRPr sz="2000" b="1" /></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0"><a:buNone /><a:defRPr sz="1800" b="1" /></a:lvl3pPr><a:lvl4pPr marL="1371600" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl5pPr><a:lvl6pPr marL="2286000" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl6pPr><a:lvl7pPr marL="2743200" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0">'+'<a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Content Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph sz="quarter" idx="4" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="4645025" y="2174875" /><a:ext cx="4041775" cy="3951288" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr><a:defRPr sz="2400" /></a:lvl1pPr><a:lvl2pPr><a:defRPr sz="2000" /></a:lvl2pPr>'+'<a:lvl3pPr><a:defRPr sz="1800" /></a:lvl3pPr><a:lvl4pPr><a:defRPr sz="1600" /></a:lvl4pPr><a:lvl5pPr><a:defRPr sz="1600" /></a:lvl5pPr><a:lvl6pPr><a:defRPr sz="1600" /></a:lvl6pPr><a:lvl7pPr><a:defRPr sz="1600" /></a:lvl7pPr><a:lvl8pPr><a:defRPr sz="1600" /></a:lvl8pPr><a:lvl9pPr><a:defRPr sz="1600" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r>'+'<a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="7" name="Date Placeholder 6" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="8" name="Footer Placeholder 7" />'+'<p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="9" name="Slide Number Placeholder 8" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>';a.writeRaw(t)}if(6==t){a.writeAttributeString("type","titleOnly"),a.writeAttributeString("preserve","1");let t='<p:cSld name="Title Only"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Date Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr>'+'<p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Footer Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Slide Number Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr>'+'<p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>';a.writeRaw(t)}if(7==t){a.writeAttributeString("type","blank"),a.writeAttributeString("preserve","1"),a.writeStartElement("p:cSld"),a.writeAttributeString("name","Blank"),a.writeStartElement("p:spTree"),a.writeStartElement("p:nvGrpSpPr"),a.writeStartElement("p:cNvPr"),a.writeAttributeString("id","1"),a.writeAttributeString("name",""),a.writeEndElement(),a.writeStartElement("p:cNvGrpSpPr"),a.writeEndElement(),a.writeStartElement("p:nvPr"),a.writeEndElement(),a.writeFullEndElement(),a.writeStartElement("p:grpSpPr"),a.writeStartElement("a:xfrm"),a.writeStartElement("a:off"),a.writeAttributeString("x","0"),a.writeAttributeString("y","0"),a.writeEndElement(),a.writeStartElement("a:ext"),a.writeAttributeString("cx","0"),a.writeAttributeString("cy","0"),a.writeEndElement(),a.writeStartElement("a:chOff"),a.writeAttributeString("x","0"),a.writeAttributeString("y","0"),a.writeEndElement(),a.writeStartElement("a:chExt"),a.writeAttributeString("cx","0"),a.writeAttributeString("cy","0"),a.writeEndElement(),a.writeFullEndElement(),a.writeFullEndElement(),a.writeStartElement("p:sp"),a.writeStartElement("p:nvSpPr"),a.writeStartElement("p:cNvPr"),a.writeAttributeString("id","2"),a.writeAttributeString("name","Date Placeholder 1"),a.writeEndElement(),a.writeStartElement("p:cNvSpPr"),a.writeStartElement("a:spLocks"),a.writeAttributeString("noGrp","1"),a.writeEndElement(),a.writeFullEndElement(),a.writeStartElement("p:nvPr"),a.writeStartElement("p:ph"),a.writeAttributeString("type","dt"),a.writeAttributeString("sz","half"),a.writeAttributeString("idx","10"),a.writeEndElement(),a.writeFullEndElement(),a.writeFullEndElement(),a.writeStartElement("p:spPr"),a.writeEndElement(),a.writeStartElement("p:txBody"),a.writeStartElement("a:bodyPr"),a.writeEndElement(),a.writeStartElement("a:lstStyle"),a.writeEndElement(),a.writeStartElement("a:p"),a.writeStartElement("a:fld"),a.writeAttributeString("id","{BBCD0B08-7874-4091-A11F-B0CCB138CA98}"),a.writeAttributeString("type","datetimeFigureOut"),a.writeStartElement("a:rPr"),a.writeAttributeString("lang","ru-RU"),a.writeAttributeString("smtClean","0"),a.writeEndElement(),a.writeStartElement("a:t"),a.writeString("15.04.2009"),a.writeFullEndElement(),a.writeFullEndElement(),a.writeStartElement("a:endParaRPr"),a.writeAttributeString("lang","ru-RU"),a.writeEndElement(),a.writeFullEndElement(),a.writeFullEndElement(),a.writeFullEndElement(),a.writeStartElement("p:sp"),a.writeStartElement("p:nvSpPr"),a.writeStartElement("p:cNvPr"),a.writeAttributeString("id","3"),a.writeAttributeString("name","Footer Placeholder 2"),a.writeEndElement(),a.writeStartElement("p:cNvSpPr"),a.writeStartElement("a:spLocks"),a.writeAttributeString("noGrp","1"),a.writeEndElement(),a.writeFullEndElement(),a.writeStartElement("p:nvPr"),a.writeStartElement("p:ph"),a.writeAttributeString("type","ftr"),a.writeAttributeString("sz","quarter"),a.writeAttributeString("idx","11"),a.writeEndElement(),a.writeFullEndElement(),a.writeFullEndElement(),a.writeStartElement("p:spPr"),a.writeEndElement(),a.writeStartElement("p:txBody"),a.writeStartElement("a:bodyPr"),a.writeEndElement(),a.writeStartElement("a:lstStyle"),a.writeEndElement(),a.writeStartElement("a:p"),a.writeStartElement("a:endParaRPr"),a.writeAttributeString("lang","ru-RU"),a.writeEndElement(),a.writeFullEndElement(),a.writeFullEndElement(),a.writeFullEndElement(),a.writeStartElement("p:sp"),a.writeStartElement("p:nvSpPr"),a.writeStartElement("p:cNvPr"),a.writeAttributeString("id","4"),a.writeAttributeString("name","Slide Number Placeholder 3"),a.writeEndElement(),a.writeStartElement("p:cNvSpPr"),a.writeStartElement("a:spLocks"),a.writeAttributeString("noGrp","1"),a.writeEndElement(),a.writeFullEndElement(),a.writeStartElement("p:nvPr"),a.writeStartElement("p:ph"),a.writeAttributeString("type","sldNum"),a.writeAttributeString("sz","quarter"),a.writeAttributeString("idx","12"),a.writeEndElement(),a.writeFullEndElement(),a.writeFullEndElement(),a.writeStartElement("p:spPr"),a.writeEndElement(),a.writeStartElement("p:txBody"),a.writeStartElement("a:bodyPr"),a.writeEndElement(),a.writeStartElement("a:lstStyle"),a.writeEndElement(),a.writeStartElement("a:p"),a.writeStartElement("a:fld"),a.writeAttributeString("id","{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}"),a.writeAttributeString("type","slidenum"),a.writeStartElement("a:rPr"),a.writeAttributeString("lang","ru-RU"),a.writeAttributeString("smtClean","0"),a.writeEndElement(),a.writeStartElement("a:t"),a.writeString("‹#›"),a.writeFullEndElement(),a.writeFullEndElement(),a.writeStartElement("a:endParaRPr"),a.writeAttributeString("lang","ru-RU"),a.writeEndElement(),a.writeFullEndElement(),a.writeFullEndElement(),a.writeFullEndElement();let t=null==(i=this.report.parentReport)?void 0:i.getCurrentPage(),e=this.report.isDocument&&null!=t&&t.is(Lt);if((!Z.Base.vAeXc.eMAio.UUyjq()||e)&&(!Z.Base.vAeXc.eMAio.lAtWS()||!e)&&(!(Z.Base.vAeXc.eMAio.rdCzm()||Z.Base.vAeXc.eMAio.CWsHL()&&!e||Z.Base.vAeXc.eMAio.tnNVR()&&e)||!Z.System.NodeJs.isStandaloneVersion)){let t=n.unit.convertToHInches(n.pageWidth-n.margins.left-n.margins.right),e=n.unit.convertToHInches(n.pageHeight-n.margins.top-n.margins.bottom),i=n.unit.convertToHInches(n.margins.left),r=n.unit.convertToHInches(n.margins.top);a.writeRaw('<p:sp><p:nvSpPr><p:cNvPr id="67" name="TextBox Additional"/><p:cNvSpPr txBox="1"/><p:nvPr userDrawn="1"/></p:nvSpPr>'+'<p:spPr><a:xfrm rot="-2700000"><a:off x="'+this.convertToEmu(i)+'" y="'+this.convertToEmu(r+.45*e)+'"/><a:ext cx="'+this.convertToEmu(t)+'" cy="'+this.convertToEmu(.1*e)+'"/></a:xfrm>'+'<a:prstGeom prst="rect"><a:avLst/></a:prstGeom><a:noFill/></p:spPr>'+'<p:txBody><a:bodyPr wrap="square" rtlCol="0" anchor="ctr" anchorCtr="0"><a:spAutoFit/></a:bodyPr><a:lstStyle/><a:p><a:pPr algn="ctr"/><a:r><a:rPr lang="en-US" sz="9600" b="1" dirty="0" smtClean="0">'+'<a:solidFill><a:schemeClr val="tx1"><a:alpha val="12000"/></a:schemeClr></a:solidFill>'+'<a:latin typeface="Arial" panose="020B0604020202020204" pitchFamily="34" charset="0"/><a:cs typeface="Arial" panose="020B0604020202020204" pitchFamily="34" charset="0"/>'+"</a:rPr><a:t>Trial</a:t></a:r></a:p></p:txBody></p:sp>")}a.writeFullEndElement(),a.writeFullEndElement()}if(8==t){a.writeAttributeString("type","objTx"),a.writeAttributeString("preserve","1");let t='<p:cSld name="Content with Caption"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="273050" /><a:ext cx="3008313" cy="1162050" /></a:xfrm></p:spPr><p:txBody><a:bodyPr anchor="b" /><a:lstStyle><a:lvl1pPr algn="l"><a:defRPr sz="2000" b="1" /></a:lvl1pPr></a:lstStyle><a:p><a:r><a:rPr lang="en-US" smtClean="0" />'+'<a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Content Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="3575050" y="273050" /><a:ext cx="5111750" cy="5853113" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr><a:defRPr sz="3200" /></a:lvl1pPr><a:lvl2pPr><a:defRPr sz="2800" /></a:lvl2pPr><a:lvl3pPr><a:defRPr sz="2400" /></a:lvl3pPr><a:lvl4pPr><a:defRPr sz="2000" /></a:lvl4pPr><a:lvl5pPr><a:defRPr sz="2000" /></a:lvl5pPr><a:lvl6pPr><a:defRPr sz="2000" /></a:lvl6pPr><a:lvl7pPr>'+'<a:defRPr sz="2000" /></a:lvl7pPr><a:lvl8pPr><a:defRPr sz="2000" /></a:lvl8pPr><a:lvl9pPr><a:defRPr sz="2000" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp>'+'<p:sp><p:nvSpPr><p:cNvPr id="4" name="Text Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" sz="half" idx="2" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="1435100" /><a:ext cx="3008313" cy="4691063" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr marL="0" indent="0"><a:buNone /><a:defRPr sz="1400" /></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0"><a:buNone /><a:defRPr sz="1200" /></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0"><a:buNone /><a:defRPr sz="1000" /></a:lvl3pPr><a:lvl4pPr marL="1371600" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0">'+'<a:buNone /><a:defRPr sz="900" /></a:lvl5pPr><a:lvl6pPr marL="2286000" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl6pPr><a:lvl7pPr marL="2743200" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Date Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr />'+'<p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Footer Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="7" name="Slide Number Placeholder 6" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr />'+'<p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>';a.writeRaw(t)}if(9==t){a.writeAttributeString("type","picTx"),a.writeAttributeString("preserve","1");let t='<p:cSld name="Picture with Caption"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="1792288" y="4800600" /><a:ext cx="5486400" cy="566738" /></a:xfrm></p:spPr><p:txBody><a:bodyPr anchor="b" /><a:lstStyle><a:lvl1pPr algn="l"><a:defRPr sz="2000" b="1" /></a:lvl1pPr></a:lstStyle><a:p><a:r><a:rPr lang="en-US" smtClean="0" />'+'<a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Picture Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="pic" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="1792288" y="612775" /><a:ext cx="5486400" cy="4114800" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr marL="0" indent="0"><a:buNone /><a:defRPr sz="3200" /></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0"><a:buNone /><a:defRPr sz="2800" /></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0"><a:buNone /><a:defRPr sz="2400" /></a:lvl3pPr>'+'<a:lvl4pPr marL="1371600" indent="0"><a:buNone /><a:defRPr sz="2000" /></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0"><a:buNone /><a:defRPr sz="2000" /></a:lvl5pPr><a:lvl6pPr marL="2286000" indent="0"><a:buNone /><a:defRPr sz="2000" /></a:lvl6pPr><a:lvl7pPr marL="2743200" indent="0"><a:buNone /><a:defRPr sz="2000" /></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0"><a:buNone /><a:defRPr sz="2000" /></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0"><a:buNone /><a:defRPr sz="2000" /></a:lvl9pPr></a:lstStyle><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Text Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr>'+'<p:nvPr><p:ph type="body" sz="half" idx="2" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="1792288" y="5367338" /><a:ext cx="5486400" cy="804862" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr marL="0" indent="0"><a:buNone /><a:defRPr sz="1400" /></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0"><a:buNone /><a:defRPr sz="1200" /></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0"><a:buNone /><a:defRPr sz="1000" /></a:lvl3pPr><a:lvl4pPr marL="1371600" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl5pPr><a:lvl6pPr marL="2286000" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl6pPr>'+'<a:lvl7pPr marL="2743200" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Date Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut">'+'<a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Footer Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="7" name="Slide Number Placeholder 6" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle />'+'<a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>';a.writeRaw(t)}if(10==t){a.writeAttributeString("type","vertTx"),a.writeAttributeString("preserve","1");let t='<p:cSld name="Title and Vertical Text"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr>'+'<p:cNvPr id="3" name="Vertical Text Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" orient="vert" idx="1" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr vert="eaVert" /><a:lstStyle /><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" />'+'<a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Date Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Footer Placeholder 4" /><p:cNvSpPr>'+'<a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Slide Number Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>';a.writeRaw(t)}if(11==t){a.writeAttributeString("type","vertTitleAndTx"),a.writeAttributeString("preserve","1");let t='<p:cSld name="Vertical Title and Text"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Vertical Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" orient="vert" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="6629400" y="274638" /><a:ext cx="2057400" cy="5851525" /></a:xfrm></p:spPr><p:txBody><a:bodyPr vert="eaVert" /><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" />'+'<a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Vertical Text Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" orient="vert" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="274638" /><a:ext cx="6019800" cy="5851525" /></a:xfrm></p:spPr><p:txBody><a:bodyPr vert="eaVert" /><a:lstStyle /><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p>'+'<a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Date Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" />'+'<a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Footer Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Slide Number Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle />'+'<a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>';a.writeRaw(t)}return a.writeStartElement("p:clrMapOvr"),a.writeStartElement("a:masterClrMapping"),a.writeEndElement(),a.writeFullEndElement(),a.writeFullEndElement(),a.writeEndDocument(),a.flush(),e}writePresentationRels(e){let t=new K,i=new w(u.UTF8,t);i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?d.None:d.Indented,i.writeStartDocument(),i.writeStartElement("Relationships"),i.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),i.writeStartElement("Relationship"),i.writeAttributeString("Id","rId1"),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/tableStyles"),i.writeAttributeString("Target","tableStyles.xml"),i.writeEndElement(),i.writeStartElement("Relationship"),i.writeAttributeString("Id","rId2"),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/viewProps"),i.writeAttributeString("Target","viewProps.xml"),i.writeEndElement(),i.writeStartElement("Relationship"),i.writeAttributeString("Id","rId3"),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/presProps"),i.writeAttributeString("Target","presProps.xml"),i.writeEndElement(),i.writeStartElement("Relationship"),i.writeAttributeString("Id","rId4"),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme"),i.writeAttributeString("Target","theme/theme1.xml"),i.writeEndElement(),i.writeStartElement("Relationship"),i.writeAttributeString("Id","rId5"),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster"),i.writeAttributeString("Target","slideMasters/slideMaster1.xml"),i.writeEndElement();for(let t=0;t<e.count;t++)i.writeStartElement("Relationship"),i.writeAttributeString("Id",`rId`+(6+t)),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slide"),i.writeAttributeString("Target",`slides/slide${t+1}.xml`),i.writeEndElement();return i.writeFullEndElement(),i.writeEndDocument(),i.flush(),t}writePresentation(e){let t=new K,i=new w(u.UTF8,t);i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?d.None:d.Indented,i.writeStartDocument(),i.writeStartElement("p:presentation"),i.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),i.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),i.writeAttributeString("xmlns:p","http://schemas.openxmlformats.org/presentationml/2006/main"),i.writeAttributeString("saveSubsetFonts","1"),i.writeStartElement("p:sldMasterIdLst"),i.writeStartElement("p:sldMasterId"),i.writeAttributeString("id","2147483648"),i.writeAttributeString("r:id","rId5"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("p:sldIdLst");for(let t=0;t<e.count;t++)i.writeStartElement("p:sldId"),i.writeAttributeString("id",(256+t).toString()),i.writeAttributeString("r:id",`rId`+(6+t)),i.writeEndElement();i.writeEndElement();let r=e.getByIndex(0);return i.writeStartElement("p:sldSz"),i.writeAttributeString("cx",this.convertToEmu(r.unit.convertToHInches(r.width+r.margins.left+r.margins.right)).toString()),i.writeAttributeString("cy",this.convertToEmu(r.unit.convertToHInches(r.height+r.margins.top+r.margins.bottom)).toString()),i.writeEndElement(),i.writeStartElement("p:notesSz"),i.writeAttributeString("cx","6858000"),i.writeAttributeString("cy","9144000"),i.writeEndElement(),i.writeStartElement("p:defaultTextStyle"),i.writeStartElement("a:defPPr"),i.writeStartElement("a:defRPr"),i.writeAttributeString("lang","ru-RU"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("a:lvl1pPr"),i.writeAttributeString("marL","0"),i.writeAttributeString("algn","l"),i.writeAttributeString("defTabSz","914400"),i.writeAttributeString("rtl","0"),i.writeAttributeString("eaLnBrk","1"),i.writeAttributeString("latinLnBrk","0"),i.writeAttributeString("hangingPunct","1"),i.writeStartElement("a:defRPr"),i.writeAttributeString("sz","1800"),i.writeAttributeString("kern","1200"),i.writeStartElement("a:solidFill"),i.writeStartElement("a:schemeClr"),i.writeAttributeString("val","tx1"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("a:latin"),i.writeAttributeString("typeface","+mn-lt"),i.writeEndElement(),i.writeStartElement("a:ea"),i.writeAttributeString("typeface","+mn-ea"),i.writeEndElement(),i.writeStartElement("a:cs"),i.writeAttributeString("typeface","+mn-cs"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeStartElement("a:lvl2pPr"),i.writeAttributeString("marL","457200"),i.writeAttributeString("algn","l"),i.writeAttributeString("defTabSz","914400"),i.writeAttributeString("rtl","0"),i.writeAttributeString("eaLnBrk","1"),i.writeAttributeString("latinLnBrk","0"),i.writeAttributeString("hangingPunct","1"),i.writeStartElement("a:defRPr"),i.writeAttributeString("sz","1800"),i.writeAttributeString("kern","1200"),i.writeStartElement("a:solidFill"),i.writeStartElement("a:schemeClr"),i.writeAttributeString("val","tx1"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("a:latin"),i.writeAttributeString("typeface","+mn-lt"),i.writeEndElement(),i.writeStartElement("a:ea"),i.writeAttributeString("typeface","+mn-ea"),i.writeEndElement(),i.writeStartElement("a:cs"),i.writeAttributeString("typeface","+mn-cs"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeStartElement("a:lvl3pPr"),i.writeAttributeString("marL","914400"),i.writeAttributeString("algn","l"),i.writeAttributeString("defTabSz","914400"),i.writeAttributeString("rtl","0"),i.writeAttributeString("eaLnBrk","1"),i.writeAttributeString("latinLnBrk","0"),i.writeAttributeString("hangingPunct","1"),i.writeStartElement("a:defRPr"),i.writeAttributeString("sz","1800"),i.writeAttributeString("kern","1200"),i.writeStartElement("a:solidFill"),i.writeStartElement("a:schemeClr"),i.writeAttributeString("val","tx1"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("a:latin"),i.writeAttributeString("typeface","+mn-lt"),i.writeEndElement(),i.writeStartElement("a:ea"),i.writeAttributeString("typeface","+mn-ea"),i.writeEndElement(),i.writeStartElement("a:cs"),i.writeAttributeString("typeface","+mn-cs"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeStartElement("a:lvl4pPr"),i.writeAttributeString("marL","1371600"),i.writeAttributeString("algn","l"),i.writeAttributeString("defTabSz","914400"),i.writeAttributeString("rtl","0"),i.writeAttributeString("eaLnBrk","1"),i.writeAttributeString("latinLnBrk","0"),i.writeAttributeString("hangingPunct","1"),i.writeStartElement("a:defRPr"),i.writeAttributeString("sz","1800"),i.writeAttributeString("kern","1200"),i.writeStartElement("a:solidFill"),i.writeStartElement("a:schemeClr"),i.writeAttributeString("val","tx1"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("a:latin"),i.writeAttributeString("typeface","+mn-lt"),i.writeEndElement(),i.writeStartElement("a:ea"),i.writeAttributeString("typeface","+mn-ea"),i.writeEndElement(),i.writeStartElement("a:cs"),i.writeAttributeString("typeface","+mn-cs"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeStartElement("a:lvl5pPr"),i.writeAttributeString("marL","1828800"),i.writeAttributeString("algn","l"),i.writeAttributeString("defTabSz","914400"),i.writeAttributeString("rtl","0"),i.writeAttributeString("eaLnBrk","1"),i.writeAttributeString("latinLnBrk","0"),i.writeAttributeString("hangingPunct","1"),i.writeStartElement("a:defRPr"),i.writeAttributeString("sz","1800"),i.writeAttributeString("kern","1200"),i.writeStartElement("a:solidFill"),i.writeStartElement("a:schemeClr"),i.writeAttributeString("val","tx1"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("a:latin"),i.writeAttributeString("typeface","+mn-lt"),i.writeEndElement(),i.writeStartElement("a:ea"),i.writeAttributeString("typeface","+mn-ea"),i.writeEndElement(),i.writeStartElement("a:cs"),i.writeAttributeString("typeface","+mn-cs"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeStartElement("a:lvl6pPr"),i.writeAttributeString("marL","2286000"),i.writeAttributeString("algn","l"),i.writeAttributeString("defTabSz","914400"),i.writeAttributeString("rtl","0"),i.writeAttributeString("eaLnBrk","1"),i.writeAttributeString("latinLnBrk","0"),i.writeAttributeString("hangingPunct","1"),i.writeStartElement("a:defRPr"),i.writeAttributeString("sz","1800"),i.writeAttributeString("kern","1200"),i.writeStartElement("a:solidFill"),i.writeStartElement("a:schemeClr"),i.writeAttributeString("val","tx1"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("a:latin"),i.writeAttributeString("typeface","+mn-lt"),i.writeEndElement(),i.writeStartElement("a:ea"),i.writeAttributeString("typeface","+mn-ea"),i.writeEndElement(),i.writeStartElement("a:cs"),i.writeAttributeString("typeface","+mn-cs"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeStartElement("a:lvl7pPr"),i.writeAttributeString("marL","2743200"),i.writeAttributeString("algn","l"),i.writeAttributeString("defTabSz","914400"),i.writeAttributeString("rtl","0"),i.writeAttributeString("eaLnBrk","1"),i.writeAttributeString("latinLnBrk","0"),i.writeAttributeString("hangingPunct","1"),i.writeStartElement("a:defRPr"),i.writeAttributeString("sz","1800"),i.writeAttributeString("kern","1200"),i.writeStartElement("a:solidFill"),i.writeStartElement("a:schemeClr"),i.writeAttributeString("val","tx1"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("a:latin"),i.writeAttributeString("typeface","+mn-lt"),i.writeEndElement(),i.writeStartElement("a:ea"),i.writeAttributeString("typeface","+mn-ea"),i.writeEndElement(),i.writeStartElement("a:cs"),i.writeAttributeString("typeface","+mn-cs"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeStartElement("a:lvl8pPr"),i.writeAttributeString("marL","3200400"),i.writeAttributeString("algn","l"),i.writeAttributeString("defTabSz","914400"),i.writeAttributeString("rtl","0"),i.writeAttributeString("eaLnBrk","1"),i.writeAttributeString("latinLnBrk","0"),i.writeAttributeString("hangingPunct","1"),i.writeStartElement("a:defRPr"),i.writeAttributeString("sz","1800"),i.writeAttributeString("kern","1200"),i.writeStartElement("a:solidFill"),i.writeStartElement("a:schemeClr"),i.writeAttributeString("val","tx1"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("a:latin"),i.writeAttributeString("typeface","+mn-lt"),i.writeEndElement(),i.writeStartElement("a:ea"),i.writeAttributeString("typeface","+mn-ea"),i.writeEndElement(),i.writeStartElement("a:cs"),i.writeAttributeString("typeface","+mn-cs"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeStartElement("a:lvl9pPr"),i.writeAttributeString("marL","3657600"),i.writeAttributeString("algn","l"),i.writeAttributeString("defTabSz","914400"),i.writeAttributeString("rtl","0"),i.writeAttributeString("eaLnBrk","1"),i.writeAttributeString("latinLnBrk","0"),i.writeAttributeString("hangingPunct","1"),i.writeStartElement("a:defRPr"),i.writeAttributeString("sz","1800"),i.writeAttributeString("kern","1200"),i.writeStartElement("a:solidFill"),i.writeStartElement("a:schemeClr"),i.writeAttributeString("val","tx1"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("a:latin"),i.writeAttributeString("typeface","+mn-lt"),i.writeEndElement(),i.writeStartElement("a:ea"),i.writeAttributeString("typeface","+mn-ea"),i.writeEndElement(),i.writeStartElement("a:cs"),i.writeAttributeString("typeface","+mn-cs"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeEndElement(),i.writeFullEndElement(),i.writeEndDocument(),i.flush(),t}writeSlideRels(t){let e=new K,i=new w(u.UTF8,e);if(i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?d.None:d.Indented,i.writeStartDocument(),i.writeStartElement("Relationships"),i.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),i.writeStartElement("Relationship"),i.writeAttributeString("Id","rId1"),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout"),i.writeAttributeString("Target","../slideLayouts/slideLayout7.xml"),i.writeEndElement(),0<this.imageSlide.length)for(let e=0;e<this.imageSlide.length;e++){let t=this.imageSlide[e];i.writeStartElement("Relationship"),i.writeAttributeString("Id",`rId`+(2+e)),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"),i.writeAttributeString("Target",nt.format("../media/image{0:D5}.{1}",t+1,Wt.getImageFormatExtension(this.imageCache.imageFormatStore[t]))),i.writeEndElement()}if(0<this.hyperlinkList.length)for(let e=0;e<this.hyperlinkList.length;e++){i.writeStartElement("Relationship"),i.writeAttributeString("Id",`hId`+(e+1));let t=this.hyperlinkList[e];"string"==typeof t&&(i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"),i.writeAttributeString("Target",t),i.writeAttributeString("TargetMode","External")),"number"==typeof t&&(i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slide"),i.writeAttributeString("Target",`slide${t}.xml`)),i.writeEndElement()}return i.writeFullEndElement(),i.writeEndDocument(),i.flush(),e}writeSlide(t,e){let i=new K,n=new w(u.UTF8,i),a=(n.indentation=this.xmlIndentation<0?0:this.xmlIndentation,n.formatting=this.xmlIndentation<0?d.None:d.Indented,n.writeStartDocument(),n.writeStartElement("p:sld"),n.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),n.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),n.writeAttributeString("xmlns:p","http://schemas.openxmlformats.org/presentationml/2006/main"),n.writeStartElement("p:cSld"),e.getByIndex(t)),r=(e.getPage(a),lt.toColor(a.brush));(r=Z.StiOptions.Export.PowerPoint.ReplaceTransparentPageBackground&&r.equals(rt.transparent)?rt.white:r).equals(rt.white)||(n.writeStartElement("p:bg"),n.writeStartElement("p:bgPr"),n.writeStartElement("a:solidFill"),this.writeColor(n,r),n.writeFullEndElement(),n.writeStartElement("a:effectLst"),n.writeEndElement(),n.writeFullEndElement(),n.writeFullEndElement()),n.writeStartElement("p:spTree"),n.writeStartElement("p:nvGrpSpPr"),n.writeStartElement("p:cNvPr"),n.writeAttributeString("id","1"),n.writeAttributeString("name",""),n.writeEndElement(),n.writeStartElement("p:cNvGrpSpPr"),n.writeEndElement(),n.writeStartElement("p:nvPr"),n.writeEndElement(),n.writeEndElement(),n.writeStartElement("p:grpSpPr"),n.writeStartElement("a:xfrm"),n.writeStartElement("a:off"),n.writeAttributeString("x","0"),n.writeAttributeString("y","0"),n.writeEndElement(),n.writeStartElement("a:ext"),n.writeAttributeString("cx","0"),n.writeAttributeString("cy","0"),n.writeEndElement(),n.writeStartElement("a:chOff"),n.writeAttributeString("x","0"),n.writeAttributeString("y","0"),n.writeEndElement(),n.writeStartElement("a:chExt"),n.writeAttributeString("cx","0"),n.writeAttributeString("cy","0"),n.writeEndElement(),n.writeEndElement(),n.writeEndElement(),this.idCounter=2,this.writeWatermark(n,a,!0);for(let i of a.components.list)if(i.enabled&&0<i.width&&0<i.height){let e=(i=i.is(gt)?J.c.StiExportUtils.checkBoxToTextBox(i):i)[Z.System.StiObject.stimulsoft]().as(et);if(null==e||e.checkAllowHtmlTags())if(i.is(Ct)){let t=new et(i.clientRectangle);t.page=i.page,t.border=i.border,t.brush=i.brush,t.hyperlinkValue=i.hyperlinkValue,this.writeStiTextbox(n,t)}else i.is(xt)?this.writeRoundRectangle(n,i):this.writeStiImage(n,i,i);else{let t=e.angle%360;if(0==(t=t<0?360+t:t)||90==t||270==t)this.writeStiTextbox(n,i);else{let t=e.clone(!0);t.text=null,t.angle=0,this.writeStiTextbox(n,t),(t=e.clone(!0)).border=null,t.brush=null,t.horAlignment=at.Center,t.vertAlignment=st.Center,this.writeStiTextbox(n,t)}}this.idCounter++}if(null!=a.border&&this.writeBorder(n,a),this.writeWatermark(n,a,!1),!(Z.Base.vAeXc.eMAio.UUyjq()||Z.Base.vAeXc.eMAio.lAtWS()||(Z.Base.vAeXc.eMAio.rdCzm()||Z.Base.vAeXc.eMAio.CWsHL()||Z.Base.vAeXc.eMAio.tnNVR())&&Z.System.NodeJs.isStandaloneVersion)){let t=a.unit.convertToHInches(a.pageWidth-a.margins.left-a.margins.right),e=a.unit.convertToHInches(a.pageHeight-a.margins.top-a.margins.bottom),i=a.unit.convertToHInches(a.margins.left),r=a.unit.convertToHInches(a.margins.top);n.writeRaw('<p:sp><p:nvSpPr><p:cNvPr id="67" name="TextBox Additional"/><p:cNvSpPr txBox="1"/><p:nvPr userDrawn="1"/></p:nvSpPr>'+'<p:spPr><a:xfrm rot="-2700000"><a:off x="'+this.convertToEmu(i)+'" y="'+this.convertToEmu(r+.45*e)+'"/><a:ext cx="'+this.convertToEmu(t)+'" cy="'+this.convertToEmu(.1*e)+'"/></a:xfrm>'+'<a:prstGeom prst="rect"><a:avLst/></a:prstGeom><a:noFill/></p:spPr>'+'<p:txBody><a:bodyPr wrap="square" rtlCol="0" anchor="ctr" anchorCtr="0"><a:spAutoFit/></a:bodyPr><a:lstStyle/><a:p><a:pPr algn="ctr"/><a:r><a:rPr lang="en-US" sz="9600" b="1" dirty="0" smtClean="0">'+'<a:solidFill><a:schemeClr val="tx1"><a:alpha val="12000"/></a:schemeClr></a:solidFill>'+'<a:latin typeface="Arial" panose="020B0604020202020204" pitchFamily="34" charset="0"/><a:cs typeface="Arial" panose="020B0604020202020204" pitchFamily="34" charset="0"/>'+"</a:rPr><a:t>Trial</a:t></a:r></a:p></p:txBody></p:sp>")}return n.writeFullEndElement(),n.writeEndElement(),n.writeStartElement("p:clrMapOvr"),n.writeStartElement("a:masterClrMapping"),n.writeEndElement(),n.writeFullEndElement(),n.writeFullEndElement(),n.writeEndDocument(),n.flush(),i}writeStiTextbox(t,e){let i=e,r=(t.writeStartElement("p:sp"),t.writeStartElement("p:nvSpPr"),t.writeStartElement("p:cNvPr"),t.writeAttributeString("id",this.idCounter.toString()),t.writeAttributeString("name",`TextBox `+this.idCounter),this.writeHyperlinkInfo(t,e),t.writeEndElement(),t.writeStartElement("p:cNvSpPr"),t.writeAttributeString("txBox","1"),t.writeEndElement(),t.writeStartElement("p:nvPr"),t.writeEndElement(),t.writeEndElement(),this.writeSpPr(t,e)),n=(t.writeStartElement("p:txBody"),t.writeStartElement("a:bodyPr"),!1),a="";if(null!=i.textOptions){n=i.textOptions.wordWrap;let t=i.textOptions.angle%360;90==(t=t<0?360+t:t)&&(a="vert270"),270==t&&(a="vert")}0<a.length&&t.writeAttributeString("vert",a),t.writeAttributeString("horzOverflow","clip"),t.writeAttributeString("vertOverflow","clip");let s=this.convertToEmu(i.margins.left),o=this.convertToEmu(i.margins.right),l=this.convertToEmu(i.margins.top),h=this.convertToEmu(i.margins.bottom),c=(t.writeAttributeString("lIns",s.toString()),t.writeAttributeString("tIns",l.toString()),t.writeAttributeString("rIns",o.toString()),t.writeAttributeString("bIns",h.toString()),t.writeAttributeString("wrap",n?"square":"none"),t.writeAttributeString("rtlCol","0"),"t"),m=(i.vertAlignment==st.Center&&(c="ctr"),i.vertAlignment==st.Bottom&&(c="b"),t.writeAttributeString("anchor",c),t.writeAttributeString("anchorCtr","0"),t.writeStartElement("a:noAutofit"),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("a:lstStyle"),t.writeEndElement(),t.writeStartElement("a:p"),!1),g=(null!=i.textOptions&&(m=i.textOptions.rightToLeft),t.writeStartElement("a:pPr"),""),p=(i.horAlignment==at.Center&&(g="ctr"),(i.horAlignment==at.Right&&!m||i.horAlignment==at.Left&&m)&&(g="r"),0<(g=i.horAlignment==at.Width?"just":g).length&&t.writeAttributeString("algn",g),m&&t.writeAttributeString("rtl","1"),t.writeStartElement("a:lnSpc"),t.writeStartElement("a:spcPct"),t.writeAttributeString("val",Math.round(.94*i.lineSpacing*1e5).toString()),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("a:r"),t.writeStartElement("a:rPr"),t.writeAttributeString("lang","en-US"),t.writeAttributeString("sz",(100*i.font.sizeInPoints*.984|0).toString()),i.font.bold&&t.writeAttributeString("b","1"),i.font.italic&&t.writeAttributeString("i","1"),i.font.underline&&t.writeAttributeString("u","sng"),i.font.strikeout&&t.writeAttributeString("strike","sngStrike"),t.writeAttributeString("dirty","0"),t.writeAttributeString("smtClean","0"),t.writeStartElement("a:solidFill"),this.writeColor(t,lt.toColor(i.textBrush)),t.writeFullEndElement(),"");null!=i.text&&(p=i.text.toString()),i.textQuality!=Et.Wysiwyg&&i.horAlignment!=at.Width||nt.isNullOrEmpty(p)||!p.endsWith(G.StiForceWidthAlignTag)||(p=p.substr(0,p.length-G.StiForceWidthAlignTag.length)),t.writeStartElement("a:latin"),t.writeAttributeString("typeface",i.font.name),t.writeAttributeString("pitchFamily","18"),t.writeAttributeString("charset","0"),t.writeEndElement(),t.writeStartElement("a:cs"),t.writeAttributeString("typeface",i.font.name),t.writeAttributeString("pitchFamily","18"),t.writeAttributeString("charset","0"),t.writeEndElement(),t.writeEndElement(),t.writeElementString("a:t",p),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),r&&this.writeBorder(t,e)}writeStiImage(t,i,e){if(this.imageResolutionMode!=J.c.StiImageResolutionMode.Exactly&&i.is(Q))return void this.writeStiImageAuto(t,i,e);let r=!1,n=this.exportCache.getImageIndex(e);if(null==n){let t=i[Z.System.StiObject.stimulsoft]().as(pt);if(null!=t){let t=J.d.StiOfficeImageFormatHelper.getImageAndTag(i,J.a.StiExportFormat.PowerPoint,this.imageResolution,this.imageFormat,this.currentCulture,this.newCulture),e=Wt.correctImageFormat(this.imageFormat,t.imageFormat);n=this.imageCache.addImageInt(t,e)}}null!=n&&(this.imageSlide.push(n),t.writeStartElement("p:pic"),t.writeStartElement("p:nvPicPr"),t.writeStartElement("p:cNvPr"),t.writeAttributeString("id",this.idCounter.toString()),t.writeAttributeString("name",`Picture `+(this.idCounter+1)),t.writeAttributeString("descr",`Picture ${this.idCounter+1} description`),this.writeHyperlinkInfo(t,i),t.writeEndElement(),t.writeStartElement("p:cNvPicPr"),t.writeStartElement("a:picLocks"),t.writeAttributeString("noChangeAspect","1"),t.writeEndElement(),t.writeFullEndElement(),t.writeStartElement("p:nvPr"),t.writeEndElement(),t.writeFullEndElement(),t.writeStartElement("p:blipFill"),t.writeStartElement("a:blip"),t.writeAttributeString("r:embed",`rId`+(1+this.imageSlide.length)),t.writeEndElement(),t.writeStartElement("a:stretch"),t.writeStartElement("a:fillRect"),t.writeEndElement(),t.writeFullEndElement(),t.writeFullEndElement(),r=this.writeSpPr(t,i),t.writeFullEndElement()),(r||i.is(E))&&this.writeBorder(t,i)}writeStiImageAuto(f,b,t){let E,v=b.as(Q);if(null==v)return;let y=!1,x=this.exportCache.getImageIndex(t);if(null==x){let t={ref:this.imageResolution},e=v.getImage(t);if(null!=e){let t=Wt.correctImageFormat(this.imageFormat,e.imageFormat);x=this.imageCache.addImageInt(e,t)}}if(null!=x){this.imageSlide.push(x);let i=v.multipleFactor,t=v.stretch,r=v.horAlignment,n=v.vertAlignment,a=(null!=v.icon&&(r=M.Center,n=st.Center,t=!0),(null==(E=v.imageToDraw)?void 0:E.imageFormat)==Z.System.Drawing.Imaging.ImageFormat.Svg&&(i=1/this.imageResolution),this.imageCache.imageSizeStore[x].width),s=this.imageCache.imageSizeStore[x].height,o=b.report.unit.convertToHInches(b.width),l=b.report.unit.convertToHInches(b.height);if(v.imageRotation==O.Rotate90CCW||v.imageRotation==O.Rotate90CW){let t=o;o=l,l=t}let h=v.margins.left,c=v.margins.right,m=v.margins.top,g=v.margins.bottom;if(v.imageRotation!=O.None){let t=M.Center,e=st.Center;v.imageRotation==O.Rotate90CW&&(r==M.Left&&(e=st.Bottom),r==M.Right&&(e=st.Top),n==st.Top&&(t=M.Left),n==st.Bottom&&(t=M.Right),h=v.margins.top,c=v.margins.bottom,m=v.margins.right,g=v.margins.left),v.imageRotation==O.Rotate90CCW&&(r==M.Left&&(e=st.Top),r==M.Right&&(e=st.Bottom),n==st.Top&&(t=M.Right),n==st.Bottom&&(t=M.Left),h=v.margins.bottom,c=v.margins.top,m=v.margins.left,g=v.margins.right),v.imageRotation==O.Rotate180&&(r==M.Left&&(t=M.Right),r==M.Right&&(t=M.Left),n==st.Top&&(e=st.Bottom),n==st.Bottom&&(e=st.Top),h=v.margins.right,c=v.margins.left,m=v.margins.bottom,g=v.margins.top),v.imageRotation==O.FlipHorizontal&&(r==M.Left&&(t=M.Right),r==M.Right&&(t=M.Left),e=n,h=v.margins.right,c=v.margins.left),v.imageRotation==O.FlipVertical&&(n==st.Top&&(e=st.Bottom),n==st.Bottom&&(e=st.Top),t=r,m=v.margins.bottom,g=v.margins.top),r=t,n=e}let p=o-h-c,d=l-m-g;if(t){if(v.aspectRatio){let t=Math.min(p/a,d/s),e=(p-a*t)/2,i=(d-s*t)/2;r==M.Left&&(c+=2*e),r==M.Right&&(h+=2*e),r==M.Center&&(h+=e,c+=e),n==st.Top&&(g+=2*i),n==st.Bottom&&(m+=2*i),n==st.Center&&(m+=i,g+=i),p-=2*e,d-=2*i}}else{p=a*i,d=s*i;let t=-(p-o)/2,e=-(d-l)/2;r==M.Left&&(c+=2*t),r==M.Right&&(h+=2*t),r==M.Center&&(h+=t,c+=t),n==st.Top&&(g+=2*e),n==st.Bottom&&(m+=2*e),n==st.Center&&(m+=e,g+=e)}let e=-Math.round(h/p*1e5),w=-Math.round(c/p*1e5),u=-Math.round(m/d*1e5),S=-Math.round(g/d*1e5);f.writeStartElement("p:pic"),f.writeStartElement("p:nvPicPr"),f.writeStartElement("p:cNvPr"),f.writeAttributeString("id",nt.format("{0}",this.idCounter)),f.writeAttributeString("name",nt.format("Picture {0}",this.idCounter+1)),f.writeAttributeString("descr",nt.format("Picture {0} description",this.idCounter+1)),this.writeHyperlinkInfo(f,b),f.writeEndElement(),f.writeStartElement("p:cNvPicPr"),f.writeStartElement("a:picLocks"),f.writeAttributeString("noChangeAspect","1"),f.writeEndElement(),f.writeFullEndElement(),f.writeStartElement("p:nvPr"),f.writeEndElement(),f.writeFullEndElement(),f.writeStartElement("p:blipFill"),f.writeStartElement("a:blip"),f.writeAttributeString("r:embed",nt.format("rId{0}",1+this.imageSlide.length)),f.writeEndElement(),0==e&&0==w&&0==u&&0==S||(f.writeStartElement("a:srcRect"),0!=e&&f.writeAttributeString("l",e.toString()),0!=u&&f.writeAttributeString("t",u.toString()),0!=w&&f.writeAttributeString("r",w.toString()),0!=S&&f.writeAttributeString("b",S.toString()),f.writeEndElement()),f.writeStartElement("a:stretch"),f.writeFullEndElement(),f.writeFullEndElement(),y=this.writeSpPr(f,b),f.writeFullEndElement()}y&&this.writeBorder(f,b)}writeSpPr(t,e){let n=this.convertToEmu(e.report.unit.convertToHInches(e.left+e.page.margins.left)),a=this.convertToEmu(e.report.unit.convertToHInches(e.top+e.page.margins.top)),s=this.convertToEmu(e.report.unit.convertToHInches(e.right+e.page.margins.left)),o=this.convertToEmu(e.report.unit.convertToHInches(e.bottom+e.page.margins.top)),i=0,r=e.as(ht),l=(null==r||null==r.textOptions||90!=(i=r.textOptions.angle%360)&&270!=i&&-90!=i&&-270!=i||(i=0),e.as(Q)),h=0<=(i=null!=l&&(l.imageRotation==O.Rotate180&&(i=180),l.imageRotation==O.Rotate90CCW&&(i=90),l.imageRotation==O.Rotate90CW)?-90:i)?i:360+i;if(45<h&&h<135||225<h&&h<315){let t=s-n,e=o-a,i=(s+n)/2-e/2,r=(o+a)/2-t/2;n=i,s=i+e,a=r,o=r+t}t.writeStartElement("p:spPr"),t.writeStartElement("a:xfrm"),0!=i&&t.writeAttributeString("rot",(0|Math.round(6e4*-i)).toString()),null!=l&&(l.imageRotation==O.FlipHorizontal&&t.writeAttributeString("flipH","1"),l.imageRotation==O.FlipVertical)&&t.writeAttributeString("flipV","1"),t.writeStartElement("a:off"),t.writeAttributeString("x",n.toString()),t.writeAttributeString("y",a.toString()),t.writeEndElement(),t.writeStartElement("a:ext"),t.writeAttributeString("cx",(s-n).toString()),t.writeAttributeString("cy",(o-a).toString()),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("a:prstGeom"),t.writeAttributeString("prst","rect"),t.writeStartElement("a:avLst"),t.writeEndElement(),t.writeEndElement();let c=e.is(L),m=rt.transparent,g=(0==(m=e.is(N)?lt.toColor(e.brush):m).a||c?(t.writeStartElement("a:noFill"),t.writeEndElement()):(t.writeStartElement("a:solidFill"),this.writeColor(t,m),t.writeFullEndElement()),!1),p=null;return null!=(p=e.is(z)?e.border:p)&&p.side!=P.None&&p.style!=ot.None&&(p.side!=P.All||p.is(ft)?g=!0:(t.writeStartElement("a:ln"),t.writeAttributeString("w",this.convertToEmu(p.size).toString()),t.writeStartElement("a:solidFill"),this.writeColor(t,p.color),t.writeFullEndElement(),t.writeStartElement("a:prstDash"),t.writeAttributeString("val",this.getLineStyle(p.style)),t.writeEndElement(),t.writeStartElement("a:miter"),t.writeAttributeString("lim","800000"),t.writeEndElement(),t.writeFullEndElement())),t.writeEndElement(),g}writeBorder(e,i){let r=i.as(z).border;if(r.is(ft)){let t=r;t.isLeftBorderSidePresent&&this.writeLine(e,i,new mt(i.left,i.top,0,i.height),t.leftSide.size,t.leftSide.style,t.leftSide.color),t.isRightBorderSidePresent&&this.writeLine(e,i,new mt(i.right,i.top,0,i.height),t.rightSide.size,t.rightSide.style,t.rightSide.color),t.isTopBorderSidePresent&&this.writeLine(e,i,new mt(i.left,i.top,i.width,0),t.topSide.size,t.topSide.style,t.topSide.color),t.isBottomBorderSidePresent&&this.writeLine(e,i,new mt(i.left,i.bottom,i.width,0),t.bottomSide.size,t.bottomSide.style,t.bottomSide.color)}else r.isLeftBorderSidePresent&&this.writeLine(e,i,new mt(i.left,i.top,0,i.height),r.size,r.style,r.color),r.isRightBorderSidePresent&&this.writeLine(e,i,new mt(i.right,i.top,0,i.height),r.size,r.style,r.color),r.isTopBorderSidePresent&&this.writeLine(e,i,new mt(i.left,i.top,i.width,0),r.size,r.style,r.color),r.isBottomBorderSidePresent&&this.writeLine(e,i,new mt(i.left,i.bottom,i.width,0),r.size,r.style,r.color)}writeLine(r,t,e,i,n,a){if(n==ot.None||0==a.a)return;r.writeStartElement("p:cxnSp"),r.writeStartElement("p:nvCxnSpPr"),r.writeStartElement("p:cNvPr"),r.writeAttributeString("id",this.idCounter.toString()),r.writeAttributeString("name",`Line `+this.idCounter),r.writeEndElement(),r.writeStartElement("p:cNvCxnSpPr"),r.writeEndElement(),r.writeStartElement("p:nvPr"),r.writeEndElement(),r.writeEndElement();let s=this.convertToEmu(t.report.unit.convertToHInches(e.left+t.page.margins.left)),o=this.convertToEmu(t.report.unit.convertToHInches(e.top+t.page.margins.top)),l=this.convertToEmu(t.report.unit.convertToHInches(e.right+t.page.margins.left)),h=this.convertToEmu(t.report.unit.convertToHInches(e.bottom+t.page.margins.top)),c=(r.writeStartElement("p:spPr"),r.writeStartElement("a:xfrm"),r.writeStartElement("a:off"),r.writeAttributeString("x",s.toString()),r.writeAttributeString("y",o.toString()),r.writeEndElement(),r.writeStartElement("a:ext"),r.writeAttributeString("cx",(l-s).toString()),r.writeAttributeString("cy",(h-o).toString()),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("a:prstGeom"),r.writeAttributeString("prst","line"),r.writeStartElement("a:avLst"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("a:ln"),r.writeAttributeString("w",this.convertToEmu(i).toString()),r.writeStartElement("a:solidFill"),this.writeColor(r,a),r.writeFullEndElement(),r.writeStartElement("a:prstDash"),r.writeAttributeString("val",this.getLineStyle(n)),r.writeEndElement(),t.as(E));if(null!=c){let e=null,i=null;if(c.is(qt)&&(e=c.startCap,i=c.endCap),c.is(Yt)&&(e=c.startCap,i=c.endCap),null!=e){let t=this.capStyleToPptStyle(e.style);nt.isNullOrEmpty(t)||(r.writeStartElement("a:headEnd"),r.writeAttributeString("type",t),r.writeEndElement())}if(null!=i){let t=this.capStyleToPptStyle(i.style);nt.isNullOrEmpty(t)||(r.writeStartElement("a:tailEnd"),r.writeAttributeString("type",t),r.writeEndElement())}}r.writeFullEndElement(),r.writeEndElement(),r.writeEndElement()}writeRoundRectangle(n,a){let t=a.as(xt);if(null==t)return;if(t.style==ot.None||t.color.equals(rt.transparent))return;let s=a.as(jt),o=a.clientRectangle,e=(n.writeStartElement("p:sp"),n.writeStartElement("p:nvSpPr"),n.writeStartElement("p:cNvPr"),n.writeAttributeString("id",nt.format("{0}",this.idCounter)),n.writeAttributeString("name",nt.format("{0}Rectangle {1}",null!=s?"Round":"",this.idCounter)),n.writeEndElement(),n.writeStartElement("p:cNvSpPr"),n.writeEndElement(),n.writeStartElement("p:nvPr"),n.writeEndElement(),n.writeEndElement(),this.convertToEmu(a.report.unit.convertToHInches(o.left+a.page.margins.left))),i=this.convertToEmu(a.report.unit.convertToHInches(o.top+a.page.margins.top)),r=this.convertToEmu(a.report.unit.convertToHInches(o.right+a.page.margins.left)),l=this.convertToEmu(a.report.unit.convertToHInches(o.bottom+a.page.margins.top));if(n.writeStartElement("p:spPr"),n.writeStartElement("a:xfrm"),n.writeStartElement("a:off"),n.writeAttributeString("x",nt.format("{0}",e)),n.writeAttributeString("y",nt.format("{0}",i)),n.writeEndElement(),n.writeStartElement("a:ext"),n.writeAttributeString("cx",nt.format("{0}",r-e)),n.writeAttributeString("cy",nt.format("{0}",l-i)),n.writeEndElement(),n.writeEndElement(),n.writeStartElement("a:prstGeom"),n.writeAttributeString("prst",null!=s?"roundRect":"rect"),n.writeStartElement("a:avLst"),null!=s){let t=a.report.unit.convertToHInches(o.width),e=a.report.unit.convertToHInches(o.height),i=Math.max(e<t?e:t,1),r=Math.min(1,100/i);n.writeStartElement("a:gd"),n.writeAttributeString("name","adj"),n.writeAttributeString("fmla",nt.format("val {0}",0|Math.round(s.round*r*1e5))),n.writeEndElement()}n.writeEndElement(),n.writeEndElement(),n.writeStartElement("a:noFill"),n.writeEndElement(),n.writeStartElement("a:ln"),n.writeAttributeString("w",nt.format("{0}",this.convertToEmu(t.size))),t.style==ot.Double&&n.writeAttributeString("cmpd","dbl"),n.writeStartElement("a:solidFill"),this.writeColor(n,t.color),n.writeFullEndElement(),n.writeStartElement("a:prstDash"),n.writeAttributeString("val",this.getLineStyle(t.style)),n.writeEndElement(),n.writeFullEndElement(),n.writeEndElement(),n.writeEndElement()}capStyleToPptStyle(t){switch(t){case Vt.Arrow:return"triangle";case Vt.Diamond:return"diamond";case Vt.Square:return"diamond";case Vt.Open:return"arrow";case Vt.Oval:return"oval";case Vt.Stealth:return"stealth"}return null}writeWatermark(e,i,t){if(null!=i.watermark&&(null!=i.watermark.image||!nt.isNullOrWhiteSpace(i.watermark.imageHyperlink))&&i.watermark.showImageBehind==t){let t=new Q;switch(t.page=i,t.image=i.watermark.image,t.left=-i.margins.left,t.top=-i.margins.top,t.width=i.pageWidth,t.height=i.pageHeight,t.stretch=i.watermark.imageStretch,t.aspectRatio=i.watermark.aspectRatio,t.multipleFactor=i.watermark.imageMultipleFactor,t.horAlignment=M.Left,t.vertAlignment=st.Bottom,i.watermark.imageAlignment){case b.TopCenter:case b.MiddleCenter:case b.BottomCenter:t.horAlignment=M.Center;break;case b.TopRight:case b.MiddleRight:case b.BottomRight:t.horAlignment=M.Right;break}switch(i.watermark.imageAlignment){case b.TopLeft:case b.TopCenter:case b.TopRight:t.vertAlignment=st.Top;break;case b.MiddleLeft:case b.MiddleCenter:case b.MiddleRight:t.vertAlignment=st.Center;break}this.writeStiImage(e,t,i)}}writeHyperlinkInfo(r,t){if(null!=t.hyperlinkValue){let e=t.hyperlinkValue.toString().trim(),i;if(0<e.length&&!e.startsWith("javascript:")&&!e.startsWith("#")){let t=this.stringToUrl(e);-1==(i=this.hyperlinkList.indexOf(t))&&(this.hyperlinkList.push(t),i=this.hyperlinkList.length),r.writeStartElement("a:hlinkClick"),r.writeAttributeString("r:id",`hId`+i),r.writeEndElement()}}}writeImage(t){let e=new K,i=this.imageCache.imagePackedStore[t];return null==i&&(i=[]),e.write(i,0,i.length),e}exportPowerPoint(e,n,t){null==Z.Base[["St","iL","ic","en","se"].join("")].key&&console.warn("You are using a trial version of the Stimulsoft product!"),J.a.StiLogService.write(this[Z.System.StiObject.stimulsoft]().getType(),"Export report to PowerPoint 2007 format"),this.report=e;let a=t.pageRange,s=(this.imageResolution=t.imageResolution,this.imageQuality=t.imageQuality,t.encryptionPassword);this.imageFormat=t.imageFormat,this.xmlIndentation=-1,this.imageResolution<10&&(this.imageResolution=10),this.imageResolution=this.imageResolution/100,null!=this.imageFormat&&this.imageFormat!=J.a.ImageFormat.Jpeg&&(this.imageFormat=J.a.ImageFormat.Png),this.currentCulture=q.currentCulture,this.newCulture=q.cultures["en-US"];try{q.currentCulture=this.newCulture;let i=a.getSelectedPages(e.renderedPages);if(this.isStopped)return;null!=this.exportCache?this.imageCache=this.exportCache.imageCache:this.imageCache=new J.a.StiImageCache(Z.StiOptions.Export.PowerPoint.AllowImageComparer,!0,this.imageFormat,this.imageQuality);let r=new p,t=null;nt.isNullOrWhiteSpace(s)?r.begin(n,!0):(t=new K,r.begin(t,!0)),r.addFile("[Content_Types].xml",this.writeContentTypes(i.count)),r.addFile("_rels/.rels",this.writeMainRels()),r.addFile("docProps/app.xml",this.writeDocPropsApp(i.count)),r.addFile("docProps/core.xml",this.writeDocPropsCore()),r.addFile("ppt/tableStyles.xml",this.writeTableStyles()),r.addFile("ppt/presProps.xml",this.writePresProps()),r.addFile("ppt/viewProps.xml",this.writeViewProps()),r.addFile("ppt/theme/theme1.xml",this.writeTheme()),r.addFile("ppt/slideMasters/slideMaster1.xml",this.writeSlideMaster()),r.addFile("ppt/slideMasters/_rels/slideMaster1.xml.rels",this.writeSlideMasterRels());for(let t=0;t<11;t++)r.addFile(`ppt/slideLayouts/slideLayout${t+1}.xml`,this.writeSlideLayout(t+1,i.getByIndex(0))),r.addFile(`ppt/slideLayouts/_rels/slideLayout${t+1}.xml.rels`,this.writeSlideLayoutRels());r.addFile("ppt/presentation.xml",this.writePresentation(i)),r.addFile("ppt/_rels/presentation.xml.rels",this.writePresentationRels(i)),this.hyperlinkList=[];for(let e=0;e<i.count;e++){if(this.invokeExporting2(e,i.count,0,1),this.isStopped)return;let t=i.getByIndex(e);i.getPage(t),this.imageSlide=[],r.addFile(`ppt/slides/slide${e+1}.xml`,this.writeSlide(e,i)),r.addFile(`ppt/slides/_rels/slide${e+1}.xml.rels`,this.writeSlideRels(e)),this.hyperlinkList[Z.System.StiObject.stimulsoft]().clear()}if(0<this.imageCache.imagePackedStore.length)for(let t=0;t<this.imageCache.imagePackedStore.length;t++)r.addFile(nt.format("ppt/media/image{0:D5}.{1}",t+1,Wt.getImageFormatExtension(this.imageCache.imageFormatStore[t])),this.writeImage(t));r.end(),nt.isNullOrWhiteSpace(s)||(t.flush(),Ht.EncryptPackage(t.toArray(),s,n),t.close())}finally{q.currentCulture=this.currentCulture,this.imageCache.clear(),this.hyperlinkList=null}}}J.c.StiPowerPointExportService=Br,J.c.StiPpt2007ExportService=class extends Br{}}let _t=J.a.Components.StiImageHelper,Kt=Z.System.Drawing.Graphics;{class Dr{}class H extends J.c.StiExportService{constructor(){super(...arguments),this.multipleFiles=!1,this.matrix=null,this.removeEmptySpaceAtBottom=Z.StiOptions.Export.Word.removeEmptySpaceAtBottom,this.fontList=null,this.styleList=null,this.imageCache=null,this.bookmarkList=null,this.hyperlinkList=null,this.embedsList=null,this.xmlIndentation=1,this.imageQuality=.75,this.imageResolution=96,this.imageFormat=J.a.ImageFormat.Jpeg,this.imageResolutionMode=J.c.StiImageResolutionMode.Auto,this.lineSpace=null,this.lineSpace2=null,this.usePageHeadersAndFooters=!1,this.restrictEditing=J.c.StiWordRestrictEditing.No,this.protectionPassword=null,this.headersData=null,this.headersRels=null,this.footersData=null,this.footersRels=null,this.shiftHeader=!1,this.shiftFooter=!1,this.hasHeader=!1,this.hasFooter=!1,this.additionalIndex=0,this.spriteIndex=0,this.needEmptyParagraph=!1,this.bkmRefText=null,this.bkmRefId=-1,this.hypRefText=null,this.hypRefId=-1,this.exportCache=null,this.englishCulture=new q("en-US"),this.docCompanyString=null,this.docLastModifiedString=null,this.wrongUrlSymbols=" \"#'*,;<>[^`{|}",this.initialCodeArray=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],this.encryptionMatrix=[[44796,19929,39858,10053,20106,40212,10761],[31585,63170,64933,60267,50935,40399,11199],[17763,35526,1453,2906,5812,11624,23248],[885,1770,3540,7080,14160,28320,56640],[55369,41139,20807,41614,21821,43642,17621],[28485,56970,44341,19019,38038,14605,29210],[60195,50791,40175,10751,21502,43004,24537],[18387,36774,3949,7898,15796,31592,63184],[47201,24803,49606,37805,14203,28406,56812],[17824,35648,1697,3394,6788,13576,27152],[43601,17539,35078,557,1114,2228,4456],[30388,60776,51953,34243,7079,14158,28316],[14128,28256,56512,43425,17251,34502,7597],[13105,26210,52420,35241,883,1766,3532],[4129,8258,16516,33032,4657,9314,18628]]}implements(){let t=[J.c.IStiWordExportService];return(this.implements=()=>t)()}get exportFormat(){return J.a.StiExportFormat.Word}exportTo(e,t,i){if(null==this.exportCache){let t=i;this.exportCache=new J.c.StiExportImageCache(t.imageFormat,!0,new J.a.StiImageCache(Z.StiOptions.Export.Word.allowImageComparer,!0,t.imageFormat,t.imageQuality,!1),Math.max(t.imageResolution,10)/100,e)}this.exportWord(e,t,i)}exportToAsync(e,i,r,n){setTimeout(async()=>{try{let t=n;this.exportCache=new J.c.StiExportImageCache(t.imageFormat,!0,new J.a.StiImageCache(Z.StiOptions.Export.Word.allowImageComparer,!0,t.imageFormat,t.imageQuality,!1),Math.max(t.imageResolution,10)/100,i),await J.c.StiExportImageHelper.convertAllImages(i,Z.System.Drawing.Imaging.ImageFormat.Jpeg,!1,this.exportFormat,this.exportCache),this.exportTo(i,r,n),null!=i&&null!=i.preparedExportImages&&(i.preparedExportImages.clear(),i.preparedExportImages=null)}catch(t){if(o.log(t,i,`Export Error`).isImportant)return e(o.getMessage(t))}e()},0)}getFilter(){return e.get("FileFilters","WordFiles")}static checkFontsToCorrectHeight(t){return null==this.fontsToCorrectHeight&&(this.fontsToCorrectHeight=new C,this.fontsToCorrectHeight.add("Arial Unicode MS",null),this.fontsToCorrectHeight.add("Cascadia Code ExtraLight",null),this.fontsToCorrectHeight.add("Cascadia Code SemiBold",null),this.fontsToCorrectHeight.add("Cascadia Code SemiLight",null),this.fontsToCorrectHeight.add("Cascadia Mono ExtraLight",null),this.fontsToCorrectHeight.add("Cascadia Mono Light",null),this.fontsToCorrectHeight.add("Cascadia Mono SemiBold",null),this.fontsToCorrectHeight.add("Cascadia Mono SemiLight",null),this.fontsToCorrectHeight.add("Malgun Gothic",null),this.fontsToCorrectHeight.add("Malgun Gothic Semilight",null),this.fontsToCorrectHeight.add("Microsoft JhengHei",null),this.fontsToCorrectHeight.add("Microsoft JhengHei Light",null),this.fontsToCorrectHeight.add("Microsoft JhengHei UI",null),this.fontsToCorrectHeight.add("Microsoft JhengHei UI Light",null),this.fontsToCorrectHeight.add("Microsoft YaHei",null),this.fontsToCorrectHeight.add("Microsoft YaHei Light",.8),this.fontsToCorrectHeight.add("Microsoft YaHei UI",null),this.fontsToCorrectHeight.add("Microsoft YaHei UI Light",null),this.fontsToCorrectHeight.add("MingLiU_HKSCS-ExtB",.92),this.fontsToCorrectHeight.add("MingLiU-ExtB",.92),this.fontsToCorrectHeight.add("MS Gothic",null),this.fontsToCorrectHeight.add("MS PGothic",null),this.fontsToCorrectHeight.add("MS UI Gothic",null),this.fontsToCorrectHeight.add("NSimSun",.88),this.fontsToCorrectHeight.add("PMingLiU",.92),this.fontsToCorrectHeight.add("PMingLiU-ExtB",.92),this.fontsToCorrectHeight.add("Segoe MDL2 Assets",null),this.fontsToCorrectHeight.add("SimSun",.88),this.fontsToCorrectHeight.add("SimSun-ExtB",null),this.fontsToCorrectHeight.add("Sumana",.98),this.fontsToCorrectHeight.add("Yu Gothic",.96),this.fontsToCorrectHeight.add("Yu Gothic Light",.96),this.fontsToCorrectHeight.add("Yu Gothic Medium",.96),this.fontsToCorrectHeight.add("Yu Gothic UI",null),this.fontsToCorrectHeight.add("Yu Gothic UI Light",null),this.fontsToCorrectHeight.add("Yu Gothic UI Semibold",null),this.fontsToCorrectHeight.add("Yu Gothic UI Semilight",null),this.fontsToCorrectHeight.add("微软雅黑",null)),this.fontsToCorrectHeight.containsKey(t)}getLineStyle(t){switch(t){case ot.Solid:return"single";case ot.Dot:return"dotted";case ot.Dash:return"dashSmallGap";case ot.DashDot:return"dotDash";case ot.DashDotDot:return"dotDotDash";case ot.Double:return"double";default:return""}}getColorString(t){if(0==t.a)return"auto";if(t.a<32)return"FFFFFF";return nt.format("{0:X8}",t.toArgb()).substr(2)}getStyleNumber(i,r){if(0<i.length)for(let e=0;e<i.length;e++){let t=i[e];if(t.alignment==r.alignment&&t.name==r.name&&t.fontName==r.fontName&&t.fontSize==r.fontSize&&t.bold==r.bold&&t.italic==r.italic&&t.underline==r.underline&&t.textColor.equals(r.textColor)&&t.rightToLeft==r.rightToLeft)return e}i.push(r);let t=i.length-1;return t}getStyleFromComponent(a){if(null!=a&&!nt.isNullOrEmpty(a.componentStyle)){let t=a[Z.System.StiObject.stimulsoft]().as(dt),e=a[Z.System.StiObject.stimulsoft]().as(wt),i=a[Z.System.StiObject.stimulsoft]().as(ut),r=a[Z.System.StiObject.stimulsoft]().as(ht),n=new Dr;return n.name=a.componentStyle,null!=t&&(n.fontName=t.font.name,n.fontSize=$.round2(2*t.font.sizeInPoints,0),n.bold=t.font.bold,n.italic=t.font.italic,n.underline=t.font.underline),null!=e&&(n.textColor=lt.toColor(e.textBrush)),null!=i&&(n.alignment=i.horAlignment),null!=r&&(n.rightToLeft=r.textOptions.rightToLeft),this.getStyleNumber(this.styleList,n)}return-1}stringToUrl(e){if(nt.isNullOrEmpty(e))return"";let i=new ct;if(e.startsWith("file:"))for(let t of e.split(""))t.charCodeAt(0)<32||'"'==t?i.append(nt.format("%{0:x2}",t)):i.append(t);else for(let t of e.split(""))t.charCodeAt(0)<32||-1!=this.wrongUrlSymbols.indexOf(t)?i.append("_"):i.append(t);return i.toString()}getHyperlinkRefId(t){t.startsWith("www.")&&(t="http:\\"+t);let e;return this.hyperlinkList.containsKey(t)?e=this.hyperlinkList[t]:(e=this.hyperlinkList.count,this.hyperlinkList.add(t,e)),e}static get hiToTwips(){return 14.4*.995}convert(t){return $.round2(t*H.hiToTwips)}convertHiToTwips(t){return $.round2(14.4*t)}convertTwipsToEmu(t){return $.round2(t/14.4/100*914400)}convertStringToBookmark(e){let i=new ct;for(let t of e.split(""))tt.isLetterOrDigit(t)&&i.append(t);return 0<i.length&&null!=i.toString()[0]&&tt.isDigit(i.toString()[0])&&i.insert(0,"b"),i.toString()}concatByteArrays(t,e){let i=[];return it.copy2(e,0,i,0,e.length),it.copy2(t,0,i,e.length,t.length),i}generateDocumentProtection(t,a){let e=Ht.getRandomBytes(16),s=[0,0,0,0],o=15;if(!nt.isNullOrEmpty(a)){a=a.substr(0,Math.min(a.length,o));let r=[];for(let e=0;e<a.length;e++){let t=a.charCodeAt(e);r[e]=255&t,0==r[e]&&(r[e]=(65280&t)>>8)}let n=this.initialCodeArray[r.length-1];for(let i=0;i<r.length;i++){let e=o-r.length+i;for(let t=0;t<7;t++)0!=(r[i]&1<<t)&&(n^=this.encryptionMatrix[e][t])}let e=0;for(let t=r.length-1;0<=t;t--)e=(e>>14&1|e<<1&32767)^r[t];e=(e>>14&1|e<<1&32767)^r.length^52811;let i=(n<<16)+e;for(let t=0;t<4;t++)s[t]=(i&255<<8*t)>>8*t}let i=new ct;for(let t=0;t<4;t++)i.append(J.c.StiExportUtils.toHex(s[t]));s=u.Unicode.getBytes(i.toString().toUpperCase()),s=this.concatByteArrays(s,e);let r=5e4,n=new Z.System.Crypt.SHA1,l=(s=n.bytes(s),[0,0,0,0]);for(let t=0;t<r;t++)l[0]=(255&t)>>0,l[1]=(65280&t)>>8,l[2]=(16711680&t)>>16,l[3]=(4278190080&t)>>24,s=this.concatByteArrays(l,s),s=n.bytes(s);t.writeStartElement("w:documentProtection"),t.writeAttributeString("w:edit","readOnly"),t.writeAttributeString("w:enforcement","1"),t.writeAttributeString("w:cryptProviderType","rsaFull"),t.writeAttributeString("w:cryptAlgorithmClass","hash"),t.writeAttributeString("w:cryptAlgorithmType","typeAny"),t.writeAttributeString("w:cryptAlgorithmSid","4"),t.writeAttributeString("w:cryptSpinCount",r.toString()),t.writeAttributeString("w:hash",Z.System.Convert.toBase64String(s)),t.writeAttributeString("w:salt",Z.System.Convert.toBase64String(e)),t.writeEndElement()}writeFromMatrix(h,e,s,c,t=null){let m=63,g=this.matrix.coordX.countItems,p=this.matrix.coordY.countItems,d=it.create(Number,g),i=this.matrix.coordX.getKeys();for(let e=0;e<g;e++){let t=this.matrix.coordX.getByIndex(e,i);d[e]=this.convert(t)}let w=it.create(Number,p),r=this.matrix.coordY.getKeys();for(let e=0;e<p;e++){let t=this.matrix.coordY.getByIndex(e,r);w[e]=this.convert(t)}let u=!1,S=0;if(null!=t&&t.watermark.enabled&&!Z.StiOptions.Export.Word.watermarkOnlyBehind&&this.writeWatermark(h,t,!t.watermark.showImageBehind,!t.watermark.showBehind,!0)&&h.writeEndElement(),!(Z.Base.vAeXc.eMAio.UUyjq()||Z.Base.vAeXc.eMAio.lAtWS()||this.usePageHeadersAndFooters||(Z.Base.vAeXc.eMAio.rdCzm()||Z.Base.vAeXc.eMAio.CWsHL()||Z.Base.vAeXc.eMAio.tnNVR())&&Z.System.NodeJs.isStandaloneVersion||null==t)){let t=(this.spriteIndex++).toString(),e='<v:shapetype id="_x0000_t'+t+'" coordsize="21600,21600" o:spt="'+t+'" adj="10800" path="m@7,l@8,m@5,21600l@6,21600e">'+'<v:formulas><v:f eqn="sum #0 0 10800"/><v:f eqn="prod #0 2 1"/><v:f eqn="sum 21600 0 @1"/><v:f eqn="sum 0 0 @2"/>'+'<v:f eqn="sum 21600 0 @3"/><v:f eqn="if @0 @3 0"/><v:f eqn="if @0 21600 @1"/><v:f eqn="if @0 0 @2"/><v:f eqn="if @0 @4 21600"/>'+'<v:f eqn="mid @5 @6"/><v:f eqn="mid @8 @5"/><v:f eqn="mid @7 @8"/><v:f eqn="mid @6 @7"/><v:f eqn="sum @6 0 @5"/></v:formulas>'+'<v:path textpathok="t" o:connecttype="custom" o:connectlocs="@9,0;@10,10800;@11,21600;@12,10800" o:connectangles="270,180,90,0"/>'+'<v:textpath on="t" fitshape="t"/><v:handles><v:h position="#0,bottomRight" xrange="6629,14971"/></v:handles>'+'<o:lock v:ext="edit" text="t" shapetype="t"/></v:shapetype>',i=new ct;i.append("position:absolute;margin-left:0;margin-top:0;"),i.append("width:5.5in;height:2.51in;z-index:281656192;rotation:315;"),i.append("mso-position-horizontal:center;mso-position-horizontal-relative:page;mso-position-vertical:center;mso-position-vertical-relative:page;"),h.writeStartElement("w:p"),h.writeStartElement("w:r"),h.writeStartElement("w:rPr"),h.writeStartElement("w:noProof"),h.writeEndElement(),h.writeEndElement(),h.writeStartElement("w:pict"),h.writeRaw(e),h.writeStartElement("v:shape"),h.writeAttributeString("id","PowerPlusWaterMarkObject264"+t),h.writeAttributeString("o:spid","_x0000_s20"+t),h.writeAttributeString("type","#_x0000_t"+t),h.writeAttributeString("style",i.toString()),h.writeAttributeString("o:allowincell","f"),h.writeAttributeString("fillcolor","#000000"),h.writeAttributeString("stroked","f"),h.writeStartElement("v:fill"),h.writeAttributeString("opacity","0.2"),h.writeEndElement(),h.writeStartElement("v:textpath"),h.writeAttributeString("style",'font-family:"Arial";font-weight:bold'),h.writeAttributeString("string","Trial"),h.writeEndElement(),h.writeEndElement(),h.writeEndElement(),h.writeEndElement(),h.writeEndElement()}let f=it.create2(Boolean,p,g),b=it.create2(Boolean,p,g),E="";this.currentPassNumber=2+(Z.StiOptions.Export.Word.divideSegmentPages?1:0);for(let l=1;l<p;l++){this.invokeExporting2(l,p,this.currentPassNumber,this.maximumPassNumber);let i=l-1>=e&&l-1<=s,r=(0!=c||this.matrix.linePlacement[l-1]!=J.c.StiTableLineInfo.PageHeader&&this.matrix.linePlacement[l-1]!=J.c.StiTableLineInfo.PageFooter&&this.matrix.linePlacement[l-1]!=J.c.StiTableLineInfo.Trash||(i=!1),0<S&&(S--,i=!1),100005),n=[],a=!1;if(i)for(let t=1;t<g;t++){let e=this.matrix.cells.gett(l-1,t-1);if(0==f[l][t]&&null!=e&&null!=e.component){if(null!=e.component.tagValue){let t=e.component.tagValue.toString().toLowerCase();-1!=t.indexOf("rtfparagraph")&&(n.push(e),i=!1),-1!=t.indexOf("rtfnewpage")&&(a=!0)}let t=null;e.component.is(et)&&(t=e.component.margins),null!=(t=e.component.is(A)?e.component.margins:t)&&(t.top<r&&(r=t.top),0<e.height)&&(r=0)}}r*=H.hiToTwips;let o=$.round2(r);if(a&&(u&&(h.writeFullEndElement(),u=!1),h.writeStartElement("w:p"),h.writeStartElement("w:r"),h.writeStartElement("w:br"),h.writeAttributeString("w:type","page"),h.writeEndElement(),h.writeEndElement(),h.writeEndElement()),i){if(this.usePageHeadersAndFooters&&this.matrix.linePlacement[l-1]==J.c.StiTableLineInfo.HeaderAP){let t=this.matrix.parentBandName[l-1],e=t.indexOf("");(t=-1!=e?t.substr(0,e):t)!=E&&(E=t,u&&h.writeFullEndElement(),h.writeStartElement("w:p"),h.writeEndElement(),h.writeStartElement("w:tbl"),this.writeTableInfo(h,d,g),u=!0)}u||(h.writeStartElement("w:tbl"),this.writeTableInfo(h,d,g),u=!0),h.writeStartElement("w:tr");let t=w[l]-w[l-1];h.writeStartElement("w:trPr"),this.usePageHeadersAndFooters&&!Z.StiOptions.Export.Word.forceLineHeight||(h.writeStartElement("w:trHeight"),(!this.usePageHeadersAndFooters&&Z.StiOptions.Export.Word.lineHeightExactly||this.usePageHeadersAndFooters&&Z.StiOptions.Export.Word.lineHeightExactlyForPHFMode)&&h.writeAttributeString("w:hRule","exact"),h.writeAttributeString("w:val",t.toString()),h.writeEndElement()),this.usePageHeadersAndFooters&&this.matrix.linePlacement[l-1]==J.c.StiTableLineInfo.HeaderAP&&(h.writeStartElement("w:tblHeader"),h.writeEndElement()),h.writeEndElement()}let t=0;for(let s=1;s<g;s++){let a=this.matrix.cells.gett(l-1,s-1);if(!f[l][s]||b[l][s]){t++;let n=!0;if(b[l][s]){let t=l;while(b[t][s])t--;a=this.matrix.cells.gett(t-1,s-1),n=!1}if(null!=a&&n){for(let e=0;e<=a.height;e++)for(let t=0;t<=a.width;t++)f[l+e][s+t]=!0;if(0<a.height)for(let t=1;t<=a.height;t++)b[l+t][s]=!0}if(i){if(h.writeStartElement("w:tc"),null!=a){h.writeStartElement("w:tcPr");let e=0;for(let t=0;t<a.width+1;t++)e+=d[s+t]-d[s-1+t];if(h.writeStartElement("w:tcW"),h.writeAttributeString("w:w",e.toString()),h.writeAttributeString("w:type","dxa"),h.writeEndElement(),0<a.width&&(h.writeStartElement("w:gridSpan"),h.writeAttributeString("w:val",(a.width+1).toString()),h.writeEndElement()),0<a.height&&(b[l][s]?h.writeStartElement("w:vMerge"):(h.writeStartElement("w:vMerge"),h.writeAttributeString("w:val","restart")),h.writeEndElement()),null!=a.cellStyle.textOptions){let t=a.cellStyle.textOptions.angle,e=225<t&&t<315?"tbRl":45<t&&t<135?"btLr":"";""!=e&&(h.writeStartElement("w:textDirection"),h.writeAttributeString("w:val",e),h.writeEndElement())}let t=a.component.is(et)&&a.component.checkAllowHtmlTags()&&!Z.StiOptions.Export.Word.renderHtmlTagsAsImage;if(n&&a.component.is(et)&&(!a.component.isExportAsImage(this.exportFormat)||t)){let t=a.component,e=this.convert(t.margins.left),i=this.convert(t.margins.right-Z.StiOptions.Export.Word.rightMarginCorrection),r=this.convert(t.margins.top);r>o&&(r=o),(0<e||0<i||0<r)&&(h.writeStartElement("w:tcMar"),0<r&&(h.writeStartElement("w:top"),h.writeAttributeString("w:w",r.toString()),h.writeAttributeString("w:type","dxa"),h.writeEndElement()),0<e&&(h.writeStartElement("w:left"),h.writeAttributeString("w:w",e.toString()),h.writeAttributeString("w:type","dxa"),h.writeEndElement()),0<i&&(h.writeStartElement("w:right"),h.writeAttributeString("w:w",i.toString()),h.writeAttributeString("w:type","dxa"),h.writeEndElement()),h.writeEndElement())}let i="";switch(a.cellStyle.vertAlignment){case st.Center:i="center";break;case st.Bottom:i="bottom";break}if(""!=i&&(h.writeStartElement("w:vAlign"),h.writeAttributeString("w:val",i),h.writeEndElement()),this.writeBorders(h,a.top,a.left,a.height+1,a.width+1),null!=a.component){let t=a.component.as(Q);a.component.isExportAsImage(J.a.StiExportFormat.Word)&&(null==t||this.imageResolutionMode==J.c.StiImageResolutionMode.Exactly)||a.cellStyle.color.equals(rt.empty)||a.cellStyle.color.equals(rt.transparent)||(h.writeStartElement("w:shd"),h.writeAttributeString("w:val","clear"),h.writeAttributeString("w:color","auto"),h.writeAttributeString("w:fill",this.getColorString(a.cellStyle.color)),h.writeEndElement())}h.writeEndElement();let r=this.restrictEditing==J.c.StiWordRestrictEditing.ExceptEditableFields&&null!=a.component&&a.component.is(et)&&a.component.editable;r&&(h.writeStartElement("w:permStart"),h.writeAttributeString("w:id","0"),h.writeEndElement()),this.needEmptyParagraph=!0,n&&this.writeCellContent(h,a,l,s,d,w),this.needEmptyParagraph&&(h.writeStartElement("w:p"),h.writeFullEndElement()),r&&(h.writeStartElement("w:permEnd"),h.writeAttributeString("w:id","0"),h.writeEndElement())}else{let r=null,t={ref:r},n=this.renderBorder2TableGetValues(l,s,t),a=0;if(0==(n&P.Right)){while(s+a+1<g&&null==this.matrix.cells.gett(l-1,s+a+1-1)&&0==f[l][s+a+1]&&0==b[l][s+a+1]){let t=null,e={ref:t},i=this.renderBorder2TableGetValues(l,s+a+1,e);if(0<(i&P.Left))break;if((i&(P.Top|P.Bottom))!=(n&(P.Top|P.Bottom)))break;if(r!=t)break;if(a++,0<(i&P.Right))break}if(0<a)for(let t=1;t<=a;t++)f[l][s+t]=!0}h.writeStartElement("w:tcPr");let e=d[s+a]-d[s-1];h.writeStartElement("w:tcW"),h.writeAttributeString("w:w",e.toString()),h.writeAttributeString("w:type","dxa"),h.writeEndElement(),0<a&&(h.writeStartElement("w:gridSpan"),h.writeAttributeString("w:val",(a+1).toString()),h.writeEndElement()),this.writeBorders(h,l-1,s-1,1,a+1),h.writeEndElement(),h.writeStartElement("w:p"),h.writeFullEndElement()}h.writeFullEndElement()}}if(t>=m)break}i&&h.writeFullEndElement();for(let t of n)u&&h.writeEndElement(),u=!1,S=t.height,this.writeCellContent(h,t,t.top+1,t.left+1,d,w)}u&&h.writeEndElement()}writeCellContent(l,h,i,r,n,a){var c;this.bkmRefText=null,this.bkmRefId=-1;let t=this.matrix.bookmarks.gett(i-1,r-1);if(null==t||this.bookmarkList.containsKey(t)||(this.bkmRefId=this.bookmarkList.count,this.bkmRefText=this.convertStringToBookmark(t),this.bookmarkList.set(t,this.bkmRefId)),this.hypRefText=null,this.hypRefId=-1,null!=h.component&&null!=h.component.hyperlinkValue){let t=h.component.hyperlinkValue.toString().trim();0<t.length&&!t.startsWith("javascript:")&&(t.startsWith("#")?this.hypRefText=this.convertStringToBookmark(t.substr(1)):(this.hypRefText=this.stringToUrl(t),this.hyperlinkList.containsKey(this.hypRefText)?this.hypRefId=$.trunc(this.hyperlinkList.get(this.hypRefText)):(this.hypRefId=this.hyperlinkList.count,this.hyperlinkList.add(this.hypRefText,this.hypRefId))))}let m=h.component.as(et);if(null==m||m.isExportAsImage(this.exportFormat)||m.checkAllowHtmlTags()){if(!h.component.is(A)||Z.StiOptions.Export.Word.renderRichTextAsImage)if(h.component.is(et)&&h.component.checkAllowHtmlTags()&&!Z.StiOptions.Export.Word.renderHtmlTagsAsImage)nt.isNullOrWhiteSpace(h.text)||(this.writeHtmlTags(l,h),this.needEmptyParagraph=!1);else if(h.component.isExportAsImage(this.exportFormat)){let t=a[i-1+h.height+1]-a[i-1],e=n[r-1+h.width+1]-n[r-1];this.imageResolutionMode!=J.c.StiImageResolutionMode.Exactly&&h.component.is(Q)?this.writeStiImageAuto(l,h,e,t):this.writeStiImage(l,h,e,t)}else-1!=this.bkmRefId&&(l.writeStartElement("w:bookmarkStart"),l.writeAttributeString("w:id",this.bkmRefId.toString()),l.writeAttributeString("w:name",this.bkmRefText),l.writeEndElement(),l.writeStartElement("w:bookmarkEnd"),l.writeAttributeString("w:id",this.bkmRefId.toString()),l.writeEndElement())}else{let e=new ct(h.text);if(this.usePageHeadersAndFooters){let t=m.tagValue;nt.isNullOrEmpty(t)||-1!=t.toLowerCase().indexOf("rtfnewpage")||-1==t.indexOf("#PageNumber#")&&-1==t.indexOf("#TotalPageCount#")&&-1==t.indexOf("#PageRef")||(e=new ct(t))}let s=[],i="";for(let t of e.toString().split(""))tt.isControl(t)&&"\t"!=t?"\n"==t&&(s.push(i),i=""):i+=t;""!=i&&s.push(i),0==s.length&&s.push(i),0<s.length&&(this.needEmptyParagraph=!1);let o=this.getStyleFromComponent(h.component);for(let a=0;a<s.length;a++){let r=s[a],n=(l.writeStartElement("w:p"),l.writeStartElement("w:pPr"),m.lineSpacing);if(null!=this.lineSpace||1!=n){let i=this.lineSpace,t=(1!=n&&(i=$.round2(240*Z.StiOptions.Export.Word.lineSpacing*n).toString()),h.component.as(dt));if(null!=t&&null!=t.font){let e=null!=(c=Z.StiOptions.Export.alternativeFontNames.get(t.font.name))?c:t.font.name;if(H.checkFontsToCorrectHeight(e)){let t=H.fontsToCorrectHeight.get(e);null==t?(i=this.lineSpace2,1!=n&&(i=$.round2(240*Z.StiOptions.Export.Word.lineSpacing*H.defaultFontHeightCorrection*n).toString())):i=$.round2(240*Z.StiOptions.Export.Word.lineSpacing*t*n).toString()}}l.writeStartElement("w:spacing"),l.writeAttributeString("w:line",i),l.writeEndElement()}if(!m.wordWrap&&m.horAlignment==at.Left){let t=this.convert(this.report.unit.convertToHInches(h.component.right+h.component.page.margins.left)-2100);t<0&&(l.writeStartElement("w:ind"),l.writeAttributeString("w:right",t.toString()),l.writeEndElement())}-1!=o&&(l.writeStartElement("w:pStyle"),l.writeAttributeString("w:val",`Style`+o),l.writeEndElement());let t=h.cellStyle.horAlignment,e=!1,i=(null!=h.cellStyle.textOptions&&(e=h.cellStyle.textOptions.rightToLeft),"");if((t==at.Left&&1==e||t==at.Right&&0==e)&&(i="right"),t==at.Center&&(i="center"),""!=(i=t==at.Width?"both":i)&&(l.writeStartElement("w:jc"),l.writeAttributeString("w:val",i),l.writeEndElement()),-1==o&&this.writeRunProperties(l,h),l.writeEndElement(),null!=this.hypRefText&&(l.writeStartElement("w:hyperlink"),-1==this.hypRefId?l.writeAttributeString("w:anchor",this.hypRefText):l.writeAttributeString("r:id",`hId`+this.hypRefId)),-1!=this.bkmRefId&&(l.writeStartElement("w:bookmarkStart"),l.writeAttributeString("w:id",this.bkmRefId.toString()),l.writeAttributeString("w:name",this.bkmRefText),l.writeEndElement()),""!=r)if(this.usePageHeadersAndFooters){r=r[Z.System.StiObject.stimulsoft]().replaceAll("#PageNumber#","")[Z.System.StiObject.stimulsoft]().replaceAll("#TotalPageCount#","");let i=[],e=new ct;for(let t of r.split(""))""==t||""==t?(0<e.length&&i.push(e.toString()),i.push(t.toString()),e=new ct):e.append(t);0<e.length&&i.push(e.toString()),0==i.length&&i.push(r);for(let e=0;e<i.length;e++){let t=i[e];if(0<t.length&&(""==t[0]||""==t[0])){switch(l.writeStartElement("w:r"),-1==o&&this.writeRunProperties(l,h),l.writeStartElement("w:fldChar"),l.writeAttributeString("w:fldCharType","begin"),l.writeEndElement(),l.writeEndElement(),l.writeStartElement("w:r"),this.writeRunProperties(l,h),l.writeStartElement("w:instrText"),t.charAt(0)){case"":l.writeString("PAGE   \\* MERGEFORMAT");break;case"":l.writeString("NUMPAGES");break}l.writeEndElement(),l.writeEndElement(),l.writeStartElement("w:r"),this.writeRunProperties(l,h),l.writeStartElement("w:fldChar"),l.writeAttributeString("w:fldCharType","separate"),l.writeEndElement(),l.writeEndElement(),l.writeStartElement("w:r"),this.writeRunProperties(l,h),l.writeStartElement("w:t"),l.writeString("1"),l.writeEndElement(),l.writeEndElement(),l.writeStartElement("w:r"),this.writeRunProperties(l,h),l.writeStartElement("w:fldChar"),l.writeAttributeString("w:fldCharType","end")}else l.writeStartElement("w:r"),-1==o&&this.writeRunProperties(l,h),l.writeStartElement("w:t"),l.writeAttributeString("xml:space","preserve"),l.writeString(t);l.writeEndElement(),l.writeEndElement()}}else l.writeStartElement("w:r"),-1==o&&this.writeRunProperties(l,h),l.writeStartElement("w:t"),l.writeAttributeString("xml:space","preserve"),l.writeString(r),l.writeEndElement(),l.writeEndElement();-1!=this.bkmRefId&&(l.writeStartElement("w:bookmarkEnd"),l.writeAttributeString("w:id",this.bkmRefId.toString()),l.writeEndElement()),null!=this.hypRefText&&l.writeEndElement(),l.writeEndElement()}}}writeStiImage(n,a,s,o){let t=a.component.as(pt);if(null==t)return;let l=this.exportCache.getImageIndex(a.component,null,a.componentId);if(null==l){let t=J.d.StiOfficeImageFormatHelper.getImageAndTag(a.component,J.a.StiExportFormat.Word,this.imageResolution,this.imageFormat,null,null);null!=t&&(l=this.imageCache.addImageIntRaw(t,t.imageFormat))}if(null!=l){this.needEmptyParagraph=!1;let t=J.d.StiOfficeImageFormatHelper.getImageFormatExtension(this.imageCache.imageFormatStore[l]),e=(n.writeStartElement("w:p"),n.writeStartElement("w:pPr"),a.cellStyle.horAlignment),i=!1;if(null!=a.cellStyle.textOptions&&(i=a.cellStyle.textOptions.rightToLeft),null==a.component.as(ut)){let t=a.component.as(vt);null!=t&&(t.horAlignment==M.Left&&(e=at.Left),t.horAlignment==M.Center&&(e=at.Center),t.horAlignment==M.Right)&&(e=at.Right)}let r="";(e==at.Left&&1==i||e==at.Right&&0==i)&&(r="right"),e==at.Center&&(r="center"),""!=(r=e==at.Width?"both":r)&&(n.writeStartElement("w:jc"),n.writeAttributeString("w:val",r),n.writeEndElement()),n.writeEndElement(),-1!=this.bkmRefId&&(n.writeStartElement("w:bookmarkStart"),n.writeAttributeString("w:id",this.bkmRefId.toString()),n.writeAttributeString("w:name",this.bkmRefText),n.writeEndElement()),n.writeStartElement("w:r"),n.writeStartElement("w:rPr"),n.writeElementString("w:noProof",""),n.writeEndElement(),n.writeStartElement("w:drawing"),n.writeStartElement("wp:inline"),n.writeAttributeString("distT","0"),n.writeAttributeString("distB","0"),n.writeAttributeString("distL","0"),n.writeAttributeString("distR","0"),n.writeStartElement("wp:extent"),n.writeAttributeString("cx",this.convertTwipsToEmu(s).toString()),n.writeAttributeString("cy",this.convertTwipsToEmu(o).toString()),n.writeEndElement(),n.writeStartElement("wp:effectExtent"),n.writeAttributeString("l","0"),n.writeAttributeString("t","0"),n.writeAttributeString("r","0"),n.writeAttributeString("b","0"),n.writeEndElement(),n.writeStartElement("wp:docPr"),n.writeAttributeString("id",(l+2).toString()),n.writeAttributeString("name",`Picture `+(l+1)),n.writeAttributeString("descr",nt.format("Image{0:D5}.{1}",l+1,t)),null!=this.hypRefText&&(-1==this.hypRefId&&(this.hypRefText="#"+this.hypRefText,this.hypRefId=this.getHyperlinkRefId(this.hypRefText)),n.writeStartElement("a:hlinkClick"),n.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),n.writeAttributeString("r:id",`hId`+this.hypRefId),n.writeEndElement()),n.writeEndElement(),n.writeStartElement("wp:cNvGraphicFramePr"),n.writeStartElement("a:graphicFrameLocks"),n.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),n.writeAttributeString("noChangeAspect","1"),n.writeEndElement(),n.writeEndElement(),n.writeStartElement("a:graphic"),n.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),n.writeStartElement("a:graphicData"),n.writeAttributeString("uri","http://schemas.openxmlformats.org/drawingml/2006/picture"),n.writeStartElement("pic:pic"),n.writeAttributeString("xmlns:pic","http://schemas.openxmlformats.org/drawingml/2006/picture"),n.writeStartElement("pic:nvPicPr"),n.writeStartElement("pic:cNvPr"),n.writeAttributeString("id","0"),n.writeAttributeString("name",nt.format("Image{0:D5}.{1}",l+1,t)),n.writeEndElement(),n.writeStartElement("pic:cNvPicPr"),n.writeEndElement(),n.writeEndElement(),n.writeStartElement("pic:blipFill"),n.writeStartElement("a:blip"),n.writeAttributeString("r:embed",`rId`+(5+l)),n.writeAttributeString("cstate","print"),n.writeEndElement(),n.writeStartElement("a:stretch"),n.writeStartElement("a:fillRect"),n.writeEndElement(),n.writeEndElement(),n.writeEndElement(),n.writeStartElement("pic:spPr"),n.writeStartElement("a:xfrm"),n.writeStartElement("a:off"),n.writeAttributeString("x","0"),n.writeAttributeString("y","0"),n.writeEndElement(),n.writeStartElement("a:ext"),n.writeAttributeString("cx",this.convertTwipsToEmu(s).toString()),n.writeAttributeString("cy",this.convertTwipsToEmu(o).toString()),n.writeEndElement(),n.writeEndElement(),n.writeStartElement("a:prstGeom"),n.writeAttributeString("prst","rect"),n.writeStartElement("a:avLst"),n.writeEndElement(),n.writeEndElement(),n.writeEndElement(),n.writeEndElement(),n.writeEndElement(),n.writeEndElement(),n.writeEndElement(),n.writeEndElement(),n.writeEndElement(),-1!=this.bkmRefId&&(n.writeStartElement("w:bookmarkEnd"),n.writeAttributeString("w:id",this.bkmRefId.toString()),n.writeEndElement()),n.writeEndElement()}}writeStiImageAuto(t,e,i,N){let r=e.component.as(Q);if(null==r)return;let n,a=0,s=0,o=this.exportCache.getImageIndex(e.component,null,e.componentId);if(null!=o)n=new Z.System.Drawing.Image,a=this.imageCache.imageSizeStore[o].width,s=this.imageCache.imageSizeStore[o].height;else{let t={ref:this.imageResolution};if(null==(n=r.getImage(t)))return;let e=n.imageFormat,i=(a=n.width,s=n.height,J.d.StiOfficeImageFormatHelper.correctImageFormat(this.imageFormat,e));o=this.imageCache.addImageInt(n,i)}this.needEmptyParagraph=!1;let l=e.component.report.unit.convertToHInches(e.component.width),h=e.component.report.unit.convertToHInches(e.component.height);if(r.imageRotation==O.Rotate90CCW||r.imageRotation==O.Rotate90CW){let t=l;l=h,h=t}let c=new mt,m=[],g=this.matrix.getRealImageData(e,n,m),p=(null!=g&&0<m.length&&(c.x=m[0],c.y=m[1]),this.matrix.coordX.getKeys()),d=this.matrix.coordY.getKeys(),w=(c.width=this.matrix.coordX.getByIndex(e.left+e.width+1,p)-this.matrix.coordX.getByIndex(e.left,p),c.height=this.matrix.coordY.getByIndex(e.top+e.height+1,d)-this.matrix.coordY.getByIndex(e.top,d),c.clone()),u=r.margins.left,S=r.margins.right,f=r.margins.top,b=r.margins.bottom,E=r.horAlignment,v=r.vertAlignment,y=0;if(r.imageRotation!=O.None){let t=M.Center,e=st.Center;r.imageRotation==O.Rotate90CW&&(E==M.Left&&(e=st.Bottom),E==M.Right&&(e=st.Top),v==st.Top&&(t=M.Left),v==st.Bottom&&(t=M.Right),u=r.margins.top,S=r.margins.bottom,f=r.margins.right,b=r.margins.left,y=-90,w.x=c.y,w.y=h-(c.x+c.width),w.width=c.height,w.height=c.width),r.imageRotation==O.Rotate90CCW&&(E==M.Left&&(e=st.Top),E==M.Right&&(e=st.Bottom),v==st.Top&&(t=M.Right),v==st.Bottom&&(t=M.Left),u=r.margins.bottom,S=r.margins.top,f=r.margins.left,b=r.margins.right,y=90,w.x=l-(c.y+c.height),w.y=c.x,w.width=c.height,w.height=c.width),r.imageRotation==O.Rotate180&&(E==M.Left&&(t=M.Right),E==M.Right&&(t=M.Left),v==st.Top&&(e=st.Bottom),v==st.Bottom&&(e=st.Top),u=r.margins.right,S=r.margins.left,f=r.margins.bottom,b=r.margins.top,y=180,w.x=l-(c.x+c.width),w.y=h-(c.y+c.height)),r.imageRotation==O.FlipHorizontal&&(E==M.Left&&(t=M.Right),E==M.Right&&(t=M.Left),e=v,u=r.margins.right,S=r.margins.left,w.x=l-(c.x+c.width)),r.imageRotation==O.FlipVertical&&(v==st.Top&&(e=st.Bottom),v==st.Bottom&&(e=st.Top),t=E,f=r.margins.bottom,b=r.margins.top,w.y=h-(c.y+c.height)),E=t,v=e}let x=l-u-S,A=h-f-b;if(r.stretch||null!=r.icon){if(r.aspectRatio){let t=Math.min(x/a,A/s),e=(x-a*t)/2,i=(A-s*t)/2;E==M.Left&&(S+=2*e),E==M.Right&&(u+=2*e),E==M.Center&&(u+=e,S+=e),v==st.Top&&(b+=2*i),v==st.Bottom&&(f+=2*i),v==st.Center&&(f+=i,b+=i),x-=2*e,A-=2*i}}else{x=a*r.multipleFactor,A=s*r.multipleFactor;let t=-(x-l)/2,e=-(A-h)/2;E==M.Left&&(S+=2*t),E==M.Right&&(u+=2*t),E==M.Center&&(u+=t,S+=t),v==st.Top&&(b+=2*e),v==st.Bottom&&(f+=2*e),v==st.Center&&(f+=e,b+=e)}let T=-w.x,F=w.x+w.width-l,C=-w.y,P=w.y+w.height-h,L=(u+=T,S+=F,f+=C,b+=P,l+=T+F,h+=C+P,0|-Math.round(u/x*1e5)),k=0|-Math.round(S/x*1e5),B=0|-Math.round(f/A*1e5),D=0|-Math.round(b/A*1e5),I=J.d.StiOfficeImageFormatHelper.getImageFormatExtension(this.imageCache.imageFormatStore[o]),R=(t.writeStartElement("w:p"),t.writeStartElement("w:pPr"),null);E==M.Right&&(R="right"),E==M.Center&&(R="center"),nt.isNullOrEmpty(R)||(t.writeStartElement("w:jc"),t.writeAttributeString("w:val",R),t.writeEndElement()),t.writeEndElement(),-1!=this.bkmRefId&&(t.writeStartElement("w:bookmarkStart"),t.writeAttributeString("w:id",this.bkmRefId.toString()),t.writeAttributeString("w:name",this.bkmRefText),t.writeEndElement()),t.writeStartElement("w:r"),t.writeStartElement("w:rPr"),t.writeElementString("w:noProof",""),t.writeEndElement(),t.writeStartElement("w:drawing"),t.writeStartElement("wp:inline"),t.writeAttributeString("distT","0"),t.writeAttributeString("distB","0"),t.writeAttributeString("distL","0"),t.writeAttributeString("distR","0"),t.writeStartElement("wp:extent"),t.writeAttributeString("cx",nt.format("{0}",this.convertTwipsToEmu(l*H.hiToTwips))),t.writeAttributeString("cy",nt.format("{0}",this.convertTwipsToEmu(h*H.hiToTwips))),t.writeEndElement(),t.writeStartElement("wp:effectExtent"),t.writeAttributeString("l","0"),t.writeAttributeString("t","0"),t.writeAttributeString("r","0"),t.writeAttributeString("b","0"),t.writeEndElement(),t.writeStartElement("wp:docPr"),t.writeAttributeString("id",``+(o+2)),t.writeAttributeString("name",nt.format("Picture {0}",o+1)),t.writeAttributeString("descr",nt.format("Image{0:D5}.{1}",o+1,I)),null!=this.hypRefText&&(-1==this.hypRefId&&(this.hypRefText="#"+this.hypRefText,this.hypRefId=this.getHyperlinkRefId(this.hypRefText)),t.writeStartElement("a:hlinkClick"),t.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),t.writeAttributeString("r:id",nt.format("hId{0}",this.hypRefId)),t.writeEndElement()),t.writeEndElement(),t.writeStartElement("wp:cNvGraphicFramePr"),t.writeStartElement("a:graphicFrameLocks"),t.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),t.writeAttributeString("noChangeAspect","1"),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("a:graphic"),t.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),t.writeStartElement("a:graphicData"),t.writeAttributeString("uri","http://schemas.openxmlformats.org/drawingml/2006/picture"),t.writeStartElement("pic:pic"),t.writeAttributeString("xmlns:pic","http://schemas.openxmlformats.org/drawingml/2006/picture"),t.writeStartElement("pic:nvPicPr"),t.writeStartElement("pic:cNvPr"),t.writeAttributeString("id","0"),t.writeAttributeString("name",nt.format("Image{0:D5}.{1}",o+1,I)),t.writeEndElement(),t.writeStartElement("pic:cNvPicPr"),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("pic:blipFill"),t.writeAttributeString("rotWithShape","1"),t.writeStartElement("a:blip"),t.writeAttributeString("r:embed",nt.format("rId{0}",5+o)),t.writeAttributeString("cstate","print"),t.writeStartElement("a:extLst"),t.writeStartElement("a:ext"),t.writeAttributeString("uri","{28A0092B-C50C-407E-A947-70E740481C1C}"),t.writeStartElement("a14:useLocalDpi"),t.writeAttributeString("xmlns:a14","http://schemas.microsoft.com/office/drawing/2010/main"),t.writeAttributeString("val","0"),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),0==L&&0==k&&0==B&&0==D||(t.writeStartElement("a:srcRect"),0!=L&&t.writeAttributeString("l",L.toString()),0!=B&&t.writeAttributeString("t",B.toString()),0!=k&&t.writeAttributeString("r",k.toString()),0!=D&&t.writeAttributeString("b",D.toString()),t.writeEndElement()),t.writeStartElement("a:stretch"),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("pic:spPr"),t.writeStartElement("a:xfrm"),0!=y&&t.writeAttributeString("rot",nt.format("{0}",0|Math.round(6e4*-y))),r.imageRotation==O.FlipHorizontal&&t.writeAttributeString("flipH","1"),r.imageRotation==O.FlipVertical&&t.writeAttributeString("flipV","1"),t.writeStartElement("a:off"),t.writeAttributeString("x","0"),t.writeAttributeString("y","0"),t.writeEndElement(),t.writeStartElement("a:ext"),t.writeAttributeString("cx",nt.format("{0}",this.convertTwipsToEmu(l*H.hiToTwips))),t.writeAttributeString("cy",nt.format("{0}",this.convertTwipsToEmu(h*H.hiToTwips))),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("a:prstGeom"),t.writeAttributeString("prst","rect"),t.writeStartElement("a:avLst"),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("a:ln"),t.writeStartElement("a:noFill"),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("a:extLst"),t.writeStartElement("a:ext"),t.writeAttributeString("uri","{53640926-AAD7-44D8-BBD7-CCE9431645EC}"),t.writeStartElement("a14:shadowObscured"),t.writeAttributeString("xmlns:a14","http://schemas.microsoft.com/office/drawing/2010/main"),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),-1!=this.bkmRefId&&(t.writeStartElement("w:bookmarkEnd"),t.writeAttributeString("w:id",this.bkmRefId.toString()),t.writeEndElement()),t.writeEndElement()}writeTableInfo(i,r,t){i.writeStartElement("w:tblPr"),i.writeStartElement("w:tblStyle"),i.writeAttributeString("w:val","a1"),i.writeEndElement(),i.writeStartElement("w:tblW"),i.writeAttributeString("w:w","0"),i.writeAttributeString("w:type","dxa"),i.writeEndElement(),i.writeStartElement("w:tblLayout"),i.writeAttributeString("w:type","fixed"),i.writeEndElement(),i.writeStartElement("w:tblCellMar"),i.writeStartElement("w:top"),i.writeAttributeString("w:w","0"),i.writeAttributeString("w:type","dxa"),i.writeEndElement(),i.writeStartElement("w:left"),i.writeAttributeString("w:w","0"),i.writeAttributeString("w:type","dxa"),i.writeEndElement(),i.writeStartElement("w:bottom"),i.writeAttributeString("w:w","0"),i.writeAttributeString("w:type","dxa"),i.writeEndElement(),i.writeStartElement("w:right"),i.writeAttributeString("w:w","0"),i.writeAttributeString("w:type","dxa"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("w:tblLook"),i.writeAttributeString("w:val","04A0"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("w:tblGrid");for(let e=1;e<t;e++){let t=r[e]-r[e-1];i.writeStartElement("w:gridCol"),i.writeAttributeString("w:w",t.toString()),i.writeEndElement()}i.writeFullEndElement()}writeHtmlTags(a,s){let t=s.component,e=s.text,o=new g(t.font.bold,t.font.italic,t.font.underline,t.font.strikeout,t.font.sizeInPoints,t.font.name,lt.toColor(t.textBrush),lt.toColor(t.brush),!1,!1,0,0,t.lineSpacing,t.horAlignment),i=new U(o,0),l=Z.Base.Drawing.StiTextRenderer.parseHtmlToStates(e,i),h=this.getStyleFromComponent(s.component);this.writeParagraphBegin(a,s,h,l,0);for(let n=0;n<l.length;n++){let t=l[n],e=t.ts;if("\n"==t.text.toString()&&n<l.length-1){a.writeEndElement(),this.writeParagraphBegin(a,s,h,l,n+1);continue}a.writeStartElement("w:r"),a.writeStartElement("w:rPr"),e.bold&&(a.writeStartElement("w:b"),a.writeEndElement()),e.italic&&(a.writeStartElement("w:i"),a.writeEndElement()),e.underline&&(a.writeStartElement("w:u"),a.writeAttributeString("w:val","single"),a.writeEndElement()),e.strikeout&&(a.writeStartElement("w:strike"),a.writeEndElement()),e.superscript&&(a.writeStartElement("w:vertAlign"),a.writeAttributeString("w:val","superscript"),a.writeEndElement()),e.subscript&&(a.writeStartElement("w:vertAlign"),a.writeAttributeString("w:val","subscript"),a.writeEndElement()),e.fontColor.toArgb()!=o.fontColor.toArgb()&&(a.writeStartElement("w:color"),a.writeAttributeString("w:val",this.getColorString(e.fontColor)),a.writeEndElement()),e.backColor.toArgb()!=o.backColor.toArgb()&&(a.writeStartElement("w:shd"),a.writeAttributeString("w:val","clear"),a.writeAttributeString("w:color","auto"),a.writeAttributeString("w:fill",this.getColorString(e.backColor)),a.writeEndElement()),a.writeStartElement("w:sz"),a.writeAttributeString("w:val",(2*e.fontSize).toString()),a.writeEndElement(),a.writeStartElement("w:szCs"),a.writeAttributeString("w:val",(2*e.fontSize).toString()),a.writeEndElement(),a.writeStartElement("w:rFonts");let i=e.fontName,r=(this.fontList.set(i,i),a.writeAttributeString("w:ascii",i),a.writeAttributeString("w:hAnsi",i),a.writeAttributeString("w:eastAsia",i),a.writeAttributeString("w:cs",i),a.writeEndElement(),e.letterSpacing*e.fontSize*18.8+Z.StiOptions.Export.Word.spaceBetweenCharacters);0!=r&&(a.writeStartElement("w:spacing"),a.writeAttributeString("w:val",r.toString()),a.writeEndElement()),null!=s.cellStyle.textOptions&&s.cellStyle.textOptions.rightToLeft&&(a.writeStartElement("w:rtl"),a.writeEndElement()),a.writeEndElement(),a.writeStartElement("w:t"),a.writeAttributeString("xml:space","preserve"),a.writeString(Z.Base.Drawing.StiTextRenderer.prepareStateText(t.text).toString()),a.writeEndElement(),a.writeEndElement()}a.writeEndElement()}writeParagraphBegin(t,e,i,r,n){var a;t.writeStartElement("w:p"),t.writeStartElement("w:pPr"),-1!=i?(t.writeStartElement("w:pStyle"),t.writeAttributeString("w:val",`Style`+i),t.writeEndElement()):this.writeRunProperties(t,e);let s=r[n];if("\n"!=s.text.toString()){let t=n+1;while(t<r.length&&"\n"!=r[t].text.toString())s=r[t],t++}let o=Z.StiOptions.Export.Word.lineSpacing*s.ts.lineHeight,l=(s.ts.lineHeight<1&&(o*=1-.2*(1-s.ts.lineHeight)),null!=(a=Z.StiOptions.Export.alternativeFontNames.get(s.ts.fontName))?a:s.ts.fontName);if(H.checkFontsToCorrectHeight(l)){let t=H.fontsToCorrectHeight.get(l);o*=null==t?H.defaultFontHeightCorrection:t}1!=o&&(t.writeStartElement("w:spacing"),t.writeAttributeString("w:line",$.round2(240*o).toString()),t.writeEndElement());let h=null;s.ts.textAlign==at.Center&&(h="center"),s.ts.textAlign==at.Right&&(h="right"),null!=(h=s.ts.textAlign==at.Width?"both":h)&&(t.writeStartElement("w:jc"),t.writeAttributeString("w:val",h),t.writeEndElement()),t.writeEndElement()}writeRunProperties(t,e){t.writeStartElement("w:rPr"),t.writeStartElement("w:rFonts");let i=e.cellStyle.font.name;this.fontList.set(i,i),t.writeAttributeString("w:ascii",i),t.writeAttributeString("w:hAnsi",i),t.writeAttributeString("w:eastAsia",i),t.writeAttributeString("w:cs",i),t.writeEndElement(),e.cellStyle.font.bold&&(t.writeStartElement("w:b"),t.writeEndElement()),e.cellStyle.font.italic&&(t.writeStartElement("w:i"),t.writeEndElement()),e.cellStyle.font.underline&&(t.writeStartElement("w:u"),t.writeAttributeString("w:val","single"),t.writeEndElement()),t.writeStartElement("w:color"),t.writeAttributeString("w:val",this.getColorString(e.cellStyle.textColor)),t.writeEndElement(),t.writeStartElement("w:sz"),t.writeAttributeString("w:val",(2*e.cellStyle.font.sizeInPoints).toString()),t.writeEndElement(),0!=Z.StiOptions.Export.Word.spaceBetweenCharacters&&(t.writeStartElement("w:spacing"),t.writeAttributeString("w:val",Z.StiOptions.Export.Word.spaceBetweenCharacters.toString()),t.writeEndElement()),null!=e.cellStyle.textOptions&&e.cellStyle.textOptions.rightToLeft&&(e.cellStyle.font.bold&&(t.writeStartElement("w:bCs"),t.writeEndElement()),e.cellStyle.font.italic&&(t.writeStartElement("w:iCs"),t.writeEndElement()),t.writeStartElement("w:szCs"),t.writeAttributeString("w:val",(2*e.cellStyle.font.sizeInPoints).toString()),t.writeEndElement(),t.writeStartElement("w:rtl"),t.writeEndElement()),t.writeEndElement()}renderBorder2TableGetValues(t,e,i){let r=i.ref,n=P.None,a=new ct;return null!=this.matrix.bordersY.gett(t-1,e-1)&&(n|=P.Left),null!=this.matrix.bordersY.gett(t-1,e-1+1)&&(n|=P.Right),null!=this.matrix.bordersX.gett(t-1,e-1)&&(a.append("\\t"+this.getLineStyle2TableGetValues(this.matrix.bordersX.gett(t-1,e-1))),n|=P.Top),null!=this.matrix.bordersX.gett(t-1+1,e-1)&&(a.append("\\b"+this.getLineStyle2TableGetValues(this.matrix.bordersX.gett(t-1+1,e-1))),n|=P.Bottom),r=a.toString(),i.ref=r,n}getLineStyle2TableGetValues(t){let e=new ct;return e.append(this.getLineStyle(t.style)),e.append($.trunc(15*t.size)),e.append(nt.format("c{0}",this.getColorString(t.color))),e.toString()}writeDocument(s,o,t,l){let e=new K,h=new w(u.UTF8,e),i=(h.indentation=this.xmlIndentation<0?0:this.xmlIndentation,h.formatting=this.xmlIndentation<0?d.None:d.Indented,h.writeStartDocument(),h.writeStartElement("w:document"),h.writeAttributeString("xmlns:ve","http://schemas.openxmlformats.org/markup-compatibility/2006"),h.writeAttributeString("xmlns:o","urn:schemas-microsoft-com:office:office"),h.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),h.writeAttributeString("xmlns:m","http://schemas.openxmlformats.org/officeDocument/2006/math"),h.writeAttributeString("xmlns:v","urn:schemas-microsoft-com:vml"),h.writeAttributeString("xmlns:wp","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"),h.writeAttributeString("xmlns:w10","urn:schemas-microsoft-com:office:word"),h.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),h.writeAttributeString("xmlns:wne","http://schemas.microsoft.com/office/word/2006/wordml"),this.getPagesBackColor(s)),r=(i.equals(rt.white)||0==i.a||(h.writeStartElement("w:background"),h.writeAttributeString("w:color",this.getColorString(i)),h.writeEndElement()),h.writeStartElement("w:body"),s),n=(s=null,0),c=0;while(n<r.count){(s=new f(o,r)).cacheMode=o.renderedPages.cacheMode,s.addV2Internal(r.getPageWithoutCache(n));while(n<r.count-1&&this.comparePages(r.getPageWithoutCache(n+1),r.getPageWithoutCache(n)))n++,s.addV2Internal(r.getPageWithoutCache(n));let a=s.getByIndex(0);if(null!=a){if(s.getPage(a),this.usePageHeadersAndFooters){let t=new f(o,o.renderedPages),e=(t.cacheMode=o.renderedPages.cacheMode,t.add(s.getByIndex(0)),this.matrix=new J.c.StiMatrix(t,Z.StiOptions.Export.Word.divideBigCells,this),this.matrix.scanComponentsPlacement(!1),0),i=0,r=!1;i=this.matrix.coordY.countItems-1-1;while(0<i&&this.matrix.linePlacement[i]!=J.c.StiTableLineInfo.PageHeader)i--;if(0<=i&&this.matrix.linePlacement[i]==J.c.StiTableLineInfo.PageHeader){e=0;while(this.matrix.linePlacement[e]!=J.c.StiTableLineInfo.PageHeader)e++;r=!0}this.headersData.push(this.writeHeader(e,i,r,a,l)),null!=this.headersData[c]&&(0<this.imageCache.imagePackedStore.length||l)?this.headersRels.push(this.writeHeaderFooterRels(l)):this.headersRels.push(null);let n=!1;e=0;while(this.matrix.linePlacement[e]!=J.c.StiTableLineInfo.PageFooter&&e<this.matrix.coordY.countItems-1-1)e++;if(this.matrix.linePlacement[e]==J.c.StiTableLineInfo.PageFooter){i=this.matrix.coordY.countItems-1-1;while(this.matrix.linePlacement[i]!=J.c.StiTableLineInfo.PageFooter)i--;n=!0}this.footersData.push(this.writeFooter(e,i,n,a,l)),null!=this.footersData[c]&&0<this.imageCache.imagePackedStore.length?this.footersRels.push(this.writeHeaderFooterRels(!1)):this.footersRels.push(null),this.matrix=new J.c.StiMatrix(s,Z.StiOptions.Export.Word.divideBigCells,this),this.matrix.scanComponentsPlacement(!0),i=this.matrix.coordY.countItems-1-1,this.writeFromMatrix(h,0,i,!1,a)}else this.headersData.push(this.writeHeader(0,0,!1,a,l)),this.footersData.push(this.writeFooter(0,0,!1,a,l)),null!=this.headersData[c]&&(0<this.imageCache.imagePackedStore.length||l)?this.headersRels.push(this.writeHeaderFooterRels(l)):this.headersRels.push(null),null!=this.footersData[c]&&0<this.imageCache.imagePackedStore.length?this.footersRels.push(this.writeHeaderFooterRels(!1)):this.footersRels.push(null),this.matrix=new J.c.StiMatrix(s,Z.StiOptions.Export.Word.divideBigCells,this,null,J.c.StiDataExportMode.AllBands,t),this.writeFromMatrix(h,0,this.matrix.coordY.countItems-1-1,!0,a);n<r.count-1&&(h.writeStartElement("w:p"),h.writeStartElement("w:pPr"),this.writePageInfo(h,s.getByIndex(0),c),h.writeEndElement(),h.writeEndElement())}n++,c++}return 0<s.count&&this.writePageInfo(h,s.getByIndex(0),c-1),h.writeFullEndElement(),h.writeFullEndElement(),h.writeEndDocument(),h.flush(),e}getPagesBackColor(r){let n=rt.transparent;if(0<r.count){let t=r.getPageWithoutCache(0);n=lt.toColor(t.brush);for(let i=1;i<r.count;i++){let t=r.getPageWithoutCache(i),e=lt.toColor(t.brush);if(!n.equals(e)){n=rt.transparent;break}}}return n}comparePages(t,e){let i=t.excelSheetValue,r=(nt.isNullOrEmpty(i)&&(i=""),e.excelSheetValue);if(nt.isNullOrEmpty(r)&&(r=""),i!=r)return!1;if(t.orientation!=e.orientation)return!1;if(!t.margins.equals(e.margins))return!1;if(t.unlimitedHeight!=e.unlimitedHeight)return!1;return!0}writePageInfo(t,e,i){let r=this.convertHiToTwips(e.unit.convertToHInches(e.pageHeight*(this.usePageHeadersAndFooters?1:e.segmentPerHeight))),n=this.convertHiToTwips(e.unit.convertToHInches(e.pageWidth*(this.usePageHeadersAndFooters?1:e.segmentPerWidth))),a=this.convertHiToTwips(e.unit.convertToHInches(e.margins.left)),s=this.convertHiToTwips(e.unit.convertToHInches(e.margins.right)),o=this.convertHiToTwips(e.unit.convertToHInches(e.margins.top)),l=this.convertHiToTwips(e.unit.convertToHInches(e.margins.bottom))-Z.StiOptions.Export.Word.bottomMarginCorrection,h=this.shiftHeader?.4*o:o,c=this.shiftFooter?.4*l:l;l<0&&(l=0),31500<n&&(n=31500),31500<r&&(r=31500),t.writeStartElement("w:sectPr"),null!=this.headersData[i]&&(t.writeStartElement("w:headerReference"),t.writeAttributeString("w:type","default"),t.writeAttributeString("r:id",`rIdh`+(i+1)),t.writeEndElement()),null!=this.footersData[i]&&(t.writeStartElement("w:footerReference"),t.writeAttributeString("w:type","default"),t.writeAttributeString("r:id",`rIdf`+(i+1)),t.writeEndElement()),t.writeStartElement("w:pgSz"),t.writeAttributeString("w:w",n.toString()),t.writeAttributeString("w:h",r.toString()),e.orientation==S.Landscape&&t.writeAttributeString("w:orient","landscape"),t.writeEndElement(),t.writeStartElement("w:pgMar"),t.writeAttributeString("w:top",o.toString()),t.writeAttributeString("w:right",s.toString()),t.writeAttributeString("w:bottom",l.toString()),t.writeAttributeString("w:left",a.toString()),t.writeAttributeString("w:header",h.toString()),t.writeAttributeString("w:footer",c.toString()),t.writeAttributeString("w:gutter","0"),t.writeEndElement(),t.writeEndElement()}writeBorders(t,e,i,r,n){let a=!0,s=!0;for(let t=0;t<r;t++)null==this.matrix.bordersY.gett(e+t,i)&&(a=!1),null==this.matrix.bordersY.gett(e+t,i+n)&&(s=!1);let o=!0,l=!0;for(let t=0;t<n;t++)null==this.matrix.bordersX.gett(e,i+t)&&(o=!1),null==this.matrix.bordersX.gett(e+r,i+t)&&(l=!1);(o||a||l||s)&&(t.writeStartElement("w:tcBorders"),o&&this.writeBorderData(t,"w:top",this.matrix.bordersX.gett(e,i)),a&&this.writeBorderData(t,"w:left",this.matrix.bordersY.gett(e,i)),l&&this.writeBorderData(t,"w:bottom",this.matrix.bordersX.gett(e+r,i)),s&&this.writeBorderData(t,"w:right",this.matrix.bordersY.gett(e,i+n)),t.writeEndElement())}writeBorderData(e,i,r){if(null!=r){let t=this.getLineStyle(r.style);""!=t&&(e.writeStartElement(i),e.writeAttributeString("w:val",t),e.writeAttributeString("w:sz",$.trunc(5*r.size).toString()),e.writeAttributeString("w:space","0"),e.writeAttributeString("w:color",this.getColorString(r.color)),e.writeEndElement())}}writeFootNotes(){let t=new K,e=new w(u.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?d.None:d.Indented,e.writeStartDocument(),e.writeStartElement("w:footnotes"),e.writeAttributeString("xmlns:ve","http://schemas.openxmlformats.org/markup-compatibility/2006"),e.writeAttributeString("xmlns:o","urn:schemas-microsoft-com:office:office"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeAttributeString("xmlns:m","http://schemas.openxmlformats.org/officeDocument/2006/math"),e.writeAttributeString("xmlns:v","urn:schemas-microsoft-com:vml"),e.writeAttributeString("xmlns:wp","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"),e.writeAttributeString("xmlns:w10","urn:schemas-microsoft-com:office:word"),e.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),e.writeAttributeString("xmlns:wne","http://schemas.microsoft.com/office/word/2006/wordml"),e.writeStartElement("w:footnote"),e.writeAttributeString("w:type","separator"),e.writeAttributeString("w:id","0"),e.writeStartElement("w:p"),e.writeStartElement("w:r"),e.writeStartElement("w:separator"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeStartElement("w:footnote"),e.writeAttributeString("w:type","continuationSeparator"),e.writeAttributeString("w:id","1"),e.writeStartElement("w:p"),e.writeStartElement("w:r"),e.writeStartElement("w:continuationSeparator"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeEndNotes(){let t=new K,e=new w(u.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?d.None:d.Indented,e.writeStartDocument(),e.writeStartElement("w:endnotes"),e.writeAttributeString("xmlns:ve","http://schemas.openxmlformats.org/markup-compatibility/2006"),e.writeAttributeString("xmlns:o","urn:schemas-microsoft-com:office:office"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeAttributeString("xmlns:m","http://schemas.openxmlformats.org/officeDocument/2006/math"),e.writeAttributeString("xmlns:v","urn:schemas-microsoft-com:vml"),e.writeAttributeString("xmlns:wp","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"),e.writeAttributeString("xmlns:w10","urn:schemas-microsoft-com:office:word"),e.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),e.writeAttributeString("xmlns:wne","http://schemas.microsoft.com/office/word/2006/wordml"),e.writeStartElement("w:endnote"),e.writeAttributeString("w:type","separator"),e.writeAttributeString("w:id","0"),e.writeStartElement("w:p"),e.writeStartElement("w:r"),e.writeStartElement("w:separator"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeStartElement("w:endnote"),e.writeAttributeString("w:type","continuationSeparator"),e.writeAttributeString("w:id","1"),e.writeStartElement("w:p"),e.writeStartElement("w:r"),e.writeStartElement("w:continuationSeparator"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeHeader(t,e,i,r,n){let a=new K,s=new w(u.UTF8,a),o=(s.indentation=this.xmlIndentation<0?0:this.xmlIndentation,s.formatting=this.xmlIndentation<0?d.None:d.Indented,s.writeStartDocument(),s.writeStartElement("w:hdr"),s.writeAttributeString("xmlns:ve","http://schemas.openxmlformats.org/markup-compatibility/2006"),s.writeAttributeString("xmlns:o","urn:schemas-microsoft-com:office:office"),s.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),s.writeAttributeString("xmlns:m","http://schemas.openxmlformats.org/officeDocument/2006/math"),s.writeAttributeString("xmlns:v","urn:schemas-microsoft-com:vml"),s.writeAttributeString("xmlns:wp","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"),s.writeAttributeString("xmlns:w10","urn:schemas-microsoft-com:office:word"),s.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),s.writeAttributeString("xmlns:wne","http://schemas.microsoft.com/office/word/2006/wordml"),i&&this.writeFromMatrix(s,t,e,!0),this.writeWatermark(s,r,!0,!0,!0));if(n){0==this.additionalIndex&&(this.additionalIndex=5+this.imageCache.addImageInt(_t.getImageFromObject(J.c.StiExportUtils.additionalData),J.a.ImageFormat.Png));let t=(this.spriteIndex++).toString();o||(s.writeStartElement("w:p"),o=!0),s.writeRaw('<w:pPr><w:pStyle w:val="a3"/></w:pPr><w:r><w:rPr><w:noProof/><w:lang w:eastAsia="ru-RU"/></w:rPr><w:pict>'+'<v:shapetype id="_x0000_t'+t+'" coordsize="21600,21600" o:spt="'+t+'" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f"> <v:stroke joinstyle="miter"/> <v:formulas>'+'<v:f eqn="if lineDrawn pixelLineWidth 0"/><v:f eqn="sum @0 1 0"/><v:f eqn="sum 0 0 @1"/><v:f eqn="prod @2 1 2"/><v:f eqn="prod @3 21600 pixelWidth"/><v:f eqn="prod @3 21600 pixelHeight"/><v:f eqn="sum @0 0 1"/>'+'<v:f eqn="prod @6 1 2"/><v:f eqn="prod @7 21600 pixelWidth"/><v:f eqn="sum @8 21600 0"/><v:f eqn="prod @7 21600 pixelHeight"/><v:f eqn="sum @10 21600 0"/></v:formulas><v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>'+'<o:lock v:ext="edit" aspectratio="t"/></v:shapetype><v:shape id="WordPictureWatermark117770'+t+'" o:spid="_x0000_s20'+t+'" type="#_x0000_t'+t+'" '+'style="position:absolute;margin-left:0;margin-top:0;width:467.45pt;height:381pt;z-index:282657216;mso-position-horizontal:center;mso-position-horizontal-relative:page;mso-position-vertical:center;mso-position-vertical-relative:page" '+'o:allowincell="f"><v:imagedata r:id="rId'+this.additionalIndex.toString()+'" o:title="additional"/></v:shape></w:pict></w:r>')}if(o&&s.writeEndElement(),this.shiftHeader=!i,!o&&!i){if(!this.hasHeader)return s.close(),null;s.writeStartElement("w:p"),s.writeStartElement("w:r"),s.writeEndElement(),s.writeEndElement()}return this.hasHeader=!0,s.writeFullEndElement(),s.writeEndDocument(),s.flush(),a}writeFooter(t,e,i,r,n){let a=new K,s=new w(u.UTF8,a);if(s.indentation=this.xmlIndentation<0?0:this.xmlIndentation,s.formatting=this.xmlIndentation<0?d.None:d.Indented,s.writeStartDocument(),s.writeStartElement("w:ftr"),s.writeAttributeString("xmlns:ve","http://schemas.openxmlformats.org/markup-compatibility/2006"),s.writeAttributeString("xmlns:o","urn:schemas-microsoft-com:office:office"),s.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),s.writeAttributeString("xmlns:m","http://schemas.openxmlformats.org/officeDocument/2006/math"),s.writeAttributeString("xmlns:v","urn:schemas-microsoft-com:vml"),s.writeAttributeString("xmlns:wp","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"),s.writeAttributeString("xmlns:w10","urn:schemas-microsoft-com:office:word"),s.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),s.writeAttributeString("xmlns:wne","http://schemas.microsoft.com/office/word/2006/wordml"),this.shiftFooter=!i,i)this.writeFromMatrix(s,t,e,!0);else{if(!this.hasFooter)return s.close(),null;s.writeStartElement("w:p"),s.writeStartElement("w:r"),s.writeEndElement(),s.writeEndElement()}return this.hasFooter=!0,s.writeFullEndElement(),s.writeEndDocument(),s.flush(),a}writeWatermark(m,g,t,e,p){let d=!1;if(!g.watermark.enabled)return d;if(t){let c=this.exportCache.getImageIndex(g);if(null==c){let t=g.watermark.getImage(g.report);null!=t&&(c=this.imageCache.addImageIntRaw(t,t.imageFormat))}if(null!=c){d=!0;let r=this.imageCache.imageSizeStore[c].width,n=this.imageCache.imageSizeStore[c].height,t=g.watermark.showImageBehind?-251656192:251656192,e=(this.spriteIndex++).toString(),a=r*g.watermark.imageMultipleFactor/100,s=n*g.watermark.imageMultipleFactor/100;if(g.watermark.imageStretch&&(a=g.unit.convertToHInches(g.pageWidth)/100,s=g.unit.convertToHInches(g.pageHeight)/100,g.watermark.aspectRatio)){let t=g.unit.convertToHInches(g.pageWidth)/r,e=g.unit.convertToHInches(g.pageHeight)/n,i=Math.min(t,e);a=r*i/100,s=n*i/100}let i="center",o="center",l=(g.watermark.imageAlignment!=b.TopLeft&&g.watermark.imageAlignment!=b.MiddleLeft&&g.watermark.imageAlignment!=b.BottomLeft||(i="left"),g.watermark.imageAlignment!=b.TopRight&&g.watermark.imageAlignment!=b.MiddleRight&&g.watermark.imageAlignment!=b.BottomRight||(i="right"),g.watermark.imageAlignment!=b.TopLeft&&g.watermark.imageAlignment!=b.TopCenter&&g.watermark.imageAlignment!=b.TopRight||(o="top"),g.watermark.imageAlignment!=b.BottomLeft&&g.watermark.imageAlignment!=b.BottomCenter&&g.watermark.imageAlignment!=b.BottomRight||(o="bottom"),'<v:shapetype id="_x0000_t'+e+'" coordsize="21600,21600" o:spt="'+e+'" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f">'+'<v:stroke joinstyle="miter"/><v:formulas>'+'<v:f eqn="if lineDrawn pixelLineWidth 0"/><v:f eqn="sum @0 1 0"/><v:f eqn="sum 0 0 @1"/><v:f eqn="prod @2 1 2"/>'+'<v:f eqn="prod @3 21600 pixelWidth"/><v:f eqn="prod @3 21600 pixelHeight"/><v:f eqn="sum @0 0 1"/><v:f eqn="prod @6 1 2"/>'+'<v:f eqn="prod @7 21600 pixelWidth"/><v:f eqn="sum @8 21600 0"/><v:f eqn="prod @7 21600 pixelHeight"/><v:f eqn="sum @10 21600 0"/></v:formulas>'+'<v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/><o:lock v:ext="edit" aspectratio="t"/></v:shapetype>'),h=new ct;h.append("position:absolute;margin-left:0;margin-top:0;"),h.appendFormat("width:{0}in;height:{1}in;z-index:{2};",a,s,t),h.appendFormat("mso-position-horizontal:{0};mso-position-horizontal-relative:page;mso-position-vertical:{1};mso-position-vertical-relative:page;",i,o),p&&m.writeStartElement("w:p"),m.writeStartElement("w:r"),m.writeStartElement("w:rPr"),m.writeStartElement("w:noProof"),m.writeEndElement(),m.writeEndElement(),m.writeStartElement("w:pict"),m.writeRaw(l),m.writeStartElement("v:shape"),m.writeAttributeString("id","WordPictureWatermark12345"+e),m.writeAttributeString("o:spid","_x0000_s20"+e),m.writeAttributeString("type","#_x0000_t"+e),m.writeAttributeString("style",h.toString()),m.writeAttributeString("o:allowincell","f"),m.writeStartElement("v:imagedata"),m.writeAttributeString("r:id","rId"+(c+5).toString()),m.writeEndElement(),m.writeStartElement("w10:wrap"),m.writeAttributeString("anchorx","page"),m.writeAttributeString("anchory","page"),m.writeEndElement(),m.writeEndElement(),m.writeEndElement(),m.writeEndElement()}}if(e&&!nt.isNullOrWhiteSpace(g.watermark.text)){let t=g.watermark.showBehind?-241656192:271656192,e=(this.spriteIndex++).toString(),i=Kt.measureString(g.watermark.text,g.watermark.font),r=i.width*J.a.StiDpiHelper.deviceCapsScale/100,n=i.height*J.a.StiDpiHelper.deviceCapsScale/100,a=-g.watermark.angle,s=(a<0&&(a=360+a),'<v:shapetype id="_x0000_t'+e+'" coordsize="21600,21600" o:spt="'+e+'" adj="10800" path="m@7,l@8,m@5,21600l@6,21600e">'+'<v:formulas><v:f eqn="sum #0 0 10800"/><v:f eqn="prod #0 2 1"/><v:f eqn="sum 21600 0 @1"/><v:f eqn="sum 0 0 @2"/>'+'<v:f eqn="sum 21600 0 @3"/><v:f eqn="if @0 @3 0"/><v:f eqn="if @0 21600 @1"/><v:f eqn="if @0 0 @2"/><v:f eqn="if @0 @4 21600"/>'+'<v:f eqn="mid @5 @6"/><v:f eqn="mid @8 @5"/><v:f eqn="mid @7 @8"/><v:f eqn="mid @6 @7"/><v:f eqn="sum @6 0 @5"/></v:formulas>'+'<v:path textpathok="t" o:connecttype="custom" o:connectlocs="@9,0;@10,10800;@11,21600;@12,10800" o:connectangles="270,180,90,0"/>'+'<v:textpath on="t" fitshape="t"/><v:handles><v:h position="#0,bottomRight" xrange="6629,14971"/></v:handles>'+'<o:lock v:ext="edit" text="t" shapetype="t"/></v:shapetype>'),o=new ct,l=(o.append("position:absolute;margin-left:0;margin-top:0;"),o.appendFormat("width:{0}in;height:{1}in;z-index:{2};rotation:{3};",r,n,t,a),o.append("mso-position-horizontal:center;mso-position-horizontal-relative:page;mso-position-vertical:center;mso-position-vertical-relative:page;"),new ct);l.append('font-family:"'+g.watermark.font.name+'"'),g.watermark.font.bold&&l.append(";font-weight:bold"),g.watermark.font.italic&&l.append(";font-style:italic"),p&&!d&&m.writeStartElement("w:p"),m.writeStartElement("w:r"),m.writeStartElement("w:rPr"),m.writeStartElement("w:noProof"),m.writeEndElement(),m.writeEndElement(),m.writeStartElement("w:pict"),m.writeRaw(s),m.writeStartElement("v:shape"),m.writeAttributeString("id","PowerPlusWaterMarkObject264"+e),m.writeAttributeString("o:spid","_x0000_s20"+e),m.writeAttributeString("type","#_x0000_t"+e),m.writeAttributeString("style",o.toString()),m.writeAttributeString("o:allowincell","f"),m.writeAttributeString("fillcolor","#"+nt.format("{0:X8}",lt.toColor(g.watermark.textBrush).toArgb()).substr(2)),m.writeAttributeString("stroked","f"),m.writeStartElement("v:fill"),m.writeAttributeString("opacity",$.round2(lt.toColor(g.watermark.textBrush).a/255,3).toString()),m.writeEndElement(),m.writeStartElement("v:textpath"),m.writeAttributeString("style",l.toString()),m.writeAttributeString("string",g.watermark.text[Z.System.StiObject.stimulsoft]().replaceAll("\r","")),m.writeEndElement(),m.writeEndElement(),m.writeEndElement(),m.writeEndElement(),d=!0}return d}writeContentTypes(){let t=new K,e=new w(u.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?d.None:d.Indented,e.writeStartDocument(),e.writeStartElement("Types"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/content-types"),e.writeStartElement("Default"),e.writeAttributeString("Extension","rels"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-package.relationships+xml"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","xml"),e.writeAttributeString("ContentType","application/xml"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","jpeg"),e.writeAttributeString("ContentType","image/jpeg"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","emf"),e.writeAttributeString("ContentType","image/x-emf"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","rtf"),e.writeAttributeString("ContentType","application/rtf"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","png"),e.writeAttributeString("ContentType","image/png"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/docProps/app.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.extended-properties+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/docProps/core.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-package.core-properties+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/word/document.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/word/styles.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/word/settings.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/word/webSettings.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.webSettings+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/word/fontTable.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/word/footnotes.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/word/endnotes.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.endnotes+xml"),e.writeEndElement();for(let t=0;t<this.headersData.length;t++)null!=this.footersData[t]&&(e.writeStartElement("Override"),e.writeAttributeString("PartName",nt.format("/word/footer{0}.xml",t+1)),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml"),e.writeEndElement()),null!=this.headersData[t]&&(e.writeStartElement("Override"),e.writeAttributeString("PartName",nt.format("/word/header{0}.xml",t+1)),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml"),e.writeEndElement());return e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeMainRels(){let t=new K,e=new w(u.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?d.None:d.Indented,e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId1"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument"),e.writeAttributeString("Target","word/document.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId2"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties"),e.writeAttributeString("Target","docProps/core.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId3"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties"),e.writeAttributeString("Target","docProps/app.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeDocPropsApp(){let t,e=new K,i=new w(u.UTF8,e);return i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?d.None:d.Indented,i.writeStartDocument(),i.writeStartElement("Properties"),i.writeAttributeString("xmlns","http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"),i.writeAttributeString("xmlns:vt","http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"),i.writeElementString("Application",J.c.StiExportUtils.getReportVersion(this.report)),i.writeElementString("Company",null!=(t=this.docCompanyString)?t:""),i.writeElementString("Template","Normal.dotm"),i.writeElementString("TotalTime","0"),i.writeElementString("Pages","1"),i.writeElementString("Words","1"),i.writeElementString("Characters","1"),i.writeElementString("DocSecurity",this.restrictEditing==J.c.StiWordRestrictEditing.No?"0":"8"),i.writeElementString("Lines","1"),i.writeElementString("Paragraphs","1"),i.writeElementString("ScaleCrop","false"),i.writeElementString("LinksUpToDate","false"),i.writeElementString("CharactersWithSpaces","1"),i.writeElementString("SharedDoc","false"),i.writeElementString("HyperlinksChanged","false"),i.writeElementString("AppVersion","12.0000"),i.writeFullEndElement(),i.writeEndDocument(),i.flush(),e}writeDocPropsCore(){let t,e,i,r,n=new K,a=new w(u.UTF8,n),s=(a.indentation=this.xmlIndentation<0?0:this.xmlIndentation,a.formatting=this.xmlIndentation<0?d.None:d.Indented,a.writeStartDocument(),a.writeStartElement("cp:coreProperties"),a.writeAttributeString("xmlns:cp","http://schemas.openxmlformats.org/package/2006/metadata/core-properties"),a.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),a.writeAttributeString("xmlns:dcterms","http://purl.org/dc/terms/"),a.writeAttributeString("xmlns:dcmitype","http://purl.org/dc/dcmitype/"),a.writeAttributeString("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance"),nt.format("{0}{1}",_.now.toString("yyyy-MM-dd"),_.now.toString("THH:mm:ssZ")));return a.writeElementString("dc:title",null!=(t=this.report.reportName)?t:""),a.writeElementString("dc:subject",null!=(e=this.report.reportAlias)?e:""),a.writeElementString("dc:creator",null!=(i=this.report.reportAuthor)?i:""),a.writeElementString("cp:keywords",""),a.writeElementString("dc:description",null!=(r=this.report.reportDescription)?r:""),null!=this.docLastModifiedString&&a.writeElementString("cp:lastModifiedBy",this.docLastModifiedString),a.writeElementString("cp:revision","1"),a.writeStartElement("dcterms:created"),a.writeAttributeString("xsi:type","dcterms:W3CDTF"),a.writeString(s),a.writeEndElement(),a.writeStartElement("dcterms:modified"),a.writeAttributeString("xsi:type","dcterms:W3CDTF"),a.writeString(s),a.writeEndElement(),a.writeElementString("cp:contentStatus",Z.StiVersion.platform()),a.writeFullEndElement(),a.writeEndDocument(),a.flush(),n}writeSettings(t){let e=new K,i=new w(u.UTF8,e),r=(i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?d.None:d.Indented,i.writeStartDocument(),i.writeStartElement("w:settings"),i.writeAttributeString("xmlns:o","urn:schemas-microsoft-com:office:office"),i.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),i.writeAttributeString("xmlns:m","http://schemas.openxmlformats.org/officeDocument/2006/math"),i.writeAttributeString("xmlns:v","urn:schemas-microsoft-com:vml"),i.writeAttributeString("xmlns:w10","urn:schemas-microsoft-com:office:word"),i.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),i.writeAttributeString("xmlns:sl","http://schemas.openxmlformats.org/schemaLibrary/2006/main"),this.restrictEditing!=J.c.StiWordRestrictEditing.No&&this.generateDocumentProtection(i,this.protectionPassword),i.writeStartElement("w:zoom"),i.writeAttributeString("w:percent","100"),i.writeEndElement(),this.getPagesBackColor(t));return r.equals(rt.white)||0==r.a||(i.writeStartElement("w:displayBackgroundShape"),i.writeEndElement()),Z.StiOptions.Export.Word.specifyGrammarAndSpellCheckingAsClean&&(i.writeStartElement("w:proofState"),i.writeAttributeString("w:spelling","clean"),i.writeAttributeString("w:grammar","clean"),i.writeEndElement()),i.writeStartElement("w:defaultTabStop"),i.writeAttributeString("w:val","708"),i.writeEndElement(),i.writeStartElement("w:characterSpacingControl"),i.writeAttributeString("w:val","doNotCompress"),i.writeEndElement(),this.usePageHeadersAndFooters&&(i.writeStartElement("w:footnotePr"),i.writeStartElement("w:footnote"),i.writeAttributeString("w:id","0"),i.writeEndElement(),i.writeStartElement("w:footnote"),i.writeAttributeString("w:id","1"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("w:endnotePr"),i.writeStartElement("w:endnote"),i.writeAttributeString("w:id","0"),i.writeEndElement(),i.writeStartElement("w:endnote"),i.writeAttributeString("w:id","1"),i.writeEndElement(),i.writeEndElement()),i.writeStartElement("w:compat"),12<Z.StiOptions.Export.Word.compatibilityModeValue&&(i.writeStartElement("w:compatSetting"),i.writeAttributeString("w:name","compatibilityMode"),i.writeAttributeString("w:uri","http://schemas.microsoft.com/office/word"),i.writeAttributeString("w:val",Z.StiOptions.Export.Word.compatibilityModeValue.toString()),i.writeEndElement()),i.writeEndElement(),i.writeStartElement("m:mathPr"),i.writeStartElement("m:mathFont"),i.writeAttributeString("m:val","Cambria Math"),i.writeEndElement(),i.writeStartElement("m:brkBin"),i.writeAttributeString("m:val","before"),i.writeEndElement(),i.writeStartElement("m:brkBinSub"),i.writeAttributeString("m:val","--"),i.writeEndElement(),i.writeStartElement("m:smallFrac"),i.writeAttributeString("m:val","off"),i.writeEndElement(),i.writeStartElement("m:dispDef"),i.writeEndElement(),i.writeStartElement("m:lMargin"),i.writeAttributeString("m:val","0"),i.writeEndElement(),i.writeStartElement("m:rMargin"),i.writeAttributeString("m:val","0"),i.writeEndElement(),i.writeStartElement("m:defJc"),i.writeAttributeString("m:val","centerGroup"),i.writeEndElement(),i.writeStartElement("m:wrapIndent"),i.writeAttributeString("m:val","1440"),i.writeEndElement(),i.writeStartElement("m:intLim"),i.writeAttributeString("m:val","subSup"),i.writeEndElement(),i.writeStartElement("m:naryLim"),i.writeAttributeString("m:val","undOvr"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("w:themeFontLang"),i.writeAttributeString("w:val","en-EN"),i.writeEndElement(),i.writeStartElement("w:clrSchemeMapping"),i.writeAttributeString("w:bg1","light1"),i.writeAttributeString("w:t1","dark1"),i.writeAttributeString("w:bg2","light2"),i.writeAttributeString("w:t2","dark2"),i.writeAttributeString("w:accent1","accent1"),i.writeAttributeString("w:accent2","accent2"),i.writeAttributeString("w:accent3","accent3"),i.writeAttributeString("w:accent4","accent4"),i.writeAttributeString("w:accent5","accent5"),i.writeAttributeString("w:accent6","accent6"),i.writeAttributeString("w:hyperlink","hyperlink"),i.writeAttributeString("w:followedHyperlink","followedHyperlink"),i.writeEndElement(),i.writeStartElement("w:shapeDefaults"),i.writeStartElement("o:shapedefaults"),i.writeAttributeString("v:ext","edit"),i.writeAttributeString("spidmax","2050"),i.writeEndElement(),i.writeStartElement("o:shapelayout"),i.writeAttributeString("v:ext","edit"),i.writeStartElement("o:idmap"),i.writeAttributeString("v:ext","edit"),i.writeAttributeString("data","1"),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("w:decimalSymbol"),i.writeAttributeString("w:val",","),i.writeEndElement(),i.writeStartElement("w:listSeparator"),i.writeAttributeString("w:val",";"),i.writeEndElement(),i.writeFullEndElement(),i.writeEndDocument(),i.flush(),e}writeWebSettings(){let t=new K,e=new w(u.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?d.None:d.Indented,e.writeStartDocument(),e.writeStartElement("w:webSettings"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),e.writeStartElement("w:optimizeForBrowser"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeFontTable(){let t=new K,e=new w(u.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?d.None:d.Indented,e.writeStartDocument(),e.writeStartElement("w:fonts"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),this.fontList.set("Calibri","Calibri"),this.fontList.set("Cambria","Cambria");for(let t of this.fontList.values)e.writeStartElement("w:font"),e.writeAttributeString("w:name",t),e.writeFullEndElement();return e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeDocumentRels(){let t=new K,e=new w(u.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?d.None:d.Indented,e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId1"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles"),e.writeAttributeString("Target","styles.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId2"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings"),e.writeAttributeString("Target","settings.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId3"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings"),e.writeAttributeString("Target","webSettings.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId4"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable"),e.writeAttributeString("Target","fontTable.xml"),e.writeEndElement();for(let t=0;t<this.imageCache.imagePackedStore.length;t++)e.writeStartElement("Relationship"),e.writeAttributeString("Id",`rId`+(5+t)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"),e.writeAttributeString("Target",nt.format("media/image{0:D5}.{1}",t+1,J.d.StiOfficeImageFormatHelper.getImageFormatExtension(this.imageCache.imageFormatStore[t]))),e.writeEndElement();e.writeStartElement("Relationship"),e.writeAttributeString("Id",nt.format("rId{0}",5+this.imageCache.imagePackedStore.length+0)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes"),e.writeAttributeString("Target","footnotes.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id",nt.format("rId{0}",5+this.imageCache.imagePackedStore.length+1)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes"),e.writeAttributeString("Target","endnotes.xml"),e.writeEndElement();for(let t=0;t<this.headersData.length;t++)null!=this.headersData[t]&&(e.writeStartElement("Relationship"),e.writeAttributeString("Id",nt.format("rIdh{0}",t+1)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/header"),e.writeAttributeString("Target",nt.format("header{0}.xml",t+1)),e.writeEndElement()),null!=this.footersData[t]&&(e.writeStartElement("Relationship"),e.writeAttributeString("Id",nt.format("rIdf{0}",t+1)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer"),e.writeAttributeString("Target",nt.format("footer{0}.xml",t+1)),e.writeEndElement());if(0<this.hyperlinkList.count)for(let t of this.hyperlinkList.keys)e.writeStartElement("Relationship"),e.writeAttributeString("Id",`hId`+$.trunc(this.hyperlinkList.get(t))),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"),e.writeAttributeString("Target",t),e.writeAttributeString("TargetMode","External"),e.writeEndElement();if(0<this.embedsList.length)for(let t=0;t<this.embedsList.length;t++)e.writeStartElement("Relationship"),e.writeAttributeString("Id",`reId`+(1+t)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/aFChunk"),e.writeAttributeString("Target",nt.format("embeddings/richtext{0:D5}.rtf",t+1)),e.writeAttributeString("TargetMode","Internal"),e.writeEndElement();return e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeHeaderFooterRels(t){let e=new K,i=new w(u.UTF8,e);i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?d.None:d.Indented,i.writeStartDocument(),i.writeStartElement("Relationships"),i.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships");for(let t=0;t<this.imageCache.imagePackedStore.length;t++)i.writeStartElement("Relationship"),i.writeAttributeString("Id",`rId`+(5+t)),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"),i.writeAttributeString("Target",nt.format("media/image{0:D5}.{1}",t+1,J.d.StiOfficeImageFormatHelper.getImageFormatExtension(this.imageCache.imageFormatStore[t]))),i.writeEndElement();return i.writeFullEndElement(),i.writeEndDocument(),i.flush(),e}writeStyles(){let t=new K,i=new w(u.UTF8,t);i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?d.None:d.Indented,i.writeStartDocument(),i.writeStartElement("w:styles"),i.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),i.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),i.writeStartElement("w:style"),i.writeAttributeString("w:type","paragraph"),i.writeAttributeString("w:default","1"),i.writeAttributeString("w:styleId","a"),i.writeStartElement("w:name"),i.writeAttributeString("w:val","Normal"),i.writeEndElement(),i.writeStartElement("w:qFormat"),i.writeEndElement(),i.writeStartElement("w:pPr"),i.writeStartElement("w:spacing"),i.writeAttributeString("w:after","0"),i.writeAttributeString("w:line","240"),i.writeAttributeString("w:lineRule","auto"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("w:rPr"),i.writeStartElement("w:sz"),i.writeAttributeString("w:val",$.round2(2*Z.StiOptions.Export.Word.normalStyleDefaultFontSize).toString()),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("w:style"),i.writeAttributeString("w:type","character"),i.writeAttributeString("w:default","1"),i.writeAttributeString("w:styleId","a0"),i.writeStartElement("w:name"),i.writeAttributeString("w:val","Default Paragraph Font"),i.writeEndElement(),i.writeStartElement("w:uiPriority"),i.writeAttributeString("w:val","1"),i.writeEndElement(),i.writeStartElement("w:semiHidden"),i.writeEndElement(),i.writeStartElement("w:unhideWhenUsed"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("w:style"),i.writeAttributeString("w:type","table"),i.writeAttributeString("w:default","1"),i.writeAttributeString("w:styleId","a1"),i.writeStartElement("w:name"),i.writeAttributeString("w:val","Normal Table"),i.writeEndElement(),i.writeStartElement("w:uiPriority"),i.writeAttributeString("w:val","99"),i.writeEndElement(),i.writeStartElement("w:semiHidden"),i.writeEndElement(),i.writeStartElement("w:unhideWhenUsed"),i.writeEndElement(),i.writeStartElement("w:qFormat"),i.writeEndElement(),i.writeStartElement("w:tblPr"),i.writeStartElement("w:tblInd"),i.writeAttributeString("w:w","0"),i.writeAttributeString("w:type","dxa"),i.writeEndElement(),i.writeStartElement("w:tblCellMar"),i.writeStartElement("w:top"),i.writeAttributeString("w:w","0"),i.writeAttributeString("w:type","dxa"),i.writeEndElement(),i.writeStartElement("w:left"),i.writeAttributeString("w:w","0"),i.writeAttributeString("w:type","dxa"),i.writeEndElement(),i.writeStartElement("w:bottom"),i.writeAttributeString("w:w","0"),i.writeAttributeString("w:type","dxa"),i.writeEndElement(),i.writeStartElement("w:right"),i.writeAttributeString("w:w","0"),i.writeAttributeString("w:type","dxa"),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("w:style"),i.writeAttributeString("w:type","numbering"),i.writeAttributeString("w:default","1"),i.writeAttributeString("w:styleId","a2"),i.writeStartElement("w:name"),i.writeAttributeString("w:val","No List"),i.writeEndElement(),i.writeStartElement("w:uiPriority"),i.writeAttributeString("w:val","99"),i.writeEndElement(),i.writeStartElement("w:semiHidden"),i.writeEndElement(),i.writeStartElement("w:unhideWhenUsed"),i.writeEndElement(),i.writeEndElement();for(let e=0;e<this.styleList.length;e++){let t=this.styleList[e];i.writeStartElement("w:style"),i.writeAttributeString("w:type","paragraph"),i.writeAttributeString("w:customStyle","1"),i.writeAttributeString("w:styleId",`Style`+e),i.writeStartElement("w:name"),i.writeAttributeString("w:val",t.name),i.writeEndElement(),i.writeStartElement("w:basedOn"),i.writeAttributeString("w:val","a"),i.writeEndElement(),i.writeStartElement("w:rPr"),i.writeStartElement("w:rFonts"),i.writeAttributeString("w:ascii",t.fontName),i.writeAttributeString("w:hAnsi",t.fontName),i.writeAttributeString("w:cs",t.fontName),i.writeEndElement(),t.bold&&(i.writeStartElement("w:b"),i.writeEndElement()),t.italic&&(i.writeStartElement("w:i"),i.writeEndElement()),t.underline&&(i.writeStartElement("w:u"),i.writeAttributeString("w:val","single"),i.writeEndElement()),i.writeStartElement("w:color"),i.writeAttributeString("w:val",this.getColorString(t.textColor)),i.writeEndElement(),i.writeStartElement("w:sz"),i.writeAttributeString("w:val",t.fontSize.toString()),i.writeEndElement(),0!=Z.StiOptions.Export.Word.spaceBetweenCharacters&&(i.writeStartElement("w:spacing"),i.writeAttributeString("w:val",Z.StiOptions.Export.Word.spaceBetweenCharacters.toString()),i.writeEndElement()),t.rightToLeft&&(t.bold&&(i.writeStartElement("w:bCs"),i.writeEndElement()),t.italic&&(i.writeStartElement("w:iCs"),i.writeEndElement()),i.writeStartElement("w:szCs"),i.writeAttributeString("w:val",t.fontSize.toString()),i.writeEndElement(),i.writeStartElement("w:rtl"),i.writeEndElement()),i.writeEndElement(),i.writeEndElement()}return i.writeFullEndElement(),i.writeEndDocument(),i.flush(),t}writeImage(t){let e=new K,i=this.imageCache.imagePackedStore[t];return null!=i&&e.write(i,0,i.length),e}exportWord(a,s,t){if(null==Z.Base[["St","iL","ic","en","se"].join("")].key&&console.warn("You are using a trial version of the Stimulsoft product!"),J.a.StiLogService.write(this[Z.System.StiObject.stimulsoft]().getType(),"Export report to Word 2007 format"),null==t)throw new Error("The 'settings' argument cannot be equal in null.");let o=t.pageRange,l=(this.usePageHeadersAndFooters=t.usePageHeadersAndFooters,this.removeEmptySpaceAtBottom=t.removeEmptySpaceAtBottom,this.imageResolution=t.imageResolution,this.imageQuality=t.imageQuality,this.imageFormat=t.imageFormat,this.docCompanyString=t.companyString,this.docLastModifiedString=t.lastModifiedString,this.restrictEditing=t.restrictEditing,this.protectionPassword=t.protectionPassword,t.encryptionPassword),e=(this.xmlIndentation=-1,this.imageQuality<0&&(this.imageQuality=0),1<this.imageQuality&&(this.imageQuality=1),this.imageResolution<10&&(this.imageResolution=10),this.imageResolution=this.imageResolution/100,1!=Z.StiOptions.Export.Word.lineSpacing&&(this.lineSpace=$.round2(240*Z.StiOptions.Export.Word.lineSpacing).toString(),this.lineSpace2=$.round2(Z.StiOptions.Export.Word.lineSpacing*H.defaultFontHeightCorrection*240).toString()),Z.StiOptions.Export.Word.restrictEditing>this.restrictEditing&&(this.restrictEditing=Z.StiOptions.Export.Word.restrictEditing),this.report=a,q.currentCulture);try{q.currentCulture=this.englishCulture,this.styleList=[],this.fontList=new C,this.bookmarkList=new C,this.hyperlinkList=new C,this.embedsList=[],null!=this.exportCache?this.imageCache=this.exportCache.imageCache:this.imageCache=new J.a.StiImageCache(Z.StiOptions.Export.Word.allowImageComparer,!0,this.imageFormat,this.imageQuality,!1),this.currentPassNumber=0,this.maximumPassNumber=3+(Z.StiOptions.Export.Word.divideSegmentPages?1:0);let e=!1,i=o.getSelectedPages(a.renderedPages);if(Z.StiOptions.Export.Word.divideSegmentPages){let t=!0;if(t=this.usePageHeadersAndFooters&&0<i.count&&i.getByIndex(0).unlimitedHeight&&1==i.getByIndex(0).segmentPerWidth?!1:t){let t=J.c.StiSegmentPagesDivider.divide(i,this,this.exportCache);i!=t&&(e=!0),i=t,this.currentPassNumber++}}let r=new p,t=null,n=(nt.isNullOrWhiteSpace(l)?r.begin(s,!0):(t=new K,r.begin(t,!0)),this.headersData=[],this.headersRels=[],this.footersData=[],this.footersRels=[],this.hasHeader=!1,this.hasFooter=!1,this.additionalIndex=0,this.spriteIndex=75,!(Z.Base.vAeXc.eMAio.UUyjq()||Z.Base.vAeXc.eMAio.lAtWS()||this.usePageHeadersAndFooters||(Z.Base.vAeXc.eMAio.rdCzm()||Z.Base.vAeXc.eMAio.CWsHL()||Z.Base.vAeXc.eMAio.tnNVR())&&Z.System.NodeJs.isStandaloneVersion));r.addFile("word/document.xml",this.writeDocument(i,a,e,n),!0);for(let t=0;t<this.headersData.length;t++)null!=this.headersData[t]&&r.addFile(nt.format("word/header{0}.xml",t+1),this.headersData[t]),null!=this.headersRels[t]&&r.addFile(nt.format("word/_rels/header{0}.xml.rels",t+1),this.headersRels[t]),null!=this.footersData[t]&&r.addFile(nt.format("word/footer{0}.xml",t+1),this.footersData[t]),null!=this.footersRels[t]&&r.addFile(nt.format("word/_rels/footer{0}.xml.rels",t+1),this.footersRels[t]);if(r.addFile("word/footnotes.xml",this.writeFootNotes()),r.addFile("word/endnotes.xml",this.writeEndNotes()),r.addFile("[Content_Types].xml",this.writeContentTypes()),r.addFile("_rels/.rels",this.writeMainRels()),r.addFile("docProps/app.xml",this.writeDocPropsApp()),r.addFile("docProps/core.xml",this.writeDocPropsCore()),r.addFile("word/settings.xml",this.writeSettings(i)),r.addFile("word/webSettings.xml",this.writeWebSettings()),r.addFile("word/fontTable.xml",this.writeFontTable()),r.addFile("word/_rels/document.xml.rels",this.writeDocumentRels()),r.addFile("word/styles.xml",this.writeStyles()),0<this.imageCache.imagePackedStore.length)for(let t=0;t<this.imageCache.imagePackedStore.length;t++)r.addFile(nt.format("word/media/image{0:D5}.{1}",t+1,J.d.StiOfficeImageFormatHelper.getImageFormatExtension(this.imageCache.imageFormatStore[t])),this.writeImage(t));r.end(),nt.isNullOrWhiteSpace(l)||(t.flush(),Ht.EncryptPackage(t.toArray(),l,s),t.close())}finally{q.currentCulture=e,null!=this.matrix&&(this.matrix.clear(),this.matrix=null),this.fontList.clear(),this.fontList=null,this.imageCache.clear(),this.imageCache=null,this.styleList[Z.System.StiObject.stimulsoft]().clear(),this.styleList=null,this.bookmarkList.clear(),this.bookmarkList=null,this.hyperlinkList.clear(),this.hyperlinkList=null,this.embedsList[Z.System.StiObject.stimulsoft]().clear(),this.embedsList=null,this.usePageHeadersAndFooters&&(this.headersData[Z.System.StiObject.stimulsoft]().clear(),this.headersData=null,this.headersRels[Z.System.StiObject.stimulsoft]().clear(),this.headersRels=null,this.footersData[Z.System.StiObject.stimulsoft]().clear(),this.footersData=null,this.footersRels[Z.System.StiObject.stimulsoft]().clear(),this.footersRels=null),a.renderedPages.cacheMode&&J.c.StiMatrix.GCCollect()}}}H.fontsToCorrectHeight=null,H.defaultFontHeightCorrection=.772,J.c.StiWordExportService=H,J.c.StiWord2007ExportService=class extends H{}}let v=Z.System.Drawing.Point;{class Ir{static convertArcToCubicBezier(t,e,i,r){let n=i*this.PiDiv180,a=r*this.PiDiv180,s=n+a,o=t.x+e*Math.cos(n),l=t.y+e*Math.sin(n),h=t.x+e*Math.cos(s),c=t.y+e*Math.sin(s),m=e*this.FourDivThree*Math.tan(.25*a),g=Math.atan(m/e),p=e/Math.cos(g),d=(g+=n,t.x+p*Math.cos(g)),w=t.y+p*Math.sin(g),u=(g=Math.atan(-m/e),g+=s,t.x+p*Math.cos(g)),S=t.y+p*Math.sin(g),f=[];return f.push(new v(o,l)),f.push(new v(d,w)),f.push(new v(u,S)),f.push(new v(h,c)),f}static convertArcToCubicBezier2(t,e,i,r,n){let a=r*this.PiDiv180,s=n*this.PiDiv180,o=a+s,l=t.x+e*Math.cos(a),h=t.y+e*Math.sin(a),c=t.x+i*Math.cos(o),m=t.y+i*Math.sin(o),g=(e-i)/3,p=(i+=g,(e-=g)*this.FourDivThree*Math.tan(.25*s)),d=Math.atan(p/e),w=e/Math.cos(d),u=(d+=a,t.x+w*Math.cos(d)),S=t.y+w*Math.sin(d),f=(d=Math.atan(-p/e),d+=o,t.x+w*Math.cos(d)),b=t.y+w*Math.sin(d),E=[];return E.push(new v(l,h)),E.push(new v(u,S)),E.push(new v(f,b)),E.push(new v(c,m)),E}}Ir.PiDiv180=Math.PI/180,Ir.FourDivThree=4/3,J.c.StiGaugeDrawingHelper=Ir}let Qt=Z.System.StiObject,Zt=Z.Base.Drawing.StiCornerRadius,Jt=J.a.Components.Table.StiTableCell,$t=J.a.Components.StiPrimitive,te=J.a.Components.StiMargins,ee=Z.Base.StiSignatureFontsHelper,ie=Z.Base.Drawing.StiSolidBrush,re=Z.Base.Drawing.StiImageConverter,ne=J.a.Components.StiSignatureMode,ae=J.a.Components.StiElectronicSignature,se=J.a.Components.StiPdfDigitalSignature,oe=J.a.Components.Gauge.IStiGauge,le=J.a.Components.StiHtmlTextRender,he=J.c.StiPdfEmbeddedFileData,ce=J.a.Components.StiSparkline,me=Z.Base.Drawing.StiColorUtils,ge=J.a.Components.StiDataBarIndicator,pe=J.a.Components.StiIconSetHelper,de=J.a.Components.StiIcon,we=J.a.Components.StiIconSetIndicator,ue=J.a.Components.StiBookmarksCollection,Se=J.a.Components.StiBookmark,fe=Z.Base.Drawing.StiHtmlTag,be=Z.Base.Drawing.StiLinearGradientBrush,Ee=Z.Base.Drawing.StiGlareBrush,ve=Z.Base.Drawing.StiHatchBrush,ye=Z.Base.Drawing.StiGlassBrush,xe=J.a.Components.StiPage,Ae=J.a.Chart.IStiChart,Te=J.a.BarCodes.StiBarCode,Fe=Z.System.Drawing.Drawing2D.Matrix,Ce=J.a.Dictionary.StiResourceType,Pe=J.a.Components.StiDataBarTextPlacement;{let F=Z.System.Drawing.Rectangle;class Rr{get Right(){return this.X+this.Width}get Top(){return this.Y+this.Height}clone(){let t=new Rr(this.service);return t.X=this.X,t.Y=this.Y,t.Width=this.Width,t.Height=this.Height,t.Component=this.Component,t}constructor(t){this.X=0,this.Y=0,this.Width=0,this.Height=0,this.Component=null,this.service=null,this.service=t}}J.c.StiPdfData=Rr;class Nr{}J.c.StiImageData=Nr;class Mr{}J.c.StiShadingData=Mr;class Or{}J.c.StiShadingFunctionData=Or;class Hr{constructor(){this.FontColor=rt.black}}J.c.StiEditableObject=Hr;class Wr{}J.c.StiLinkObject=Wr;class zr{}class Ur extends J.c.StiExportService{constructor(){super(...arguments),this.multipleFiles=!1,this.imageQuality=.75,this.imageResolutionMain=1,this.imageResolutionMode=J.c.StiImageResolutionMode.Auto,this.sw=null,this.pageStream=null,this.imageList=null,this.imageCache=null,this.exportCache=null,this.imageInterpolationTable=null,this.imageCacheIndexToList=null,this.imageInfoList=null,this.imageInfoCounter=0,this.colorTable=it.create(String,256),this.alphaTable=it.create(Boolean,256),this.pdfFont=null,this.standardPdfFonts=!0,this.embeddedFonts=!1,this.useUnicodeMode=!1,this.reduceFontSize=!0,this.compressed=!1,this.compressedFonts=!1,this.encrypted=!1,this.usePdfA=!1,this.pdfComplianceMode=J.c.StiPdfComplianceMode.None,this.exportRtfTextAsImage=!1,this.autoPrint=J.c.StiPdfAutoPrintMode.None,this.imageCompressionMethod=J.c.StiPdfImageCompressionMethod.Jpeg,this.imageFormat=J.c.StiImageFormat.Color,this.monochromeDitheringType=J.c.StiMonochromeDitheringType.FloydSteinberg,this.allowEditable=J.c.StiPdfAllowEditable.No,this.useTransparency=!0,this.embeddedFiles=null,this.zugferdComplianceMode=J.c.StiPdfZUGFeRDComplianceMode.None,this.zugferdConformanceLevel="BASIC",this.fontGlyphsReduceNotNeed=null,this.bookmarksTree=null,this.bookmarksTreeTemp=null,this.linksArray=null,this.tagsArray=null,this.tooltipsArray=null,this.shadingArray=null,this.hatchArray=null,this.shadingFunctionArray=null,this.haveBookmarks=!1,this.haveLinks=!1,this.haveAnnots=!1,this.haveTooltips=!1,this.CodePage1252part80AF=[8364,8226,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,8226,381,8226,8226,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,8226,382,376],this.CodePage1252=it.create(Number,256),this.hiToTwips=.72,this.precision_digits_font=3,this.pdfCKT=.55228,this.IDValue=null,this.IDValueString="",this.IDValueStringMeta="",this.currentDateTime="",this.currentDateTimeMeta="",this.producerName="Stimulsoft Reports",this.creatorName="",this.keywords="",this.keyLength=J.c.StiPdfEncryptionKeyLength.Bit40,this.lastColorStrokeA=255,this.lastColorNonStrokeA=255,this.colorStack=null,this.info=null,this.haveDigitalSignature=!1,this.pdfSecurity=null,this.tempGeomWriter=null,this.lastProcessedComponent=null,this.colorHash1=new C,this.colorHash2=new C,this._gsTable=null}implements(){let t=[J.c.IStiPdfExportService];return(this.implements=()=>t)()}get exportFormat(){return J.a.StiExportFormat.Pdf}exportTo(i,t,r){if(null==this.exportCache){let t=r,e=t.imageCompressionMethod==J.c.StiPdfImageCompressionMethod.Jpeg?J.a.ImageFormat.Jpeg:J.a.ImageFormat.MemoryBmp;this.exportCache=new J.c.StiExportImageCache(e,!0,new J.a.StiImageCache(Z.StiOptions.Export.Pdf.allowImageComparer,!0,e,t.imageQuality),Math.max(t.imageResolution,10)/100,i)}this.exportPdf1(i,t,r)}exportToAsync(r,n,a,s){setTimeout(async()=>{var i;try{let t=s,e=t.imageCompressionMethod==J.c.StiPdfImageCompressionMethod.Jpeg?J.a.ImageFormat.Jpeg:J.a.ImageFormat.MemoryBmp;if(this.exportCache=new J.c.StiExportImageCache(e,!0,new J.a.StiImageCache(Z.StiOptions.Export.Pdf.allowImageComparer,!0,e,t.imageQuality),Math.max(t.imageResolution,10)/100,n),await J.c.StiExportImageHelper.convertAllImages(n,Z.System.Drawing.Imaging.ImageFormat.Jpeg,!0,this.exportFormat,this.exportCache),!n.isDocument&&null!=(i=n.getCurrentPage())&&i.is(Lt))return await Ut.export(n,a,s),void r();this.exportTo(n,a,s),await J.c.StiExportImageHelper.restoreImagesWithMask(n),null!=n&&null!=n.preparedExportImages&&(n.preparedExportImages.clear(),n.preparedExportImages=null)}catch(t){if(o.log(t,n,`Export Error`).isImportant)return r(o.getMessage(t))}r()},0)}stringReplace(t,e,i){e=e.replace(Ur.regexEscape,"\\$1");let r=new RegExp(e,"g");return t.replace(r,i)}getHatchNumber(i){if(0<this.hatchArray.length)for(let e=0;e<this.hatchArray.length;e++){let t=this.hatchArray[e];if(i.style==t.style&&i.backColor.equals(t.backColor)&&i.foreColor.equals(t.foreColor))return e}return this.hatchArray.push(i),this.hatchArray.length-1}getShadingFunctionNumber(i){if(0<this.shadingFunctionArray.length)for(let e=0;e<this.shadingFunctionArray.length;e++){let t=this.shadingFunctionArray[e];if(this.isColorArraysEquals(t.Colors,i))return e}let t=new Or;return t.Colors=i,this.shadingFunctionArray.push(t),this.shadingFunctionArray.length-1}isColorArraysEquals(e,i){if(e.length!=i.length)return!1;for(let t=0;t<e.length;t++)if(!e[t].equals(i[t]))return!1;return!0}addXref(t){let e=this.sw.position;this.xref[t]=e.toString()[Z.System.StiObject.stimulsoft]().padLeft(10,"0")+" 00000 n",this.currentObjectNumber=t,this.currentGenerationNumber=0}convertToString(t,e=2){let i=$.round2(t,e);return i.toString().split(",").join(Z.System.Globalization.CultureInfo.currentCulture.numberFormat.numberDecimalSeparator)}static convertToEscapeSequence(i){let r=[40,41,92,13,10,8,12],n="()\\rnbf",a,s;if(null==i)return"";s=new ct;for(let e=0;e<i.length;e++){a=!1;for(let t=0;t<r.length;t++)if(i.charCodeAt(e)==r[t]){s.append("\\"+n[t]),a=!0;break}a||s.append(i.charAt(e))}return s.toString()}static convertToEscapeSequencePlusTabs(i){let r=[40,41,92,13,10,9,8,12],n="()\\rntbf",a,s;if(null==i)return"";s="";for(let e=0;e<i.length;e++){a=!1;for(let t=0;t<r.length;t++)if(i.charCodeAt(e)==r[t]){s+="\\"+n[t],a=!0;break}a||(s+=i.charAt(e))}return s}setStrokeColor(t){let e=this.colorHash1.get(t),i=(null==e&&(e=nt.format("{0} {1} {2} RG",this.colorTable[t.r],this.colorTable[t.g],this.colorTable[t.b]),this.colorHash1.set(t,e)),this.pageStream.writeLine(e),t.a);i!=this.lastColorStrokeA&&Z.StiOptions.Export.Pdf.allowExtGState&&!this.usePdfA&&(this.pageStream.writeLine(this.gsTable[i][0]),this.lastColorStrokeA=i,this.alphaTable[i]=!0)}setNonStrokeColor(t){let e=this.colorHash2.get(t),i=(null==e&&(e=nt.format("{0} {1} {2} rg",this.colorTable[t.r],this.colorTable[t.g],this.colorTable[t.b]),this.colorHash2.set(t,e)),this.pageStream.writeLine(e),t.a);i!=this.lastColorNonStrokeA&&Z.StiOptions.Export.Pdf.allowExtGState&&!this.usePdfA&&(this.pageStream.writeLine(this.gsTable[i][1]),this.lastColorNonStrokeA=i,this.alphaTable[i]=!0)}get gsTable(){if(null==this._gsTable){this._gsTable=it.create2(String,256,2);for(let t=0;t<256;t++)this._gsTable[t][0]=nt.format("/GS{0:X2}S gs",t),this._gsTable[t][1]=nt.format("/GS{0:X2}N gs",t)}return this._gsTable}pushColorToStack(){this.colorStack.push(this.lastColorStrokeA),this.colorStack.push(this.lastColorNonStrokeA)}popColorFromStack(){this.lastColorNonStrokeA=this.colorStack.pop(),this.lastColorStrokeA=this.colorStack.pop()}fillRectBrush(e,i,r=null){let n=lt.toColor(e);if(this.setNonStrokeColor(n),this.storeShadingData2(i.x,i.y,i.width,i.height,e),(e.is(Ft)||e.is(Ee)||e.is(be))&&this.pageStream.writeLine1("/Pattern cs /P{0} scn",1+this.shadingCurrent),e.is(ve)){let t=e;this.pageStream.writeLine1("/Cs1 cs /PH{0} scn",this.getHatchNumber(t)+1)}if(e.is(ye)){let t=e;this.setNonStrokeColor(t.getTopColor()),null==r?this.pageStream.writeLine(this.tempGeomWriter.getRectString4(i.x,i.y+i.height/2,i.width,i.height/2)+"f"):this.pageStream.writeLine(this.tempGeomWriter.getRectWithCornersString(new F(i.x,i.y+i.height/2,i.width,i.height/2),new Zt(r.bottomLeft,r.bottomRight,0,0))+"f"),this.setNonStrokeColor(t.getBottomColor()),null==r?this.pageStream.writeLine(this.tempGeomWriter.getRectString4(i.x,i.y,i.width,i.height/2)+"f"):this.pageStream.writeLine(this.tempGeomWriter.getRectWithCornersString(new F(i.x,i.y,i.width,i.height/2),new Zt(0,0,r.topRight,r.topLeft))+"f"),n=rt.transparent}if(0!=n.a){let t=null==r?null:new Zt(r.bottomLeft,r.bottomRight,r.topRight,r.topLeft);this.pageStream.writeLine(this.tempGeomWriter.getRectWithCornersString(i,t)+"f")}}storeStringLine(t,e,i=!1){let r=t+this.convertToHexString(e,i);this.storeString(r),this.sw.writeLine()}storeString(e){let i=[];for(let t=0;t<e.length;t++)i.push(e.charCodeAt(t));this.sw.write(i)}convertToHexString(a,t,e=!1){let s="";if(nt.isNullOrEmpty(a))if(this.encrypted){let e=this.pdfSecurity.encryptData([],this.currentObjectNumber,this.currentGenerationNumber),i="";for(let t=0;t<e.length;t++)i+=String.fromCharCode(e[t]);s+="("+Ur.convertToEscapeSequencePlusTabs(i)+")"}else s+="()";else{let n=e;for(let t=0;t<a.length;t++)127<a.charCodeAt(t)&&(n=!0);if(this.encrypted){let i=null;if(1==n){i=[];for(let e=0;e<a.length;e++){let t=a.charCodeAt(e);i[2+2*e+0]=t>>8&255,i[2+2*e+1]=255&t}i[0]=254,i[1]=255}else{i=[];for(let t=0;t<a.length;t++)i[t]=a.charCodeAt(t)}let e=this.pdfSecurity.encryptData(i,this.currentObjectNumber,this.currentGenerationNumber),r="";for(let t=0;t<e.length;t++)r+=String.fromCharCode(e[t]);s+="("+Ur.convertToEscapeSequencePlusTabs(r)+")"}else if(1==n){s+="<FEFF";for(let t=0;t<a.length;t++)s+=nt.format("{0:X4}",a.charCodeAt(t));s+=">"}else s+=t?"("+Ur.convertToEscapeSequencePlusTabs(a)+")":"("+a+")"}return s}storeMemoryStream2(e,i){if(this.encrypted){let t=this.pdfSecurity.encryptData(e.toArray(),this.currentObjectNumber,this.currentGenerationNumber);this.sw.writeLine1(nt.format(i,t.length)),this.sw.writeLine(">>"),this.sw.writeLine("stream"),this.sw.write(t,0,t.length)}else this.sw.writeLine1(nt.format(i,e.length)),this.sw.writeLine(">>"),this.sw.writeLine("stream"),e.writeTo(this.sw);e.close()}storeMemoryStream3(e,t){let i=new K;for(let t=0;t<e.length;t++)i.writeByte(e[t]);this.storeMemoryStream2(i,t),i.close()}storeMemoryStream4(e,t){let i=new K;for(let t=0;t<e.length;t++)i.writeByte(e[t]);this.storeMemoryStream2(i,t),i.close()}storeWysiwygSymbols(t,a=-1){let e=[],s=[],i=t.text,o=t.rightToLeft;if(le.drawTextForOutput(t,e,s),this.pdfFont.storeUnicodeSymbolsInMap(i),Z.StiOptions.Export.Pdf.useProperCaseFontNamesFromHtml)for(let r of s){let e=r.fontName,i=!1;for(let t=0;t<e.length;t++)if(tt.isUpper(e,t)){i=!0;break}if(!i){let t=Z.System.Globalization.CultureInfo.ivariantCulture.textInfo.toTitleCase(e),i=null;if(-1!=t.indexOf(",")){let e=t.split(",");for(let t of e)if((i=new X(t,r.fontBase.size,r.fontBase.style)).name.toLowerCase()==t.toLowerCase())break}else i=new X(t,r.fontBase.size,r.fontBase.style);r.fontBase=i,r.fontName=i.name}}for(let n of e){let t=s[n.fontIndex].fontBase,e=this.pdfFont.getFontNumber(t),i=(this.pdfFont.currentFont=e,new ct),r=(i.append(String.fromCharCode(65535)),J.c.StiBidirectionalConvert2.convertString(n.text,o));if(this.pdfFont.storeGlyphsInMap(i.toString()),this.pdfFont.storeUnicodeSymbolsInMap(r),-1!=a&&!nt.isNullOrWhiteSpace(n.href)&&!n.href.trim().startsWith("javascript:")&&!this.usePdfA){let t=new Wr;t.Link=n.href,t.Page=a,this.linksArray.push(t)}}}renderStartDoc(n,a){this.sw.writeLine("%PDF-1.7"),this.sw.write([37,226,227,207,211],0,5),this.sw.writeLine(),this.addXref(1),this.sw.writeLine("1 0 obj"),this.sw.writeLine("<<"),this.keyLength==J.c.StiPdfEncryptionKeyLength.Bit256_r5&&this.sw.writeLine("/Extensions<</ADBE<</BaseVersion/1.7/ExtensionLevel 3>>>>"),this.keyLength==J.c.StiPdfEncryptionKeyLength.Bit256_r6&&this.sw.writeLine("/Extensions<</ADBE<</BaseVersion/1.7/ExtensionLevel 8>>>>"),this.sw.writeLine("/Type /Catalog"),this.sw.writeLine1("/Pages {0} 0 R",this.info.pages.ref),this.sw.writeLine("/MarkInfo<</Marked true>>"),this.sw.writeLine1("/Metadata {0} 0 R",this.info.metadata.ref),this.sw.writeLine1("/OutputIntents {0} 0 R",this.info.outputIntents.ref),this.sw.writeLine1("/StructTreeRoot {0} 0 R",this.info.structTreeRoot.ref),this.haveBookmarks?(this.sw.writeLine1("/Outlines {0} 0 R",this.info.outlines.ref),this.sw.writeLine("/PageMode /UseOutlines")):this.sw.writeLine("/PageMode /UseNone"),Ur.printScaling||(this.sw.writeLine("/ViewerPreferences"),this.sw.writeLine("<<"),this.sw.writeLine("/PrintScaling /None"),this.sw.writeLine(">>")),(this.haveAnnots||this.haveDigitalSignature)&&this.sw.writeLine1("/AcroForm {0} 0 R",this.info.acroForm.ref);let t=this.autoPrint!=J.c.StiPdfAutoPrintMode.None,e=0<this.info.embeddedFilesList.length;if(t||e){if(this.sw.writeLine("/Names <<"),t&&this.sw.writeLine1("/JavaScript {0} 0 R",this.info.embeddedJS.ref),e){this.sw.writeLine("/EmbeddedFiles <<"),this.sw.writeString("/Names [ ");for(let i=0;i<this.info.embeddedFilesList.length;i++){let t=this.embeddedFiles[i],e=nt.format("{0} {1} 0 R ",this.convertToHexString(t.name,!0,!0),this.info.embeddedFilesList[i].ref);this.sw.writeString(e)}this.sw.writeLine("]"),this.sw.writeLine(">>")}this.sw.writeLine(">>")}if(this.zugferdComplianceMode!=J.c.StiPdfZUGFeRDComplianceMode.None||this.pdfComplianceMode==J.c.StiPdfComplianceMode.A3){this.sw.writeString("/AF [ ");for(let t=0;t<this.info.embeddedFilesList.length;t++)this.sw.writeString(nt.format("{0} 0 R ",this.info.embeddedFilesList[t].ref));this.sw.writeLine("]")}this.usePdfA||this.sw.writeLine1("/OCProperties << /OCGs [{0} 0 R] /D << /ON [{0} 0 R] /AS [<</Event /Print /OCGs [{0} 0 R] /Category [/Print]>>] >> >>",this.info.optionalContentGroup.ref),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(2),this.sw.writeLine("2 0 obj"),this.sw.writeLine("<<"),this.storeStringLine("/Producer ",this.producerName,!0),this.storeStringLine("/Creator ",this.creatorName,!0),nt.isNullOrEmpty(n.reportAuthor)||this.storeStringLine("/Author ",n.reportAuthor,!0),nt.isNullOrEmpty(n.reportAlias)||this.storeStringLine("/Subject ",n.reportAlias,!0),nt.isNullOrEmpty(n.reportName)||this.storeStringLine("/Title ",n.reportName,!0),nt.isNullOrEmpty(this.keywords)||this.storeStringLine("/Keywords ",this.keywords,!0),this.storeStringLine("/CreationDate ","D:"+this.currentDateTime),this.storeStringLine("/ModDate ","D:"+this.currentDateTime);for(let t of n.metaTags.list)t.name.startsWith("pdf:")&&this.storeStringLine(nt.format("/{0} ",J.a.StiNameValidator.correctName(t.name.substr(4),!1)),t.tag);this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(3),this.sw.writeLine("3 0 obj"),this.sw.writeLine("<<"),this.sw.writeLine("/Cs1 [/Pattern /DeviceRGB]"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.pages.ref),this.sw.writeLine1("{0} 0 obj",this.info.pages.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Pages"),this.sw.writeString("/Kids [ ");for(let t=0;t<a.count;t++)this.sw.writeString(nt.format("{0} 0 R ",this.info.pageList[t].ref));if(this.sw.writeLine("]"),this.sw.writeLine1("/Count {0}",a.count),Z.StiOptions.Export.Pdf.allowInheritedPageResources){let e=[];e.push("/Resources"),e.push("<<"),e.push("/ProcSet [/PDF /Text /ImageC]"),e.push("/Font"),e.push("<<");for(let t=0;t<this.fontsCounter;t++)e.push(nt.format("/F{0} {1} 0 R",t,this.info.fontList[t].ref));if(e.push(">>"),0<this.imageCache.imageStore.length){e.push("/XObject"),e.push("<<");for(let t=0;t<this.imageCache.imageStore.length;t++)e.push(nt.format("/Image{0} {1} 0 R",t,this.info.xObjectList[t].ref));e.push(">>")}e.push("/Pattern"),e.push("<<"),e.push(nt.format("/P1 {0} 0 R",this.info.patterns.first.ref));for(let t=0;t<this.hatchArray.length;t++)e.push(nt.format("/PH{0} {1} 0 R",1+t,this.info.patterns.hatchItems[t].ref));for(let t=0;t<this.shadingArray.length;t++)e.push(nt.format("/P{0} {1} 0 R",2+t,this.info.patterns.shadingItems[t].ref));e.push(">>"),e.push("/ColorSpace 3 0 R"),Z.StiOptions.Export.Pdf.allowExtGState&&this.useTransparency&&e.push(nt.format("/ExtGState {0} 0 R",this.info.extGState.ref)),this.usePdfA||e.push(nt.format("/Properties << /oc1 {0} 0 R >>",this.info.optionalContentGroup.ref)),e.push(">>");for(let t=0;t<e.length;t++)this.sw.writeLine(e[t])}this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(5),this.sw.writeLine("5 0 obj"),this.sw.writeLine("<<"),this.sw.writeLine("/Type /StructTreeRoot"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(6),this.sw.writeLine("6 0 obj"),this.sw.writeLine("<<"),this.sw.writeLine("/Type /OCG"),this.sw.writeLine("/Name (Printable off)"),this.sw.writeLine("/Usage <<"),this.sw.writeLine("/Print << /PrintState /OFF >>"),this.sw.writeLine("/View << /ViewState /ON >>"),this.sw.writeLine(">>"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("");for(let r=0;r<a.count;r++){this.addXref(this.info.pageList[r].ref),this.sw.writeLine1("{0} 0 obj",this.info.pageList[r].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Page"),this.sw.writeLine("/Parent 4 0 R");let t=a.getByIndex(r),e=this.hiToTwips*n.unit.convertToHInches(t.pageHeight*t.segmentPerHeight),i=this.hiToTwips*n.unit.convertToHInches(t.pageWidth*t.segmentPerWidth);if(14400<e&&(e=14400),14400<i&&(i=14400),this.sw.writeLine1("/MediaBox [ 0 0 {0} {1} ]",this.convertToString(i),this.convertToString(e)),!Z.StiOptions.Export.Pdf.allowInheritedPageResources){let e=[];e.push("/Resources"),e.push("<<"),e.push("/ProcSet [/PDF /Text /ImageC]"),e.push("/Font"),e.push("<<");for(let t=0;t<this.fontsCounter;t++)e.push(nt.format("/F{0} {1} 0 R",t,this.info.fontList[t].ref));if(e.push(">>"),0<this.imageCache.imageStore.length){e.push("/XObject"),e.push("<<");for(let t=0;t<this.imageCache.imageStore.length;t++)e.push(nt.format("/Image{0} {1} 0 R",t,this.info.xObjectList[t].ref));e.push(">>")}let i=new ct;i.append(nt.format("/P1 {0} 0 R",this.info.patterns.first.ref));for(let t=0;t<this.hatchArray.length;t++)i.append(nt.format("/PH{0} {1} 0 R",1+t,this.info.patterns.hatchItems[t].ref));for(let e=0;e<this.shadingArray.length;e++){let t=this.shadingArray[e];t.Page==r&&i.append(nt.format("/P{0} {1} 0 R",2+e,this.info.patterns.shadingItems[e].ref))}e.push("/Pattern << "+i.toString()+" >>"),e.push("/ColorSpace 3 0 R"),Z.StiOptions.Export.Pdf.allowExtGState&&this.useTransparency&&e.push(nt.format("/ExtGState {0} 0 R",this.info.extGState.ref)),this.usePdfA||e.push(nt.format("/Properties << /oc1 {0} 0 R >>",this.info.optionalContentGroup.ref)),e.push(">>");for(let t=0;t<e.length;t++)this.sw.writeLine(e[t])}if(this.sw.writeLine1("/Contents {0} 0 R",this.info.pageList[r].content.ref),this.usePdfA||(this.sw.writeLine("/Group"),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Group"),this.sw.writeLine("/S /Transparency"),this.sw.writeLine("/CS /DeviceRGB"),this.sw.writeLine(">>")),this.haveLinks||this.haveAnnots||this.haveDigitalSignature||this.haveTooltips){if(this.sw.writeLine("/Annots ["),this.haveLinks)for(let e=0;e<this.linksCounter;e++){let t=this.linksArray[e];t.Page==r&&this.sw.writeLine1("{0} 0 R ",this.info.linkList[e].ref)}if(this.haveAnnots){for(let e=0;e<this.annotsCounter;e++){let t=this.annotsArray[e];t.Page==r&&this.sw.writeLine1("{0} 0 R ",this.info.acroForm.annots[e].ref)}for(let e=0;e<this.annots2Counter;e++){let t=this.annots2Array[e];if(t.Page==r)for(let t=0;t<this.info.acroForm.checkBoxes[e].items.length;t++)this.sw.writeLine1("{0} 0 R ",this.info.acroForm.checkBoxes[e].items[t].ref)}for(let e=0;e<this.unsignedSignaturesCounter;e++){let t=this.unsignedSignaturesArray[e];t.Page==r&&this.sw.writeLine1("{0} 0 R ",this.info.acroForm.unsignedSignatures[e].ref)}}this.sw.writeLine("]")}this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}}renderEndDoc(){let t=this.sw.position,e=Qt.keys(this.xref).length;this.sw.writeLine("xref"),this.sw.writeLine1("0 {0}",e+1),this.sw.writeLine("0000000000 65535 f");for(let t=0;t<e;t++)this.sw.writeLine(this.xref[t+1]);this.sw.writeLine("trailer"),this.sw.writeLine("<<"),this.sw.writeLine1("/Size {0}",e+1),this.sw.writeLine("/Root 1 0 R"),this.sw.writeLine("/Info 2 0 R"),this.encrypted&&this.sw.writeLine1("/Encrypt {0} 0 R",this.info.encode.ref),this.sw.writeLine1("/ID[<{0}><{0}>]",this.IDValueString),this.sw.writeLine(">>"),this.sw.writeLine("%"+J.c.StiExportUtils.getReportVersion(this.report)),this.sw.writeLine("%"+Z.StiVersion.platform()),this.sw.writeLine("startxref"),this.sw.writeLine1("{0}",t),this.sw.writeLine("%%EOF")}getCreatorString(){if(!nt.isNullOrEmpty(Z.StiOptions.Export.Pdf.creatorString))return Z.StiOptions.Export.Pdf.creatorString;return J.c.StiExportUtils.getReportVersion(this.report)}renderPageHeader(t){this.addXref(this.info.pageList[t].content.ref),this.sw.writeLine1("{0} 0 obj",this.info.pageList[t].content.ref),this.sw.writeLine("<<"),this.pageStream=new K,this.pageStream.writeLine("2 J")}renderPageFooter(i,r){let t,e=null==(t=this.report.parentReport)?void 0:t.getCurrentPage(),n=this.report.isDocument&&null!=e&&e.is(Lt);if((!Z.Base.vAeXc.eMAio.UUyjq()||n)&&(!Z.Base.vAeXc.eMAio.lAtWS()||!n)&&(!(Z.Base.vAeXc.eMAio.rdCzm()||Z.Base.vAeXc.eMAio.CWsHL()&&!n||Z.Base.vAeXc.eMAio.tnNVR()&&n)||!Z.System.NodeJs.isStandaloneVersion)){let t=r/596*1.4,e=i/840*1.4;t>e?t=e:e=t,this.pageStream.writeLine("q"),this.pushColorToStack(),this.pageStream.writeLine("1 J 1 j 20 w"),this.setStrokeColor(rt.fromArgb(64,100,100,100)),this.pageStream.writeLine1("{0} 0 0 {1} {2} {3} cm 0.707 0.707 -0.707 0.707 0 0 cm 1 0 0 1 -155 -50 cm",this.convertToString(t),this.convertToString(e),this.convertToString(r/2),this.convertToString(i/2)),this.pageStream.writeLine("40 0 m 40 100 l 0 100 m 80 100 l S"),this.pageStream.writeLine("100 0 m 100 70 l 100 45 m 120 65 l 130 72 l 140 68 l S"),this.pageStream.writeLine("170 0 m 170 70 l 169 100 m 171 100 l S"),this.pageStream.writeLine("215 60 m 222 69 l 232 71 l 255 70 l 265 60 l 265 5 l 270 0 l 265 44 m 220 31 l 212 20 l 212 10 l 225 0 l 235 0 l 250 5 l 265 18 l S"),this.pageStream.writeLine("310 0 m 310 100 l S"),this.pageStream.writeLine("Q"),this.popColorFromStack()}if(this.pageStream.position<this.pageStream.length&&this.pageStream.setLength(this.pageStream.position),1==this.compressed){let t=this.pageStream.toArray(),e=J.c.StiExportUtils.makePdfDeflateStream(t);this.storeMemoryStream2(e,"/Filter [/FlateDecode] /Length {0}")}else this.storeMemoryStream2(this.pageStream,"/Filter [] /Length {0}");this.sw.writeLine(),this.pageStream.close(),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")}renderFontTable(){for(let b=0;b<this.fontsCounter;b++){let w=new ct,u=(this.pdfFont.currentFont=b,this.pdfFont.fontList[b]),S=u.Name,f=(Z.StiOptions.Export.useAlternativeFontNames&&Z.StiOptions.Export.alternativeFontNames.containsKey(S)&&(S=Z.StiOptions.Export.alternativeFontNames.get(S)),this.embeddedFonts||J.c.PdfFonts.isFontStimulsoft(u.Name));if(this.pdfFont.UseUnicode){w=new ct(S[Z.System.StiObject.stimulsoft]().replaceAll(" ","#20")),(u.Bold||u.Italic)&&(w.append(","),u.Bold&&w.append("Bold"),u.Italic)&&w.append("Italic"),f&&w.insert(0,nt.format("SR{0}{1}{2}{3}+",String.fromCharCode(24*Math.random()+65),String.fromCharCode(24*Math.random()+65),String.fromCharCode(24*Math.random()+65),String.fromCharCode(24*Math.random()+65))),this.addXref(this.info.fontList[b].ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[b].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Font"),this.sw.writeLine("/Subtype /Type0"),this.sw.writeLine1("/BaseFont /{0}",w),this.sw.writeLine1("/DescendantFonts [{0} 0 R]",this.info.fontList[b].descendantFont.ref),this.sw.writeLine("/Encoding /Identity-H"),this.sw.writeLine1("/ToUnicode {0} 0 R",this.info.fontList[b].toUnicode.ref),this.sw.writeLine1("/Name /F{0}",b),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.fontList[b].descendantFont.ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[b].descendantFont.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Font"),this.sw.writeLine("/Subtype /CIDFontType2"),this.sw.writeLine1("/BaseFont /{0}",w),this.sw.writeLine("/CIDSystemInfo"),this.sw.writeLine("<<"),this.storeStringLine("/Registry","Adobe"),this.storeStringLine("/Ordering","Identity"),this.sw.writeLine("/Supplement 0"),this.sw.writeLine(">>"),this.sw.writeLine1("/FontDescriptor {0} 0 R",this.info.fontList[b].fontDescriptor.ref),this.usePdfA&&this.sw.writeLine("/CIDToGIDMap /Identity"),this.sw.writeString("/W [");let e=this.pdfFont.GlyphList,i=e.length,n=it.create(Number,i),a=it.create(Number,i);for(let t=32;t<i;t++)n[t]=e[t],a[t]=t;for(let r=32;r<n.length-1;r++)for(let i=r+1;i<n.length;i++)if(n[r]>n[i]){let t=n[r],e=(n[r]=n[i],n[i]=t,a[r]);a[r]=a[i],a[i]=e}let r=this.pdfFont.GlyphMapsList[b];for(let e=0;e<r.length-1;e++)if(0<r[e]){let t=new ct;t.append(nt.format("{0} [{1}",e,this.pdfFont.GlyphWidths[e]));while(0<r[e+1])t.append(" "),e++,t.append(this.pdfFont.GlyphWidths[e].toString());t.append("]"),this.sw.writeLine(t.toString())}this.sw.writeLine("]"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.fontList[b].toUnicode.ref);let t="SR+F"+b.toString(),s=(this.sw.writeLine1("{0} 0 obj",this.info.fontList[b].toUnicode.ref),this.sw.writeLine("<<"),new K),o=(s.writeLine("/CIDInit /ProcSet findresource begin"),s.writeLine("12 dict begin"),s.writeLine("begincmap"),s.writeLine("/CIDSystemInfo"),s.writeLine("<<"),s.writeLine("/Registry (Adobe)"),s.writeLine1("/Ordering ({0})",t),s.writeLine("/Supplement 0"),s.writeLine(">> def"),s.writeLine1("/CMapName /{0} def",t),s.writeLine("/CMapType 2 def"),s.writeLine("1 begincodespacerange"),s.writeLine("<0000> <FFFF>"),s.writeLine("endcodespacerange"),this.pdfFont.MappedSymbolsCount-32),l=32;while(0<o){let e=o;100<e&&(e=100),s.writeLine1("{0} beginbfchar",e);for(let t=0;t<e;t++)s.writeLine1("<{0:X4}> <{1:X4}>",this.pdfFont.GlyphList[l],this.pdfFont.UnicodeMapBack[l]),l++;s.writeLine("endbfchar"),o-=e}s.writeLine("endcmap"),s.writeLine("CMapName currentdict /CMap defineresource pop"),s.writeLine("end"),s.writeLine("end"),s.flush();let h=s.toArray();if(s.close(),1==this.compressed){let t=J.c.StiExportUtils.makePdfDeflateStream(h);this.storeMemoryStream2(t,"/Length {0} /Filter [/FlateDecode] /Length1 "+h.length.toString())}else this.storeMemoryStream4(h,"/Length {0} /Filter [] /Length1 {0}");this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.fontList[b].cIDSet.ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[b].cIDSet.ref),this.sw.writeLine("<<");let c=it.create(Boolean,65536+32),m=0;for(let e=0;e<this.pdfFont.GlyphList.length;e++){let t=this.pdfFont.GlyphList[e];65535!=t&&(c[t]=!0,t>m)&&(m=t)}if(0!=r[65535])for(let t=0;t<65535;t++)0<r[t]&&(c[t]=!0,t>m)&&(m=t);let g=$.trunc(m/8)+1,p=it.create(Number,g+1),d=0;while(d<g){let t=8*d,e=0;c[t]&&(e|=128),c[t+1]&&(e|=64),c[t+2]&&(e|=32),c[t+3]&&(e|=16),c[t+4]&&(e|=8),c[t+5]&&(e|=4),c[t+6]&&(e|=2),c[t+7]&&(e|=1),p[d]=e,d++}if(1==this.compressed){let t=J.c.StiExportUtils.makePdfDeflateStream(p);this.storeMemoryStream2(t,"/Length {0} /Filter [/FlateDecode] /Length1 "+p.length.toString())}else this.storeMemoryStream4(p,"/Length {0} /Filter [] /Length1 "+p.length.toString());this.sw.writeLine(""),this.sw.writeLine("endstream")}else{this.addXref(this.info.fontList[b].ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[b].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Font"),1==this.standardPdfFonts?(this.sw.writeLine("/Subtype /Type1"),this.sw.writeLine1("/BaseFont /{0}",u.PdfName)):(this.sw.writeLine("/Subtype /TrueType"),w=new ct(this.stringReplace(S," ","#20")),1!=u.Bold&&1!=u.Italic||(w.append(","),1==u.Bold&&w.append("Bold"),1==u.Italic&&w.append("Italic")),this.sw.writeLine1("/BaseFont /{0}",w),this.sw.writeLine1("/FontDescriptor {0} 0 R",this.info.fontList[b].fontDescriptor.ref)),this.sw.writeLine1("/Encoding {0} 0 R",this.info.fontList[b].encoding.ref);let e=new ct(" ");for(let t=32;t<this.pdfFont.MappedSymbolsCount;t++)e.append(this.pdfFont.Widths[t-32].toString()+" ");if(this.sw.writeLine1("/FirstChar {0}",32),this.sw.writeLine1("/LastChar {0}",this.pdfFont.MappedSymbolsCount-1),this.sw.writeLine1("/Widths [{0}]",e),this.sw.writeLine1("/Name /F{0}",b),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.fontList[b].encoding.ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[b].encoding.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Encoding"),this.sw.writeLine("/BaseEncoding /WinAnsiEncoding"),this.pdfFont.MappedSymbolsCount>this.pdfFont.firstMappedSymbol){let e=new ct(this.pdfFont.firstMappedSymbol.toString()+" ");for(let t=this.pdfFont.firstMappedSymbol;t<this.pdfFont.MappedSymbolsCount;t++)e.append("/"+this.pdfFont.CharPdfNames[t]);this.sw.writeLine1("/Differences [{0}]",e)}this.sw.writeLine(">>")}this.sw.writeLine("endobj"),this.sw.writeLine("");let i=null;if(f&&(i=this.pdfFont.getFontDataBuf(u.Font,this.report)),0==this.standardPdfFonts){this.addXref(this.info.fontList[b].fontDescriptor.ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[b].fontDescriptor.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /FontDescriptor"),this.sw.writeLine1("/FontName /{0}",w),this.sw.writeLine("/Flags 32"),this.sw.writeLine1("/Ascent {0}",this.pdfFont.tmASC),this.sw.writeLine1("/CapHeight {0}",this.pdfFont.CH),this.sw.writeLine1("/Descent {0}",this.pdfFont.tmDESC),this.sw.writeLine1("/FontBBox [{0} {1} {2} {3}]",this.pdfFont.LLX,this.pdfFont.LLY,this.pdfFont.URX,this.pdfFont.URY),this.sw.writeLine1("/ItalicAngle {0}",this.pdfFont.ItalicAngle),this.sw.writeLine1("/StemV {0}",this.pdfFont.StemV),f&&null!=i&&this.sw.writeLine1("/FontFile2 {0} 0 R",this.info.fontList[-1==u.ParentFontNumber?b:u.ParentFontNumber].fontFile2.ref);let t=this.pdfFont.UseUnicode;(t=this.pdfComplianceMode!=J.c.StiPdfComplianceMode.A2&&this.pdfComplianceMode!=J.c.StiPdfComplianceMode.A3?t:!1)&&this.sw.writeLine1("/CIDSet {0} 0 R",this.info.fontList[b].cIDSet.ref),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}if(f){if(null!=i&&0<i.length&&-1==u.ParentFontNumber){if(this.reduceFontSize){let t=this.pdfFont.reduceFontSize(i,u.Name,!this.fontGlyphsReduceNotNeed[b]);null!=t&&(i=t)}if(this.addXref(this.info.fontList[b].fontFile2.ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[b].fontFile2.ref),this.sw.writeLine("<<"),1==this.compressedFonts){if(i instanceof Uint8Array){let t=J.c.StiExportUtils.makePdfDeflateStream(i);this.storeMemoryStream2(t,"/Length {0} /Filter [/FlateDecode] /Length1 "+i.length.toString())}if(i instanceof K){let t=i.toArray(),e=J.c.StiExportUtils.makePdfDeflateStream(t);this.storeMemoryStream2(e,"/Length {0} /Filter [/FlateDecode] /Length1 "+i.length.toString())}}else i instanceof Uint8Array&&this.storeMemoryStream3(i,"/Length {0} /Filter [] /Length1 "+i.length.toString()),i instanceof K&&this.storeMemoryStream2(i,"/Length {0} /Filter [] /Length1 "+i.length.toString());this.sw.writeLine(""),this.sw.writeLine("endstream")}else this.addXref(this.info.fontList[b].fontFile2.ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[b].fontFile2.ref),this.sw.writeLine("<< >>");this.sw.writeLine("endobj"),this.sw.writeLine("")}}}renderImageTable(){if(0<this.imageCache.imageStore.length)for(let o=0;o<this.imageCache.imageStore.length;o++){let t=this.imageCache.imagePackedStore[o],i=this.imageCache.imageMaskStore[o],r=this.imageCacheIndexToList.get(o),e=(null==r&&((r=new Nr).Name=`Name`+o,r.Width=0,r.Height=0),r.ImageFormat),n=(this.addXref(this.info.xObjectList[o].ref),this.sw.writeLine1("{0} 0 obj",this.info.xObjectList[o].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /XObject"),this.sw.writeLine("/Subtype /Image"),this.sw.writeLine1("/ColorSpace /{0}",e==J.c.StiImageFormat.Monochrome?"DeviceGray":"DeviceRGB"),this.sw.writeLine1("/Width {0}",r.Width),this.sw.writeLine1("/Height {0}",r.Height),this.sw.writeLine1("/BitsPerComponent {0}",e==J.c.StiImageFormat.Monochrome?"1":"8"),!this.usePdfA&&this.imageInterpolationTable.containsKey(o)&&this.sw.writeLine("/Interpolate true"),null!=i&&this.sw.writeLine1("/SMask {0} 0 R",this.info.xObjectList[o].mask.ref),this.sw.writeLine1("/Name /{0}",r.Name),"DCTDecode"),a=(this.imageCompressionMethod==J.c.StiPdfImageCompressionMethod.Flate&&(n="FlateDecode"),null==t&&(t=[56,48,56,48,56,48],n="ASCIIHexDecode"),"/Length {0} "+nt.format("/Filter [/{0}]",n)),s=new K;if(s.write(t,0,t.length),this.storeMemoryStream2(s,a),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine(""),null!=i){this.addXref(this.info.xObjectList[o].mask.ref),this.sw.writeLine1("{0} 0 obj",this.info.xObjectList[o].mask.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /XObject"),this.sw.writeLine("/Subtype /Image"),this.sw.writeLine("/ColorSpace /DeviceGray"),this.sw.writeLine("/Matte [ 0 0 0 ]"),this.sw.writeLine1("/Width {0}",r.Width),this.sw.writeLine1("/Height {0}",r.Height),this.sw.writeLine("/BitsPerComponent 8"),!this.usePdfA&&this.imageInterpolationTable.containsKey(o)&&this.sw.writeLine("/Interpolate true");let t="/Length {0} /Filter /FlateDecode",e=new K;e.write(i,0,i.length),this.storeMemoryStream2(e,t),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")}}}renderBookmarksTable(){if(this.haveBookmarks){this.addXref(this.info.outlines.ref),this.sw.writeLine1("{0} 0 obj",this.info.outlines.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Outlines"),this.sw.writeLine1("/First {0} 0 R",this.info.outlines.items[0].ref),this.sw.writeLine1("/Last {0} 0 R",this.info.outlines.items[0].ref),this.sw.writeLine1("/Count {0}",1),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("");for(let e=0;e<this.bookmarksCounter;e++){this.addXref(this.info.outlines.items[e].ref);let t=this.bookmarksTree[e];this.sw.writeLine1("{0} 0 obj",this.info.outlines.items[e].ref),this.sw.writeLine("<<"),this.storeStringLine("/Title ",t.Title,!0),-1!=t.Parent&&this.sw.writeLine1("/Parent {0} 0 R",this.info.outlines.items[t.Parent].ref),-1!=t.Prev&&this.sw.writeLine1("/Prev {0} 0 R",this.info.outlines.items[t.Prev].ref),-1!=t.Next&&this.sw.writeLine1("/Next {0} 0 R",this.info.outlines.items[t.Next].ref),-1!=t.First&&this.sw.writeLine1("/First {0} 0 R",this.info.outlines.items[t.First].ref),-1!=t.Last&&this.sw.writeLine1("/Last {0} 0 R",this.info.outlines.items[t.Last].ref),0<t.Count&&(0==e?this.sw.writeLine1("/Count {0}",t.Count):this.sw.writeLine1("/Count {0}",-t.Count)),-1<t.Y&&this.sw.writeLine1("/Dest [{0} 0 R /XYZ null {1} null]",this.info.pageList[t.Page].ref,this.convertToString(t.Y)),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}}}renderPatternTable(){if(this.addXref(this.info.patterns.resources.ref),this.sw.writeLine1("{0} 0 obj",this.info.patterns.resources.ref),this.sw.writeLine("<< /ProcSet [/PDF] >>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.patterns.first.ref),this.sw.writeLine1("{0} 0 obj",this.info.patterns.first.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Pattern"),this.sw.writeLine("/PatternType 1"),this.sw.writeLine("/PaintType 1"),this.sw.writeLine("/TilingType 1"),this.sw.writeLine("/BBox [0 0 2 2]"),this.sw.writeLine("/XStep 3"),this.sw.writeLine("/YStep 3"),this.sw.writeLine1("/Resources {0} 0 R",this.info.patterns.resources.ref),this.pageStream=new K,this.pageStream.writeLine("1 J 1 j 1 w"),this.pageStream.writeLine("1 0 0 RG"),this.pageStream.writeString("1 1 m 1.1 1.1 l S"),this.storeMemoryStream2(this.pageStream,"/Length {0}"),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine(""),0<this.hatchArray.length)for(let t=0;t<this.hatchArray.length;t++)this.writeHatchPattern(t);if(0<this.shadingArray.length)for(let t=0;t<this.shadingArray.length;t++)this.writeShadingPattern(t);if(0<this.shadingFunctionArray.length){for(let t=0;t<this.shadingFunctionArray.length;t++)this.writeShadingFunction(t);this.sw.writeLine("")}this.pageStream.close()}writeHatchPattern(t){let e=this.hatchArray[t],i=e.style,r=(53<i&&(i=53),this.addXref(this.info.patterns.hatchItems[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.patterns.hatchItems[t].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Pattern"),this.sw.writeLine("/PatternType 1"),this.sw.writeLine("/PaintType 1"),this.sw.writeLine("/TilingType 1"),this.sw.writeLine("/BBox [0 0 1 1]"),this.sw.writeLine("/XStep 1"),this.sw.writeLine("/YStep 1"),this.sw.writeLine1("/Resources {0} 0 R",this.info.patterns.resources.ref),this.sw.writeLine("/Matrix [5.5 0 0 5.5 0 0]"),new K);0!=e.backColor.a&&(r.writeLine1("{0} {1} {2} rg",this.colorTable[e.backColor.r],this.colorTable[e.backColor.g],this.colorTable[e.backColor.b]),r.writeLine("0 0 1 1 re f")),r.writeLine1("{0} {1} {2} rg",this.colorTable[e.foreColor.r],this.colorTable[e.foreColor.g],this.colorTable[e.foreColor.b]),r.writeLine("BI"),r.writeLine("/W 8"),r.writeLine("/H 8"),r.writeLine("/BPC 1"),r.writeLine("/IM true"),r.writeLine("/D [1 0]"),r.writeLine("/F [/AHx]"),r.writeLine("ID"),r.writeLine(J.c.StiPdfResources.hatchData[i]+">"),r.writeLine("EI"),r.flush(),this.storeMemoryStream2(r,"/Length {0}"),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")}writeShadingPattern(t){let e=this.shadingArray[t],i=1,r=1,n=e.Angle,a=(n<0&&(n+=360),270<=n&&n<360&&(n=360-n,r=-1),180<=n&&n<270&&(n-=180,r=-1,i=-1),90<=n&&n<180&&(n=180-n,i=-1),n=n*Math.PI/180,e.X+e.Width/2),s=e.Y+e.Height/2,o=Math.sqrt(e.Width*e.Width+e.Height*e.Height)/2,l=Math.atan2(e.Height,e.Width),h=Math.PI/2-n+l,c=o*Math.sin(h),m=c*Math.cos(n)*i,g=c*Math.sin(n)*r,p=a-m,d=a+m,w=s+g,u=s-g;this.addXref(this.info.patterns.shadingItems[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.patterns.shadingItems[t].ref),this.sw.writeString("<<"),this.sw.writeString("/PatternType 2"),this.sw.writeString("/Shading <<"),this.sw.writeString("/ColorSpace /DeviceRGB"),this.sw.writeString("/ShadingType 2"),this.sw.writeString(nt.format("/Coords [{0} {1} {2} {3}]",this.convertToString(p),this.convertToString(w),this.convertToString(d),this.convertToString(u))),this.sw.writeString("/Extend [true true]"),this.sw.writeString(nt.format("/Function {0} 0 R",this.info.patterns.shadingFunctionItems[e.FunctionIndex].ref)),this.sw.writeString(">> "),this.sw.writeLine(">>"),this.sw.writeLine("endobj")}writeShadingFunction(t){let e=this.shadingFunctionArray[t],i=(this.addXref(this.info.patterns.shadingFunctionItems[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.patterns.shadingFunctionItems[t].ref),this.sw.writeString("<<"),this.sw.writeString("/FunctionType 0"),this.sw.writeString(nt.format("/Size [{0}]",e.Colors.length)),this.sw.writeString("/Decode [0 1 0 1 0 1]"),this.sw.writeString("/Range [0 1 0 1 0 1]"),this.sw.writeString(
"/BitsPerSample 8"),this.sw.writeString("/Domain [0 1]"),this.sw.writeString(nt.format("/Encode [0 {0}]",e.Colors.length-1)),this.sw.writeString("/Order 1"),new K);for(let t of e.Colors)i.writeByte(t.r),i.writeByte(t.g),i.writeByte(t.b);this.storeMemoryStream2(i,"/Length {0}"),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj")}renderLinkTable(){if(this.haveLinks)for(let t=0;t<this.linksCounter;t++){let r=this.linksArray[t];if(r.Link.startsWith("##")&&0<this.tagsArray.length){let i=r.Link.substr(2);for(let e=0;e<this.tagsArray.length;e++){let t=this.tagsArray[e];if(t.Link==i){r.DestPage=t.Page,r.DestY=t.Y+t.Height;break}}}else if("#"==r.Link.charAt(0)&&this.haveBookmarks){let i=r.Link.substr(1);if("%"==i.charAt(0)&&2<i.length){let t=i.lastIndexOf(i.charAt(1));t<i.length-1&&(i=i.substr(t+1))}for(let e=0;e<this.bookmarksCounter;e++){let t=this.bookmarksTree[e];if(t.Title==i){r.DestPage=t.Page,r.DestY=t.Y;break}}}if(this.linksArray[t]=r,this.addXref(this.info.linkList[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.linkList[t].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Link"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(r.X),this.convertToString(r.Y),this.convertToString(r.X+r.Width),this.convertToString(r.Y+r.Height)),this.sw.writeLine("/Border [0 0 0]"),"#"==r.Link.charAt(0))-1<r.DestY?this.sw.writeLine1("/Dest [{0} 0 R /XYZ null {1} null]",this.info.pageList[r.DestPage].ref,this.convertToString(r.DestY)):this.sw.writeLine1("/Dest [{0} 0 R /XYZ null null null]",this.info.pageList[0].ref);else{let t=this.stringReplace(r.Link,"\\","/"),e=6<t.length&&tt.isLetter(t,0)&&":"==t.charAt(1)&&"/"==t.charAt(2)||"/"==t.charAt(0)&&tt.isLetter(t,1)&&"/"==t.charAt(2);e&&":"==t.charAt(1)&&(t="/"+t.charAt(0)+t.substr(2)),this.sw.writeLine("/A <<"),this.sw.writeLine("/Type /Action"),e?(this.sw.writeLine("/S /Launch"),this.sw.writeLine("/F <<"),this.sw.writeLine("/Type /Filespec"),this.storeStringLine("/F ",t),this.storeStringLine("/UF ",t),this.sw.writeLine(">>")):(this.sw.writeLine("/S /URI"),this.storeStringLine("/URI ",J.c.StiExportUtils.stringToUrl(t))),this.sw.writeLine(">>")}this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}}renderAnnotTable(){if(this.haveAnnots||this.haveDigitalSignature||this.haveTooltips){this.addXref(this.info.acroForm.ref),this.sw.writeLine1("{0} 0 obj",this.info.acroForm.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Fields [");for(let t=0;t<this.annotsCounter;t++)this.sw.writeLine1("{0} 0 R",this.info.acroForm.annots[t].ref);for(let e=0;e<this.annots2Counter;e++)for(let t=0;t<this.info.acroForm.checkBoxes[e].items.length;t++)this.sw.writeLine1("{0} 0 R",this.info.acroForm.checkBoxes[e].items[t].ref);for(let t=0;t<this.unsignedSignaturesCounter;t++)this.sw.writeLine1("{0} 0 R",this.info.acroForm.unsignedSignatures[t].ref);this.haveDigitalSignature&&this.sw.writeLine1("{0} 0 R",this.info.acroForm.signatures[0].ref);for(let t=0;t<this.tooltipsCounter;t++)this.sw.writeLine1("{0} 0 R",this.info.acroForm.tooltips[t].ref);if(this.sw.writeLine("]"),this.sw.writeLine("/DR <<"),0<this.annotsCounter||0<this.annots2Counter){this.sw.writeLine("/Font <<"),this.sw.writeLine1("/Helv {0} 0 R",this.info.acroForm.fontHelvetica.ref);for(let t=0;t<this.fontsCounter;t++)this.sw.writeLine1("/FA{0} {1} 0 R",t,this.info.acroForm.annotFontItems[t].ref);this.sw.writeLine(">>")}if(this.sw.writeLine(">>"),this.haveAnnots&&0<this.fontsCounter&&this.storeStringLine("/DA ","/Helv 0 Tf 0 g"),this.haveDigitalSignature&&this.sw.writeLine("/SigFlags 3"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.acroForm.fontHelvetica.ref),this.sw.writeLine1("{0} 0 obj",this.info.acroForm.fontHelvetica.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Font"),this.sw.writeLine("/Subtype /Type1"),this.sw.writeLine("/BaseFont /Helvetica"),this.sw.writeLine("/Encoding /WinAnsiEncoding"),this.sw.writeLine("/Name /Helv"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.haveAnnots){let l=new C;for(let a=0;a<this.annotsCounter;a++){let t=this.annotsArray[a],i="";if(Z.StiOptions.Export.Pdf.useEditableFieldName&&(i=t.Component.name),Z.StiOptions.Export.Pdf.useEditableFieldAlias&&(i=t.Component.alias),Z.StiOptions.Export.Pdf.useEditableFieldTag&&(i=t.Component.tagValue),nt.isNullOrEmpty(i)&&(i=`Field`+a),l.containsKey(i)){let t=2,e="";while(l.containsKey(i+e))e="_"+t.toString(),t++;i+=e}l.add(i,i),this.addXref(this.info.acroForm.annots[a].ref),this.sw.writeLine1("{0} 0 obj",this.info.acroForm.annots[a].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Widget"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(t.X),this.convertToString(t.Y),this.convertToString(t.X+t.Width),this.convertToString(t.Y+t.Height)),this.sw.writeLine("/F 4"),this.sw.writeLine1("/P {0} 0 R",this.info.pageList[t.Page].ref),this.sw.writeLine("/FT /Tx"),this.sw.writeLine("/BS << /W 0 >>"),this.storeStringLine("/T ",i),this.sw.writeLine("/MK << /TP 2 >>"),this.sw.writeLine("/H /P"),this.sw.writeLine1("/AP << /N {0} 0 R >>",this.info.acroForm.annots[a].aP.ref);let e=t.Multiline?4096:0;null!=t.Component.as(et)&&null!=t.Component.as(et).textOptions&&t.Component.as(et).textOptions.lineLimit&&(e|=8388608),this.sw.writeLine1("/Ff {0}",e),this.storeStringLine("/DA ",nt.format("/FA{0} {1} Tf {2} {3} {4} rg",t.FontNumber,this.convertToString(t.FontSize,this.precision_digits_font),this.colorTable[t.FontColor.r],this.colorTable[t.FontColor.g],this.colorTable[t.FontColor.b])),this.storeStringLine("/V ",t.Text,!0),this.storeStringLine("/DV ",t.Text,!0),this.sw.writeLine1("/Q {0}",(t.Alignment==Z.Base.Drawing.StiTextHorAlignment.Center?1:0)+(t.Alignment==Z.Base.Drawing.StiTextHorAlignment.Right?2:0)),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.acroForm.annots[a].aP.ref),this.sw.writeLine1("{0} 0 obj",this.info.acroForm.annots[a].aP.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Subtype /Form"),this.sw.writeLine1("/BBox [{0} {1} {2} {3}]",this.convertToString(0),this.convertToString(0),this.convertToString(t.Width),this.convertToString(t.Height)),this.sw.writeLine("/Resources <<"),this.sw.writeLine("/ProcSet [ /PDF /Text ]"),this.sw.writeString("/Font << ");for(let t=0;t<this.fontsCounter;t++)this.sw.writeString(nt.format("/F{0} {1} 0 R ",t,this.info.fontList[t].ref));this.sw.writeLine(">> >>");let r=new K,n=(r.writeLine("/Tx BMC"),r.writeLine("q"),1);r.writeLine1("{0} {1} {2} {3} re W n",this.convertToString(n),this.convertToString(n),this.convertToString(t.Width-n),this.convertToString(t.Height-n)),r.flush(),r.write(t.Content,0,t.Content.length),r.writeLine("Q"),r.writeLine("EMC"),r.flush(),this.storeMemoryStream2(r,"/Filter [] /Length {0}"),this.sw.writeLine(""),r.close(),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")}for(let a=0;a<this.fontsCounter;a++){this.pdfFont.currentFont=a;let t=this.pdfFont.fontList[a],e=t.Name,i=(Z.StiOptions.Export.useAlternativeFontNames&&Z.StiOptions.Export.alternativeFontNames.containsKey(e)&&(e=Z.StiOptions.Export.alternativeFontNames.get(e)),new ct(this.stringReplace(e," ","#20")));if((t.Bold||t.Italic)&&(i.append(","),t.Bold&&i.append("Bold"),t.Italic)&&i.append("Italic"),this.addXref(this.info.acroForm.annotFontItems[a].ref),this.sw.writeLine1("{0} 0 obj",this.info.acroForm.annotFontItems[a].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Font"),this.sw.writeLine("/Subtype /TrueType"),this.sw.writeLine1("/Name /FA{0}",a),this.sw.writeLine1("/BaseFont /{0}",i),this.sw.writeLine("/Encoding /WinAnsiEncoding"),this.sw.writeLine1("/FontDescriptor {0} 0 R",this.info.acroForm.annotFontItems[a].fontDescriptor.ref),this.fontGlyphsReduceNotNeed[a]){let e=new ct(" ");for(let t=32;t<256;t++)e.append(this.pdfFont.Widths[this.pdfFont.UnicodeMap[this.CodePage1252[t]]-32].toString()+" ");this.sw.writeLine("/FirstChar 32"),this.sw.writeLine("/LastChar 255"),this.sw.writeLine1("/Widths [{0}]",e)}this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("");let r=null,n=this.embeddedFonts||J.c.PdfFonts.isFontStimulsoft(t.Name);n&&(r=this.pdfFont.getFontDataBuf(t.Font,this.report)),this.addXref(this.info.acroForm.annotFontItems[a].fontDescriptor.ref),this.sw.writeLine1("{0} 0 obj",this.info.acroForm.annotFontItems[a].fontDescriptor.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /FontDescriptor"),this.sw.writeLine1("/FontName /{0}",i),this.sw.writeLine("/Flags 32"),this.sw.writeLine1("/Ascent {0}",this.pdfFont.tmASC),this.sw.writeLine1("/CapHeight {0}",this.pdfFont.CH),this.sw.writeLine1("/Descent {0}",-this.pdfFont.tmDESC),this.sw.writeLine1("/FontBBox [{0} {1} {2} {3}]",-500,-200,1500,1e3),this.sw.writeLine1("/ItalicAngle {0}",this.pdfFont.ItalicAngle),this.sw.writeLine1("/StemV {0}",this.pdfFont.StemV),n&&null!=r&&this.sw.writeLine1("/FontFile2 {0} 0 R",this.info.fontList[a].fontFile2.ref),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}for(let o=0;o<this.annots2Counter;o++){let r=this.annots2Array[o],n="";if(Z.StiOptions.Export.Pdf.useEditableFieldName&&(n=r.Component.name),Z.StiOptions.Export.Pdf.useEditableFieldAlias&&(n=r.Component.alias),Z.StiOptions.Export.Pdf.useEditableFieldTag&&(n=r.Component.tagValue),nt.isNullOrEmpty(n)&&(n=`Checkbox`+(o+1)),l.containsKey(n)){let t=2,e="";while(l.containsKey(n+e))e="_"+t.toString(),t++;n+=e}l.add(n,n);let a=.01,e=r.Component.as(gt),s=J.c.StiPdfRenderPrimitives.getCheckBoxValue(e);if(null==s&&(s=!1),1<this.info.acroForm.checkBoxes[o].items.length){let t=this.info.acroForm.checkBoxes[o].items[0];this.addXref(t.ref),this.sw.writeLine1("{0} 0 obj",t.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Widget"),this.sw.writeLine("/FT /Btn"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(r.X),this.convertToString(r.Y),this.convertToString(r.X+r.Width-a),this.convertToString(r.Y+r.Height-a)),this.sw.writeLine1("/F {0}",4+(3==this.info.acroForm.checkBoxes[o].items.length||0==s?2:0)),this.sw.writeLine1("/P {0} 0 R",this.info.pageList[r.Page].ref),this.storeStringLine("/T ",n+"Yes"),this.sw.writeLine("/MK << >>"),this.sw.writeLine("/Ff 65536"),this.sw.writeLine1("/A {0} 0 R",t.aA[0].ref),this.sw.writeLine1("/AP << /N {0} 0 R >>",t.aP.ref),this.sw.writeLine("/H /O"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(t.aP.ref),this.sw.writeLine1("{0} 0 obj",t.aP.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /XObject"),this.sw.writeLine("/Subtype /Form"),this.sw.writeLine("/FormType 1"),this.sw.writeLine1("/BBox [{0} {1} {2} {3}]",this.convertToString(0),this.convertToString(0),this.convertToString(r.Width),this.convertToString(r.Height)),this.sw.writeLine("/Matrix [ 1 0 0 1 0 0 ]"),this.sw.writeLine("/Resources <<"),this.sw.writeLine("/ProcSet [ /PDF ]"),this.sw.writeLine("/Pattern"),this.sw.writeLine("<<");for(let t=0;t<this.hatchArray.length;t++)this.sw.writeLine1(nt.format("/PH{0} {1} 0 R",1+t,this.info.patterns.hatchItems[t].ref));for(let t=0;t<this.shadingArray.length;t++)this.sw.writeLine1(nt.format("/P{0} {1} 0 R",2+t,this.info.patterns.shadingItems[t].ref));this.sw.writeLine(">>"),this.sw.writeLine("/ColorSpace 3 0 R"),this.sw.writeLine(">>");let e=new K,i=(e.writeLine("/Tx BMC"),e.writeLine("q"),1);e.writeLine1("{0} {1} {2} {3} re W n",this.convertToString(i),this.convertToString(i),this.convertToString(r.Width-i),this.convertToString(r.Height-i)),e.flush(),e.write(r.Content,0,r.Content.length),e.writeLine("Q"),e.writeLine("EMC"),e.flush(),this.storeMemoryStream2(e,"/Filter [] /Length {0}"),this.sw.writeLine(""),e.close(),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(t.aA[0].ref),this.sw.writeLine1("{0} 0 obj",t.aA[0].ref),this.sw.writeLine("<<"),this.sw.writeLine1("/Next {0} 0 R",t.aA[1].ref),this.sw.writeLine("/S /Hide"),this.sw.writeLine1("/T ({0})",n+"Yes"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(t.aA[1].ref),this.sw.writeLine1("{0} 0 obj",t.aA[1].ref),this.sw.writeLine("<<"),this.sw.writeLine("/H false"),this.sw.writeLine("/S /Hide"),this.sw.writeLine1("/T ({0})",n+"No"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),t=this.info.acroForm.checkBoxes[o].items[1],this.addXref(t.ref),this.sw.writeLine1("{0} 0 obj",t.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Widget"),this.sw.writeLine("/FT /Btn"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(r.X),this.convertToString(r.Y),this.convertToString(r.X+r.Width-a),this.convertToString(r.Y+r.Height-a)),this.sw.writeLine1("/F {0}",4+(3==this.info.acroForm.checkBoxes[o].items.length||1==s?2:0)),this.sw.writeLine1("/P {0} 0 R",this.info.pageList[r.Page].ref),this.storeStringLine("/T ",n+"No"),this.sw.writeLine("/MK << >>"),this.sw.writeLine("/Ff 65536"),this.sw.writeLine1("/A {0} 0 R",t.aA[0].ref),this.sw.writeLine1("/AP << /N {0} 0 R >>",t.aP.ref),this.sw.writeLine("/H /O"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(t.aP.ref),this.sw.writeLine1("{0} 0 obj",t.aP.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /XObject"),this.sw.writeLine("/Subtype /Form"),this.sw.writeLine("/FormType 1"),this.sw.writeLine1("/BBox [{0} {1} {2} {3}]",this.convertToString(0),this.convertToString(0),this.convertToString(r.Width),this.convertToString(r.Height)),this.sw.writeLine("/Matrix [ 1 0 0 1 0 0 ]"),this.sw.writeLine("/Resources <<"),this.sw.writeLine("/ProcSet [ /PDF ]"),this.sw.writeLine("/Pattern"),this.sw.writeLine("<<");for(let t=0;t<this.hatchArray.length;t++)this.sw.writeLine1(nt.format("/PH{0} {1} 0 R",1+t,this.info.patterns.hatchItems[t].ref));for(let t=0;t<this.shadingArray.length;t++)this.sw.writeLine1(nt.format("/P{0} {1} 0 R",2+t,this.info.patterns.shadingItems[t].ref));this.sw.writeLine(">>"),this.sw.writeLine("/ColorSpace 3 0 R"),this.sw.writeLine(">>"),(e=new K).writeLine("/Tx BMC"),e.writeLine("q"),i=1,e.writeLine1("{0} {1} {2} {3} re W n",this.convertToString(i),this.convertToString(i),this.convertToString(r.Width-i),this.convertToString(r.Height-i)),e.flush(),e.write(r.Content2,0,r.Content2.length),e.writeLine("Q"),e.writeLine("EMC"),e.flush(),this.storeMemoryStream2(e,"/Filter [] /Length {0}"),this.sw.writeLine(""),e.close(),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(t.aA[0].ref),this.sw.writeLine1("{0} 0 obj",t.aA[0].ref),this.sw.writeLine("<<"),this.sw.writeLine("/H false"),this.sw.writeLine1("/Next {0} 0 R",t.aA[1].ref),this.sw.writeLine("/S /Hide"),this.sw.writeLine1("/T ({0})",n+"Yes"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(t.aA[1].ref),this.sw.writeLine1("{0} 0 obj",t.aA[1].ref),this.sw.writeLine("<<"),this.sw.writeLine("/S /Hide"),this.sw.writeLine1("/T ({0})",n+"No"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}if(3==this.info.acroForm.checkBoxes[o].items.length){let t=this.info.acroForm.checkBoxes[o].items[2];this.addXref(t.ref),this.sw.writeLine1("{0} 0 obj",t.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Widget"),this.sw.writeLine("/FT /Btn"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(r.X),this.convertToString(r.Y),this.convertToString(r.X+r.Width-a),this.convertToString(r.Y+r.Height-a)),this.sw.writeLine("/F 4"),this.sw.writeLine1("/P {0} 0 R",this.info.pageList[r.Page].ref),this.storeStringLine("/T ",n+"None"),this.sw.writeLine("/MK << >>"),this.sw.writeLine("/Ff 65536"),this.sw.writeLine1("/A {0} 0 R",t.aA[0].ref),this.sw.writeLine("/H /O"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(t.aA[0].ref),this.sw.writeLine1("{0} 0 obj",t.aA[0].ref),this.sw.writeLine("<<"),this.sw.writeLine1("/Next {0} 0 R",t.aA[1].ref),this.sw.writeLine("/S /Hide"),this.sw.writeLine1("/T ({0})",n+"None"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(t.aA[1].ref),this.sw.writeLine1("{0} 0 obj",t.aA[1].ref),this.sw.writeLine("<<"),this.sw.writeLine("/H false"),this.sw.writeLine("/S /Hide"),this.sw.writeLine1("/T ({0})",n+(e.checkStyleForTrue==J.a.Components.StiCheckStyle.None?"No":"Yes")),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}}for(let r=0;r<this.unsignedSignaturesCounter;r++){let t=this.unsignedSignaturesArray[r],i="";if(Z.StiOptions.Export.Pdf.useEditableFieldName&&(i=t.Component.name),Z.StiOptions.Export.Pdf.useEditableFieldAlias&&(i=t.Component.alias),Z.StiOptions.Export.Pdf.useEditableFieldTag&&(i=t.Component.tagValue),nt.isNullOrEmpty(i)&&(i=`UnsignedSignature`+r),l.containsKey(i)){let t=2,e="";while(l.containsKey(i+e))e="_"+t.toString(),t++;i+=e}l.add(i,i);let e=this.info.acroForm.unsignedSignatures[r].ref;this.addXref(e),this.sw.writeLine1("{0} 0 obj",e),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Widget"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(t.X),this.convertToString(t.Y),this.convertToString(t.X+t.Width),this.convertToString(t.Y+t.Height)),this.sw.writeLine("/F 4"),this.sw.writeLine1("/P {0} 0 R",this.info.pageList[t.Page].ref),this.sw.writeLine("/FT /Sig"),this.storeStringLine("/T ",i),this.sw.writeLine("/MK << >>"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}}}}renderTooltipTable(){if(this.haveTooltips)for(let t=0;t<this.tooltipsCounter;t++){let e=this.tooltipsArray[t],i=!1,r=new Wr;for(let t=0;t<this.linksCounter;t++)if((r=this.linksArray[t]).X==e.X&&r.Y==e.Y&&r.Width==e.Width&&r.Height==e.Height&&r.Page-1==e.Page){i=!0;break}this.addXref(this.info.acroForm.tooltips[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.acroForm.tooltips[t].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Widget"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(e.X),this.convertToString(e.Y),this.convertToString(e.X+e.Width),this.convertToString(e.Y+e.Height)),this.storeStringLine("/TU ",e.Link,!0),this.sw.writeLine("/F 0"),this.sw.writeLine1("/P {0} 0 R",this.info.pageList[e.Page].ref),this.storeStringLine("/T ",`Tooltip`+t),this.sw.writeLine("/FT /Btn"),this.sw.writeLine("/Ff 65536"),this.sw.writeLine("/H /N"),this.sw.writeLine("/AP <<"),this.sw.writeLine(">>"),i&&("#"==r.Link.charAt(0)?-1<r.DestY?this.sw.writeLine1("/Dest [{0} 0 R /XYZ null {1} null]",this.info.pageList[r.DestPage].ref,this.convertToString(r.DestY)):this.sw.writeLine1("/Dest [{0} 0 R /XYZ null null null]",this.info.pageList[0].ref):(this.sw.writeLine("/A <<"),this.sw.writeLine("/Type /Action"),this.sw.writeLine("/S /URI"),this.storeStringLine("/URI ",J.c.StiExportUtils.stringToUrl(this.stringReplace(r.Link,"\\","/"))),this.sw.writeLine(">>"))),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}}renderEncodeRecord(){this.encrypted&&(this.addXref(this.info.encode.ref),this.sw.writeLine1("{0} 0 obj",this.info.encode.ref),this.sw.writeLine("<<"),this.pdfSecurity.renderEncodeRecord(this.sw,this),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""))}renderExtGStateRecord(){this.addXref(this.info.extGState.ref),this.sw.writeLine1("{0} 0 obj",this.info.extGState.ref),this.sw.writeLine("<<");for(let e=0;e<256;e++)if(this.alphaTable[e]){let t=nt.format("{0:X2}",e).toUpperCase();this.sw.writeLine1("/GS{0}S <</Type /ExtGState /BM /Normal /CA {1}>>",t,this.colorTable[e]),this.sw.writeLine1("/GS{0}N <</Type /ExtGState /BM /Normal /ca {1}>>",t,this.colorTable[e])}this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}storeImageData(t,e,i,r,n=null){let a,s=(null!=t&&(a=t.imageFormat,t.tryConvertSync(Z.System.Drawing.Imaging.ImageFormat.Jpeg)),this.exportCache.getImageIndex(r,n)),o=(null==s&&(s=this.imageCache.addImageInt(t)),new Nr);return null!=t&&null!=t.bytes?(o.Width=t.width,o.Height=t.height):(o.Width=1,o.Height=1),o.Name=nt.format("Image{0}",s),o.ImageFormat=this.imageFormat,this.imageList.push(o),this.imageCacheIndexToList.set(s,o),i&&this.imageInterpolationTable.set(s,!0),null!=t&&(t.imageFormat=a),e}storeImageDataForGeom(t){let e=t.imageToDraw.horizontalResolution/100;this.imageResolutionMode==J.c.StiImageResolutionMode.NoMoreThan&&(e=t.stretch?t.imageToDraw.width/this.report.unit.convertToHInches(t.width):1/t.multipleFactor),e=this.storeImageData(t.imageToDraw,e,t.smoothing,this.lastProcessedComponent),this.imageInfoList.set(this.imageInfoCounter,e)}writeImageInfo(o,t,e=!1){let i=this.imageList[this.imagesCurrent],l=(this.imagesCurrent++,o.Component.as(Q)),r=this.imageResolutionMode;if((r=e?J.c.StiImageResolutionMode.Auto:r)!=J.c.StiImageResolutionMode.Exactly&&null!=l&&!l.margins.isEmpty){let t=this.hiToTwips*l.margins.left,e=this.hiToTwips*l.margins.right,i=this.hiToTwips*l.margins.top,r=this.hiToTwips*l.margins.bottom;0!=t&&(o.X+=t,o.Width-=t),0!=r&&(o.Y+=r,o.Height-=r),0!=e&&(o.Width-=e),0!=i&&(o.Height-=i)}let n=O.None,h=(null!=l&&(n=l.imageRotation),i.Width),c=i.Height,m=(n!=O.Rotate90CCW&&n!=O.Rotate90CW||(h=i.Height,c=i.Width),o.X),g=o.Y,p=this.hiToTwips*(h-1)/t,d=this.hiToTwips*(c-1)/t,w=!1;if(r!=J.c.StiImageResolutionMode.Exactly&&null!=l&&null!=l.imageToDraw){let n=l.imageToDraw,a=l.getPaintRectangle(!0,!1),s=(a=l.convertImageMargins(a,!1),new F(0,0,a.width,a.height));if(l.stretch){let i=h,r=c;if(null==n&&(i=1,r=1),l.aspectRatio){let t=s.width/i,e=s.height/r;switch(e<t?s.width=i*e:s.height=r*t,l.vertAlignment){case st.Center:s.y=(a.height-s.height)/2;break;case st.Top:s.y=a.height-s.height;break}switch(l.horAlignment){case M.Center:s.x=(a.width-s.width)/2;break;case M.Right:s.x=a.width-s.width;break}m+=s.x*this.hiToTwips,g+=s.y*this.hiToTwips,p=s.width*this.hiToTwips,d=s.height*this.hiToTwips}else p=o.Width,d=o.Height}else{let t=h*l.multipleFactor,e=c*l.multipleFactor;switch(null!=n&&null!=n.bytes||(t=1,e=1),s.width=t,s.height=e,l.horAlignment){case M.Center:s.x=(a.width-t)/2;break;case M.Right:s.x=a.width-t;break}switch(l.vertAlignment){case st.Center:s.y=(a.height-e)/2;break;case st.Top:s.y=a.height-e;break}m+=s.x*this.hiToTwips,g+=s.y*this.hiToTwips,p=s.width*this.hiToTwips,d=s.height*this.hiToTwips,w=!0}}this.pageStream.writeLine("q"),this.pushColorToStack(),this.setNonStrokeColor(rt.black),w&&this.pageStream.writeLine1("{0} {1} {2} {3} re W n",this.convertToString(o.X),this.convertToString(o.Y),this.convertToString(o.Width),this.convertToString(o.Height)),n==O.None?this.pageStream.writeLine1("{0} 0 0 {1} {2} {3} cm",this.convertToString(p),this.convertToString(d),this.convertToString(m),this.convertToString(g)):(this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(m+p/2),this.convertToString(g+d/2)),n==O.Rotate90CCW&&this.pageStream.writeLine("0 1 -1 0 0 0 cm"),n==O.Rotate90CW&&this.pageStream.writeLine("0 -1 1 0 0 0 cm"),n==O.Rotate180&&this.pageStream.writeLine("-1 0 0 -1 0 0 cm"),n==O.FlipHorizontal&&this.pageStream.writeLine("-1 0 0 1 0 0 cm"),n==O.FlipVertical&&this.pageStream.writeLine("1 0 0 -1 0 0 cm"),n==O.Rotate90CCW||n==O.Rotate90CW?this.pageStream.writeLine1("{0} 0 0 {1} {2} {3} cm",this.convertToString(d),this.convertToString(p),this.convertToString(-d/2),this.convertToString(-p/2)):this.pageStream.writeLine1("{0} 0 0 {1} {2} {3} cm",this.convertToString(p),this.convertToString(d),this.convertToString(-p/2),this.convertToString(-d/2))),this.pageStream.writeLine1("/{0} Do",i.Name),this.pageStream.writeLine("Q"),this.popColorFromStack()}writeImageInfo2(t,e,i){let r=this.imageList[this.imagesCurrent];this.imagesCurrent++,this.pageStream.writeLine("q"),this.pushColorToStack(),this.setNonStrokeColor(rt.black),this.pageStream.writeLine1("{0} 0 0 {1} {2} {3} cm",this.convertToString(this.hiToTwips*r.Width/e),this.convertToString(this.hiToTwips*r.Height/i),this.convertToString(t.X),this.convertToString(t.Y)),this.pageStream.writeLine1("/{0} Do",r.Name),this.pageStream.writeLine("Q"),this.popColorFromStack()}renderImage(n,a,s=!1){if(this.imageInfoList.containsKey(this.imageInfoCounter)){let t=this.imageInfoList.get(this.imageInfoCounter);this.writeImageInfo(n,t,s)}else{let r=n.Component.as(pt);if(null!=r&&n.Component.isExportAsImage(J.a.StiExportFormat.Pdf)){let t=a,e={ref:t},i=r.getImage(e,J.a.StiExportFormat.Pdf);null!=i&&this.writeImageInfo(n,t=e.ref,s)}}}renderIcon(r){let t=r.Component.as(Q),e=J.a.StiFontIconsHelper.getContent(t.icon),n=Math.min(r.Width,r.Height)/this.hiToTwips,i=1,a=new X("Stimulsoft",i),s=Kt.measureString(e,a),o=Math.max(s.height,s.width),l=Kt.measureString(" ",a),h=(o+=l.width,i=Math.floor(n/o),r.clone()),c=new et;if(c.text=e,c.textBrush=new ie(t.iconColor),c.font=new X("Stimulsoft",i),c.horAlignment=t.horAlignment==M.Left?at.Left:t.horAlignment==M.Center?at.Center:at.Right,c.vertAlignment=t.vertAlignment,c.page=r.Component.page,c.textQuality=Et.Standard,c.margins=new te(1,1,10,7),h.Component=c,t.aspectRatio)J.c.StiPdfRenderText.renderTextFont(h),J.c.StiPdfRenderText.renderText(h,null,!1);else{c.horAlignment=at.Center,c.vertAlignment=st.Center,c.margins=new te(0,0,1,0);let t=r.Width/r.Height,e=1<t?t:1,i=1<t?1:1/t;this.pageStream.writeLine("q"),this.pushColorToStack(),this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(r.X),this.convertToString(r.Y)),this.pageStream.writeLine1("{0} 0 0 {1} 0 0 cm",this.convertToString(e),this.convertToString(i)),h.X=0,h.Y=0,n=Math.min(r.Width,r.Height),h.Width=h.Height=n,J.c.StiPdfRenderText.renderTextFont(h),J.c.StiPdfRenderText.renderText(h,null,!1),this.pageStream.writeLine("Q"),this.popColorFromStack()}}renderWatermark(i,t,h,c,e){let m=i.watermark;if(null!=m&&m.enabled){if(null!=m.image&&m.showImageBehind==t){let i=this.imageList[this.imagesCurrent],r=i.Width*this.hiToTwips*m.imageMultipleFactor,n=i.Height*this.hiToTwips*m.imageMultipleFactor,a=0,s=0,o=1,t=1,e=m.imageAlignment,l=m.imageTiling;if(m.imageStretch){let t=n/r;r=h,n=c,l=!1,m.aspectRatio&&(t<c/h?n=r*t:r=n/t)}switch((m.imageStretch||1<m.imageMultipleFactor)&&this.imageInterpolationTable.set(this.imageCache.imageIndex[this.imagesCurrent],!0),l&&(e=Z.System.Drawing.ContentAlignment.TopLeft,o=$.round2(h/r)+1,t=$.round2(c/n)+1),e){case Z.System.Drawing.ContentAlignment.TopCenter:case Z.System.Drawing.ContentAlignment.MiddleCenter:case Z.System.Drawing.ContentAlignment.BottomCenter:a=(h-r)/2;break;case Z.System.Drawing.ContentAlignment.TopRight:case Z.System.Drawing.ContentAlignment.MiddleRight:case Z.System.Drawing.ContentAlignment.BottomRight:a=h-r;break}switch(e){case Z.System.Drawing.ContentAlignment.TopLeft:case Z.System.Drawing.ContentAlignment.TopCenter:case Z.System.Drawing.ContentAlignment.TopRight:s=c-n;break;case Z.System.Drawing.ContentAlignment.MiddleLeft:case Z.System.Drawing.ContentAlignment.MiddleCenter:case Z.System.Drawing.ContentAlignment.MiddleRight:s=(c-n)/2;break}this.setNonStrokeColor(rt.fromArgb3(255-m.imageTransparency,rt.black));for(let e=0;e<t;e++)for(let t=0;t<o;t++)this.pageStream.writeLine("q"),this.pushColorToStack(),this.pageStream.writeLine1("{0} 0 0 {1} {2} {3} cm",this.convertToString(r),this.convertToString(n),this.convertToString(a+r*t),this.convertToString(s-n*e)),this.pageStream.writeLine1("/{0} Do",i.Name),this.pageStream.writeLine("Q"),this.popColorFromStack();this.imagesCurrent++}if(!nt.isNullOrEmpty(m.text)&&m.showBehind==t){let t=new Rr(this),e=(t.X=0,t.Y=0,t.Width=h,t.Height=c,new et(new F(t.X,t.Y,t.Width,t.Height)));e.text=m.text,e.textBrush=m.textBrush,e.font=m.font,e.textOptions=new Z.Base.Drawing.StiTextOptions,e.textOptions.angle=m.angle,e.horAlignment=Z.Base.Drawing.StiTextHorAlignment.Center,e.vertAlignment=st.Center,e.page=i,e.textQuality=J.a.Components.StiTextQuality.Standard,t.Component=e,J.c.StiPdfRenderText.renderTextFont(t),J.c.StiPdfRenderText.renderText(t)}}}storeShadingData1(i,r){if(null!=i){if(i.is(Ft)){let t=i,e=new Mr;e.Angle=t.angle,e.Page=r,e.FunctionIndex=this.getShadingFunctionNumber([t.startColor,t.endColor]),this.shadingArray.push(e)}if(i.is(Ee)){let t=i,e=new Mr;e.Angle=t.angle,e.FunctionIndex=this.getShadingFunctionNumber([t.startColor,t.endColor,t.startColor]),e.Page=r,this.shadingArray.push(e)}if(i.is(be)){let t=i,e=new Mr;e.Angle=t.angle,e.FunctionIndex=this.getShadingFunctionNumber(t.colors),e.Page=r,this.shadingArray.push(e)}}}storeShadingData2(e,i,r,n,a,s=0){if(null!=a&&(a.is(Ft)||a.is(Ee)||a.is(be))){let t=this.shadingArray[this.shadingCurrent];t.X=e,t.Y=i,t.Width=r,t.Height=n,0==t.Angle&&0<r&&0<n&&a.is(Ft)&&(t.Angle=180*Math.atan2(n,r)/Math.PI),t.Angle+=s,this.shadingArray[this.shadingCurrent]=t,this.shadingCurrent++}return this.shadingCurrent}storeHatchData(e){if(null!=e&&(e.is(ve)&&this.getHatchNumber(e),e.is(ye))){let t=e.as(ye);t.drawHatch}}renderMetadata(e){let t=new K,i='<?xpacket begin="ï»¿" id="W5M0MpCehiHzreSzNTczkc9d"?>\r\n',r=(t.writeString(i),new K),n=new w(Z.System.Text.Encoding.UTF8,r);if(n.formatting=Z.System.Xml.Formatting.Indented,n.writeStartElement("x:xmpmeta"),n.writeAttributeString("xmlns:x","adobe:ns:meta/"),n.writeAttributeString("x:xmptk","Adobe XMP Core 4.0-c316 44.253921, Sun Oct 01 2006 17:14:39"),n.writeStartElement("rdf:RDF"),n.writeAttributeString("xmlns:rdf","http://www.w3.org/1999/02/22-rdf-syntax-ns#"),n.writeStartElement("rdf:Description"),n.writeAttributeString("rdf:about",""),n.writeAttributeString("xmlns:xap","http://ns.adobe.com/xap/1.0/"),n.writeElementString("xap:ModifyDate",this.currentDateTimeMeta),n.writeElementString("xap:CreateDate",this.currentDateTimeMeta),n.writeElementString("xap:MetadataDate",this.currentDateTimeMeta),n.writeElementString("xap:CreatorTool",this.getCreatorString()),n.writeFullEndElement(),n.writeStartElement("rdf:Description"),n.writeAttributeString("rdf:about",""),n.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),n.writeElementString("dc:format","application/pdf"),n.writeStartElement("dc:title"),n.writeStartElement("rdf:Alt"),nt.isNullOrEmpty(e.reportName)||(n.writeStartElement("rdf:li"),n.writeAttributeString("xml:lang","x-default"),n.writeString(e.reportName),n.writeFullEndElement()),n.writeEndElement(),n.writeFullEndElement(),n.writeStartElement("dc:description"),n.writeStartElement("rdf:Alt"),nt.isNullOrEmpty(e.reportAlias)||(n.writeStartElement("rdf:li"),n.writeAttributeString("xml:lang","x-default"),n.writeString(e.reportAlias),n.writeFullEndElement()),n.writeEndElement(),n.writeFullEndElement(),n.writeStartElement("dc:creator"),n.writeStartElement("rdf:Seq"),nt.isNullOrEmpty(e.reportAuthor)||(n.writeStartElement("rdf:li"),n.writeAttributeString("xml:lang","x-default"),n.writeString(e.reportAuthor),n.writeFullEndElement()),n.writeEndElement(),n.writeFullEndElement(),n.writeStartElement("dc:subject"),n.writeStartElement("rdf:Bag"),!nt.isNullOrEmpty(this.keywords)){let e=this.keywords.split(";");for(let t of e)n.writeStartElement("rdf:li"),n.writeString(t.trim()),n.writeFullEndElement()}n.writeEndElement(),n.writeFullEndElement(),n.writeFullEndElement(),n.writeStartElement("rdf:Description"),n.writeAttributeString("rdf:about",""),n.writeAttributeString("xmlns:xapMM","http://ns.adobe.com/xap/1.0/mm/"),n.writeElementString("xapMM:DocumentID",this.IDValueStringMeta),n.writeElementString("xapMM:InstanceID",this.IDValueStringMeta),n.writeFullEndElement(),n.writeStartElement("rdf:Description"),n.writeAttributeString("rdf:about",""),n.writeAttributeString("xmlns:pdf","http://ns.adobe.com/pdf/1.3/"),n.writeAttributeString("xmlns:pdfx","http://ns.adobe.com/pdf/1.3/"),n.writeElementString("pdf:Producer",this.producerName),n.writeElementString("pdf:Keywords",this.keywords);for(let t of e.metaTags.list)t.name.startsWith("pdf:")&&n.writeElementString("pdfx:"+t.name.substr(4),t.tag);if(n.writeFullEndElement(),this.zugferdComplianceMode!=J.c.StiPdfZUGFeRDComplianceMode.None&&(n.writeStartElement("rdf:Description"),n.writeAttributeString("xmlns:pdfaExtension","http://www.aiim.org/pdfa/ns/extension/"),n.writeAttributeString("xmlns:pdfaField","http://www.aiim.org/pdfa/ns/field#"),n.writeAttributeString("xmlns:pdfaProperty","http://www.aiim.org/pdfa/ns/property#"),n.writeAttributeString("xmlns:pdfaSchema","http://www.aiim.org/pdfa/ns/schema#"),n.writeAttributeString("xmlns:pdfaType","http://www.aiim.org/pdfa/ns/type#"),n.writeAttributeString("rdf:about",""),n.writeStartElement("pdfaExtension:schemas"),n.writeStartElement("rdf:Bag"),n.writeStartElement("rdf:li"),n.writeAttributeString("rdf:parseType","Resource"),this.zugferdComplianceMode==J.c.StiPdfZUGFeRDComplianceMode.V1&&(n.writeElementString("pdfaSchema:schema","ZUGFeRD PDFA Extension Schema"),n.writeElementString("pdfaSchema:namespaceURI","urn:ferd:pdfa:CrossIndustryDocument:invoice:1p0#"),n.writeElementString("pdfaSchema:prefix","zf")),this.zugferdComplianceMode==J.c.StiPdfZUGFeRDComplianceMode.V2&&(n.writeElementString("pdfaSchema:schema","ZUGFeRD PDFA Extension Schema"),n.writeElementString("pdfaSchema:namespaceURI","urn:zugferd:pdfa:CrossIndustryDocument:invoice:2p0#"),n.writeElementString("pdfaSchema:prefix","zf")),this.zugferdComplianceMode==J.c.StiPdfZUGFeRDComplianceMode.V2_1&&(n.writeElementString("pdfaSchema:schema","Factur-X/ZUGFeRD PDF/A Extension Schema"),n.writeElementString("pdfaSchema:namespaceURI","urn:factur-x:pdfa:CrossIndustryDocument:invoice:1p0#"),n.writeElementString("pdfaSchema:prefix","fx")),n.writeStartElement("pdfaSchema:property"),n.writeStartElement("rdf:Seq"),n.writeStartElement("rdf:li"),n.writeAttributeString("rdf:parseType","Resource"),n.writeElementString("pdfaProperty:name","DocumentFileName"),n.writeElementString("pdfaProperty:valueType","Text"),n.writeElementString("pdfaProperty:category","external"),n.writeElementString("pdfaProperty:description","Name of the embedded XML invoice file"),n.writeFullEndElement(),n.writeStartElement("rdf:li"),n.writeAttributeString("rdf:parseType","Resource"),n.writeElementString("pdfaProperty:name","DocumentType"),n.writeElementString("pdfaProperty:valueType","Text"),n.writeElementString("pdfaProperty:category","external"),n.writeElementString("pdfaProperty:description","INVOICE"),n.writeFullEndElement(),n.writeStartElement("rdf:li"),n.writeAttributeString("rdf:parseType","Resource"),n.writeElementString("pdfaProperty:name","Version"),n.writeElementString("pdfaProperty:valueType","Text"),n.writeElementString("pdfaProperty:category","external"),this.zugferdComplianceMode==J.c.StiPdfZUGFeRDComplianceMode.V2_1?n.writeElementString("pdfaProperty:description","Version of the Factur-X/ZUGFeRD XML schema"):n.writeElementString("pdfaProperty:description","The actual version of the ZUGFeRD data"),n.writeFullEndElement(),n.writeStartElement("rdf:li"),n.writeAttributeString("rdf:parseType","Resource"),n.writeElementString("pdfaProperty:name","ConformanceLevel"),n.writeElementString("pdfaProperty:valueType","Text"),n.writeElementString("pdfaProperty:category","external"),this.zugferdComplianceMode==J.c.StiPdfZUGFeRDComplianceMode.V2_1?n.writeElementString("pdfaProperty:description","Conformance level of the embedded Factur-X/ZUGFeRD XML invoice data"):n.writeElementString("pdfaProperty:description","The conformance level of the ZUGFeRD data"),n.writeFullEndElement(),n.writeFullEndElement(),n.writeFullEndElement(),n.writeFullEndElement(),n.writeFullEndElement(),n.writeFullEndElement(),n.writeFullEndElement(),n.writeStartElement("rdf:Description"),n.writeAttributeString("rdf:about",""),this.zugferdComplianceMode==J.c.StiPdfZUGFeRDComplianceMode.V1&&(n.writeAttributeString("xmlns:zf","urn:ferd:pdfa:CrossIndustryDocument:invoice:1p0#"),n.writeAttributeString("zf:DocumentFileName","ZUGFeRD-invoice.xml"),n.writeAttributeString("zf:ConformanceLevel",this.zugferdConformanceLevel),n.writeAttributeString("zf:DocumentType","INVOICE"),n.writeAttributeString("zf:Version","1.0")),this.zugferdComplianceMode==J.c.StiPdfZUGFeRDComplianceMode.V2&&(n.writeAttributeString("xmlns:zf","urn:zugferd:pdfa:CrossIndustryDocument:invoice:2p0#"),n.writeElementString("zf:DocumentFileName","zugferd-invoice.xml"),n.writeElementString("zf:ConformanceLevel",this.zugferdConformanceLevel),n.writeElementString("zf:DocumentType","INVOICE"),n.writeElementString("zf:Version","1.0")),this.zugferdComplianceMode==J.c.StiPdfZUGFeRDComplianceMode.V2_1&&(n.writeAttributeString("xmlns:fx","urn:factur-x:pdfa:CrossIndustryDocument:invoice:1p0#"),n.writeElementString("fx:DocumentFileName","factur-x.xml"),n.writeElementString("fx:ConformanceLevel",this.zugferdConformanceLevel),n.writeElementString("fx:DocumentType","INVOICE"),n.writeElementString("fx:Version","1.0")),n.writeFullEndElement()),this.usePdfA){n.writeStartElement("rdf:Description"),n.writeAttributeString("rdf:about",""),n.writeAttributeString("xmlns:pdfaid","http://www.aiim.org/pdfa/ns/id/");let t="1";switch(this.pdfComplianceMode){case J.c.StiPdfComplianceMode.A1:t="1";break;case J.c.StiPdfComplianceMode.A2:t="2";break;case J.c.StiPdfComplianceMode.A3:t="3";break}let e="A";switch(this.zugferdComplianceMode){case J.c.StiPdfZUGFeRDComplianceMode.V1:e="A";break;case J.c.StiPdfZUGFeRDComplianceMode.V2:e="B";break;case J.c.StiPdfZUGFeRDComplianceMode.V2_1:e="B";break}n.writeElementString("pdfaid:part",t),n.writeElementString("pdfaid:conformance",e),n.writeFullEndElement()}n.writeFullEndElement(),n.writeFullEndElement(),n.writeString("                              \r\n"),n.writeString("                              \r\n"),n.writeString("                              \r\n"),n.writeString("                              \r\n"),n.writeString("                              \r\n");let a=r.toArray();n.close(),r.close(),t.write(a,0,a.length),t.writeString('<?xpacket end="w"?>'),this.addXref(this.info.metadata.ref),this.sw.writeLine1("{0} 0 obj",this.info.metadata.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Metadata"),this.sw.writeLine("/Subtype /XML"),this.storeMemoryStream2(t,"/Length {0}"),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")}renderColorSpace(){this.addXref(this.info.destOutputProfile.ref),this.sw.writeLine1("{0} 0 obj",this.info.destOutputProfile.ref),this.sw.writeLine("<<"),this.sw.writeLine("/N 3");let t=null,e=null;e=1==this.compressed?(t=J.c.StiExportUtils.makePdfDeflateStream(J.c.StiPdfResources.sRGBprofile),"/Length {0} /Filter [/FlateDecode] /Length1 "+J.c.StiPdfResources.sRGBprofile.length.toString()):((t=new K).write(J.c.StiPdfResources.sRGBprofile,0,J.c.StiPdfResources.sRGBprofile.length),"/Length {0}"),this.storeMemoryStream2(t,e),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.outputIntents.ref),this.sw.writeLine1("{0} 0 obj",this.info.outputIntents.ref),this.sw.writeLine("[<<"),this.storeStringLine("/Info","sRGB IEC61966-2.1"),this.storeStringLine("/OutputConditionIdentifier","Custom"),this.storeStringLine("/OutputCondition",""),this.storeStringLine("/RegistryName",""),this.sw.writeLine("/S /GTS_PDFA1"),this.sw.writeLine1("/DestOutputProfile {0} 0 R",this.info.destOutputProfile.ref),this.sw.writeLine("/Type /OutputIntent"),this.sw.writeLine(">>]"),this.sw.writeLine("endobj"),this.sw.writeLine("")}renderAutoPrint(){this.autoPrint!=J.c.StiPdfAutoPrintMode.None&&(this.addXref(this.info.embeddedJS.ref),this.sw.writeLine1("{0} 0 obj",this.info.embeddedJS.ref),this.sw.writeLine("<<"),this.sw.writeLine1("/Names [(EmbeddedJS) {0} 0 R]",this.info.embeddedJS.content.ref),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.embeddedJS.content.ref),this.sw.writeLine1("{0} 0 obj",this.info.embeddedJS.content.ref),this.sw.writeLine("<<"),this.sw.writeLine("/S /JavaScript"),this.sw.writeLine1("/JS (print\\({0}\\);)",this.autoPrint==J.c.StiPdfAutoPrintMode.Dialog?"true":"false"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""))}renderEmbeddedFiles(){for(let t=0;t<this.info.embeddedFilesList.length;t++){let e=this.embeddedFiles[t];if(this.addXref(this.info.embeddedFilesList[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.embeddedFilesList[t].ref),this.sw.writeLine("<<"),this.storeStringLine("/F",e.name,!0),this.sw.writeLine("/Type /Filespec"),this.sw.writeLine("/EF <<"),this.sw.writeLine1("/F {0} 0 R",this.info.embeddedFilesList[t].content.ref),this.sw.writeLine(">>"),this.zugferdComplianceMode==J.c.StiPdfZUGFeRDComplianceMode.None&&this.pdfComplianceMode!=J.c.StiPdfComplianceMode.A3||this.sw.writeLine("/AFRelationship /Alternative"),this.storeStringLine("/UF",e.name,!0),this.storeStringLine("/Desc",e.description,!0),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.embeddedFilesList[t].content.ref),this.sw.writeLine1("{0} 0 obj",this.info.embeddedFilesList[t].content.ref),this.sw.writeLine("<<"),this.sw.writeLine1("/Subtype /{0}",e.MIMEType[Z.System.StiObject.stimulsoft]().replaceAll("/","#2F")),this.sw.writeLine("/Type /EmbeddedFile"),this.sw.writeLine("/Params <<"),this.storeStringLine("/ModDate ","D:"+this.currentDateTime),this.sw.writeLine1("/Size {0}",e.data.length),this.sw.writeLine(">>"),this.compressed){let t=J.c.StiExportUtils.makePdfDeflateStream(e.data);this.storeMemoryStream2(t,"/Filter [/FlateDecode] /Length {0}")}else if(e.data instanceof Uint8Array)this.storeMemoryStream3(e.data,"/Length {0}");else if(e.data instanceof Array)this.storeMemoryStream4(e.data,"/Length {0}");else{let t=Z.System.Text.Encoding.UTF8.getBytes(e.data);this.storeMemoryStream4(t,"/Length {0}")}this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")}}addBookmarkNode(a,t){let e=new zr,s=(e.Parent=-1,e.First=-1,e.Last=-1,e.Prev=-1,e.Next=-1,e.Count=-1,e.Page=-1,e.Y=-1,e.Title="",e.Guid="",e.Used=-1==t,this.bookmarksTree.push(e),this.bookmarksTree.length-1);if(e.Parent=t,e.Title=a.text,e.Guid=a.componentGuid,0==a.bookmarks.count)e.Count=0;else{let n=-1;for(let r=0;r<=a.bookmarks.count-1;r++){let t=this.bookmarksTree.length,e=a.bookmarks.list[r],i=(this.addBookmarkNode(e,s),this.bookmarksTree[t]);r<a.bookmarks.count-1&&(i.Next=this.bookmarksTree.length),0<r&&(i.Prev=n),this.bookmarksTree[t]=i,n=t}e.First=s+1,e.Last=this.bookmarksTree.length-1,e.Count=this.bookmarksTree.length-s-1}this.bookmarksTree[s]=e}makeBookmarkFromTree(i,e){if(i.text=e.Title,i.bookmarks=new ue,0<e.Count){let t=e.First;while(-1!=t){let e=this.bookmarksTree[t];if(e.Used){let t=new Se;i.bookmarks.add(t),this.makeBookmarkFromTree(t,e)}t=e.Next}}}exportPdf(t,e,i){try{this.exportPdf1(t,e,i)}finally{}}exportPdf1(g,t,e){var o,l,r,p,d,w;if(null==Z.Base[["St","iL","ic","en","se"].join("")].key&&console.warn("You are using a trial version of the Stimulsoft product!"),J.a.StiLogService.write(this[Z.System.StiObject.stimulsoft]().getType(),"Export report to Pdf format"),null==e)throw new Error("The 'settings' argument cannot be equal in null.");this.report=g;let i=e.pageRange,u=e.imageResolution,n=(this.imageResolutionMode=e.imageResolutionMode,this.imageQuality=e.imageQuality,this.embeddedFonts=e.embeddedFonts,this.standardPdfFonts=e.standardPdfFonts,this.compressed=e.compressed,this.useUnicodeMode=e.useUnicode,e.passwordInputUser),a=e.passwordInputOwner,s=e.userAccessPrivileges,h=(this.keyLength=e.keyLength,this.pdfComplianceMode=e.pdfComplianceMode,this.autoPrint=e.autoPrintMode,this.imageCompressionMethod=e.imageCompressionMethod,this.allowEditable=e.allowEditable,this.embeddedFiles=e.embeddedFiles,this.zugferdComplianceMode=e.ZUGFeRDComplianceMode,this.zugferdConformanceLevel=e.ZUGFeRDConformanceLevel,e.ZUGFeRDInvoiceData);if(this.creatorName=this.getCreatorString(),this.keywords=Z.StiOptions.Export.Pdf.keywordsString,nt.isNullOrEmpty(e.creatorString)||(this.creatorName=e.creatorString),nt.isNullOrEmpty(e.keywordsString)||(this.keywords=e.keywordsString),nt.isNullOrEmpty(this.creatorName)&&(this.creatorName=this.producerName),null==this.embeddedFiles&&(this.embeddedFiles=new zt),null!=g.dictionary.resources)for(let i of g.dictionary.resources.list){if(i.availableInTheViewer){let t=i.alias!=i.name?i.alias:"",e=new he(i.name+i.getFileExt(),t,i.content,i.getContentType());this.embeddedFiles.add(e)}i.type==Ce.Xml&&("ZUGFeRD-invoice"==i.name?(this.zugferdComplianceMode=J.c.StiPdfZUGFeRDComplianceMode.V1,this.embeddedFiles.add(new he("ZUGFeRD-invoice.xml","ZUGFeRD Invoice",i.content,"text/xml"))):"zugferd-invoice"==i.name.toLowerCase()?(this.zugferdComplianceMode=J.c.StiPdfZUGFeRDComplianceMode.V2,this.embeddedFiles.add(new he("zugferd-invoice.xml","ZUGFeRD Invoice",i.content,"text/xml"))):"factur-x"==i.name.toLowerCase()&&(this.zugferdComplianceMode=J.c.StiPdfZUGFeRDComplianceMode.V2_1,this.embeddedFiles.add(new he("factur-x.xml","Factur-X/ZUGFeRD",i.content,"text/xml"))))}if(this.zugferdComplianceMode!=J.c.StiPdfZUGFeRDComplianceMode.None&&(this.pdfComplianceMode=J.c.StiPdfComplianceMode.A3,null!=h)){let i=!1;for(let e of this.embeddedFiles){let t=e.name.toLowerCase();"zugferd-invoice.xml"!=t&&"factur-x.xml"!=t||(i=!0)}i||(this.zugferdComplianceMode==J.c.StiPdfZUGFeRDComplianceMode.V1&&this.embeddedFiles.add(new he("ZUGFeRD-invoice.xml","ZUGFeRD Rechnung",h)),this.zugferdComplianceMode==J.c.StiPdfZUGFeRDComplianceMode.V2&&this.embeddedFiles.add(new he("zugferd-invoice.xml","ZUGFeRD Rechnung",h)),this.zugferdComplianceMode==J.c.StiPdfZUGFeRDComplianceMode.V2_1&&this.embeddedFiles.add(new he("factur-x.xml","Factur-X/ZUGFeRD",h)))}1<this.embeddedFiles.countItems&&(this.embeddedFiles=this.embeddedFiles.orderBy(t=>t.name).toList()),this.usePdfA=this.pdfComplianceMode!=J.c.StiPdfComplianceMode.None,this.useTransparency=this.pdfComplianceMode!=J.c.StiPdfComplianceMode.A1,this.embeddedFonts||(this.useUnicodeMode=!1),this.compressedFonts=!0,this.usePdfA&&(this.standardPdfFonts=!1,this.embeddedFonts=!0,this.useUnicodeMode=!0);let c=i.rangeType!=J.a.StiRangeType.All,m=!this.usePdfA;this.embeddedFonts&&(this.standardPdfFonts=!1),this.imageQuality<0&&(this.imageQuality=0),1<this.imageQuality&&(this.imageQuality=1),this.useUnicodeMode&&(this.standardPdfFonts=!1),u<10&&(u=10),u/=100,this.imageResolutionMain=u,this.pdfFont=new J.c.PdfFonts,this.pdfFont.standardPdfFonts=this.standardPdfFonts,this.pdfFont.forceUseUnicode=this.useUnicodeMode,this.fontGlyphsReduceNotNeed=null;for(let i=0;i<=255;i++){let t=$.round2(i/255,3),e=t.toString().split(",").join(Z.System.Globalization.CultureInfo.currentCulture.numberFormat.numberDecimalSeparator);this.colorTable[i]=e,this.alphaTable[i]=!1}if(this.lastColorStrokeA=255,this.lastColorNonStrokeA=255,this.colorStack=new Array,this.imageList=new Array,null!=this.exportCache)this.imageCache=this.exportCache.imageCache;else switch(this.imageCompressionMethod){case J.c.StiPdfImageCompressionMethod.Flate:this.imageCache=new J.a.StiImageCache(!0,!0,J.a.ImageFormat.MemoryBmp,this.imageQuality,m);break;default:this.imageCache=new J.a.StiImageCache(!0,!0,J.a.ImageFormat.Jpeg,this.imageQuality,m);break}this.imageInterpolationTable=new C,this.imageCacheIndexToList=new C,this.imageInfoList=new C,this.imageInfoCounter=0,this.pdfFont.fontList=new Array,this.xref=new Array,this.bookmarksTree=new Array,this.haveBookmarks=!1,this.linksArray=new Array,this.annotsArray=new Array,this.annots2Array=new Array,this.unsignedSignaturesArray=new Array,this.shadingArray=new Array,this.shadingFunctionArray=new Array,this.hatchArray=new Array,this.tooltipsArray=new Array,this.sw=t,this.fontsCounter=0,this.bookmarksCounter=0,this.linksCounter=0,this.annotsCounter=0,this.annots2Counter=0,this.tooltipsCounter=0;for(let t=0;t<256;t++)this.CodePage1252[t]=t;for(let t=0;t<32;t++)this.CodePage1252[128+t]=this.CodePage1252part80AF[t];this.fontGlyphsReduceNotNeed=it.create(Boolean,256),this.tempGeomWriter=new J.c.StiPdfGeomWriter(null,this);let S=_.now,f=S.toString("yyyyMMddHHmmsszzz"),b=(this.currentDateTime=f.substr(0,17)+"'"+f.substr(18,2)+"'",this.currentDateTimeMeta=S.toString("yyyy-MM-ddTHH:mm:sszzz"),S.toString("yyyyMMddHHmmssffff")),E=(b=(b=(b=(b+=this.producerName)+this.creatorName)+g.reportAuthor)+g.reportAlias+g.reportName,"");for(let t=0;t<b.length;t++)E+=String.fromCharCode(255&b.charCodeAt(t));this.IDValue=Z.Base.StiMD5Helper.MD5(E,!1);let v="";for(let t=0;t<this.IDValue.length;t++)v+=J.c.StiExportUtils.toHex(this.IDValue[t]);this.IDValueString=v,this.IDValueStringMeta=nt.format("uuid:{0}-{1}-{2}-{3}-{4}",this.IDValueString.substring(0,8),this.IDValueString.substring(8,4),this.IDValueString.substring(12,4),this.IDValueString.substring(16,4),this.IDValueString.substring(20,12)).toLowerCase(),this.pdfSecurity=new J.c.StiPdfSecurity(this),this.usePdfA||(this.encrypted=this.pdfSecurity.computingCryptoValues(s,a,n,this.keyLength,this.IDValue)),this.encrypted&&this.useUnicodeMode&&(this.embeddedFonts=!0),this.currentPassNumber=0,this.maximumPassNumber=Z.StiOptions.Export.Pdf.divideSegmentPages?3:2;let y=i.getSelectedPages(g.renderedPages),x=(Z.StiOptions.Export.Pdf.divideSegmentPages&&(y=J.c.StiSegmentPagesDivider.divide(y,this,this.exportCache),this.currentPassNumber++),0==y.length&&y.add(new xe),null!=g.bookmark&&0!=g.bookmark.bookmarks.count&&(this.addBookmarkNode(g.bookmark,-1),this.haveBookmarks=!0,this.bookmarksCounter=this.bookmarksTree.length),0);for(let r of y.list){if(y.getPage(r),this.storeShadingData1(r.brush,x),this.storeHatchData(r.brush),null!=r.hyperlinkValue&&0<r.hyperlinkValue.toString().trim().length&&!r.hyperlinkValue.toString().trim().startsWith("javascript:")&&!this.usePdfA){let t=new Wr;t.Link=r.hyperlinkValue.ToString(),t.Page=x,this.linksArray.push(t)}null!=r.watermark&&r.watermark.enabled&&(nt.isNullOrEmpty(r.watermark.text)||(null!=r.watermark.font&&this.pdfFont.getFontNumber(r.watermark.font),this.pdfFont.storeUnicodeSymbolsInMap(r.watermark.text),this.pdfFont.storeUnicodeSymbolsInMap(J.c.StiBidirectionalConvert2.convertString(r.watermark.text,!1)),this.storeShadingData1(r.watermark.textBrush,x),this.storeHatchData(r.watermark.textBrush)),1==r.watermark.showImageBehind)&&null!=r.watermark.image&&this.storeImageData(r.watermark.image,u,!1,r);let e=[],i=[];for(let t of r.components.list)(t.is($t)?i:e).push(t);e.push(...i),i.length=0;for(let s of e)if(s.enabled&&(!g.isPrinting||s.printable)){this.imageInfoCounter+=2;let t=0<(this.lastProcessedComponent=s).width&&0<s.height;if(t){let t=s.as(N),e=(null!=t&&(this.storeShadingData1(t.brush,x),this.storeHatchData(t.brush)),s.isExportAsImage(J.a.StiExportFormat.Pdf)),i=s.as(L);if(null!=i&&J.c.StiPdfRenderPrimitives.checkShape(i)&&(e=!1),(s.is(ae)||s.is(se))&&(e=!1),s.is(gt)){let t=s;if(this.storeShadingData1(t.textBrush,x),this.storeHatchData(t.textBrush),this.allowEditable==J.c.StiPdfAllowEditable.Yes&&t.editable){let t=new Hr;t.Page=x,t.Component=s,this.annots2Array.push(t)}continue}let r=s.as(Q);if(null!=r&&null!=r.icon){e=!1;let t=new X("Stimulsoft",8);this.pdfFont.getFontNumber(t),this.pdfFont.storeUnicodeSymbolsInMap(J.a.StiFontIconsHelper.getContent(r.icon))}if(e){let e=!1,i=s;if(this.imageResolutionMode!=J.c.StiImageResolutionMode.Exactly&&null!=i&&null!=i.imageToDraw&&null!=i.imageToDraw.bytes){e=!0;let t=i.imageToDraw.horizontalResolution/100;this.imageResolutionMode==J.c.StiImageResolutionMode.NoMoreThan&&(t=i.stretch?i.imageToDraw.width/g.unit.convertToHInches(s.width):1/i.multipleFactor),t=this.storeImageData(i.imageToDraw,t,i.smoothing,s),this.imageInfoList.set(this.imageInfoCounter,t)}if(!e){let r=s.as(pt);if(null!=r){let t=u,e={ref:t},i=r.getImage(e,J.a.StiExportFormat.Pdf);t=e.ref,null!=i&&(this.storeImageData(i,t,!1,s),this.imageInfoList.set(this.imageInfoCounter,t))}}}let n=s.as(dt),a=(null!=n&&this.pdfFont.getFontNumber(n.font),s[Z.System.StiObject.stimulsoft]().as(ht));if(s.is(et)&&!e){let n=s,t=null!=a&&null!=a.textOptions&&a.textOptions.rightToLeft,r=new ct(n.text);if(n.allowHtmlTags)if(Z.StiOptions.Engine.useNewHtmlEngine)this.storeWysiwygSymbols(n,x);else{let t=new Z.Base.Drawing.StiHtmlTagsState(n.font.bold,n.font.italic,n.font.underline,n.font.strikeout,n.font.size,n.font.name,lt.toColor(n.textBrush),lt.toColor(n.brush),!1,!1,0,0,1,n.horAlignment),e=new Z.Base.Drawing.StiHtmlState(t,0),i=Z.Base.Drawing.StiTextRenderer.parseHtmlToStates(n.text,e);r=new ct;for(let e=0;e<i.length;e++){let t=i[e];r.append(Z.Base.Drawing.StiTextRenderer.prepareStateText(t.text))}}this.pdfFont.storeUnicodeSymbolsInMap(r.toString()),this.pdfFont.storeUnicodeSymbolsInMap(J.c.StiBidirectionalConvert2.convertString(r.toString(),t));let e=s.as(wt);if(null!=n&&null!=e&&(this.storeShadingData1(e.textBrush,x),this.storeHatchData(e.textBrush)),this.allowEditable==J.c.StiPdfAllowEditable.Yes&&n.editable){let t=new Hr;t.Page=x,this.annotsArray.push(t),this.fontGlyphsReduceNotNeed[this.pdfFont.currentFont]=!0}if(null!=n.indicator){let i=n.indicator[Z.System.StiObject.stimulsoft]().as(we);if(null!=i&&(i.icon!=de.None||null!=i.customIcon)){let t=pe.getIcon(i),e=1;e=this.storeImageData(t,e,!0,s,"indicator_icon"),this.imageInfoList[this.imageInfoCounter]=e}let r=n.indicator[Z.System.StiObject.stimulsoft]().as(ge);if(null!=r&&(r.textPlacement==Pe.Inside||0!=r.value)&&r.brushType==J.a.Components.StiBrushType.Gradient){let t=r.value<0?r.negativeColor:r.positiveColor,e=me.light(t,200),i=new Mr;i.Page=x,i.FunctionIndex=this.getShadingFunctionNumber([t,e]),this.shadingArray.push(i)}}}if(null==i||e||nt.isNullOrWhiteSpace(i.getParsedText())||(this.pdfFont.storeUnicodeSymbolsInMap(i.getParsedText()),this.pdfFont.storeUnicodeSymbolsInMap(J.c.StiBidirectionalConvert2.convertString(i.getParsedText(),!1))),s.is(Te)&&!e){let t=new J.c.StiPdfGeomWriter(this.pageStream,this,!0),e=(t.pageNumber=x,J.c.StiBarCodeExportPainter.createNew(t)),i=s;if(!nt.isNullOrEmpty(i.codeValue)&&null!=i.page){let t=g.unit.convertRectangleToHInches(i.clientRectangle);i.barCodeType.draw(e,i,t,1)}}else if(s.is(Ae)&&!e){let t=new Rr(this);t.Component=s,J.c.StiPdfRenderChart.renderChart(t,!0,x)}else if(s.is(oe)&&!e){let t=new Rr(this);t.Component=s,J.c.StiPdfRenderGauge.renderGauge(t,!0,x)}else if(s.is(ce)&&!e){let t=new Rr(this);t.Component=s,J.c.StiPdfRenderChart.renderSparkline(t,!0,x)}if(s.is(ae)){e=!1;let i=s.as(ae);if(i.mode==ne.Draw){if(null!=(null==(o=i.image)?void 0:o.image)&&0<i.image.image.length){let t=null!=i.bitmapImageForExport?i.bitmapImageForExport:re.bytesToImage(i.image.image),e=t.horizontalResolution/100;e=this.storeImageData(t,e,!0,s,"signature_image"),this.imageInfoList.set(this.imageInfoCounter,e)}if(null!=i.draw.image){let t=null!=i.bitmapDrawForExport?i.bitmapDrawForExport:re.bytesToImage(i.draw.image);this.storeImageData(t,1,!0,s,"signature_draw"),this.imageInfoList.set(this.imageInfoCounter,1)}nt.isNullOrWhiteSpace(null==(l=i.text)?void 0:l.text)||(this.pdfFont.getFontNumber(i.text.font),this.pdfFont.storeUnicodeSymbolsInMap(i.text.text),this.pdfFont.storeUnicodeSymbolsInMap(J.c.StiBidirectionalConvert2.convertString(i.text.text,!1)))}if(i.mode==ne.Type){let e=" "+i.type.fullName+" "+i.type.initials;if(!nt.isNullOrWhiteSpace(e)){let t=new X(Z.Base.StiSignatureFontsHelper.getFontName(i.type.style),16);this.pdfFont.getFontNumber(t),this.pdfFont.storeUnicodeSymbolsInMap(e),this.pdfFont.storeUnicodeSymbolsInMap(J.c.StiBidirectionalConvert2.convertString(e,!1))}}}if(s.is(se)){e=!1;let t=s.as(se);nt.isNullOrWhiteSpace(t.placeholder)||(this.pdfFont.getFontNumber(new X("Segoe UI",10)),this.pdfFont.storeUnicodeSymbolsInMap(t.placeholder),this.pdfFont.storeUnicodeSymbolsInMap(J.c.StiBidirectionalConvert2.convertString(t.placeholder,!1)))}}if(null!=s.hyperlinkValue&&0<s.hyperlinkValue.toString().trim().length&&!s.hyperlinkValue.toString().trim().startsWith("javascript:")){let t=new Wr;t.Link=s.hyperlinkValue.toString(),t.Page=x,this.linksArray.push(t)}if(null!=s.toolTipValue&&0<s.toolTipValue.toString().trim().length&&!this.usePdfA){let t=new Wr;t.Page=x,this.tooltipsArray.push(t)}if(s.is(se)){let t=new Hr;t.Page=x,this.unsignedSignaturesArray.push(t)}if(null!=s.tagValue&&"pdfunsignedsignaturefield"==s.tagValue.toString().toLowerCase()&&!this.usePdfA){let t=new Hr;t.Page=x,this.unsignedSignaturesArray.push(t)}}x++,null!=r.watermark&&r.watermark.enabled&&0==r.watermark.showImageBehind&&null!=r.watermark.image&&this.storeImageData(r.watermark.image,u,!1,r)}for(let t=0;t<this.pdfFont.fontList.length;t++)this.pdfFont.currentFont=t,this.pdfFont.storeUnicodeSymbolsInMap("…");if(0<this.unsignedSignaturesArray.length&&(0<this.annotsArray.length||0<this.annots2Array.length))for(let e=0;e<this.pdfFont.fontList.length;e++){let t=this.pdfFont.fontList[e];"Arial"==t.Name&&(this.fontGlyphsReduceNotNeed[e]=!0)}let A="";for(let t=32;t<256;t++)A+=String.fromCharCode(this.CodePage1252[t]);for(let t=0;t<this.pdfFont.fontList.length;t++)this.fontGlyphsReduceNotNeed[t]&&(this.pdfFont.currentFont=t,this.pdfFont.storeUnicodeSymbolsInMap(A));this.imagesCurrent=0,this.annotsCurrent=0,this.annots2Current=0,this.shadingCurrent=0,this.linksCounter=this.linksArray.length,this.haveLinks=0<this.linksCounter,this.annotsCounter=this.annotsArray.length,this.annots2Counter=this.annots2Array.length,this.unsignedSignaturesCounter=this.unsignedSignaturesArray.length,this.haveAnnots=0<this.annotsCounter||0<this.annots2Counter||0<this.unsignedSignaturesCounter,this.tooltipsCounter=this.tooltipsArray.length,this.haveTooltips=0<this.tooltipsCounter,this.pdfFont.InitFontsData(g),this.fontsCounter=this.pdfFont.fontList.length,this.info=new J.c.StiPdfStructure;for(let t=0;t<y.count;t++)this.info.pageList.push(this.info.createContentObject(!0));for(let t=0;t<this.imageCache.imagePackedStore.length;t++)this.info.xObjectList.push(this.info.createXObject(!0,null!=this.imageCache.imageMaskStore[t]));for(let e=0;e<this.pdfFont.fontList.length;e++){let t=this.pdfFont.fontList[e];this.info.fontList.push(this.info.createFontObject(!0,t.UseUnicode,this.standardPdfFonts,this.embeddedFonts||J.c.PdfFonts.isFontStimulsoft(t.Name)))}if(this.info.outlines=this.info.createOutlinesObject(this.haveBookmarks),this.haveBookmarks)for(let t=0;t<this.bookmarksCounter;t++)this.info.outlines.items.push(this.info.createObject(!0));this.info.patterns=this.info.createPatternsObject(!0);for(let t=0;t<this.hatchArray.length;t++)this.info.patterns.hatchItems.push(this.info.createObject(!0));for(let t=0;t<this.shadingArray.length;t++)this.info.patterns.shadingItems.push(this.info.createObject(!0));for(let t=0;t<this.shadingFunctionArray.length;t++)this.info.patterns.shadingFunctionItems.push(this.info.createObject(!0));for(let t=0;t<this.linksCounter;t++)this.info.linkList.push(this.info.createObject(!0));if(this.info.encode=this.info.createObject(this.encrypted),this.info.extGState=this.info.createObject(!0),this.info.acroForm=this.info.createAcroFormObject(this.haveAnnots||this.haveTooltips),this.haveAnnots){for(let t=0;t<this.annotsCounter;t++)this.info.acroForm.annots.push(this.info.createAnnotObject(!0,!0,0));for(let t=0;t<this.fontsCounter;t++)this.info.acroForm.annotFontItems.push(this.info.createFontObject(!0,!1,!1,!1,!0));for(let t=0;t<this.annots2Counter;t++)this.info.acroForm.checkBoxes.push(new J.c.StiPdfCheckBoxObjInfo),this.info.acroForm.checkBoxes[t].items=[],this.info.acroForm.checkBoxes[t].items.push(this.info.createAnnotObject(!0,!0,2)),this.info.acroForm.checkBoxes[t].items.push(this.info.createAnnotObject(!0,!0,2)),null==this.annots2Array[t].Component.as(gt).checkedValue&&this.info.acroForm.checkBoxes[t].items.push(this.info.createAnnotObject(!0,!1,2));for(let t=0;t<this.unsignedSignaturesCounter;t++)this.info.acroForm.unsignedSignatures.push(this.info.createAnnotObject(!0,!1,0))}for(let t=0;t<this.tooltipsCounter;t++)this.info.acroForm.tooltips.push(this.info.createAnnotObject(!0,!1,0));this.info.metadata=this.info.createObject(!0),this.info.destOutputProfile=this.info.createObject(!0),this.info.outputIntents=this.info.createObject(!0),this.info.embeddedJS=this.info.createContentObject(this.autoPrint!=J.c.StiPdfAutoPrintMode.None),null!=this.embeddedFiles&&0<this.embeddedFiles.countItems&&this.embeddedFiles.forEach(t=>this.info.embeddedFilesList.push(this.info.createContentObject(!0))),this.renderStartDoc(g,y);let T=0;this.linksArray[Z.System.StiObject.stimulsoft]().clear(),this.tagsArray=new Array,this.tooltipsArray[Z.System.StiObject.stimulsoft]().clear(),this.unsignedSignaturesArray[Z.System.StiObject.stimulsoft]().clear(),this.imageInfoCounter=0,this.currentPassNumber++;for(let m of y.list){if(y.getPage(m),this.isStopped)return;this.renderPageHeader(T++);let a=this.hiToTwips*g.unit.convertToHInches(m.pageHeight*m.segmentPerHeight),n=this.hiToTwips*g.unit.convertToHInches(m.pageWidth*m.segmentPerWidth),s=this.hiToTwips*g.unit.convertToHInches(m.margins.left),o=this.hiToTwips*g.unit.convertToHInches(m.margins.right),h=this.hiToTwips*g.unit.convertToHInches(m.margins.top),l=this.hiToTwips*g.unit.convertToHInches(m.margins.bottom);if(14400<a&&(a=14400),this.haveBookmarks&&(!nt.isNullOrEmpty(m.guid)||null!=m.bookmarkValue&&""!=m.bookmarkValue.toString())){let i=0;while(i<this.bookmarksCounter){let e=this.bookmarksTree[i];if(0==e.Used&&-1==e.Page){let t=!1;if(nt.isNullOrEmpty(e.Guid)?nt.isNullOrEmpty(e.Title)||null!=m.bookmarkValue&&0<m.bookmarkValue.length&&e.Title==m.bookmarkValue&&(t=!0):nt.isNullOrEmpty(m.guid)||e.Guid!=m.guid||(t=!0),t){e.Page=T-1,e.Y=a,e.Used=!0,this.bookmarksTree[i]=e;break}}i++}}if(null!=m.hyperlinkValue&&0<m.hyperlinkValue.toString().trim().length&&!m.hyperlinkValue.toString().trim().startsWith("javascript:")&&!this.usePdfA){let t=new Wr;t.Link=m.hyperlinkValue.toString(),t.X=0,t.Y=0,t.Width=n,t.Height=a,t.Page=T,t.DestPage=-1,t.DestY=-1,this.linksArray.push(t)}if(null!=m.brush){let t=new Rr(this),e=(t.X=0,t.Y=0,t.Width=n,t.Height=a,new Ct);e.brush=m.brush,e.border=null,t.Component=e,J.c.StiPdfRenderPrimitives.renderBorder1(t)}this.renderWatermark(m,!0,n,a,u);let t=null==(r=m.tagValue)?void 0:r[Z.System.StiObject.stimulsoft]().as(String);if(!nt.isNullOrWhiteSpace(t)&&t.startsWith("Segments:")){let r=Z.System.StiNumber.tryParse(t.substring(9));if(r.successfully){let t=r.result,e=new mt(0,0,n,a),i=1;0<(t&P.Left)&&(e.x+=s-i,e.width-=s-i),0<(t&P.Right)&&(e.width-=o-i),0<(t&P.Top)&&(e.height-=h-i),0<(t&P.Bottom)&&(e.y+=l-i,e.height-=l-i),this.pageStream.writeLine1("{0} {1} {2} {3} re W n",this.convertToString(e.x),this.convertToString(e.y),this.convertToString(e.width),this.convertToString(e.height))}}let c=new Array,e=[],i=[];for(let t of m.components.list)(t.is($t)?i:e).push(t);e.push(...i),i.length=0;for(let l of e)if(l.enabled&&(!g.isPrinting||l.printable)){this.imageInfoCounter+=2;let t=this.hiToTwips*g.unit.convertToHInches(l.left),e=this.hiToTwips*g.unit.convertToHInches(l.top),i=this.hiToTwips*g.unit.convertToHInches(l.right),r=this.hiToTwips*g.unit.convertToHInches(l.bottom),o=new Rr(this),n=(o.X=t+s,o.Y=e+h,o.Width=i-t,o.Height=r-e,o.Y=a-(o.Y+o.Height),0<(o.Component=l).width&&0<l.height);if(n){let t=l.isExportAsImage(J.a.StiExportFormat.Pdf);if(this.usePdfA||l.printable||this.pageStream.writeLine("/OC /oc1 BDC"),l.is(L)||J.c.StiPdfRenderPrimitives.renderBorder1(o),l.is(et)&&!t){let a=l,r=0,s=(this.haveAnnots&&a.editable&&(r=this.pageStream.position,this.pushColorToStack(),this.lastColorStrokeA=255,this.lastColorNonStrokeA=255),J.c.StiPdfRenderIndicators.renderIndicators(o));if(a.allowHtmlTags){if(J.c.StiPdfRenderText.renderTextFont(s),Z.StiOptions.Engine.useNewHtmlEngine)J.c.StiPdfRenderText.renderText2(o,T);else{let t=new Z.Base.Drawing.StiHtmlTagsState(a.font.bold,a.font.italic,a.font.underline,a.font.strikeout,a.font.size,a.font.name,lt.toColor(a.textBrush),lt.toColor(a.brush),!1,!1,0,0,1,a.horAlignment),e=new Z.Base.Drawing.StiHtmlState(t,0),i=Z.Base.Drawing.StiTextRenderer.parseHtmlToStates(a.text,e),r="";for(let e=0;e<i.length;e++){let t=i[e];if(t.ts.tag.tag==fe.P&&"\n"==t.text.toString())continue;r+=Z.Base.Drawing.StiTextRenderer.prepareStateText(t.text)}let n=a.clone(!0);n.text=r,o.Component=n,J.c.StiPdfRenderText.renderTextFont(s),J.c.StiPdfRenderText.renderText(s)}if(this.haveAnnots&&a.editable){let i=this.annotsArray[this.annotsCurrent],r=(i.Multiline=a.wordWrap,i.X=o.X,i.Y=o.Y,i.Width=o.Width,i.Height=o.Height,i.Component=o.Component,i.Alignment=Z.Base.Drawing.StiTextHorAlignment.Left,o.Component.as(ut));if(null!=r){let t=r.horAlignment,e=o.Component.as(ht);null!=e&&null!=e.textOptions&&e.textOptions.rightToLeft&&(t==Z.Base.Drawing.StiTextHorAlignment.Left?t=Z.Base.Drawing.StiTextHorAlignment.Right:t==Z.Base.Drawing.StiTextHorAlignment.Right&&(t=Z.Base.Drawing.StiTextHorAlignment.Left)),i.Alignment=t}i.Text=o.Component.as(et).text.toString().split("\n").join("")}}else J.c.StiPdfRenderText.renderTextFont(s),J.c.StiPdfRenderText.renderText(s);if((0<this.annotsCounter||0<this.annots2Counter)&&a.editable){this.pageStream.flush();let t=this.pageStream.position,e=(this.pageStream.seek(r,Z.System.IO.SeekOrigin.Begin),[]),i=(this.pageStream.read(e,0,t-r),this.pageStream.seek(r,Z.System.IO.SeekOrigin.Begin),this.pageStream.setLength(r),this.annotsArray[this.annotsCurrent]);i.Content=e,this.annotsCurrent++,this.popColorFromStack()}}if(l.is(L))J.c.StiPdfRenderPrimitives.renderShape(o,u);else if(l.is(Te)&&!t){let i=new J.c.StiPdfGeomWriter(this.pageStream,this),r=J.c.StiBarCodeExportPainter.createNew(i),n=l;if(i.componentAngle=-n.angle,!nt.isNullOrEmpty(n.codeValue)&&null!=n.page){this.pageStream.writeLine("q"),this.pushColorToStack(),this.pageStream.writeLine1("{0} {1} {2} {3} re W n",this.convertToString(o.X),this.convertToString(o.Y),this.convertToString(o.Width),this.convertToString(o.Height)),this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(s),this.convertToString(a-h)),this.pageStream.writeLine("1 0 0 -1 0 0 cm"),this.pageStream.writeLine1("{0} 0 0 {0} 0 0 cm",this.convertToString(this.hiToTwips));let t=new Fe(1,0,0,1,0,0),e=(t.translate(s,a-h),t.scale(1,-1),t.scale(this.hiToTwips,this.hiToTwips),i.pageNumber=T,i.matrixCache.push(t),g.unit.convertRectangleToHInches(n.clientRectangle));n.barCodeType.draw(r,n,e,1),this.pageStream.writeLine("Q"),this.popColorFromStack()}}else if(l.is(Ae)&&!t)this.pageStream.writeLine("q"),this.pushColorToStack(),this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(o.X),this.convertToString(o.Y+o.Height)),this.pageStream.writeLine("1 0 0 -1 0 0 cm"),this.pageStream.writeLine1("{0} 0 0 {0} 0 0 cm",this.convertToString(this.hiToTwips/.96)),J.c.StiPdfRenderChart.renderChart(o,!1,T-1),this.pageStream.writeLine("Q"),this.popColorFromStack();else if(l.is(oe)&&!t)this.pageStream.writeLine("q"),this.pushColorToStack(),this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(o.X),this.convertToString(o.Y+o.Height)),this.pageStream.writeLine("1 0 0 -1 0 0 cm"),this.pageStream.writeLine1("{0} 0 0 {0} 0 0 cm",this.convertToString(this.hiToTwips/.96)),J.c.StiPdfRenderGauge.renderGauge(o,!1,T-1),this.pageStream.writeLine("Q"),this.popColorFromStack();else if(l.is(ce)&&!t)this.pageStream.writeLine("q"),this.pushColorToStack(),this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(o.X),this.convertToString(o.Y+o.Height)),this.pageStream.writeLine("1 0 0 -1 0 0 cm"),this.pageStream.writeLine1("{0} 0 0 {0} 0 0 cm",this.convertToString(this.hiToTwips/.96)),J.c.StiPdfRenderChart.renderSparkline(o,!1,T-1),this.pageStream.writeLine("Q"),this.popColorFromStack();else if(l.is(ae)){t=!1;let r=l,n=o.clone();if(r.mode==ne.Draw){if(null!=(null==(p=r.image)?void 0:p.image)&&0<r.image.image.length){let t=new Q(new F(l.left,l.top,l.width,l.height));t.image=null!=r.bitmapImageForExport?r.bitmapImageForExport:re.bytesToImage(r.image.image),t.horAlignment=r.image.horAlignment,t.vertAlignment=r.image.vertAlignment,t.stretch=r.image.stretch,t.aspectRatio=r.image.aspectRatio,t.page=m,n.Component=t,this.renderImage(n,u,!0)}if(null!=r.draw.image){let t=new Q(new F(l.left,l.top,l.width,l.height));t.image=null!=r.bitmapDrawForExport?r.bitmapDrawForExport:re.bytesToImage(r.draw.image),t.horAlignment=r.draw.horAlignment,t.vertAlignment=r.draw.vertAlignment,t.stretch=r.draw.stretch,t.aspectRatio=r.draw.aspectRatio,t.page=m,n.Component=t,this.imageInfoCounter++,this.renderImage(n,u,!0),this.imageInfoCounter--}if(!nt.isNullOrWhiteSpace(null==(d=r.text)?void 0:d.text)){let t=new et(new F(l.left,l.top,l.width,l.height));t.text=null==(w=r.text)?void 0:w.text,t.textBrush=new ie(r.text.color),t.font=r.text.font,t.horAlignment=r.text.horAlignment,t.vertAlignment=r.text.vertAlignment,t.page=m,t.textQuality=Et.Standard,n.Component=t,J.c.StiPdfRenderText.renderTextFont(n),J.c.StiPdfRenderText.renderText(n)}}if(r.mode==ne.Type){let i=" "+r.type.fullName+" "+r.type.initials+" ";if(!nt.isNullOrWhiteSpace(i)){let t=new X(ee.getFontName(r.type.style),16),e=new et(new F(l.left,l.top,l.width,l.height));e.text=i,e.textBrush=new ie(rt.black),e.font=t,e.horAlignment=at.Left,e.vertAlignment=st.Center,e.page=m,e.textQuality=Et.Standard,n.Component=e,J.c.StiPdfRenderText.renderTextFont(n),J.c.StiPdfRenderText.renderText(n)}}}else if(l.is(se)){t=!1;let i=l.as(se);if(!nt.isNullOrWhiteSpace(i.placeholder)){let t=new et(new F(l.left,l.top,l.width,l.height)),e=(t.text=i.placeholder,t.textBrush=new ie(rt.red),t.font=new X("Segoe UI",10),t.horAlignment=at.Center,t.vertAlignment=st.Center,t.page=m,t.textQuality=Et.Standard,o.clone());e.Component=t,J.c.StiPdfRenderText.renderTextFont(e),J.c.StiPdfRenderText.renderText(e)}}else if(l.is(gt)){let e=l;if(this.haveAnnots&&e.editable){let t=this.annots2Array[this.annots2Current],e=(t.Multiline=!1,t.X=o.X,t.Y=o.Y,t.Width=o.Width,t.Height=o.Height,t.Component=o.Component,t.Alignment=Z.Base.Drawing.StiTextHorAlignment.Center,t.Text="",o.X),i=o.Y,r=(o.X=0,o.Y=0,this.pageStream.flush(),this.pageStream.position),n=(this.pushColorToStack(),this.lastColorStrokeA=255,this.lastColorNonStrokeA=255,J.c.StiPdfRenderPrimitives.renderCheckbox(o,!0),this.pageStream.flush(),this.pageStream.position),a=(this.pageStream.seek(r,Z.System.IO.SeekOrigin.Begin),[]);this.pageStream.read(a,0,n-r),this.pageStream.seek(r,Z.System.IO.SeekOrigin.Begin),t.Content=a,this.popColorFromStack(),this.pageStream.flush(),r=this.pageStream.position,this.pushColorToStack(),this.lastColorStrokeA=255,this.lastColorNonStrokeA=255,J.c.StiPdfRenderPrimitives.renderCheckbox(o,!1,!1),this.pageStream.flush(),n=this.pageStream.position,this.pageStream.seek(r,Z.System.IO.SeekOrigin.Begin),this.pageStream.read(a=[],0,n-r),this.pageStream.seek(r,Z.System.IO.SeekOrigin.Begin),t.Content2=a,this.popColorFromStack(),this.annots2Current++,o.X=e,o.Y=i}else{let t=J.c.StiPdfRenderPrimitives.getCheckBoxValue(e);null!=t&&J.c.StiPdfRenderPrimitives.renderCheckbox(o,t)}}else if(t){let t=l.as(Q);null!=t&&null!=t.icon?this.renderIcon(o):this.renderImage(o,u)}if(l.is(xt))J.c.StiPdfRenderPrimitives.renderRoundedRectanglePrimitive(o);else{let t=o.Component.as(z);null!=t&&null!=t.border&&(t.border.topmost||o.Component.is(Jt))?c.push(o):J.c.StiPdfRenderPrimitives.renderBorder2(o)}this.usePdfA||l.printable||this.pageStream.writeLine("EMC")}if(this.haveBookmarks&&(!nt.isNullOrEmpty(l.guid)||null!=l.bookmarkValue&&""!=l.bookmarkValue)){let i=0;while(i<this.bookmarksCounter){let e=this.bookmarksTree[i];if(0==e.Used&&-1==e.Page){let t=!1;if(nt.isNullOrEmpty(e.Guid)?nt.isNullOrEmpty(e.Title)||null!=l.bookmarkValue&&0<l.bookmarkValue.length&&e.Title==l.bookmarkValue&&(t=!0):nt.isNullOrEmpty(l.guid)||e.Guid!=l.guid||(t=!0),t){e.Page=T-1,e.Y=o.Y+o.Height,e.Used=!0,this.bookmarksTree[i]=e;break}}i++}}if(null!=l.hyperlinkValue&&0<l.hyperlinkValue.toString().trim().length&&!l.hyperlinkValue.toString().trim().startsWith("javascript:")){let t=new Wr;t.Link=l.hyperlinkValue.toString(),t.X=o.X,t.Y=o.Y,t.Width=o.Width,t.Height=o.Height,t.Page=T,t.DestPage=-1,t.DestY=-1,this.linksArray.push(t)}if(null!=l.tagValue&&0<l.tagValue.toString().trim().length){let e=new Wr;if(e.Link=l.tagValue.toString(),e.X=o.X,e.Y=o.Y,e.Width=o.Width,e.Height=o.Height,e.Page=T-1,e.DestPage=-1,e.DestY=-1,this.tagsArray.push(e),"pdfunsignedsignaturefield"==e.Link.trim().toLowerCase()&&!this.usePdfA){let t=new Hr;t.X=e.X,t.Y=e.Y,t.Width=e.Width,t.Height=e.Height,t.Page=e.Page,t.Component=l,this.unsignedSignaturesArray.push(t)}}if(null!=l.pointerValue&&!nt.isNullOrWhiteSpace(l.pointerValue)&&!nt.isNullOrWhiteSpace(l.guid)){let t="#"+l.pointerValue+"#GUID#"+l.guid,e=new Wr;e.Link=t,e.X=o.X,e.Y=o.Y,e.Width=o.Width,e.Height=o.Height,e.Page=T-1,e.DestPage=-1,e.DestY=-1,this.tagsArray.push(e)}if(null!=l.toolTipValue&&0<l.toolTipValue.toString().trim().length&&!this.usePdfA){let t=new Wr;t.Link=l.toolTipValue.toString().trim(),t.X=o.X,t.Y=o.Y,t.Width=o.Width,t.Height=o.Height,t.Page=T-1,t.DestPage=-1,t.DestY=-1,this.tooltipsArray.push(t)}if(l.is(se)){let t=new Hr;t.X=o.X,t.Y=o.Y,t.Width=o.Width,t.Height=o.Height,t.Page=T-1,t.Component=l,this.unsignedSignaturesArray.push(t)}}for(let t of c)J.c.StiPdfRenderPrimitives.renderBorder2(t);if(c[Z.System.StiObject.stimulsoft]().clear(),null!=m.border){let t=new Rr(this),e=(t.X=s,t.Y=l,t.Width=n-s-o,t.Height=a-h-l,new Ct);e.border=m.border,t.Component=e,J.c.StiPdfRenderPrimitives.renderBorder2(t)}this.renderWatermark(m,!1,n,a,u),this.renderPageFooter(a,n)}if(this.bookmarksTreeTemp=null,this.haveBookmarks&&c){for(let e=0;e<this.bookmarksTree.length;e++){let t=this.bookmarksTree[e];if(t.Used)while(-1!=t.Parent)(t=this.bookmarksTree[t.Parent]).Used=!0}let t=new Se,i=(this.makeBookmarkFromTree(t,this.bookmarksTree[0]),this.bookmarksTreeTemp=this.bookmarksTree,this.bookmarksTree=new Array,this.addBookmarkNode(t,-1),this.bookmarksCounter-this.bookmarksTree.length);if(0<i){let e=new zr;e.Parent=-1,e.First=-1,e.Last=-1,e.Prev=-1,e.Next=-1,e.Count=-1,e.Page=-1,e.Y=-1,e.Title="";for(let t=0;t<i;t++)this.bookmarksTree.push(e)}let r=new C;for(let e=0;e<this.bookmarksTreeTemp.length;e++){let t=this.bookmarksTreeTemp[e];r.set(t.Title,t)}for(let t=0;t<this.bookmarksTree.length;t++){let e=this.bookmarksTree[t];if(!nt.isNullOrEmpty(e.Title)){let t=r.get(e.Title);e.Page=t.Page,e.Y=t.Y}}this.bookmarksTreeTemp=null}this.renderImageTable(),this.renderFontTable(),this.renderBookmarksTable(),this.renderPatternTable(),this.renderLinkTable(),this.renderEncodeRecord(),this.renderExtGStateRecord(),this.renderAnnotTable(),this.renderTooltipTable(),this.renderMetadata(g),this.renderColorSpace(),this.renderAutoPrint(),this.renderEmbeddedFiles(),this.renderEndDoc(),this.xref=null,this.bookmarksTree=null,this.linksArray=null,this.tagsArray=null,this.tooltipsArray=null,this.annotsArray=null,this.annots2Array=null,this.unsignedSignaturesArray=null,this.shadingArray=null,this.hatchArray=null,this.colorStack=null,this.pdfFont.clear(),this.pdfFont=null,this.imageCache.clear(),this.tempGeomWriter=null}}Ur.printScaling=!0,Ur.regexEscape=new RegExp("([{}()^$&.*?/+|[\\\\]|]|-)","g"),J.c.StiPdfExportService=Ur}let Le=Z.System.Drawing.FontStyle;{class Xr{}J.c.PdfFontInfo=Xr;class Gr{}J.c.pfontInfo=Gr;class jr{constructor(){this.TagString=null,this.Tag=0,this.CheckSum=0,this.Offset=0,this.Length=0,this.NewOffset=0,this.NewLength=0,this.Required=!1,this.NewTable=null}}class Vr{constructor(){this.HeaderOffset=0,this.NumTables=0,this.NumTablesRequired=0,this.SfntVersion=0,this.Tables=null,this.HeadCheckSumOffset=0,this.NumGlyphs=0,this.IndexToLocFormat=0,this.IndexLocaTable=0,this.IndexGlyfTable=0,this.IndexCmapTable=0,this.IndexCFFTable=-1,this.FontName=null,this.HeaderOffset=0,this.NumTables=0,this.NumTablesRequired=0,this.SfntVersion=0,this.Tables=null,this.HeadCheckSumOffset=0,this.NumGlyphs=0,this.IndexToLocFormat=0,this.IndexLocaTable=0,this.IndexGlyfTable=0,this.FontName=new C}}class Yr extends Xr{getFontMetrics(t,n,a,e){if(this.WIDTHS=it.create(Number,this.maxSymbols+1),null==t)return;let i=new X(t.name,1024,t.style,Z.System.Drawing.GraphicsUnit.Pixel),r=(it.copy(n.UnicodeMapBack,0,this.WIDTHS,n.MappedSymbolsCount),Z.System.Drawing.Graphics.measureChars(this.WIDTHS,n.MappedSymbolsCount,i)),s=r.height,o=r.width;n.CH=0,n.tmASC=$.round2(.8*s*this.factor),n.tmDESC=$.round2(.2*s*this.factor),n.tmExternal=$.round2((o-s)*this.factor),n.LLX=0,n.LLY=0,n.URX=0,n.URY=0,n.StemV=0,n.ItalicAngle=0,n.UnderscoreSize=$.round2(s*(t.bold?.08:.06)*this.factor),n.UnderscorePosition=$.round2(.1*-s*this.factor),n.StrikeoutSize=$.round2(.045*s*this.factor),n.StrikeoutPosition=$.round2(.25*s*this.factor),Yr.isFontStimulsoft(i.name)&&(n.tmASC=$.round2(.86*s*this.factor),n.tmDESC=$.round2(.14*s*this.factor));for(let t=0;t<n.MappedSymbolsCount;t++)this.WIDTHS[t]=$.round2(this.WIDTHS[t]*this.factor,0);let l=this.getFontDataBuf(t,e);if(l instanceof Uint8Array&&0<l.byteLength){let r=this.getCharToGlyphTable(l,t.name);if(null!=r){let i=0;"Wingdings"!=t.name&&"Wingdings 2"!=t.name&&"Wingdings 3"!=t.name||(i=61440);for(let e=0;e<n.MappedSymbolsCount;e++){let t=n.UnicodeMapBack[e];32<=t&&t<=255&&(t+=i),n.GlyphList[e]=r[t]}}}let h=Kt.getCustomFont(t.name,t.style);if(null!=h){n.GlyphWidths=it.create(Number,h.numGlyphs+1);for(let t=0;t<a.length-1;t++)0<a[t]&&(n.GlyphWidths[t]=Math.round(h.getGlyph(t).advanceWidth/h.unitsPerEm*1e3));let t=h.ascent,e=h.descent,i=t/(t-e),r=.938;n.tmASC=$.round2(s*i*r),n.tmDESC=$.round2(s*(1-i)*r)}n.NeedSyntBold=this.NeedSyntBold,n.NeedSyntItalic=this.NeedSyntItalic}static isFontStimulsoft(t){return"Stimulsoft"==t}get currentFont(){return this._currentFont}set currentFont(t){this._currentFont!=t&&(this._currentFont=t,null!=this.fonts)&&0<this.fonts.length&&(this.Widths=this.fonts[this._currentFont].Widths,this.CH=this.fonts[this._currentFont].CH,this.XH=this.fonts[this._currentFont].XH,this.ASC=this.fonts[this._currentFont].ASC,this.DESC=this.fonts[this._currentFont].DESC,this.tmASC=this.fonts[this._currentFont].tmASC,this.tmDESC=this.fonts[this._currentFont].tmDESC,this.tmExternal=this.fonts[this._currentFont].tmExternal,this.MacAscend=this.fonts[this._currentFont].MacAscend,this.MacDescend=this.fonts[this._currentFont].MacDescend,this.MacLineGap=this.fonts[this._currentFont].MacLineGap,this.LLX=this.fonts[this._currentFont].LLX,this.LLY=this.fonts[this._currentFont].LLY,this.URX=this.fonts[this._currentFont].URX,this.URY=this.fonts[this._currentFont].URY,this.StemV=this.fonts[this._currentFont].StemV,this.ItalicAngle=this.fonts[this._currentFont].ItalicAngle,this.LineGap=this.fonts[this._currentFont].LineGap,this.NtmFlags=this.fonts[this._currentFont].NtmFlags,this.UnderscoreSize=this.fonts[this._currentFont].UnderscoreSize,this.UnderscorePosition=this.fonts[this._currentFont].UnderscorePosition,this.StrikeoutSize=this.fonts[this._currentFont].StrikeoutSize,this.StrikeoutPosition=this.fonts[this._currentFont].StrikeoutPosition,this.UnicodeMap=this.fonts[this._currentFont].UnicodeMap,this.UnicodeMapBack=this.fonts[this._currentFont].UnicodeMapBack,this.GlyphList=this.fonts[this._currentFont].GlyphList,this.GlyphBackList=this.fonts[this._currentFont].GlyphBackList,this.GlyphMap=this.fonts[this._currentFont].GlyphMap,this.SymsToPDF=this.fonts[this._currentFont].SymsToPDF,this.CharPdfNames=this.fonts[this._currentFont].CharPdfNames,this.MappedSymbolsCount=this.fonts[this._currentFont].MappedSymbolsCount,this.NeedSyntBold=this.fonts[this._currentFont].NeedSyntBold,this.NeedSyntItalic=this.fonts[this._currentFont].NeedSyntItalic,this.GlyphWidths=this.fonts[this._currentFont].GlyphWidths,this.ChildFontsMap=this.fonts[this._currentFont].ChildFontsMap,this.UseUnicode=this.fonts[this._currentFont].UseUnicode)}InitFontsData(s){let t=this.fontList.length;for(let h=0;h<t;h++){let o=this.fontList[h],l=this.forceUseUnicode;if(l){let t=null;null!=(t=this.getFontDataBuf(o.Font,s))&&0!=t.Length||(l=!1)}if(o.UseUnicode=l,this.fontList[h]=o,!l){let a=this.UnicodeMapsList[h],s=this.firstMappedSymbol;for(let t=this.firstMappedSymbol;t<65536;t++)0<a[t]&&s++;if(255<s){o=this.fontList[h];let e=null,i=it.create(Number,65536),r=this.fontList.length;for(let t=0;t<this.firstMappedSymbol;t++)i[t]=r;let n=!0;s=this.firstMappedSymbol;for(let t=this.firstMappedSymbol;t<65536;t++){if(n){let t=new Gr;t.Name=o.Name,t.PdfName=o.PdfName,t.Bold=o.Bold,t.Italic=o.Italic,t.Number=o.Number,t.Font=o.Font,t.ParentFontNumber=h,t.UseUnicode=l,this.fontList.push(t),e=it.create(Number,65536),it.copy(a,0,e,64),this.UnicodeMapsList.push(e),this.GlyphMapsList.push(it.create(Number,65536)),r=this.fontList.length-1,s=this.firstMappedSymbol,n=!1}0<a[t]&&(e[t]=1,i[t]=r,254==++s)&&(n=!0)}o.ChildFontsMap=i,this.fontList[h]=o}}}this.fonts=it.create(Xr,this.fontList.length);for(let a=0;a<this.fontList.length;a++){this.fonts[a]=new Xr;let r=this.fonts[a],t=(r.UnicodeMap=this.UnicodeMapsList[a],r.UnicodeMapBack=it.create(Number,this.maxSymbols+1),r.UseUnicode=this.fontList[a].UseUnicode,this.GlyphMapsList[a]),e=(t[0]=1,t[3]=1,r.GlyphMap=t,this.firstMappedSymbol);for(let t=this.firstMappedSymbol;t<65536;t++)0!=r.UnicodeMap[t]&&(r.UnicodeMap[t]=e,r.UnicodeMapBack[e]=t,++e>this.maxSymbols&&(e=this.maxSymbols),r.UseUnicode||92!=e||(r.UnicodeMapBack[e]=t,e++));let i=8226;r.UnicodeMap[i]=e,r.UnicodeMapBack[e]=i,e++,r.MappedSymbolsCount=e;for(let t=0;t<this.firstMappedSymbol;t++)r.UnicodeMap[t]=t,r.UnicodeMapBack[t]=t;r.CharPdfNames=it.create(String,e),r.SymsToPDF=it.create(Number,e);for(let i=32;i<r.MappedSymbolsCount;i++){let t=-1;for(let t=0;t<this.standardFontNumWidths;t++);r.SymsToPDF[i]=t;let e=J.c.StiPdfResources.standardFontCharsNames[r.UnicodeMapBack[i]];null==e&&(e="uni"+r.UnicodeMapBack[i].toString(16).toUpperCase()[Z.System.StiObject.stimulsoft]().padLeft(4,"0")),r.CharPdfNames[i]=e}r.GlyphList=it.create(Number,e);let n=this.fontList[a];this.fonts[a].Widths=it.create(Number,e),this.getFontMetrics(n.Font,r,t,s);for(let t=0;t<e-32;t++)this.fonts[a].Widths[t]=this.WIDTHS[32+t];this.standardPdfFonts,null!=this.fontList[a].ChildFontsMap&&(r.MappedSymbolsCount=255,r.ChildFontsMap=this.fontList[a].ChildFontsMap)}this._currentFont=-1,this.currentFont=0}constructor(){super(),this.standardFontQuantity=12,this.standardFontNumWidths=310,this.standardFontNumChars=3680+189,this.firstMappedSymbol=64,this.factor=1,this.maxSymbols=32767,this.forceUseUnicode=!0,this.WIDTHS=null,this.fonts=null,this.UnicodeMapsList=null,this.GlyphMapsList=null,this.standardPdfFonts=!0,this.fontsInfoStore=null,this.family_Helvetica=["Arial","Arial Black","Arial Narrow","Century Gothic","Comic Sans MS","Impact","Microsoft Sans Serif","Tahoma","Verdana"],this.family_Courier=["Courier New","Lucida Console"],this.family_Times_Roman=["Book Antiqua","Bookman Old Style","Garamond","Georgia","Times New Roman"],this.family_Symbol=["Symbol"],this.family_ZapfDingbats=["Wingdings 2"],this.PdfFontName=["Helvetica","Helvetica-Bold","Helvetica-Oblique","Helvetica-BoldOblique","Times-Roman","Times-Bold","Times-Italic","Times-BoldItalic","Courier","Courier-Bold","Courier-Oblique","Courier-BoldOblique","Symbol","ZapfDingbats"],this._currentFont=-1,this.TtfHeaderSize=12,this.ARG_1_AND_2_ARE_WORDS=1,this.ARGS_ARE_XY_VALUES=2,this.ROUND_XY_TO_GRID=4,this.WE_HAVE_A_SCALE=8,this.MORE_COMPONENTS=32,this.WE_HAVE_AN_X_AND_Y_SCALE=64,this.WE_HAVE_A_TWO_BY_TWO=128,this.WE_HAVE_INSTRUCTIONS=256,this.USE_MY_METRICS=512,this.OVERLAP_COMPOUND=1024,this.SCALED_COMPONENT_OFFSET=2048,this.UNSCALED_COMPONENT_OFFSET=4096,this.TablesNames=["head","hhea","hmtx","maxp","cmap","OS/2","post","cvt ","fpgm","glyf","loca","prep","name"],this.fontList=new Array,this.UnicodeMapsList=new Array,this.GlyphMapsList=new Array,this.fontsInfoStore=new qr}getFontNumber(i){let r=-1;if(0<this.fontList.length)for(let e=0;e<this.fontList.length;e++){let t=this.fontList[e];if(t.Name==i.name&&t.Bold==i.bold&&t.Italic==i.italic){r=e;break}}if(-1==r){let e=new Gr;e.Name=i.name,e.Bold=i.bold,e.Italic=i.italic,e.Font=i,e.ParentFontNumber=-1,r=0;for(let t of this.family_Helvetica)e.Name==t&&(r=0);for(let t of this.family_Times_Roman)e.Name==t&&(r=4);for(let t of this.family_Courier)e.Name==t&&(r=8);r<12&&(1==e.Bold&&(r+=1),1==e.Italic)&&(r+=2),e.Number=r,e.PdfName=this.PdfFontName[r],this.fontList.push(e),r=this.fontList.length-1,this.UnicodeMapsList.push(it.create(Number,65536)),this.GlyphMapsList.push(it.create(Number,65536)),e.FontKitObject=Kt.getCustomFont(i.name,i.style),null!=e.FontKitObject&&(e.UseUnicode=!0)}return this.currentFont=r}storeUnicodeSymbolsInMap(r){if(!nt.isNullOrEmpty(r)&&-1!=this.currentFont){let e=this.UnicodeMapsList[this.currentFont];for(let t=0;t<r.length;t++)e[r.charCodeAt(t)]=1;let t=this.fontList[this.currentFont].FontKitObject;if(null!=t){let e=this.GlyphMapsList[this.currentFont],i=t.layout(r);for(let t=0;t<i.glyphs.length;t++)e[i.glyphs[t].id]=1;e[65535]=1}}}storeGlyphsInMap(i){if(0<i.length&&-1!=this.currentFont){let e=this.GlyphMapsList[this.currentFont];for(let t=0;t<i.length;t++)e[i.charCodeAt(t)]=1;e[65535]=1}}getCharToGlyphTable(t,e){let i=this.scanFontFile(t,e);if(null!=i)return this.getCmapTable(t,i);return null}reduceFontSize(d,t,o){let w=this.scanFontFile(d,t),l=null;if(null!=w){if(w.IndexLocaTable==w.IndexGlyfTable&&-1!=w.IndexCFFTable&&(w.Tables[w.IndexCFFTable].Required=!0,w.NumTablesRequired++,o=!1),o){let n=it.create(Boolean,w.NumGlyphs),r=it.create(Boolean,w.NumGlyphs);for(let e=0;e<this.GlyphList.length;e++){let t=this.GlyphList[e];t<w.NumGlyphs&&(n[t]=!0,r[t]=!0)}if(null!=this.GlyphMap)for(let t=0;t<this.GlyphMap.length;t++)0<this.GlyphMap[t]&&(n[t]=!0,r[t]=!0);n[0]=!0,n[1]=!0,n[2]=!0,n[3]=!0,r[0]=!0,r[1]=!0,r[2]=!0,r[3]=!0;let a=w.Tables[w.IndexLocaTable].Offset,s=w.Tables[w.IndexGlyfTable].Offset,o=!0;while(o){o=!1;for(let e=0;e<w.NumGlyphs;e++)if(1==r[e]){r[e]=!1;let t=a+e*(1==w.IndexToLocFormat?4:2),i=0;if(i=1==w.IndexToLocFormat?this.GetUInt32(d,t):2*this.GetUInt16(d,t),i+=s,-1==this.GetInt16(d,i)){o=!0,i+=10;let e=0;do{e=this.GetUInt16(d,i);let t=this.GetUInt16(d,i+2);t<w.NumGlyphs&&(n[t]=!0,r[t]=!0),i+=4,0<(e&this.ARG_1_AND_2_ARE_WORDS)?i=i+2+2:i+=2,0<(e&this.WE_HAVE_A_SCALE)?i+=2:0<(e&this.WE_HAVE_AN_X_AND_Y_SCALE)?i=i+2+2:0<(e&this.WE_HAVE_A_TWO_BY_TWO)&&(i=(i=i+2+2)+2+2)}while(0<(e&this.MORE_COMPONENTS))}}}let l=0,h=a;for(let i=0;i<w.NumGlyphs;i++){let t=0,e=0;1==w.IndexToLocFormat?(t=this.GetUInt32(d,h),e=this.GetUInt32(d,h+4),h+=4):(t=2*this.GetUInt16(d,h),e=2*this.GetUInt16(d,h+2),h+=2),n[i]&&(l+=e-t)}let c=new Uint8Array(l+4),m=new Uint8Array(w.Tables[w.IndexLocaTable].Length+4),g=0,p=(h=a,0);for(let r=0;r<w.NumGlyphs;r++){let e=0,t=0,i=(1==w.IndexToLocFormat?(e=this.GetUInt32(d,h),t=this.GetUInt32(d,h+4),h+=4):(e=2*this.GetUInt16(d,h),t=2*this.GetUInt16(d,h+2),h+=2),t-e);if(1==n[r])for(let t=0;t<i;t++)c[g+t]=d[s+e+t];else i=0;0==w.IndexToLocFormat?this.SetUInt16(m,p,g/2):this.SetUInt32(m,p,g),g+=i,p+=1==w.IndexToLocFormat?4:2}0==w.IndexToLocFormat?this.SetUInt16(m,p,g/2):this.SetUInt32(m,p,g),w.Tables[w.IndexGlyfTable].NewLength=g,w.Tables[w.IndexGlyfTable].NewTable=c,w.Tables[w.IndexLocaTable].NewTable=m}let r=new Uint8Array(this.TtfHeaderSize+16*w.NumTablesRequired),t=(this.copyUint8Array(d,w.HeaderOffset,r,0,r.length),1);while(2<<t-1<=w.NumTablesRequired)t++;let e=16*(2<<--t-1),i=t,n=16*w.NumTablesRequired-e,a=(this.SetUInt16(r,4,w.NumTablesRequired),this.SetUInt16(r,6,e),this.SetUInt16(r,8,i),this.SetUInt16(r,10,n),0),s=this.TtfHeaderSize+16*w.NumTablesRequired;for(let i=0;i<w.NumTables;i++)if(w.Tables[i].Required){w.Tables[i].NewOffset=s;let t=(s+=w.Tables[i].NewLength)%4,e=(0<t&&(s+=4-t),this.TtfHeaderSize+16*a);this.SetUInt32(r,e,w.Tables[i].Tag),this.SetUInt32(r,e+4,w.Tables[i].CheckSum),this.SetUInt32(r,e+8,w.Tables[i].NewOffset),this.SetUInt32(r,e+12,w.Tables[i].NewLength),a++}(l=new K).writeBytes(r,0,r.length);for(let e=0;e<w.NumTables;e++)if(w.Tables[e].Required){null!=w.Tables[e].NewTable?l.writeBytes(w.Tables[e].NewTable,0,w.Tables[e].NewLength):l.writeBytes(d,w.Tables[e].Offset,w.Tables[e].NewLength);let t=w.Tables[e].NewLength%4;0<t&&l.write(it.create(Number,4-t),0,4-t)}l.flush()}return l}scanFontFile(r,n){let a=null,e=this.GetUInt32(r,0);if(65536==e||1330926671==e)a=this.getTtfInfo(r,0);else{let t=this.GetUInt32(r,4);if(1953784678==e&&(65536==t||131072==t)){let t=this.GetUInt32(r,8);for(let i=t-1;0<=i;i--){let t=this.GetUInt32(r,12+4*i),e=this.GetUInt32(r,t);if(65536==e&&(a=this.getTtfInfo(r,t)).FontName.contains(n))break}}}return a}getCmapTable(h,t){let c=null,n=t.Tables[t.IndexCmapTable].Offset,e=this.GetUInt16(h,n+2);for(let r=0;r<e;r++){let t=n+4+8*r,e=this.GetUInt16(h,t),i=this.GetUInt16(h,t+2),l=n+this.GetUInt32(h,t+4);if(3==e&&(1==i||0==i)){let t=this.GetUInt16(h,l);if(4==t){c=it.create(Number,65536);for(let t=0;t<65536;t++)c[t]=65535;let o=this.GetUInt16(h,l+6);for(let e=0;e<o;e+=2){let r=l+14+e,t=this.GetUInt16(h,r),n=this.GetUInt16(h,r+2+o),a=this.GetInt16(h,r+2+2*o),s=this.GetUInt16(h,r+2+3*o);if(65535!=n)for(let i=n;i<=t;i++){let e=65535;if(0==s)e=a+i&65535;else{let t=s+2*(i-n)+(r+2+3*o);0!=(e=this.GetUInt16(h,t))&&(e+=a)}c[i]=e}}}}}return c}copyUint8Array(e,i,r,n,a){for(let t=0;t<a;t++)r[n+t]=e[i+t]}getTtfInfo(h,t){let c=new Vr;c.HeaderOffset=t,c.SfntVersion=this.GetUInt32(h,c.HeaderOffset),c.NumTables=this.GetUInt16(h,c.HeaderOffset+4),c.NumTablesRequired=0,c.Tables=[];for(let t=0;t<c.NumTables;t++)c.Tables[t]=new jr;for(let r=0;r<c.NumTables;r++){let e=c.HeaderOffset+this.TtfHeaderSize+16*r,i=new ct;for(let t=0;t<4;t++)i.append(String.fromCharCode(this.GetUInt8(h,e+t)));c.Tables[r].Tag=this.GetUInt32(h,e),c.Tables[r].TagString=i.toString(),c.Tables[r].CheckSum=this.GetUInt32(h,e+4),c.Tables[r].Offset=this.GetUInt32(h,e+8),c.Tables[r].Length=this.GetUInt32(h,e+12),c.Tables[r].NewLength=c.Tables[r].Length;for(let t=0;t<this.TablesNames.length;t++)if(c.Tables[r].TagString==this.TablesNames[t]){c.Tables[r].Required=!0,c.NumTablesRequired++;break}switch(c.Tables[r].TagString){case"head":c.IndexToLocFormat=this.GetUInt16(h,c.Tables[r].Offset+50);break;case"maxp":c.NumGlyphs=this.GetUInt16(h,c.Tables[r].Offset+4);break;case"loca":c.IndexLocaTable=r;break;case"glyf":c.IndexGlyfTable=r;break;case"cmap":c.IndexCmapTable=r;break;case"CFF ":c.IndexCFFTable=r;break;case"name":{let o=c.Tables[r].Offset,t=this.GetUInt16(h,o+2),l=this.GetUInt16(h,o+4);for(let s=0;s<t;s++){let t=o+6+12*s,e=this.GetUInt16(h,t),i=this.GetUInt16(h,t+2),r=this.GetUInt16(h,t+6),n=this.GetUInt16(h,t+8),a=this.GetUInt16(h,t+10);if(3==e&&1==i&&1==r||0==e&&3==i&&1==r){let e=new ct;for(let t=0;t<n/2;t++)e.append(String.fromCharCode(this.GetUInt16(h,o+l+a+2*t)));let t=e.toString();c.FontName.set(t,t)}}break}}}return c}GetUInt8(t,e){return t[e]}GetUInt16(t,e){return(t[e]<<8)+t[e+1]}GetUInt32(t,e){return(t[e]<<24)+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3]}GetInt16(t,e){let i=(t[e]<<8)+t[e+1];return 32767<i?i-65536:i}SetUInt16(t,e,i){t[e+0]=i>>>8&255,t[e+1]=255&i}SetUInt32(t,e,i){t[e+0]=i>>>24&255,t[e+1]=i>>>16&255,t[e+2]=i>>>8&255,t[e+3]=255&i}clear(){this.fonts=null,this.fontList=null,this.UnicodeMapsList=null,this.GlyphMapsList=null,this.Widths=null,this.CharPdfNames=null,this.UnicodeMap=null,this.UnicodeMapBack=null,this.GlyphList=null,this.GlyphBackList=null,this.GlyphMap=null,this.SymsToPDF=null,this.GlyphWidths=null,this.fontsInfoStore.clear()}getFontDataBuf(t,e){return this.getFontDataFromGdi(t,e)}getFontDataFromGdi(i,e){let r=null;if(Yr.isFontStimulsoft(i.name)){let t=J.a.Resources.StimulsoftFont.getContent();return new Uint8Array(t)}let n=Z.Base.StiFontCollection.getBinFont(i.name,i.style);if(null==(r=(r=null!=n?n.data:null)instanceof Uint8Array?r:null)){let t=0<(i.style&Le.Bold),e=0<(i.style&Le.Italic);t&&e?null!=(n=Z.Base.StiFontCollection.getBinFont(i.name,Le.Italic))&&null!=n.data?(r=n.data,this.NeedSyntBold=!0):null!=(n=Z.Base.StiFontCollection.getBinFont(i.name,Le.Bold))&&null!=n.data?(r=n.data,this.NeedSyntItalic=!0):null!=(n=Z.Base.StiFontCollection.getBinFont(i.name,Le.Regular))&&null!=n.data&&(r=n.data,this.NeedSyntItalic=!0,this.NeedSyntBold=!0):(t&&null!=(n=Z.Base.StiFontCollection.getBinFont(i.name,Le.Regular))&&null!=n.data&&(r=n.data,this.NeedSyntBold=!0),e&&null!=(n=Z.Base.StiFontCollection.getBinFont(i.name,Le.Regular))&&null!=n.data&&(r=n.data,this.NeedSyntItalic=!0))}if(null==r){let t=e.dictionary.resources.getByName(i.name);null!=(t=null==t?e.dictionary.resources.getByAlias(i.name):t)&&null!=t.content&&0<t.content.length&&(r=new Uint8Array(t.content),this.NeedSyntBold=!0,this.NeedSyntItalic=!0,Kt.addCustomFontBytes(r,i.name))}return r}}J.c.PdfFonts=Yr;class qr{clear(){}}J.c.FontsInfoStore=qr}let ke=Z.Base.Context.StiPenGeom,Be=Z.Base.Drawing.StiPenUtils,De=Z.System.Drawing.Drawing2D.DashStyle,Ie=Z.System.Drawing.StringFormat,Re=Z.System.Drawing.StringAlignment,Ne=Z.System.Drawing.StringFormatFlags,Me=Z.System.Drawing.Pen,Oe=Z.System.Drawing.Size;{let o=Z.System.Drawing.Rectangle;J.c.StiPdfGeomWriter=class{calculateMinMax(t){null==this.xmin?this.xmin=t.x:this.xmin=Math.min(this.xmin,t.x),null==this.xmax?this.xmax=t.x:this.xmax=Math.max(this.xmax,t.x),null==this.ymin?this.ymin=t.y:this.ymin=Math.min(this.ymin,t.y),null==this.ymax?this.ymax=t.y:this.ymax=Math.max(this.ymax,t.y)}convertToString(t){return $.round2(t,this.precision_digits).toString()[Z.System.StiObject.stimulsoft]().replaceAll(",",Z.System.Globalization.CultureInfo.currentCulture.numberFormat.numberDecimalSeparator)}setPen(a,s=!1,o=!1){if(null==a)return!1;let l=!1;if(a.is(Me)){let t=a,e=(this.pdfService.setStrokeColor(t.color),t.width>this.hiToTwips?t.width:t.width*this.hiToTwips),i=(0==e&&(e=this.penWidthDefault),t.Width),r=(this.allowThinLines&&(e=t.width<.5||o&&1==t.width?this.penWidthDefault:t.width,i=.1<e?e:4*this.penWidthDefault),this.pageStream.writeLine1("{0} w",this.convertToString(e)),(l=s&&t.dashStyle!=De.Solid)&&this.pageStream.writeLine("q"),this.getPenStyleDashString(t.dashStyle,.035*i));null!=r&&this.pageStream.writeLine(r)}if(a.is(ke)){let t=a,e=rt.transparent,i=(e=t.brush instanceof rt?t.brush:lt.toColor(t.brush.as(lt)),this.pdfService.setStrokeColor(e),t.thickness>this.hiToTwips?t.thickness:t.thickness*this.hiToTwips),r=(0==i&&(i=this.penWidthDefault),t.Width),n=(this.allowThinLines&&(i=t.thickness<.5||o&&1==t.thickness?this.penWidthDefault:t.thickness,r=.1<i?i:4*this.penWidthDefault),this.pageStream.writeLine1("{0} w",this.convertToString(i)),(l=s&&t.penStyle!=ot.Solid)&&this.pageStream.writeLine("q"),this.getPenStyleDashString(Be.getPenStyle(t.penStyle),.035*r));null!=n&&this.pageStream.writeLine(n)}return l}setBrush(s,o,t=!1,e=null){if(null!=e&&(e.ref=!1),null==s)return!1;if(this.assembleData)return s instanceof rt||!(s.is(Ft)||s.is(Ee)||s.is(be)||s.is(ve)||s.is(ye))||(this.pdfService.storeShadingData1(s.as(lt),this.pageNumber),this.pdfService.storeHatchData(s.as(lt))),!1;let l=!1,i=rt.transparent;if(s instanceof rt?i=s:0==(i=lt.toColor(s.as(lt))).a&&s.is(ve)&&(i=s.as(ve).backColor),this.pdfService.setNonStrokeColor(i),0==i.a&&null!=e&&(e.ref=!0),!(s instanceof rt)&&(s.is(Ft)||s.is(Ee)||s.is(be)||s.is(ve)||s.is(ye))){let t=this.matrixCache[Z.System.StiObject.stimulsoft]().peek(),e=new v(o.x,o.bottom),i=new v(o.right,o.y),r=[e,i],n=(t.transformPoints(r),new mt(r[0].x,r[0].y,r[1].x-r[0].x,r[1].y-r[0].y)),a=this.pdfService.storeShadingData2(Math.min(n.x,n.right),Math.min(n.y,n.bottom),Math.abs(n.width),Math.abs(n.height),s.as(lt),this.componentAngle);if((s.is(Ft)||s.is(Ee)||s.is(be))&&this.pageStream.writeLine1("/Pattern cs /P{0} scn",1+a),s.is(ve)){let t=s;this.pageStream.writeLine1("/Cs1 cs /PH{0} scn",this.pdfService.getHatchNumber(t)+1)}if(s.is(ye)){let t=s.as(ye);this.pdfService.setNonStrokeColor(t.getTopColor()),this.pdfService.setNonStrokeColor(t.getBottomColor())}l=!0}return(l=l&&t)&&this.pageStream.writeLine("q"),l}outputLineString(e,i,r=!1){if(null!=i){let t=this.setPen(i,!0,r);this.pageStream.writeLine(e),t&&this.pageStream.writeLine("Q")}}convertArcToBezierPoints(t,i,e){let r=t.x+t.width/2,n=t.y+t.height/2,a=t.width/2,s=t.height/2,o=(i*=Math.PI/180,Math.ceil(Math.abs(e*=Math.PI/180)/(Math.PI/2))),l=it.create(v,3*o+1,!0),h=e/o,c=Math.sin(h/2),m=Math.cos(h/2),g=4*(1-m)/3,p=c-g*m/(c+1e-4),d=[],w=[],u=(d[0]=m,w[0]=-c,d[1]=m+g,w[1]=-p,d[2]=m+g,w[2]=p,d[3]=m,w[3]=c,Math.sin(i+h/2)),S=Math.cos(i+h/2);l[0].x=r+a*(d[0]*S-w[0]*u),l[0].y=n+s*(d[0]*u+w[0]*S);for(let e=0;e<o;e++){let t=i+h*e;u=Math.sin(t+h/2),S=Math.cos(t+h/2);for(let t=1;t<=3;t++)l[t+3*e].x=r+a*(d[t]*S-w[t]*u),l[t+3*e].y=n+s*(d[t]*u+w[t]*S)}return l}convertSplineToCubicBezier(i,r){let t=i.length,e=3*t-2,n=[];r*=.3,n[0]=i[0],n[1]=this.calculateCurveBezierEndPoints(i[0],i[1],r);for(let e=0;e<t-2;e++){let t=this.calculateCurveBezier(i,e,r);n[3*e+2]=t[0],n[3*e+3]=i[e+1],n[3*e+4]=t[1]}return n[e-2]=this.calculateCurveBezierEndPoints(i[t-1],i[t-2],r),n[e-1]=i[t-1],n}calculateCurveBezier(t,e,i){let r=t[e+2].x-t[e+0].x,n=t[e+2].y-t[e+0].y,a=new v(t[e+1].x-i*r,t[e+1].y-i*n),s=new v(t[e+1].x+i*r,t[e+1].y+i*n);return[a,s]}calculateCurveBezierEndPoints(t,e,i){return new v(i*(e.x-t.x)+t.x,i*(e.y-t.y)+t.y)}getPointString(t){return this.calculateMinMax(t),nt.format("{0} {1} {2} ",this.convertToString(t.x),this.convertToString(t.y),this.makepath&&0<this.path.length&&!this.forceNewPoint?"l":"m")}getLineToString(t){return this.calculateMinMax(t),nt.format("{0} {1} l ",this.convertToString(t.x),this.convertToString(t.y))}getRectString4(t,e,i,r){return this.getRectString(new mt(t,e,i,r))}getRectString(t){return nt.format("{0} {1} {2} {3} re ",this.convertToString(t.x),this.convertToString(t.top),this.convertToString(t.right-t.x),this.convertToString(t.bottom-t.y))}getRectWithCornersString(t,e){if(null==e)return this.getRectString(t);this.beginPath();let i=Math.min(t.width/2,t.height/2),r=2*Math.min(Math.max(e.topLeft*this.cornerScaling,0),i);return 0==e.topLeft?this.moveTo(new v(t.x,t.top)):this.drawArc(new mt(t.x,t.top,r,r),180,90),r=2*Math.min(Math.max(e.topRight*this.cornerScaling,0),i),0==e.topRight?this.moveTo(new v(t.right,t.top)):this.drawArc(new mt(t.right-r,t.top,r,r),270,90),r=2*Math.min(Math.max(e.bottomRight*this.cornerScaling,0),i),0==e.bottomRight?this.moveTo(new v(t.right,t.bottom)):this.drawArc(new mt(t.right-r,t.bottom-r,r,r),0,90),r=2*Math.min(Math.max(e.bottomLeft*this.cornerScaling,0),i),0==e.bottomLeft?this.moveTo(new v(t.x,t.bottom)):this.drawArc(new mt(t.x,t.bottom-r,r,r),90,90),this.closeFigure(),this.endPath(),this.path.toString()}getBezierString(t,e,i){return this.calculateMinMax(t),this.calculateMinMax(e),this.calculateMinMax(i),nt.format("{0} {1} {2} {3} {4} {5} c ",this.convertToString(t.x),this.convertToString(t.y),this.convertToString(e.x),this.convertToString(e.y),this.convertToString(i.x),this.convertToString(i.y))}getBezierString2(t,e,i,r,n,a){return this.calculateMinMax(new v(t,e)),this.calculateMinMax(new v(i,r)),this.calculateMinMax(new v(n,a)),nt.format("{0} {1} {2} {3} {4} {5} c ",this.convertToString(t),this.convertToString(e),this.convertToString(i),this.convertToString(r),this.convertToString(n),this.convertToString(a))}getPolylineString(e,t,i){let r=new ct;i||r.append(this.getPointString(e[0]));for(let t=i?0:1;t<e.length;t++)r.append(this.getLineToString(e[t]));return t&&r.append("h "),r.toString()}getEllipseString4(t,e,i,r){return this.getEllipseString(new mt(t,e,i,r))}getEllipseString(t){let e=t.width/2*(1-this.pdfCKT),i=t.height/2*(1-this.pdfCKT),r=new ct;return r.appendFormat("{0} {1} m ",this.convertToString(t.x),this.convertToString(t.y+t.height/2)),r.append(this.getBezierString2(t.x,t.y+t.height-i,t.x+e,t.y+t.height,t.x+t.width/2,t.y+t.height)),r.append(this.getBezierString2(t.x+t.width-e,t.y+t.height,t.x+t.width,t.y+t.height-i,t.x+t.width,t.y+t.height/2)),r.append(this.getBezierString2(t.x+t.width,t.y+i,t.x+t.width-e,t.y,t.x+t.width/2,t.y)),r.append(this.getBezierString2(t.x+e,t.y,t.x,t.y+i,t.x,t.y+t.height/2)),r.toString()}getPenStyleDashString(t,e){switch(t){case De.Dot:return nt.format("[{0} {1}] 0 d",this.convertToString(e),this.convertToString(58*e));case De.Dash:return nt.format("[{0} {1}] 0 d",this.convertToString(49.5*e),this.convertToString(62*e));case De.DashDot:return nt.format("[{0} {1} {2} {1}] 0 d",this.convertToString(50*e),this.convertToString(55*e),this.convertToString(e));case De.DashDotDot:return nt.format("[{0} {1} {2} {1} {2} {1}] 0 d",this.convertToString(50*e),this.convertToString(55*e),this.convertToString(e))}return null}beginPath(){if(this.assembleData)return;this.path=new ct,this.makepath=!0,this.pathClosed=!1,this.xmin=null,this.xmax=null,this.ymin=null,this.ymax=null,this.forceNewPoint=!1}closeFigure(){if(this.assembleData)return;this.path.append("h "),this.pathClosed=!0}endPath(){if(this.assembleData)return;this.makepath=!1}fillPath(t){let e=this.assembleData?new mt:new mt(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),i={ref:!1},r=this.setBrush(t,e,!0,i),n=i.ref;if(this.assembleData)return;this.pathClosed||this.endPath(),n||(this.pageStream.writeString(this.path.toString()),this.pageStream.writeLine("f")),r&&this.pageStream.writeLine("Q")}strokePath(t){if(this.assembleData)return;this.setPen(t),this.pageStream.writeString(this.path.toString()),this.pageStream.writeLine("S")}moveTo(t){if(this.assembleData)return;this.lastPoint=t;let e=this.getPointString(t);this.makepath?this.path.appendLine(e):this.pageStream.writeLine(e)}drawLine(e,i,r){if(this.assembleData)return;let n=this.getPointString(e)+this.getLineToString(i);if(this.makepath)this.path.appendLine(n);else{let t=e.x==i.x||e.y==i.y;this.outputLineString(n+"S",r,t)}this.lastPoint=i}drawLineTo(t,e){if(this.assembleData)return;let i=this.getLineToString(t);this.makepath?this.path.appendLine(i):this.outputLineString(i+"S",e),this.lastPoint=t}drawRectangle(t,e,i){if(this.assembleData)return;this.outputLineString(this.getRectWithCornersString(t,i)+"S",e)}fillRectangle(e,i,r){let t={ref:!1},n=this.setBrush(i,e,!0,t),a=t.ref;if(this.assembleData)return;if(null!=i&&!a){let t=i.as(ye);null!=t?(this.pdfService.setNonStrokeColor(t.getTopColor()),null==r?this.pageStream.writeLine(this.getRectString4(e.x,e.y,e.width,e.height/2)+"f"):this.pageStream.writeLine(this.getRectWithCornersString(new mt(e.x,e.y,e.width,e.height/2),new Zt(r.topLeft,r.topRight,0,0))+"f"),this.pdfService.setNonStrokeColor(t.getBottomColor()),null==r?this.pageStream.writeLine(this.getRectString4(e.x,e.y+e.height/2,e.width,e.height/2)+"f"):this.pageStream.writeLine(this.getRectWithCornersString(new mt(e.x,e.y+e.height/2,e.width,e.height/2),new Zt(0,0,r.bottomRight,r.bottomLeft))+"f")):this.pageStream.writeLine(this.getRectWithCornersString(e,r)+"f")}n&&this.pageStream.writeLine("Q")}drawPolygon(t,e){this.drawPolyline(t,e,!0)}drawPolyline(t,e,i=!1,r=!1){if(this.assembleData)return;let n=this.getPolylineString(t,i,r);this.makepath?this.path.appendLine(n):this.outputLineString(n+"S",e),this.lastPoint=t[t.length-1]}drawPolylineTo(t,e){this.drawPolyline(t,e,!1,!0)}fillPolygon(e,t){for(let t of e)this.calculateMinMax(t);let i=new mt(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),r={ref:!1},n=this.setBrush(t,i,!0,r),a=r.ref;if(this.assembleData)return;if(null!=t&&!a){let t=this.getPolylineString(e,!0,!1);this.pageStream.writeLine(t+"f")}n&&this.pageStream.writeLine("Q")}fillPolygons(t,e){for(let e of t)for(let t of e)this.calculateMinMax(t);let i=new o(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),r={ref:!1},n=this.setBrush(e,i,!0,r),a=r.ref;if(this.assembleData)return;if(this.makepath)throw new Error;if(null!=e&&!a)for(let e of t){let t=this.getPolylineString(e,!0,!1);this.pageStream.writeLine(t+"f")}n&&this.pageStream.writeLine("Q")}drawBezier(t,e,i,r,n){if(this.assembleData)return;let a=this.getPointString(t)+this.getBezierString(e,i,r);this.makepath?this.path.appendLine(a):this.outputLineString(a+"S",n),this.lastPoint=r}drawBezierTo(t,e,i,r){if(this.assembleData)return;let n=this.getBezierString(t,e,i);this.makepath?this.path.appendLine(n):this.outputLineString(n+"S",r),this.lastPoint=i}drawSpline(t,e,i){if(this.assembleData)return;let r=this.convertSplineToCubicBezier(t,e),n=(r.length-1)/3,a=new ct;a.append(this.getPointString(r[0])+this.getBezierString(r[1],r[2],r[3]));for(let t=1;t<n;t++)a.append(this.getBezierString(r[3*t+1],r[3*t+2],r[3*t+3]));this.makepath?this.path.appendLine(a.toString()):this.outputLineString(a.toString()+"S",i),this.lastPoint=r[r.length-1]}drawArc(t,e,i){if(this.assembleData)return;let r=this.convertArcToBezierPoints(t,e,i),n=(r.length-1)/3;this.drawBezier(r[0],r[1],r[2],r[3],null);for(let t=1;t<n;t++)this.drawBezierTo(r[3*t+1],r[3*t+2],r[3*t+3],null)}drawEllipse(t,e){if(this.assembleData)return;this.outputLineString(this.getEllipseString(t)+"S",e)}fillEllipse(t,e){let i={ref:!1},r=this.setBrush(e,t,!0,i),n=i.ref;if(this.assembleData)return;null==e||n||this.pageStream.writeLine(this.getEllipseString(t)+"f"),r&&this.pageStream.writeLine("Q")}drawPie(t,e,i){if(this.assembleData)return;let r=this.convertArcToBezierPoints(t,e,i),n=(r.length-1)/3,a=t.x+t.width/2,s=t.y+t.height/2;this.drawBezier(r[0],r[1],r[2],r[3],null);for(let t=1;t<n;t++)this.drawBezierTo(r[3*t+1],r[3*t+2],r[3*t+3],null);this.drawLineTo(new v(a,s),null),this.drawLineTo(r[0],null)}drawString(t,e,i,r,n){if(this.assembleData)return null!=e&&this.pdfService.pdfFont.getFontNumber(e),this.pdfService.pdfFont.storeUnicodeSymbolsInMap(t),this.pdfService.storeShadingData1(i,this.pageNumber),void this.pdfService.storeHatchData(i);let a=new et,s=(a.clientRectangle=new o(r.x,r.y,r.width,r.height),a.text=t,a.font=e,a.textBrush=i,(n=n||new Ie).alignment==Re.Center&&(a.horAlignment=at.Center),n.alignment==Re.Far&&(a.horAlignment=at.Right),n.lineAlignment==Re.Center&&(a.vertAlignment=st.Center),n.lineAlignment==Re.Far&&(a.vertAlignment=st.Bottom),0==(n.formatFlags&Ne.NoWrap)&&(a.wordWrap=!0),new J.c.StiPdfData(this.pdfService));s.Component=a,s.Width=r.width*this.hiToTwips,s.Height=r.height*this.hiToTwips,this.pageStream.writeLine("q"),this.pdfService.pushColorToStack(),this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(r.x),this.convertToString(r.y+r.height)),this.pageStream.writeLine("1.39 0 0 -1.39 0 0 cm"),J.c.StiPdfRenderText.renderTextFont(s),J.c.StiPdfRenderText.renderText(s),this.pageStream.writeLine("Q"),this.pdfService.popColorFromStack()}saveState(){if(this.assembleData)return;this.pageStream.writeLine("q"),this.pdfService.pushColorToStack(),0<this.matrixCache.length&&this.matrixCache.push(this.matrixCache[Z.System.StiObject.stimulsoft]().peek().clone())}restoreState(){if(this.assembleData)return;this.pageStream.writeLine("Q"),this.pdfService.popColorFromStack(),0<this.matrixCache.length&&this.matrixCache.pop()}translateTransform(t,e){if(this.assembleData)return;this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(t),this.convertToString(e)),0<this.matrixCache.length&&this.matrixCache[Z.System.StiObject.stimulsoft]().peek().translate(t,e)}rotateTransform(t){if(this.assembleData)return;let e=t*Math.PI/180;this.pageStream.writeLine1("{0} {1} {2} {3} 0 0 cm",this.convertToString(Math.cos(e)),this.convertToString(Math.sin(e)),this.convertToString(-Math.sin(e)),this.convertToString(Math.cos(e))),0<this.matrixCache.length&&this.matrixCache[Z.System.StiObject.stimulsoft]().peek().rotate(t)}rotateTransform2(t,e,i){if(this.assembleData)return;let r=t*Math.PI/180;this.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} cm",this.convertToString(Math.cos(r)),this.convertToString(Math.sin(r)),this.convertToString(-Math.sin(r)),this.convertToString(Math.cos(r)),this.convertToString(e),this.convertToString(i)),0<this.matrixCache.length&&this.matrixCache[Z.System.StiObject.stimulsoft]().peek().translate(e,i).rotate(t)}setClip(t){if(this.assembleData)return;this.pageStream.writeLine(this.getRectString(t)+"W n")}drawArc2(t,e,i,r){}drawText(t,e,i,r,n,a,s){}setPixel(t,e){}measureString(t,e){return new Oe(0,0)}drawImage(t,e){let i=new Q;if(i.clientRectangle=e,i.imageToDraw=t,i.smoothing=!0,i.stretch=!0,this.assembleData)return void this.pdfService.storeImageDataForGeom(i);let r=new J.c.StiPdfData(this.pdfService);r.Component=i,r.Width=e.width,r.Height=e.height,this.pageStream.writeLine("q"),this.pdfService.pushColorToStack(),this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(e.x),this.convertToString(e.y+e.height)),this.pageStream.writeLine("1 0 0 -1 0 0 cm"),this.pdfService.renderImage(r,100),this.pageStream.writeLine("Q"),this.pdfService.popColorFromStack()}constructor(t,e,i=!1,r=!1,n=.72){this.penWidthDefault=.1,this.precision_digits=3,this.hiToTwips=.72,this.pdfCKT=.55228,this.makepath=!1,this.pathClosed=!1,this.path=null,this.allowThinLines=!1,this.cornerScaling=this.hiToTwips,this.pageStream=null,this.pdfService=null,this.assembleData=!1,this.pageNumber=0,this.matrixCache=null,this.componentAngle=0,this.forceNewPoint=!1,this.xmin=null,this.xmax=null,this.ymin=null,this.ymax=null,this.pageStream=t,this.pdfService=e,this.assembleData=i,this.allowThinLines=r,this.cornerScaling=n,this.matrixCache=new Array}}}let He=J.a.Painters.StiSparklinePainter,We=Z.Base.Context.StiContext,ze=Z.Base.Context.StiContextPainter,Ue=Z.Base.Drawing.StiRotationMode,Xe=Z.Base.Context.StiPushTranslateTransformGeom,Ge=Z.Base.Context.StiPushRotateTransformGeom,je=Z.Base.Context.StiPopTransformGeom,Ve=Z.Base.Context.StiBorderGeom,Ye=Z.Base.Context.StiLineGeom,qe=Z.Base.Context.StiLinesGeom,_e=Z.Base.Context.StiPushClipGeom,Ke=Z.Base.Context.StiPopClipGeom,Qe=Z.Base.Context.StiPushSmothingModeToAntiAliasGeom,Ze=Z.Base.Context.StiPopSmothingModeGeom,Je=Z.Base.Context.StiPushTextRenderingHintToAntiAliasGeom,$e=Z.Base.Context.StiPopTextRenderingHintGeom,ti=Z.Base.Context.StiCurveGeom,ei=Z.Base.Context.StiBezierSegmentGeom,ii=Z.Base.Context.StiEllipseGeom,ri=Z.Base.Context.StiCachedShadowGeom,ni=Z.Base.Drawing.StiShadowSides,ai=Z.Base.Context.StiTextGeom,si=Z.Base.Context.StiPathGeom,oi=Z.Base.Context.StiPieSegmentGeom,li=Z.Base.Context.StiArcSegmentGeom,hi=Z.Base.Context.StiLineSegmentGeom,ci=Z.Base.Context.StiLinesSegmentGeom,mi=Z.Base.Context.StiCurveSegmentGeom,gi=Z.Base.Context.StiCloseFigureSegmentGeom,pi=(J.c.StiPdfRenderChart=class{static renderChart(e,t,i){let r=e.Component.as(Ae),n=.96,a=e.service.report.unit.convertToHInches(e.Component.width)*n,s=e.service.report.unit.convertToHInches(e.Component.height)*n,o=0,l=0,h=0,c=1,m=1;switch(r.rotation){case O.Rotate90CCW:o=-90,h=s;break;case O.Rotate90CW:o=90,l=a;break;case O.Rotate180:o=-180,l=a,h=s;break;case O.FlipVertical:m=-1,h=s;break;case O.FlipHorizontal:c=-1,l=a;break}switch(r.rotation){case O.Rotate90CCW:case O.Rotate90CW:{let t=a;a=s,s=t;break}}if(!t&&r.rotation!=O.None){let t=new Fe(1,0,0,1,0,0);t.translate(l,h),t.scale(c,m),t.rotate(o),e.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} cm",e.service.convertToString(t.elements[0]),e.service.convertToString(t.elements[1]),e.service.convertToString(t.elements[2]),e.service.convertToString(t.elements[3]),e.service.convertToString(t.elements[4]),e.service.convertToString(t.elements[5]))}let g=new ze,p=new We(g,!0,!1,!1,1),d=r.isAnimation,w=(r.isAnimation=!1,r.core.render(p,new mt(0,0,a,s),!0));w.drawGeom(p),r.isAnimation=d,this.renderContext(e,t,i,p,!0)}static renderSparkline(t,e,i){let r=t.Component.as(ce),n=.96,a=t.service.report.unit.convertToHInches(t.Component.width)*n,s=t.service.report.unit.convertToHInches(t.Component.height)*n,o=new ze,l=new We(o,!0,!1,!1,1);He.renderSparkline(l,new mt(0,0,a,s),r,1),this.renderContext(t,e,i,l)}static renderContext(t,e,i,r,n=!1){let a,s,o,l,h=new Fe(1,0,0,1,0,0),c=t.service.hiToTwips/.96,m=(h.translate(t.X,t.Y+t.Height),h.scale(1,-1),h.scale(c,c),new J.c.StiPdfGeomWriter(t.service.pageStream,t.service,e,n,1));m.pageNumber=i,m.matrixCache.push(h);for(let e of r.geoms){if(e.is(Xe)){let t=e;m.saveState(),m.translateTransform(t.x,t.y)}if(e.is(Ge)){let t=e;m.saveState(),m.rotateTransform(t.angle)}if(e.is(je)&&m.restoreState(),e.is(_e)){let t=e;m.saveState(),m.setClip(t.clipRectangle)}if(e.is(Ke)&&m.restoreState(),e.is(Qe)&&m.saveState(),e.is(Ze)&&m.restoreState(),e.is(Je)&&m.saveState(),e.is($e)&&m.restoreState(),e.is(Ve)){let t=e;null!=t.background&&m.fillRectangle(this.rectToRectangle(t.rect),t.background,t.cornerRadius),this.checkPenGeom(t.borderPen)&&m.drawRectangle(this.rectToRectangle(t.rect),t.borderPen,t.cornerRadius)}if(e.is(Ye)){let t=e;this.checkPenGeom(t.pen)&&m.drawLine(new v(t.x1,t.y1),new v(t.x2,t.y2),t.pen)}if(e.is(qe)){let t=e;this.checkPenGeom(t.pen)&&m.drawPolyline(t.points,t.pen)}if(e.is(ti)){let t=e;this.checkPenGeom(t.pen)&&m.drawSpline(t.points,t.tension,t.pen)}if(e.is(ii)){let t=e;null!=t.background&&m.fillEllipse(this.rectToRectangle(t.rect),t.background),this.checkPenGeom(t.borderPen)&&m.drawEllipse(this.rectToRectangle(t.rect),t.borderPen)}if(e.is(ri)){let t=e,r=t.rect,n=t.sides,a=r.y+8,s=r.x+8,o=0<(n&ni.Edge)?4:0;0<(n&ni.Top)&&(a=r.y+4),0<(n&ni.Left)&&(s=r.x+4);for(let i=0;i<3;i++){let t=new Array,e=(0<(n&ni.Right)?(t.push(new v(r.right,a)),0<(n&ni.Bottom)?(t.push(new v(r.right,r.bottom)),t.push(new v(s,r.bottom)),t.push(new v(s,r.bottom+i+1)),t.push(new v(r.right+i+1,r.bottom+i+1))):(t.push(new v(r.right,r.bottom+o)),t.push(new v(r.right+i+1,r.bottom+o))),t.push(new v(r.right+i+1,a))):(t.push(new v(s,r.bottom)),t.push(new v(r.right+o,r.bottom)),t.push(new v(r.right+o,r.bottom+i+1)),t.push(new v(s,r.bottom+i+1))),new ie(rt.fromArgb3(40-10*i,rt.black)));m.fillPolygon(t,e)}}if(e.is(ai)){let n=e,a=new X(n.font.fontName,n.font.fontSize,n.font.fontStyle,n.font.unit),s=new Ie,o=(s.alignment=n.stringFormat.alignment,s.formatFlags=n.stringFormat.formatFlags,s.hotkeyPrefix=n.stringFormat.hotkeyPrefix,s.lineAlignment=n.stringFormat.lineAlignment,s.trimming=n.stringFormat.trimming,this.brushToStiBrush(n.brush));if(n.isRotatedText){let e=new v;if(n.location instanceof v)e=n.location;else{let t=this.rectToRectangle(n.location);e=new v(t.x+t.width/2,t.y+t.height/2)}let t=Kt.measureString(n.text,a,n.maximalWidth),i=new mt(0,0,t.width,t.height),r=this.getStartPoint(n.rotationMode,i);i.x-=r.x,i.y-=r.y,s.alignment==Z.System.Drawing.StringAlignment.Center&&--i.x,s.alignment==Z.System.Drawing.StringAlignment.Far&&(i.x-=2),i.width+=2.5,m.saveState(),m.translateTransform(e.x,e.y),0!=n.angle&&m.rotateTransform(n.angle),m.drawString(n.text,a,o,i,s),m.restoreState()}else m.drawString(n.text,a,o,this.rectToRectangle(n.location),s)}if(e.is(si)){let t=e;m.beginPath();for(let r of t.geoms){if(r.is(oi)){let t=r,e=null!=(a=t.realStartAngle)?a:t.startAngle,i=null!=(s=t.realSweepAngle)?s:t.sweepAngle;m.drawPie(t.rect,e,i)}if(r.is(li)){let t=r,e=null!=(o=t.realStartAngle)?o:t.startAngle,i=null!=(l=t.realSweepAngle)?l:t.sweepAngle;m.drawArc(t.rect,e,i)}if(r.is(hi)){let t=r;m.drawLine(new v(t.x1,t.y1),new v(t.x2,t.y2),null)}if(r.is(ci)){let t=r;m.drawPolyline(t.points,null)}if(r.is(mi)){let t=r;m.drawSpline(t.points,t.tension,null)}if(r.is(ei)){let t=r;m.drawBezierTo(t.pt2,t.pt3,t.pt4,null)}r.is(gi)&&m.closeFigure()}m.closeFigure(),m.endPath(),null!=t.background&&m.fillPath(t.background),this.checkPenGeom(t.pen)&&m.strokePath(t.pen)}}}static getStartPoint(t,e){let i=new v(e.x+e.width/2,e.y+e.height/2);switch(t){case Ue.LeftCenter:return new v(e.x,i.y);case Ue.LeftBottom:return new v(e.x,e.bottom);case Ue.CenterTop:return new v(i.x,e.top);case Ue.CenterCenter:return i;case Ue.CenterBottom:return new v(i.x,e.bottom);case Ue.RightTop:return new v(e.right,e.top);case Ue.RightCenter:return new v(e.right,i.y);case Ue.RightBottom:return new v(e.right,e.bottom);default:return new v(e.x,e.y)}}static rectToRectangle(t){if(null==t)return new mt;if(t instanceof mt)return t;return new mt}static brushToStiBrush(t){if(null==t)return null;return t instanceof rt?new ie(t):t}static checkPenGeom(t){return!(null==t||null==t.brush||t.penStyle==ot.None)}},J.a.Gauge.GaugeGeoms.StiTextGaugeGeom),di=J.a.Gauge.GaugeGeoms.StiRadialRangeGaugeGeom,wi=J.a.Gauge.GaugeGeoms.StiGraphicsPathLinesGaugeGeom,ui=J.a.Gauge.GaugeGeoms.StiGraphicsPathLineGaugeGeom,Si=J.a.Gauge.GaugeGeoms.StiGraphicsPathArcGaugeGeom,fi=J.a.Gauge.GaugeGeoms.StiGraphicsArcGeometryGaugeGeom,bi=J.a.Gauge.GaugeGeoms.StiPieGaugeGeom,Ei=J.a.Gauge.GaugeGeoms.StiEllipseGaugeGeom,vi=J.a.Gauge.GaugeGeoms.StiGraphicsPathGaugeGeom,yi=J.a.Gauge.GaugeGeoms.StiRectangleGaugeGeom,xi=J.a.Gauge.GaugeGeoms.StiRoundedRectangleGaugeGeom,Ai=J.a.Gauge.StiGaugeGeomType,Ti=J.a.Gauge.GaugeGeoms.StiPopTranformGaugeGeom,Fi=J.a.Gauge.GaugeGeoms.StiPushMatrixGaugeGeom,Ci=J.a.Painters.StiGaugeContextPainter,Pi=(J.c.StiPdfRenderGauge=class{static renderGauge(t,e,i){let r=t.Component.as(oe),n=r.isAnimation,a=(r.isAnimation=!1,.96),s=new Ci(r,new mt(0,0,t.service.report.unit.convertToHInches(t.Component.width)*a,t.service.report.unit.convertToHInches(t.Component.height)*a),a),o=(r.drawGauge(s),r.isAnimation=n,new Fe(1,0,0,1,0,0)),l=t.service.hiToTwips/.96,u=(o.translate(t.X,t.Y+t.Height),o.scale(1,-1),o.scale(l,l),new J.c.StiPdfGeomWriter(t.service.pageStream,t.service,e));u.pageNumber=i,u.matrixCache.push(o),u.saveState();for(let w of s.geoms){if(w.is(Fi)){let t=w;u.saveState(),u.rotateTransform2(t.angle,t.centerPoint.x,t.centerPoint.y),u.saveState(),u.translateTransform(-t.centerPoint.x,-t.centerPoint.y);continue}if(w.is(Ti)&&(u.restoreState(),u.restoreState()),w.type==Ai.RoundedRectangle){let t=w.as(xi),e=(u.beginPath(),1),i=t.rightTop,r=t.leftTop,n=t.rightBottom,a=t.leftBottom,s=t.rect,o=s.x+s.width-e,l=s.y+s.height-e,h=(u.moveTo(new v(s.x+r,s.y)),0!=i?(u.drawLineTo(new v(o-i,s.y),null),u.drawArc(new mt(o-i,s.y,2*i,2*i),270,90)):u.drawLineTo(new v(o,s.y),null),0!=n?(u.drawLineTo(new v(o,l-n),null),u.drawArc(new mt(o-n,l-n,2*n,2*n),0,90)):u.drawLineTo(new v(o,l),null),0!=a?(u.drawLineTo(new v(s.x+a,l),null),u.drawArc(new mt(s.x-a,l-a,2*a,2*a),90,90)):u.drawLineTo(new v(s.x,l),null),u.closeFigure(),u.endPath(),lt.isTransparent(t.background)||u.fillPath(t.background),this.getPenGeom(t));this.checkPenGeom(h)&&u.strokePath(h)}else if(w.type==Ai.Rectangle){let t=w.as(yi),e=(null!=t.background&&u.fillRectangle(t.rect,t.background,null),this.getPenGeom(t));this.checkPenGeom(e)&&u.drawRectangle(t.rect,e,null)}else if(w.type==Ai.GraphicsPath){let t=w.as(vi),i=(u.beginPath(),!1);for(let e of t.geoms)if(e.type==Ai.GraphicsPathArc){let t=e.as(Si);u.drawArc(new mt(t.x,t.y,t.width,t.height),t.startAngle,t.sweepAngle)}else if(e.type==Ai.GraphicsPathLine){let t=e.as(ui);u.drawLine(t.p1,t.p2,null)}else if(e.type==Ai.GraphicsPathLines){let t=e.as(wi);u.drawPolyline(t.points,null),u.closeFigure(),i=!0}else e.type==Ai.GraphicsPathCloseFigure&&(u.closeFigure(),i=!0);u.endPath(),i&&null!=t.background&&u.fillPath(t.background);let e=this.getPenGeom(t);this.checkPenGeom(e)&&0<t.borderWidth&&u.strokePath(e)}else if(w.type==Ai.Pie){let t=w.as(bi),e=(u.beginPath(),u.drawPie(t.rect,t.startAngle,t.sweepAngle),u.closeFigure(),u.endPath(),this.getPenGeom(t));this.checkPenGeom(e)&&u.strokePath(e)}else if(w.type==Ai.Ellipse){let t=w.as(Ei),e=(null!=t.background&&u.fillEllipse(t.rect,t.background),this.getPenGeom(t));this.checkPenGeom(e)&&u.drawEllipse(t.rect,e)}else if(w.type==Ai.GraphicsArcGeometry){let i=w.as(fi),h=new v(i.rect.left+i.rect.width/2,i.rect.top+i.rect.height/2),c=Math.min(i.rect.width/2,i.rect.height/2),m=c-i.rect.width*i.startWidth,t=c-i.rect.width*i.endWidth;if(0<m&&0<t){let e=this.round(Math.abs(i.sweepAngle/90)),r=i.sweepAngle/e,n=i.startAngle,a=(u.beginPath(),!0);for(let t=0;t<e;t++){let t=J.c.StiGaugeDrawingHelper.convertArcToCubicBezier(h,c,n,r);a&&(u.moveTo(t[0]),a=!1),u.drawBezierTo(t[1],t[2],t[3],null),n+=r}let s=m-t,o=1/e,l=0;a=!0,n=i.startAngle+i.sweepAngle;for(let t=0;t<e;t++){let t=m-s*l,e=m-s*(l+o),i=J.c.StiGaugeDrawingHelper.convertArcToCubicBezier2(h,t,e,n,-r);a&&(u.drawLineTo(i[0],null),a=!1),u.drawBezierTo(i[1],i[2],i[3],null),n-=r,l+=o}if(u.closeFigure(),u.endPath(),0<e){lt.isTransparent(i.background)||u.fillPath(i.background);let t=this.getPenGeom(i);this.checkPenGeom(t)&&u.strokePath(t)}}}else if(w.type==Ai.Text){let t=w.as(pi),e=new X(t.font.name,t.font.size,t.font.style,t.font.unit),i=new Ie;i.alignment=t.stringFormat.alignment,i.formatFlags=t.stringFormat.formatFlags,i.hotkeyPrefix=t.stringFormat.hotkeyPrefix,i.lineAlignment=t.stringFormat.lineAlignment,i.trimming=t.stringFormat.trimming,u.drawString(t.text,e,t.foreground,t.rect,i)}else if(w.type==Ai.RadialRange){let e=w.as(di),r=e.centerPoint,t=e.startAngle,i=e.sweepAngle,n=e.radius1,a=e.radius2,s=e.radius3,o=e.radius4,l=this.round(Math.abs(i/90)),h=i/l,c=(u.beginPath(),n-a),m=1/l,g=0,p=!0,d=t+i;for(let t=0;t<l;t++){let t=n-c*g,e=n-c*(g+m),i=J.c.StiGaugeDrawingHelper.convertArcToCubicBezier2(r,t,e,d,-h);p&&(u.moveTo(i[0]),p=!1),u.drawBezierTo(i[1],i[2],i[3],null),d-=h,g+=m}c=s-o,g=0,p=!0,d=t;for(let t=0;t<l;t++){let t=s-c*g,e=s-c*(g+m),i=J.c.StiGaugeDrawingHelper.convertArcToCubicBezier2(r,t,e,d,h);p&&(u.drawLineTo(i[0],null),p=!1),u.drawBezierTo(i[1],i[2],i[3],null),d+=h,g+=m}if(u.closeFigure(),u.endPath(),0<l){lt.isTransparent(e.background)||u.fillPath(e.background);let t=this.getPenGeom(e);this.checkPenGeom(t)&&u.strokePath(t)}}}u.restoreState()}static checkPenGeom(t){return!(null==t||null==t.brush||t.penStyle==ot.None)}static getPenGeom2(t,e){return new ke(t,e)}static getPenGeom(t){if(t.is(yi))return this.getPenGeom2(t.borderBrush,t.borderWidth);if(t.is(xi))return this.getPenGeom2(t.borderBrush,t.borderWidth);if(t.is(Ei))return this.getPenGeom2(t.borderBrush,t.borderWidth);if(t.is(vi))return this.getPenGeom2(t.borderBrush,t.borderWidth);if(t.is(bi))return this.getPenGeom2(t.borderBrush,t.borderWidth);if(t.is(fi))return this.getPenGeom2(t.borderBrush,t.borderWidth);if(t.is(di))return this.getPenGeom2(t.borderBrush,t.borderWidth);return null}static round(t){let e=Math.trunc(t),i=t-e;return 0<i?e+1:e}},J.a.Components.StiDataBarDirection),Li=(J.c.StiPdfRenderIndicators=class{static renderIndicators(w){let u=w.Component.as(et);if(null==u||null==u.indicator)return w;let S=new mt(w.X,w.Y,w.Width,w.Height),s=u.indicator.as(we);if(null!=s&&(s.icon!=de.None||null!=s.customIcon)){let t=w.service.imageList[w.service.imagesCurrent],e=t.Width*w.service.hiToTwips,i=t.Height*w.service.hiToTwips,r=S.clone(),n=w.service.hiToTwips;switch(r.inflate(-n,-n),s.alignment){case b.TopLeft:r=new mt(r.x,r.bottom-i,e,i),S.x+=r.width+1,S.width-=r.width+1;break;case b.TopCenter:r=new mt(r.x+(r.width-e)/2,r.bottom-i,e,i);break;case b.TopRight:r=new mt(r.right-e,r.bottom-i,e,i),S.width-=r.width+1;break;case b.MiddleLeft:r=new mt(r.x,r.y+(r.height-i)/2,e,i),S.x+=r.width+1,S.width-=r.width+1;break;case b.MiddleCenter:r=new mt(r.x+(r.width-e)/2,r.y+(r.height-i)/2,e,i);break;case b.MiddleRight:r=new mt(r.right-e,r.y+(r.height-i)/2,e,i),S.width-=r.width+1;break;case b.BottomLeft:r=new mt(r.x,r.y,e,i),S.x+=r.width+1,S.width-=r.width+1;break;case b.BottomCenter:r=new mt(r.x+(r.width-e)/2,r.y,e,i);break;case b.BottomRight:r=new mt(r.right-e,r.y,e,i),S.width-=r.width+1;break}let a=new J.c.StiPdfData(w.service);a.X=r.x,a.Y=r.y,a.Width=r.width,a.Height=r.height,w.service.writeImageInfo2(a,1,1)}let f=u.indicator.as(ge);if(null!=f&&(f.textPlacement==Pe.Inside||0!=f.value)){let a=S.clone(),t=w.service.hiToTwips,e=(a.inflate(-2*t,-2*t),f.textPlacement==Pe.Inside),i=f.maximum+Math.abs(f.minimum),s=f.value,r=a.width*Math.abs(f.minimum)/i,o=a.width*f.maximum/i,n=a.width*Math.abs(s)/i;if(e){let t=u.autoWidth;try{u.autoWidth=!0;let t=0==s?2:4,e=u.report.unit.convertToHInches(u.getActualSize().width)+t;e>n&&(n=e>a.width?a.width:e),0==s&&(s=n/i,0==o)&&(s=-s)}finally{u.autoWidth=t}}0<s&&n>o&&(n=o),s<0&&n>r&&(n=r);let l=f.direction,h=0,c=((l=l==Pi.Default?null!=u.textOptions&&u.textOptions.rightToLeft?Pi.RighToLeft:Pi.LeftToRight:l)==Pi.LeftToRight?a.x+=0<s?r:r-n:(h=180,a.x=0<s?a.right-r-n:a.right-r),a.width=n,a.clone()),m=(0<f.padding&&a.inflate(-f.padding*w.service.hiToTwips,-f.padding*w.service.hiToTwips),f.cornerRadius),g=Math.max(.48*Math.min(a.width,a.height),.5),p=0<(m=m*w.service.hiToTwips>g?g/w.service.hiToTwips:m)?new Zt(m):null,d=(s<0&&(h+=180),!1);if(0<a.width&&0<a.height){if(f.brushType==J.a.Components.StiBrushType.Gradient){let n;if(n=l==Pi.LeftToRight?0<s?new mt(S.left+r,S.top,o,S.height):new mt(S.left,S.top,r,S.height):s<0?new mt(S.left+o,S.top,r,S.height):new mt(S.left,S.top,o,S.height),0<a.width&&a.width<1&&(a.width=1),0<n.width&&n.width<1&&(n.width=1),0<n.width&&0<a.width){let t=s<0?f.negativeColor:f.positiveColor,e=me.light(t,200),i=(n.x-=.1*n.width,n.width+=.2*n.width,new Ft(t,e,h)),r=(w.service.fillRectBrush(i,a,p),w.service.shadingArray[w.service.shadingCurrent-1]);r.Angle=h,r.X=n.x,r.Y=n.y,r.Width=n.width,r.Height=n.height,r.FunctionIndex=w.service.getShadingFunctionNumber([t,e]),w.service.shadingArray[w.service.shadingCurrent-1]=r,d=!0}}else{let t=new ie(s<0?f.negativeColor:f.positiveColor);w.service.fillRectBrush(t,a,p)}f.showBorder&&(w.service.pageStream.writeLine("q"),w.service.pushColorToStack(),w.service.setStrokeColor(s<0?f.negativeBorderColor:f.positiveBorderColor),w.service.pageStream.writeLine1("{0} {1} {2} {3} re S",w.service.convertToString(c.x),w.service.convertToString(c.y),w.service.convertToString(c.width),w.service.convertToString(c.height)),w.service.pageStream.writeLine("Q"),w.service.popColorFromStack())}e&&(S=a),d||f.brushType!=J.a.Components.StiBrushType.Gradient||w.service.shadingCurrent++}let t=new J.c.StiPdfData(w.service);return t.X=S.x,t.Y=w.Y,t.Width=S.width,t.Height=w.Height,t.Component=w.Component,t}},J.a.Components.IStiCornerRadius),ki=J.a.Components.StiRoundedRectangleShapeType,Bi=J.a.Components.StiTriangleShapeType,Di=J.a.Components.StiArrowShapeType,Ii=J.a.Components.StiOctagonShapeType,Ri=J.a.Components.StiComplexArrowShapeType,Ni=J.a.Components.StiBentArrowShapeType,Mi=J.a.Components.StiChevronShapeType,Oi=J.a.Components.StiDivisionShapeType,Hi=J.a.Components.StiEqualShapeType,Wi=J.a.Components.StiFlowchartCardShapeType,zi=J.a.Components.StiFlowchartCollateShapeType,Ui=J.a.Components.StiFlowchartDecisionShapeType,Xi=J.a.Components.StiFlowchartManualInputShapeType,Gi=J.a.Components.StiFlowchartOffPageConnectorShapeType,ji=J.a.Components.StiFlowchartPreparationShapeType,Vi=J.a.Components.StiFlowchartSortShapeType,Yi=J.a.Components.StiFrameShapeType,qi=J.a.Components.StiMinusShapeType,_i=J.a.Components.StiMultiplyShapeType,Ki=J.a.Components.StiParallelogramShapeType,Qi=J.a.Components.StiPlusShapeType,Zi=J.a.Components.StiRegularPentagonShapeType,Ji=J.a.Components.StiTrapezoidShapeType,$i=J.a.Components.StiSnipSameSideCornerRectangleShapeType,tr=J.a.Components.StiSnipDiagonalSideCornerRectangleShapeType,m=J.a.Components.StiShapeDirection,er=J.a.Components.StiCheckStyle;J.c.StiPdfRenderPrimitives=class{static renderBorder1(t){let e,i=null,r=t.Component.as(N);null!=(i=null!=r&&null!=r.brush?r.brush:i)&&t.service.fillRectBrush(i,new mt(t.X,t.Y,t.Width,t.Height),null==(e=t.Component.as(Li))?void 0:e.cornerRadius)}static renderBorder2(c){let m,g=c.Component.as(z);if(null!=g){let t=null==(m=c.Component.as(Li))?void 0:m.cornerRadius;if(null!=t)return void this.renderBorderWithCorners2(c,t);if(g.border.dropShadow&&null!=g.border.shadowBrush){let e=lt.toColor(g.border.shadowBrush);if(0!=e.a){let t=.8*g.border.shadowSize;c.service.setNonStrokeColor(e),c.service.pageStream.writeLine1("{0} {1} {2} {3} re f",c.service.convertToString(c.X+t),c.service.convertToString(c.Y-t),c.service.convertToString(c.Width-t),c.service.convertToString(t)),c.service.pageStream.writeLine1("{0} {1} {2} {3} re f",c.service.convertToString(c.X+c.Width),c.service.convertToString(c.Y-t),c.service.convertToString(t),c.service.convertToString(c.Height))}}let e=new T(g.border.color,g.border.size,g.border.style),i=g.border.as(ft),r=null!=i,n=g.border.isLeftBorderSidePresent,a=g.border.isRightBorderSidePresent,s=g.border.isTopBorderSidePresent,o=g.border.isBottomBorderSidePresent,l=g.border.style!=ot.None&&g.border.style!=ot.Solid,h=g.border.side!=P.None&&g.border.style!=ot.None;if(h=r?i.side!=P.None:h){let t=0;r||(l&&(c.service.pageStream.writeLine("q"),c.service.pushColorToStack()),t=this.storeBorderSideData(e,c)),r||g.border.side!=P.All?(n&&(r&&((e=i.leftSide).style!=ot.Solid&&(c.service.pageStream.writeLine("q"),c.service.pushColorToStack()),t=this.storeBorderSideData(e,c)),c.service.pageStream.writeLine1("{0} {1} m",c.service.convertToString(c.X-t),c.service.convertToString(c.Y-t)),c.service.pageStream.writeLine1("{0} {1} l S",c.service.convertToString(c.X-t),c.service.convertToString(c.Y+c.Height+t)),e.style==ot.Double&&(c.service.pageStream.writeLine1("{0} {1} m",c.service.convertToString(c.X+t),c.service.convertToString(c.Y+(o?t:-t))),c.service.pageStream.writeLine1("{0} {1} l S",c.service.convertToString(c.X+t),c.service.convertToString(c.Y+c.Height+(s?-t:t)))),r)&&e.style!=ot.Solid&&(c.service.pageStream.writeLine("Q"),c.service.popColorFromStack()),a&&(r&&((e=i.rightSide).style!=ot.Solid&&(c.service.pageStream.writeLine("q"),c.service.pushColorToStack()),t=this.storeBorderSideData(e,c)),c.service.pageStream.writeLine1("{0} {1} m",c.service.convertToString(c.X+c.Width+t),c.service.convertToString(c.Y-t)),c.service.pageStream.writeLine1("{0} {1} l S",c.service.convertToString(c.X+c.Width+t),c.service.convertToString(c.Y+c.Height+t)),e.style==ot.Double&&(c.service.pageStream.writeLine1("{0} {1} m",c.service.convertToString(c.X+c.Width-t),c.service.convertToString(c.Y+(o?t:-t))),c.service.pageStream.writeLine1("{0} {1} l S",c.service.convertToString(c.X+c.Width-t),c.service.convertToString(c.Y+c.Height+(s?-t:t)))),r)&&e.style!=ot.Solid&&(c.service.pageStream.writeLine("Q"),c.service.popColorFromStack()),s&&(r&&((e=i.topSide).style!=ot.Solid&&(c.service.pageStream.writeLine("q"),c.service.pushColorToStack()),t=this.storeBorderSideData(e,c)),c.service.pageStream.writeLine1("{0} {1} m",c.service.convertToString(c.X-t),c.service.convertToString(c.Y+c.Height+t)),c.service.pageStream.writeLine1("{0} {1} l S",c.service.convertToString(c.X+c.Width+t),c.service.convertToString(c.Y+c.Height+t)),e.style==ot.Double&&(c.service.pageStream.writeLine1("{0} {1} m",c.service.convertToString(c.X+(n?t:-t)),c.service.convertToString(c.Y+c.Height-t)),c.service.pageStream.writeLine1("{0} {1} l S",c.service.convertToString(c.X+c.Width+(a?-t:t)),c.service.convertToString(c.Y+c.Height-t))),r)&&e.style!=ot.Solid&&(c.service.pageStream.writeLine("Q"),c.service.popColorFromStack()),o&&(r&&((e=i.bottomSide).style!=ot.Solid&&(c.service.pageStream.writeLine("q"),c.service.pushColorToStack()),t=this.storeBorderSideData(e,c)),c.service.pageStream.writeLine1("{0} {1} m",c.service.convertToString(c.X-t),c.service.convertToString(c.Y-t)),c.service.pageStream.writeLine1("{0} {1} l S",c.service.convertToString(c.X+c.Width+t),c.service.convertToString(c.Y-t)),e.style==ot.Double&&(c.service.pageStream.writeLine1("{0} {1} m",c.service.convertToString(c.X+(n?t:-t)),c.service.convertToString(c.Y+t)),c.service.pageStream.writeLine1("{0} {1} l S",c.service.convertToString(c.X+c.Width+(a?-t:t)),c.service.convertToString(c.Y+t))),r)&&e.style!=ot.Solid&&(c.service.pageStream.writeLine("Q"),c.service.popColorFromStack())):(c.service.pageStream.writeLine1("{0} {1} {2} {3} re S",c.service.convertToString(c.X-t),c.service.convertToString(c.Y-t),c.service.convertToString(c.Width+2*t),c.service.convertToString(c.Height+2*t)),g.border.style==ot.Double&&c.service.pageStream.writeLine1("{0} {1} {2} {3} re S",c.service.convertToString(c.X+t),c.service.convertToString(c.Y+t),c.service.convertToString(c.Width-2*t),c.service.convertToString(c.Height-2*t))),!r&&l&&(c.service.pageStream.writeLine("Q"),c.service.popColorFromStack())}}}static renderBorderWithCorners2(r,n){let a=r.Component.as(z);if(null!=a){if(r.service.tempGeomWriter.pageStream=r.service.pageStream,a.border.dropShadow&&null!=a.border.shadowBrush){let e=lt.toColor(a.border.shadowBrush);if(0!=e.a){let t=.8*a.border.shadowSize;r.service.setNonStrokeColor(e),r.service.pageStream.writeLine(r.service.tempGeomWriter.getRectString4(r.X+t,r.Y-t,r.Width-t,t)+"f"),r.service.pageStream.writeLine(r.service.tempGeomWriter.getRectString4(r.X+r.Width,r.Y-t,t,r.Height)+"f")}}let t=a.border.side!=P.None&&a.border.style!=ot.None;if(t){let t=a.border.style!=ot.Solid,e=(t&&(r.service.pageStream.writeLine("q"),r.service.pushColorToStack()),new T(a.border.color,a.border.size,a.border.style)),i=this.storeBorderSideData(e,r);if(this.writeBorderWithCorners2(r,new mt(r.X,r.Y,r.Width,r.Height),n),a.border.style==ot.Double){let t=2*i;this.writeBorderWithCorners2(r,new mt(r.X+2*i,r.Y+2*i,r.Width-4*i,r.Height-4*i),new Zt(n.topLeft-t,n.topRight-t,n.bottomRight-t,n.bottomLeft-t))}t&&(r.service.pageStream.writeLine("Q"),r.service.popColorFromStack())}}}static writeBorderWithCorners2(l,h,c){let t=l.Component.as(z);if(null!=t){let n=t.border.isLeftBorderSidePresent,a=t.border.isRightBorderSidePresent,s=t.border.isTopBorderSidePresent,o=t.border.isBottomBorderSidePresent;if(t.border.side==P.All)l.service.pageStream.writeLine(l.service.tempGeomWriter.getRectWithCornersString(h,new Zt(c.bottomLeft,c.bottomRight,c.topRight,c.topLeft))+"S");else{let t=c.topLeft*l.service.hiToTwips,e=c.topRight*l.service.hiToTwips,i=c.bottomRight*l.service.hiToTwips,r=c.bottomLeft*l.service.hiToTwips;l.service.tempGeomWriter.beginPath(),l.service.tempGeomWriter.forceNewPoint=!0,n&&(l.service.tempGeomWriter.moveTo(new v(h.x,h.y+r)),l.service.tempGeomWriter.drawLineTo(new v(h.x,h.y+h.height-t),null)),s&&(n&&0<t&&l.service.tempGeomWriter.drawArc(new mt(h.x,h.y+h.height-2*t,2*t,2*t),180,-90),l.service.tempGeomWriter.moveTo(new v(h.x+t,h.y+h.height)),l.service.tempGeomWriter.drawLineTo(new v(h.x+h.width-e,h.y+h.height),null),a)&&0<e&&l.service.tempGeomWriter.drawArc(new mt(h.x+h.width-2*e,h.y+h.height-2*e,2*e,2*e),90,-90),a&&(l.service.tempGeomWriter.moveTo(new v(h.x+h.width,h.y+h.height-e)),l.service.tempGeomWriter.drawLineTo(new v(h.x+h.width,h.y+i),null)),o&&(a&&0<i&&l.service.tempGeomWriter.drawArc(new mt(h.x+h.width-2*i,h.y,2*i,2*i),0,-90),l.service.tempGeomWriter.moveTo(new v(h.x+h.width-i,h.y)),l.service.tempGeomWriter.drawLineTo(new v(h.x+r,h.y),null),n)&&0<r&&l.service.tempGeomWriter.drawArc(new mt(h.x,h.y,2*r,2*r),270,-90),l.service.tempGeomWriter.endPath(),l.service.pageStream.writeLine(l.service.tempGeomWriter.path.toString()+"S")}}}static storeBorderSideData(t,e){let i=t.size,r=(i<.5&&(i=.5),(i=t.style==ot.Double?1:i)*e.service.hiToTwips*.955),n=(e.service.pageStream.writeLine1("{0} w",e.service.convertToString(r)),this.getPenStyleDashString(t.style,.04*r,e));return null!=n&&e.service.pageStream.writeLine(n),e.service.setStrokeColor(t.color),t.style==ot.Double?r:0}static getPenStyleDashString(t,e,i){switch(t){case ot.Dot:return nt.format("[{0} {1}] 0 d",i.service.convertToString(e),i.service.convertToString(58*e));case ot.Dash:return nt.format("[{0} {1}] 0 d",i.service.convertToString(49.5*e),i.service.convertToString(62*e));case ot.DashDot:return nt.format("[{0} {1} {2} {1}] 0 d",i.service.convertToString(50*e),i.service.convertToString(55*e),i.service.convertToString(e));case ot.DashDotDot:return nt.format("[{0} {1} {2} {1} {2} {1}] 0 d",i.service.convertToString(50*e),i.service.convertToString(55*e),i.service.convertToString(e))}return null}static checkShape(t){if(t.shapeType.is2(y)||t.shapeType.is2(x)||t.shapeType.is2(F)||t.shapeType.is2(k)||t.shapeType.is2(B)||t.shapeType.is2(ki)||t.shapeType.is2(D)||t.shapeType.is2(I)||t.shapeType.is2(Bi)||t.shapeType.is2(R)||t.shapeType.is2(Di)||t.shapeType.is2(Ii)||t.shapeType.is2(Ri)||t.shapeType.is2(Ni)||t.shapeType.is2(Mi)||t.shapeType.is2(Oi)||t.shapeType.is2(Hi)||t.shapeType.is2(Wi)||t.shapeType.is2(zi)||t.shapeType.is2(Ui)||t.shapeType.is2(Xi)||t.shapeType.is2(Gi)||t.shapeType.is2(ji)||t.shapeType.is2(Vi)||t.shapeType.is2(Yi)||t.shapeType.is2(qi)||t.shapeType.is2(_i)||t.shapeType.is2(Ki)||t.shapeType.is2(Qi)||t.shapeType.is2(Zi)||t.shapeType.is2(Ji)||t.shapeType.is2($i)||t.shapeType.is2(tr))return!0;return!1}static renderShape(h,t){let c=h.Component.as(L);if(null!=c&&1==this.checkShape(c)){let e=h.Component.as(N),i=new J.c.StiPdfGeomWriter(h.service.pageStream,h.service,!1),t=rt.transparent;if(0!=(t=null!=e?lt.toColor(e.brush):t).a&&h.service.setNonStrokeColor(t),null!=e&&((e.brush.is(Ft)||e.brush.is(Ee)||e.brush.is(be))&&(h.service.storeShadingData2(h.X,h.Y,h.Width,h.Height,e.brush),h.service.pageStream.writeLine1("/Pattern cs /P{0} scn",1+h.service.shadingCurrent)),e.brush.is(ve))){let t=e.brush;h.service.pageStream.writeLine1("/Cs1 cs /PH{0} scn",h.service.getHatchNumber(t)+1)}let r=c.borderColor,n=(h.service.setStrokeColor(r),0<t.a),a=c.style!=ot.None;if(!n&&!a)return;let s=n?a?"B":"f":a?"S":"n",o=(h.service.pageStream.writeLine1("{0} w",h.service.convertToString(c.size*h.service.hiToTwips)),h.service.pageStream.writeLine("q"),c.size*h.service.hiToTwips*.04);switch(c.style){case ot.Dot:h.service.pageStream.writeLine1("[{0} {1}] 0 d",h.service.convertToString(o),h.service.convertToString(55*o));break;case ot.Dash:h.service.pageStream.writeLine1("[{0} {1}] 0 d",h.service.convertToString(50*o),h.service.convertToString(55*o));break;case ot.DashDot:h.service.pageStream.writeLine1("[{0} {1} {2} {1}] 0 d",h.service.convertToString(50*o),h.service.convertToString(55*o),h.service.convertToString(o));break;case ot.DashDotDot:h.service.pageStream.writeLine1("[{0} {1} {2} {1} {2} {1}] 0 d",h.service.convertToString(50*o),h.service.convertToString(55*o),h.service.convertToString(o));break}if(c.shapeType.is(y)&&(n&&h.service.pageStream.writeLine1("{0} {1} {2} {3} re f",h.service.convertToString(h.X),h.service.convertToString(h.Y),h.service.convertToString(h.Width),h.service.convertToString(h.Height)),a)&&(h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.X+h.Width/2),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l S",h.service.convertToString(h.X+h.Width/2),h.service.convertToString(h.Y+h.Height))),c.shapeType.is(x)&&(n&&h.service.pageStream.writeLine1("{0} {1} {2} {3} re f",h.service.convertToString(h.X),h.service.convertToString(h.Y),h.service.convertToString(h.Width),h.service.convertToString(h.Height)),a)&&(h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.X),h.service.convertToString(h.Y+h.Height/2)),h.service.pageStream.writeLine1("{0} {1} l S",h.service.convertToString(h.X+h.Width),h.service.convertToString(h.Y+h.Height/2))),c.shapeType.is(F)&&(n&&h.service.pageStream.writeLine1("{0} {1} {2} {3} re f",h.service.convertToString(h.X),h.service.convertToString(h.Y),h.service.convertToString(h.Width),h.service.convertToString(h.Height)),a)&&(h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.X),h.service.convertToString(h.Y+h.Height)),h.service.pageStream.writeLine1("{0} {1} l S",h.service.convertToString(h.X+h.Width),h.service.convertToString(h.Y+h.Height)),h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.X),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l S",h.service.convertToString(h.X+h.Width),h.service.convertToString(h.Y))),c.shapeType.is(k)&&(n&&h.service.pageStream.writeLine1("{0} {1} {2} {3} re f",h.service.convertToString(h.X),h.service.convertToString(h.Y),h.service.convertToString(h.Width),h.service.convertToString(h.Height)),a)&&(h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.X),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l S",h.service.convertToString(h.X),h.service.convertToString(h.Y+h.Height)),h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.X+h.Width),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l S",h.service.convertToString(h.X+h.Width),h.service.convertToString(h.Y+h.Height))),c.shapeType.is(B)&&(h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.X),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X),h.service.convertToString(h.Y+h.Height)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width),h.service.convertToString(h.Y+h.Height)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l "+s,h.service.convertToString(h.X),h.service.convertToString(h.Y))),c.shapeType.is(D)&&(n&&h.service.pageStream.writeLine1("{0} {1} {2} {3} re f",h.service.convertToString(h.X),h.service.convertToString(h.Y),h.service.convertToString(h.Width),h.service.convertToString(h.Height)),a)&&(h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.X),h.service.convertToString(h.Y+h.Height)),h.service.pageStream.writeLine1("{0} {1} l S",h.service.convertToString(h.X+h.Width),h.service.convertToString(h.Y))),c.shapeType.is(I)&&(n&&h.service.pageStream.writeLine1("{0} {1} {2} {3} re f",h.service.convertToString(h.X),h.service.convertToString(h.Y),h.service.convertToString(h.Width),h.service.convertToString(h.Height)),a)&&(h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.X),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l S",h.service.convertToString(h.X+h.Width),h.service.convertToString(h.Y+h.Height))),c.shapeType.is(Bi)){let t=c.shapeType.direction;t==m.Up&&(h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.X),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width/2),h.service.convertToString(h.Y+h.Height)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l "+s,h.service.convertToString(h.X),h.service.convertToString(h.Y))),t==m.Down&&(s=n?a?"B*":"f*":a?"S":"n",h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.X),h.service.convertToString(h.Y+h.Height)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width/2),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width),h.service.convertToString(h.Y+h.Height)),h.service.pageStream.writeLine1("{0} {1} l "+s,h.service.convertToString(h.X),h.service.convertToString(h.Y+h.Height))),t==m.Left&&(h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.X+h.Width),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X),h.service.convertToString(h.Y+h.Height/2)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width),h.service.convertToString(h.Y+h.Height)),h.service.pageStream.writeLine1("{0} {1} l "+s,h.service.convertToString(h.X+h.Width),h.service.convertToString(h.Y))),t==m.Right&&(s=n?a?"B*":"f*":a?"S":"n",h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.X),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width),h.service.convertToString(h.Y+h.Height/2)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X),h.service.convertToString(h.Y+h.Height)),h.service.pageStream.writeLine1("{0} {1} l "+s,h.service.convertToString(h.X),h.service.convertToString(h.Y)))}if(c.shapeType.is(R)&&h.service.pageStream.writeLine1(i.getEllipseString(new mt(h.X,h.Y,h.Width,h.Height))+s),c.shapeType.is(ki)){let t=c.shapeType.round,e=h.Width,i=(e>h.Height&&(e=h.Height),Math.min(e,70)*t),r=i*(1-h.service.pdfCKT);h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.X),h.service.convertToString(h.Y+i)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X),h.service.convertToString(h.Y+h.Height-i)),h.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",h.service.convertToString(h.X),h.service.convertToString(h.Y+h.Height-r),h.service.convertToString(h.X+r),h.service.convertToString(h.Y+h.Height),h.service.convertToString(h.X+i),h.service.convertToString(h.Y+h.Height)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width-i),h.service.convertToString(h.Y+h.Height)),h.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",h.service.convertToString(h.X+h.Width-r),h.service.convertToString(h.Y+h.Height),h.service.convertToString(h.X+h.Width),h.service.convertToString(h.Y+h.Height-r),h.service.convertToString(h.X+h.Width),h.service.convertToString(h.Y+h.Height-i)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width),h.service.convertToString(h.Y+i)),h.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",h.service.convertToString(h.X+h.Width),h.service.convertToString(h.Y+r),h.service.convertToString(h.X+h.Width-r),h.service.convertToString(h.Y),h.service.convertToString(h.X+h.Width-i),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+i),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c "+s,h.service.convertToString(h.X+r),h.service.convertToString(h.Y),h.service.convertToString(h.X),h.service.convertToString(h.Y+r),h.service.convertToString(h.X),h.service.convertToString(h.Y+i))}if(c.shapeType.is(Di)){let t=c.shapeType.direction,e=c.shapeType.arrowWidth,i=c.shapeType.arrowHeight,r=h.Width*e,n=h.Height*i;t!=m.Left&&t!=m.Right||(r=h.Height*e,n=h.Width*i),0==i&&(n=Math.min(h.Width/2,h.Height/2)),t==m.Up&&(h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.X+r),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+r),h.service.convertToString(h.Y+h.Height-n)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X),h.service.convertToString(h.Y+h.Height-n)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width/2),h.service.convertToString(h.Y+h.Height)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width),h.service.convertToString(h.Y+h.Height-n)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width-r),h.service.convertToString(h.Y+h.Height-n)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width-r),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l "+s,h.service.convertToString(h.X+r),h.service.convertToString(h.Y))),t==m.Down&&(h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.X+h.Width-r),h.service.convertToString(h.Y+h.Height)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width-r),h.service.convertToString(h.Y+n)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width),h.service.convertToString(h.Y+n)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width/2),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X),h.service.convertToString(h.Y+n)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+r),h.service.convertToString(h.Y+n)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+r),h.service.convertToString(h.Y+h.Height)),h.service.pageStream.writeLine1("{0} {1} l "+s,h.service.convertToString(h.X+h.Width-r),h.service.convertToString(h.Y+h.Height))),t==m.Left&&(h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.X+h.Width),h.service.convertToString(h.Y+r)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+n),h.service.convertToString(h.Y+r)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+n),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X),h.service.convertToString(h.Y+h.Height/2)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+n),h.service.convertToString(h.Y+h.Height)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+n),h.service.convertToString(h.Y+h.Height-r)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width),h.service.convertToString(h.Y+h.Height-r)),h.service.pageStream.writeLine1("{0} {1} l "+s,h.service.convertToString(h.X+h.Width),h.service.convertToString(h.Y+r))),t==m.Right&&(h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.X),h.service.convertToString(h.Y+h.Height-r)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width-n),h.service.convertToString(h.Y+h.Height-r)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width-n),h.service.convertToString(h.Y+h.Height)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width),h.service.convertToString(h.Y+h.Height/2)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width-n),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width-n),h.service.convertToString(h.Y+r)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X),h.service.convertToString(h.Y+r)),h.service.pageStream.writeLine1("{0} {1} l "+s,h.service.convertToString(h.X),h.service.convertToString(h.Y+h.Height-r)))}if(c.shapeType.is(Ii)){let t=c.shapeType,e=(null!=c.report?c.report.unit.convertToHInches(t.bevel):t.bevel)*h.service.hiToTwips,i=e;t.autoSize&&(e=h.Width/(2.414*1.414),i=h.Height/(2.414*1.414)),e>h.Width/2&&(e=h.Width/2),i>h.Height/2&&(i=h.Height/2),h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.X+e),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width-e),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width),h.service.convertToString(h.Y+i)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width),h.service.convertToString(h.Y+h.Height-i)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width-e),h.service.convertToString(h.Y+h.Height)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+e),h.service.convertToString(h.Y+h.Height)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X),h.service.convertToString(h.Y+h.Height-i)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X),h.service.convertToString(h.Y+i)),h.service.pageStream.writeLine1("{0} {1} l "+s,h.service.convertToString(h.X+e),h.service.convertToString(h.Y))}if(c.shapeType.is(Ri)){let t=h.Width<h.Height?h.Width/2:h.Height/2,e=h.Height/3.8,i=h.Width/3.8,r=h.Height<h.Width?h.Height/2:h.Width/2;switch(c.shapeType.direction){case m.Left:case m.Right:h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.X),h.service.convertToString(h.Y+h.Height/2)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+t),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+t),h.service.convertToString(h.Y+e)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right-t),h.service.convertToString(h.Y+e)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right-t),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right),h.service.convertToString(h.Y+h.Height/2)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right-t),h.service.convertToString(h.Top)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right-t),h.service.convertToString(h.Top-e)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+t),h.service.convertToString(h.Top-e)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+t),h.service.convertToString(h.Top)),h.service.pageStream.writeLine1("{0} {1} l h "+s,h.service.convertToString(h.X),h.service.convertToString(h.Y+h.Height/2));break;case m.Down:case m.Up:h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.X),h.service.convertToString(h.Y+r)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width/2),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right),h.service.convertToString(h.Y+r)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right-i),h.service.convertToString(h.Y+r)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right-i),h.service.convertToString(h.Top-r)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right),h.service.convertToString(h.Top-r)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width/2),h.service.convertToString(h.Top)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X),h.service.convertToString(h.Top-r)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+i),h.service.convertToString(h.Top-r)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+i),h.service.convertToString(h.Y+r)),h.service.pageStream.writeLine1("{0} {1} l h "+s,h.service.convertToString(h.X),h.service.convertToString(h.Y+r));break}}if(c.shapeType.is(Ni)){let t=0,e=0,i=0;switch(i=(h.Height>h.Width?(e=h.Width/4,t=e):(t=Math.floor(h.Height/4),e=t),e/2),c.shapeType.direction){case m.Up:h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.X),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X),h.service.convertToString(h.Y+t)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right-(i+t)),h.service.convertToString(h.Y+t)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right-(i+t)),h.service.convertToString(h.Top-e)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right-2*e),h.service.convertToString(h.Top-e)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right-e),h.service.convertToString(h.Top)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right),h.service.convertToString(h.Top-e)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right-i),h.service.convertToString(h.Top-e)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right-i),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l h "+s,h.service.convertToString(h.X),h.service.convertToString(h.Y));break;case m.Left:h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.Right),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right),h.service.convertToString(h.Top-i)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+e),h.service.convertToString(h.Top-i)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+e),h.service.convertToString(h.Top)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X),h.service.convertToString(h.Top-e)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+e),h.service.convertToString(h.Top-2*e)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+e),h.service.convertToString(h.Top-e-i)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right-t),h.service.convertToString(h.Top-e-i)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right-t),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l h "+s,h.service.convertToString(h.Right),h.service.convertToString(h.Y));break;case m.Down:h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.Right),h.service.convertToString(h.Top)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+i),h.service.convertToString(h.Top)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+i),h.service.convertToString(h.Y+e)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X),h.service.convertToString(h.Y+e)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+e),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+2*e),h.service.convertToString(h.Y+e)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+e+i),h.service.convertToString(h.Y+e)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+e+i),h.service.convertToString(h.Top-t)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right),h.service.convertToString(h.Top-t)),h.service.pageStream.writeLine1("{0} {1} l h "+s,h.service.convertToString(h.Right),h.service.convertToString(h.Top));break;case m.Right:h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.X),h.service.convertToString(h.Top)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X),h.service.convertToString(h.Y+i)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right-e),h.service.convertToString(h.Y+i)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right-e),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right),h.service.convertToString(h.Y+e)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right-e),h.service.convertToString(h.Y+2*e)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right-e),h.service.convertToString(h.Y+e+i)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+t),h.service.convertToString(h.Y+e+i)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+t),h.service.convertToString(h.Top)),h.service.pageStream.writeLine1("{0} {1} l h "+s,h.service.convertToString(h.X),h.service.convertToString(h.Top));break}}if(c.shapeType.is(Mi)){let t=h.Width>h.Height?h.Height/2:h.Width/2;switch(c.shapeType.direction){case m.Right:h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.X),h.service.convertToString(h.Top)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+t),h.service.convertToString(h.Top-h.Height/2)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right-t),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right),h.service.convertToString(h.Top-h.Height/2)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right-t),h.service.convertToString(h.Top)),h.service.pageStream.writeLine1("{0} {1} l h "+s,h.service.convertToString(h.X),h.service.convertToString(h.Top));break;case m.Left:h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.Right),h.service.convertToString(h.Top)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+t),h.service.convertToString(h.Top)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X),h.service.convertToString(h.Top-h.Height/2)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+t),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right-t),h.service.convertToString(h.Top-h.Height/2)),h.service.pageStream.writeLine1("{0} {1} l h "+s,h.service.convertToString(h.Right),h.service.convertToString(h.Top));break;case m.Up:h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.X),h.service.convertToString(h.Top-t)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width/2),h.service.convertToString(h.Top)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right),h.service.convertToString(h.Top-t)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width/2),h.service.convertToString(h.Y+t)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l h "+s,h.service.convertToString(h.X),h.service.convertToString(h.Top-t));break;case m.Down:h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.X),h.service.convertToString(h.Top)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width/2),h.service.convertToString(h.Top-t)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right),h.service.convertToString(h.Top)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.Right),h.service.convertToString(h.Y+t)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X+h.Width/2),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l",h.service.convertToString(h.X),h.service.convertToString(h.Y+t)),h.service.pageStream.writeLine1("{0} {1} l h "+s,h.service.convertToString(h.X),h.service.convertToString(h.Top));break}}if(c.shapeType.is(Oi)){let t=h.Height/3,e=4*h.service.hiToTwips;h.service.pageStream.writeLine1(i.getRectString4(h.X,h.Y+t+e,h.Width,t-2*e)+s),h.service.pageStream.writeLine1(i.getEllipseString4(h.X+h.Width/2-t/2,h.Top-h.service.hiToTwips-t,t,t)+s),h.service.pageStream.writeLine1(i.getEllipseString4(h.X+h.Width/2-t/2,h.Y+2*h.service.hiToTwips,t,t)+s)}if(c.shapeType.is(Hi)){let t=(h.Height-h.Height/6)/2;h.service.pageStream.writeLine1(i.getRectString4(h.X,h.Top-t,h.Width,t)+s),h.service.pageStream.writeLine1(i.getRectString4(h.X,h.Y,h.Width,t)+s)}if(c.shapeType.is(Wi)&&(h.service.pageStream.writeLine1("{0} {1} m {2} {3} l",h.service.convertToString(h.Right),h.service.convertToString(h.Top),h.service.convertToString(h.Right),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+s,h.service.convertToString(h.X),h.service.convertToString(h.Y),h.service.convertToString(h.X),h.service.convertToString(h.Top-h.Height/5),h.service.convertToString(h.X+h.Width/5),h.service.convertToString(h.Top),h.service.convertToString(h.Right),h.service.convertToString(h.Top))),c.shapeType.is(zi))switch(c.shapeType.direction){case m.Down:case m.Up:h.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l h "+s,h.service.convertToString(h.X),h.service.convertToString(h.Top),h.service.convertToString(h.Right),h.service.convertToString(h.Top),h.service.convertToString(h.X+h.Width/2),h.service.convertToString(h.Y+h.Height/2)),h.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l h "+s,h.service.convertToString(h.X),h.service.convertToString(h.Y),h.service.convertToString(h.X+h.Width/2),h.service.convertToString(h.Y+h.Height/2),h.service.convertToString(h.Right),h.service.convertToString(h.Y));break;case m.Left:case m.Right:h.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l h "+s,h.service.convertToString(h.X),h.service.convertToString(h.Y),h.service.convertToString(h.X),h.service.convertToString(h.Top),h.service.convertToString(h.X+h.Width/2),h.service.convertToString(h.Y+h.Height/2)),h.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l h "+s,h.service.convertToString(h.Right),h.service.convertToString(h.Y),h.service.convertToString(h.X+h.Width/2),h.service.convertToString(h.Y+h.Height/2),h.service.convertToString(h.Right),h.service.convertToString(h.Top));break}if(c.shapeType.is(Ui)&&(h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.X),h.service.convertToString(h.Top-h.Height/2)),h.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+s,h.service.convertToString(h.X+h.Width/2),h.service.convertToString(h.Top),h.service.convertToString(h.Right),h.service.convertToString(h.Top-h.Height/2),h.service.convertToString(h.X+h.Width/2),h.service.convertToString(h.Y),h.service.convertToString(h.X),h.service.convertToString(h.Top-h.Height/2))),c.shapeType.is(Xi)&&(h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.X),h.service.convertToString(h.Top-h.Height/5)),h.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+s,h.service.convertToString(h.Right),h.service.convertToString(h.Top),h.service.convertToString(h.Right),h.service.convertToString(h.Y),h.service.convertToString(h.X),h.service.convertToString(h.Y),h.service.convertToString(h.X),h.service.convertToString(h.Top-h.Height/5))),c.shapeType.is(Gi)){let t=h.Height/5,e=h.Width/5;switch(c.shapeType.direction){case m.Down:h.service.pageStream.writeLine1("{0} {1} m {2} {3} l",h.service.convertToString(h.X),h.service.convertToString(h.Top),h.service.convertToString(h.Right),h.service.convertToString(h.Top)),h.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+s,h.service.convertToString(h.Right),h.service.convertToString(h.Y+t),h.service.convertToString(h.X+h.Width/2),h.service.convertToString(h.Y),h.service.convertToString(h.X),h.service.convertToString(h.Y+t),h.service.convertToString(h.X),h.service.convertToString(h.Top));break;case m.Up:h.service.pageStream.writeLine1("{0} {1} m {2} {3} l",h.service.convertToString(h.X),h.service.convertToString(h.Y),h.service.convertToString(h.X),h.service.convertToString(h.Top-t)),h.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+s,h.service.convertToString(h.X+h.Width/2),h.service.convertToString(h.Top),h.service.convertToString(h.Right),h.service.convertToString(h.Top-t),h.service.convertToString(h.Right),h.service.convertToString(h.Y),h.service.convertToString(h.X),h.service.convertToString(h.Y));break;case m.Left:h.service.pageStream.writeLine1("{0} {1} m {2} {3} l",h.service.convertToString(h.X+e),h.service.convertToString(h.Top),h.service.convertToString(h.Right),h.service.convertToString(h.Top)),h.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+s,h.service.convertToString(h.Right),h.service.convertToString(h.Y),h.service.convertToString(h.X+e),h.service.convertToString(h.Y),h.service.convertToString(h.X),h.service.convertToString(h.Top-h.Height/2),h.service.convertToString(h.X+e),h.service.convertToString(h.Top));break;case m.Right:h.service.pageStream.writeLine1("{0} {1} m {2} {3} l",h.service.convertToString(h.X),h.service.convertToString(h.Top),h.service.convertToString(h.Right-e),h.service.convertToString(h.Top)),h.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+s,h.service.convertToString(h.Right),h.service.convertToString(h.Top-h.Height/2),h.service.convertToString(h.Right-e),h.service.convertToString(h.Y),h.service.convertToString(h.X),h.service.convertToString(h.Y),h.service.convertToString(h.X),h.service.convertToString(h.Top));break}}if(c.shapeType.is(ji)){let t=h.Width/5,e=h.Height/5,i=h.Width/2,r=h.Height/2;switch(c.shapeType.direction){case m.Left:case m.Right:h.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l",h.service.convertToString(h.X),h.service.convertToString(h.Top-r),h.service.convertToString(h.X+t),h.service.convertToString(h.Top),h.service.convertToString(h.Right-t),h.service.convertToString(h.Top)),h.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+s,h.service.convertToString(h.Right),h.service.convertToString(h.Top-r),h.service.convertToString(h.Right-t),h.service.convertToString(h.Y),h.service.convertToString(h.X+t),h.service.convertToString(h.Y),h.service.convertToString(h.X),h.service.convertToString(h.Top-r));break;case m.Down:case m.Up:h.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l",h.service.convertToString(h.X+i),h.service.convertToString(h.Top),h.service.convertToString(h.Right),h.service.convertToString(h.Top-e),h.service.convertToString(h.Right),h.service.convertToString(h.Y+e)),h.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+s,h.service.convertToString(h.X+i),h.service.convertToString(h.Y),h.service.convertToString(h.X),h.service.convertToString(h.Y+e),h.service.convertToString(h.X),h.service.convertToString(h.Top-e),h.service.convertToString(h.X+i),h.service.convertToString(h.Top));break}}if(c.shapeType.is(Vi)&&(h.service.pageStream.writeLine1("{0} {4} m {1} {3} l {2} {4} l {1} {5} l h "+s,h.service.convertToString(h.X),h.service.convertToString(h.X+h.Width/2),h.service.convertToString(h.X+h.Width),h.service.convertToString(h.Top),h.service.convertToString(h.Top-h.Height/2),h.service.convertToString(h.Top-h.Height)),h.service.pageStream.writeLine1("q 0 J {0} {2} m {1} {2} l {3} Q",h.service.convertToString(h.X),h.service.convertToString(h.X+h.Width),h.service.convertToString(h.Top-h.Height/2),a?"S":"n")),c.shapeType.is(Yi)){let t=h.Width/7,e=h.Height/7;h.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l {6} {7} l h",h.service.convertToString(h.X),h.service.convertToString(h.Top),h.service.convertToString(h.Right),h.service.convertToString(h.Top),h.service.convertToString(h.Right),h.service.convertToString(h.Y),h.service.convertToString(h.X),h.service.convertToString(h.Y)),h.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l {6} {7} l h "+s,h.service.convertToString(h.X+t),h.service.convertToString(h.Top-e),h.service.convertToString(h.X+t),h.service.convertToString(h.Y+e),h.service.convertToString(h.Right-t),h.service.convertToString(h.Y+e),h.service.convertToString(h.Right-t),h.service.convertToString(h.Top-e))}if(c.shapeType.is(qi)){let t=h.Height/3;h.service.pageStream.writeLine1(i.getRectString4(h.X,h.Y+t,h.Width,t)+s)}if(c.shapeType.is(_i)){let t=h.Width/4,e=h.Height/4;h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.X),h.service.convertToString(h.Top-e)),h.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l",h.service.convertToString(h.X+t),h.service.convertToString(h.Top),h.service.convertToString(h.X+h.Width/2),h.service.convertToString(h.Top-e),h.service.convertToString(h.Right-t),h.service.convertToString(h.Top),h.service.convertToString(h.Right),h.service.convertToString(h.Top-e)),h.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l",h.service.convertToString(h.Right-t),h.service.convertToString(h.Top-h.Height/2),h.service.convertToString(h.Right),h.service.convertToString(h.Y+e),h.service.convertToString(h.Right-t),h.service.convertToString(h.Y),h.service.convertToString(h.X+h.Width/2),h.service.convertToString(h.Y+e)),h.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l h "+s,h.service.convertToString(h.X+t),h.service.convertToString(h.Y),h.service.convertToString(h.X),h.service.convertToString(h.Y+e),h.service.convertToString(h.X+t),h.service.convertToString(h.Top-h.Height/2))}if(c.shapeType.is(Ki)&&h.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l {6} {7} l h "+s,h.service.convertToString(h.X),h.service.convertToString(h.Y),h.service.convertToString(h.X+h.Width/5),h.service.convertToString(h.Top),h.service.convertToString(h.Right),h.service.convertToString(h.Top),h.service.convertToString(h.Right-h.Width/5),h.service.convertToString(h.Y)),c.shapeType.is(Qi)){let t=h.Width/3,e=h.Height/3;h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(h.X+t),h.service.convertToString(h.Top)),h.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l",h.service.convertToString(h.Right-t),h.service.convertToString(h.Top),h.service.convertToString(h.Right-t),h.service.convertToString(h.Top-e),h.service.convertToString(h.Right),h.service.convertToString(h.Top-e),h.service.convertToString(h.Right),h.service.convertToString(h.Y+e)),h.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l",h.service.convertToString(h.Right-t),h.service.convertToString(h.Y+e),h.service.convertToString(h.Right-t),h.service.convertToString(h.Y),h.service.convertToString(h.X+t),h.service.convertToString(h.Y),h.service.convertToString(h.X+t),h.service.convertToString(h.Y+e)),h.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+s,h.service.convertToString(h.X),h.service.convertToString(h.Y+e),h.service.convertToString(h.X),h.service.convertToString(h.Top-e),h.service.convertToString(h.X+t),h.service.convertToString(h.Top-e),h.service.convertToString(h.X+t),h.service.convertToString(h.Top))}if(c.shapeType.is(Zi)){let t=h.Height/2.6,e=h.Width/5.5;h.service.pageStream.writeLine1("{0} {1} m {2} {3} l",h.service.convertToString(h.X),h.service.convertToString(h.Top-t),h.service.convertToString(h.X+h.Width/2),h.service.convertToString(h.Top)),h.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+s,h.service.convertToString(h.Right),h.service.convertToString(h.Top-t),h.service.convertToString(h.Right-e),h.service.convertToString(h.Y),h.service.convertToString(h.X+e),h.service.convertToString(h.Y),h.service.convertToString(h.X),h.service.convertToString(h.Top-t))}if(c.shapeType.is(Ji)){let t=h.Width/4.75;h.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l {6} {7} l h "+s,h.service.convertToString(h.X),h.service.convertToString(h.Y),h.service.convertToString(h.X+t),h.service.convertToString(h.Top),h.service.convertToString(h.Right-t),h.service.convertToString(h.Top),h.service.convertToString(h.Right),h.service.convertToString(h.Y))}if(c.shapeType.is($i)){let t=h.Width/7.2,e=h.Height/4.6;h.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l",h.service.convertToString(h.X),h.service.convertToString(h.Top-e),h.service.convertToString(h.X+t),h.service.convertToString(h.Top),h.service.convertToString(h.Right-t),h.service.convertToString(h.Top)),h.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l h "+s,h.service.convertToString(h.Right),h.service.convertToString(h.Top-e),h.service.convertToString(h.Right),h.service.convertToString(h.Y),h.service.convertToString(h.X),h.service.convertToString(h.Y))}if(c.shapeType.is(tr)){let t=h.Width/7.2,e=h.Height/4.6;h.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l",h.service.convertToString(h.X),h.service.convertToString(h.Top),h.service.convertToString(h.Right-t),h.service.convertToString(h.Top),h.service.convertToString(h.Right),h.service.convertToString(h.Top-e)),h.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l h "+s,h.service.convertToString(h.Right),h.service.convertToString(h.Y),h.service.convertToString(h.X+t),h.service.convertToString(h.Y),h.service.convertToString(h.X),h.service.convertToString(h.Y+e))}h.service.pageStream.writeLine("Q");let l=c.getParsedText();if(!nt.isNullOrWhiteSpace(l)){let t=new et(c.clientRectangle),e=(t.text=l,t.font=c.font,t.textBrush=new ie(c.foreColor),t.horAlignment=c.horAlignment,t.vertAlignment=c.vertAlignment,t.margins=c.margins,t.wordWrap=!0,t.textQuality=J.a.Components.StiTextQuality.Typographic,t.page=c.page,h.clone());e.Component=t,J.c.StiPdfRenderText.renderTextFont(e),J.c.StiPdfRenderText.renderText(e)}}}static renderRoundedRectanglePrimitive(p){let i=p.Component.as(z);if(null!=i){let t=new T(i.border.color,i.border.size,i.border.style),n=p.Component.as(jt);if(n.style==ot.None)return;let e=i.border.style!=ot.None&&i.border.style!=ot.Solid,a=(e&&(p.service.pageStream.writeLine("q"),p.service.pushColorToStack()),this.storeBorderSideData(t,p)),s=Math.min(p.Width<p.Height?p.Width:p.Height,100*p.Component.page.zoom)*n.round,o=s*(1-p.service.pdfCKT),l=p.X-a,h=p.X+p.Width+a,c=p.X+p.Width/2,m=p.Y-a,g=p.Y+p.Height+a;if(n.leftSide&&(n.bottomSide?(p.service.pageStream.writeLine1("{0} {1} m",p.service.convertToString(n.rightSide?c:h),p.service.convertToString(m)),p.service.pageStream.writeLine1("{0} {1} l",p.service.convertToString(l+s),p.service.convertToString(m)),p.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",p.service.convertToString(l+o),p.service.convertToString(m),p.service.convertToString(l),p.service.convertToString(m+o),p.service.convertToString(l),p.service.convertToString(m+s))):p.service.pageStream.writeLine1("{0} {1} m",p.service.convertToString(l),p.service.convertToString(m)),n.topSide?(p.service.pageStream.writeLine1("{0} {1} l",p.service.convertToString(l),p.service.convertToString(g-s)),p.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",p.service.convertToString(l),p.service.convertToString(g-o),p.service.convertToString(l+o),p.service.convertToString(g),p.service.convertToString(l+s),p.service.convertToString(g)),p.service.pageStream.writeLine1("{0} {1} l S",p.service.convertToString(n.rightSide?c:h),p.service.convertToString(g))):p.service.pageStream.writeLine1("{0} {1} l S",p.service.convertToString(l),p.service.convertToString(g))),n.rightSide&&(n.bottomSide?(p.service.pageStream.writeLine1("{0} {1} m",p.service.convertToString(n.leftSide?c:l),p.service.convertToString(m)),p.service.pageStream.writeLine1("{0} {1} l",p.service.convertToString(h-s),p.service.convertToString(m)),p.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",p.service.convertToString(h-o),p.service.convertToString(m),p.service.convertToString(h),p.service.convertToString(m+o),p.service.convertToString(h),p.service.convertToString(m+s))):p.service.pageStream.writeLine1("{0} {1} m",p.service.convertToString(h),p.service.convertToString(m)),n.topSide?(p.service.pageStream.writeLine1("{0} {1} l",p.service.convertToString(h),p.service.convertToString(g-s)),p.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",p.service.convertToString(h),p.service.convertToString(g-o),p.service.convertToString(h-o),p.service.convertToString(g),p.service.convertToString(h-s),p.service.convertToString(g)),p.service.pageStream.writeLine1("{0} {1} l S",p.service.convertToString(n.leftSide?c:l),p.service.convertToString(g))):p.service.pageStream.writeLine1("{0} {1} l S",p.service.convertToString(h),p.service.convertToString(g))),!n.topSide||n.leftSide||n.rightSide||(p.service.pageStream.writeLine1("{0} {1} m",p.service.convertToString(l),p.service.convertToString(g)),p.service.pageStream.writeLine1("{0} {1} l S",p.service.convertToString(h),p.service.convertToString(g))),!n.bottomSide||n.leftSide||n.rightSide||(p.service.pageStream.writeLine1("{0} {1} m",p.service.convertToString(l),p.service.convertToString(m)),p.service.pageStream.writeLine1("{0} {1} l S",p.service.convertToString(h),p.service.convertToString(m))),t.style==ot.Double){o=(s-=2*a)*(1-p.service.pdfCKT);let t=p.X+a,e=p.X+p.Width-a,i=p.Y+a,r=p.Y+p.Height-a;n.leftSide&&(n.bottomSide?(p.service.pageStream.writeLine1("{0} {1} m",p.service.convertToString(n.rightSide?c:h),p.service.convertToString(i)),p.service.pageStream.writeLine1("{0} {1} l",p.service.convertToString(t+s),p.service.convertToString(i)),p.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",p.service.convertToString(t+o),p.service.convertToString(i),p.service.convertToString(t),p.service.convertToString(i+o),p.service.convertToString(t),p.service.convertToString(i+s))):p.service.pageStream.writeLine1("{0} {1} m",p.service.convertToString(t),p.service.convertToString(m)),n.topSide?(p.service.pageStream.writeLine1("{0} {1} l",p.service.convertToString(t),p.service.convertToString(r-s)),p.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",p.service.convertToString(t),p.service.convertToString(r-o),p.service.convertToString(t+o),p.service.convertToString(r),p.service.convertToString(t+s),p.service.convertToString(r)),p.service.pageStream.writeLine1("{0} {1} l S",p.service.convertToString(n.rightSide?c:h),p.service.convertToString(r))):p.service.pageStream.writeLine1("{0} {1} l S",p.service.convertToString(t),p.service.convertToString(g))),n.rightSide&&(n.bottomSide?(p.service.pageStream.writeLine1("{0} {1} m",p.service.convertToString(n.leftSide?c:l),p.service.convertToString(i)),p.service.pageStream.writeLine1("{0} {1} l",p.service.convertToString(e-s),p.service.convertToString(i)),p.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",p.service.convertToString(e-o),p.service.convertToString(i),p.service.convertToString(e),p.service.convertToString(i+o),p.service.convertToString(e),p.service.convertToString(i+s))):p.service.pageStream.writeLine1("{0} {1} m",p.service.convertToString(e),p.service.convertToString(m)),n.topSide?(p.service.pageStream.writeLine1("{0} {1} l",p.service.convertToString(e),p.service.convertToString(r-s)),p.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",p.service.convertToString(e),p.service.convertToString(r-o),p.service.convertToString(e-o),p.service.convertToString(r),p.service.convertToString(e-s),p.service.convertToString(r)),p.service.pageStream.writeLine1("{0} {1} l S",p.service.convertToString(n.leftSide?c:l),p.service.convertToString(r))):p.service.pageStream.writeLine1("{0} {1} l S",p.service.convertToString(e),p.service.convertToString(g))),!n.topSide||n.leftSide||n.rightSide||(p.service.pageStream.writeLine1("{0} {1} m",p.service.convertToString(l),p.service.convertToString(r)),p.service.pageStream.writeLine1("{0} {1} l S",p.service.convertToString(h),p.service.convertToString(r))),!n.bottomSide||n.leftSide||n.rightSide||(p.service.pageStream.writeLine1("{0} {1} m",p.service.convertToString(l),p.service.convertToString(i)),p.service.pageStream.writeLine1("{0} {1} l S",p.service.convertToString(h),p.service.convertToString(i)))}e&&(p.service.pageStream.writeLine("Q"),p.service.popColorFromStack())}}static renderCheckbox(n,a,s=!0){let o=n.Component.as(gt);if(null!=o){let t=null;switch(a?o.checkStyleForTrue:o.checkStyleForFalse){case er.Cross:t="62.568 52.024 m 62.018 52.166 60.405 52.537 58.984 52.848 c 55.336 53.645 49.313 58.685 44.741 64.767 c 40.839 69.958 l 45.919 71.092 l \r\n"+"53.272 72.735 59.559 76.81 67.746 85.239 c 74.954 92.661 l 68.543 100.174 l 56.77 113.972 54.196 123.193 59.915 131.088 c 62.809 135.083 71.734 143.458 73.097 143.458 c \r\n"+"73.509 143.458 74.16 141.77 74.546 139.708 c 75.526 134.457 81.002 122.942 85.482 116.708 c 87.557 113.82 89.473 111.458 89.74 111.458 c \r\n"+"90.006 111.458 93.515 114.945 97.537 119.208 c 113.934 136.584 127.211 138.972 135.818 126.095 c 139.973 119.877 140.004 118.024 135.958 117.739 c \r\n"+"130.11 117.329 118.795 109.205 110.443 99.42 c 105.812 93.994 l 110.69 89.679 l 117.241 83.884 129.589 77.786 136.531 76.919 c \r\n"+"139.576 76.539 142.068 75.813 142.068 75.307 c 142.068 72.526 132.802 60.889 129.038 58.942 c 121.077 54.825 112.668 58.23 96.273 72.209 c \r\n"+"91.287 76.46 l 84.2 67.488 l 80.303 62.554 75.379 57.368 73.259 55.965 c 69.353 53.38 64.393 51.552 62.568 52.024 c h";break;case er.Check:t="60.972 37.503 m 51.173 63.277 43.562 76.623 35.37 82.397 c 30.912 85.54 l 33.664 88.435 l 37.539 92.513 43.698 95.935 48.566 96.713 c \r\n"+"52.426 97.33 53.024 97.093 57.102 93.334 c 59.763 90.882 63.368 85.726 66.269 80.223 c 68.899 75.234 71.18 71.153 71.337 71.153 c \r\n"+"71.493 71.153 73.65 74.19 76.13 77.903 c 96.259 108.044 129.683 141.214 157.565 158.718 c 166.414 164.274 l 168.677 161.643 l \r\n"+"170.941 159.012 l 163.178 152.717 l 139.859 133.81 108.017 94.486 89.043 61.164 c 82.362 49.432 81.87 48.851 73.952 43.345 c \r\n"+"69.45 40.214 64.908 37.04 63.858 36.292 c 62.149 35.074 61.848 35.2 60.972 37.503 c h";break;case er.CrossRectangle:t="24.153 97.958 m 24.153 170.458 l 98.653 170.458 l 173.153 170.458 l 173.153 97.958 l 173.153 25.458 l 98.653 25.458 l 24.153 25.458 l 24.153 97.958 l h \r\n"+"157.911 97.708 m 157.653 154.958 l 98.653 154.958 l 39.653 154.958 l 39.393 98.958 l 39.25 68.158 39.348 42.395 39.611 41.708 c \r\n"+"39.987 40.727 52.819 40.458 99.129 40.458 c 158.169 40.458 l 157.911 97.708 l h \r\n"+"67.337 54.521 m 65.513 54.912 62.41 56.378 60.442 57.778 c 57.123 60.14 48.153 70.186 48.153 71.541 c 48.153 71.87 50.57 72.68 53.525 73.342 c \r\n"+"60.71 74.95 67.272 79.277 75.328 87.718 c 82.003 94.713 l 75.624 102.027 l 64.931 114.288 61.644 123.705 65.472 131.108 c \r\n"+"67.054 134.168 78.562 145.458 80.098 145.458 c 80.556 145.458 81.245 143.77 81.63 141.708 c 82.611 136.457 88.086 124.942 92.567 118.708 c \r\n"+"94.642 115.82 96.558 113.458 96.824 113.458 c 97.091 113.458 100.6 116.945 104.622 121.208 c 121.019 138.584 134.296 140.972 142.903 128.095 c \r\n"+"147.058 121.877 147.089 120.024 143.043 119.739 c 137.213 119.33 124.806 110.39 117.127 101.066 c 113.226 96.33 113.155 96.112 114.876 94.198 c \r\n"+"118.066 90.648 128.579 83.654 133.847 81.578 c 136.682 80.461 141.285 79.244 144.077 78.873 c 146.868 78.503 149.153 77.878 149.153 77.484 c \r\n"+"149.153 75.37 140.777 64.275 137.501 62.048 c 129.107 56.344 120.869 59.278 103.358 74.209 c 98.372 78.46 l 91.285 69.488 l \r\n"+"81.563 57.18 74.76 52.928 67.337 54.521 c h";break;case er.CheckRectangle:t="19.915 96.5 m 19.915 169 l 91.857 169 l 163.8 169 l 170.357 173.111 l 176.914 177.223 l 178.882 174.861 l 179.963 173.563 180.864 172.217 180.882 171.872 c \r\n"+"180.9 171.526 178.44 169.334 175.415 167 c 169.915 162.757 l 169.915 93.378 l 169.915 24 l 94.915 24 l 19.915 24 l 19.915 96.5 l h \r\n"+"153.915 92.622 m 153.915 141.962 153.786 146.137 152.294 144.899 c 149.513 142.592 136.609 126.998 127.965 115.5 c 117.473 101.544 104.486 81.963 98.451 71 c \r\n"+"93.993 62.903 93.316 62.192 84.16 56 c 78.873 52.425 74.256 49.375 73.9 49.223 c 73.544 49.07 71.988 52.22 70.441 56.223 c \r\n"+"68.895 60.225 65.183 68.635 62.192 74.911 c 57.906 83.903 55.515 87.56 50.914 92.161 c 47.703 95.372 44.364 98 43.495 98 c \r\n"+"40.697 98 41.79 99.66 47.479 104.049 c 53.073 108.365 60.662 111.14 64.28 110.194 c 67.84 109.263 73.689 102.039 78.2 93.002 c \r\n"+"82.663 84.062 l 87.207 90.895 l 95.518 103.394 108.214 118.311 125.807 136.25 c 143.215 154 l 89.565 154 l 35.915 154 l 35.915 96.5 l \r\n"+"35.915 39 l 94.915 39 l 153.915 39 l 153.915 92.622 l h";break;case er.CrossCircle:t="83.347 26.864 m 61.07 31.95 42.193 47.128 32.202 67.986 c 23.401 86.36 23.68 110.034 32.919 128.958 c 41.882 147.315 60.868 162.86 80.847 168.201 c \r\n"+"91.083 170.936 112.112 170.628 121.812 167.6 c 147.999 159.425 167.881 138.673 173.432 113.721 c 175.869 102.768 175 85.662 171.452 74.743 c \r\n"+"164.795 54.256 145.804 35.792 124.126 28.729 c 117.735 26.647 113.94 26.133 102.847 25.845 c 93.814 25.61 87.363 25.947 83.347 26.864 c h \r\n"+"112.414 41.542 m 129.545 44.672 146.131 57.503 153.827 73.579 c 168.725 104.698 152.719 141.239 119.425 152.119 c 112.712 154.313 109.49 154.763 100.347 154.781 c \r\n"+"90.993 154.8 88.185 154.404 81.579 152.131 c 64.423 146.231 51.91 134.6 45.14 118.265 c 42.988 113.072 42.446 109.911 42.069 100.368 c \r\n"+"41.551 87.229 42.811 81.166 48.181 70.958 c 52.288 63.15 63.613 51.864 71.549 47.67 c 83.611 41.295 98.688 39.034 112.414 41.542 c h \r\n"+"69.097 66.583 m 66.21 69.342 63.847 71.942 63.847 72.361 c 63.847 72.78 69.506 78.671 76.422 85.451 c 88.996 97.78 l 76.198 110.607 l 63.4 123.434 l \r\n"+"68.336 128.446 l 71.051 131.202 73.641 133.458 74.091 133.458 c 74.542 133.458 80.666 127.846 87.7 120.988 c 100.49 108.517 l 104.919 113.071 l \r\n"+"107.354 115.575 113.31 121.259 118.154 125.701 c 126.961 133.777 l 132.308 128.496 l 137.656 123.215 l 124.694 110.658 l 111.733 98.1 l 124.866 84.939 l \r\n"+"137.999 71.779 l 132.815 67.118 l 129.964 64.555 127.11 62.458 126.474 62.458 c 125.837 62.458 119.93 67.858 113.347 74.458 c \r\n"+"106.765 81.058 100.96 86.458 100.449 86.458 c 99.938 86.458 93.856 80.857 86.933 74.013 c 74.347 61.567 l 69.097 66.583 l h";break;case er.DotCircle:t="81.653 29.406 m 59.375 34.493 40.499 49.67 30.507 70.529 c 21.706 88.903 21.985 112.576 31.224 131.5 c 40.187 149.857 59.173 165.402 79.153 170.743 c \r\n"+"89.388 173.479 110.417 173.17 120.117 170.142 c 146.304 161.968 166.186 141.215 171.737 116.263 c 174.174 105.311 173.305 88.205 169.757 77.285 c \r\n"+"163.1 56.798 144.109 38.334 122.431 31.271 c 116.04 29.189 112.245 28.675 101.153 28.387 c 92.119 28.152 85.668 28.49 81.653 29.406 c h \r\n"+"111.653 44.504 m 132.341 48.848 149.671 64.959 155.751 85.5 c 158.113 93.481 158.113 107.519 155.751 115.5 c 150.089 134.629 134.635 149.703 114.653 155.588 c \r\n"+"106.553 157.973 90.741 157.974 82.695 155.589 c 62.46 149.592 46.687 133.961 41.605 114.869 c 39.656 107.547 39.74 91.753 41.764 84.932 c \r\n"+"50.494 55.507 80.736 38.013 111.653 44.504 c h \r\n"+"90.005 77.33 m 76.55 82.362 69.825 98.176 75.898 110.5 c 78.035 114.836 83.045 119.856 87.653 122.277 c 93.231 125.208 104.066 125.204 109.705 122.27 c \r\n"+"127.735 112.887 128.781 89.485 111.62 79.428 c 106.047 76.162 95.789 75.166 90.005 77.33 c h";break;case er.DotRectangle:t="23.847 98.805 m 23.847 171.305 l 98.347 171.305 l 172.847 171.305 l 172.847 98.805 l 172.847 26.305 l 98.347 26.305 l 23.847 26.305 l 23.847 98.805 l h \r\n"+"157.847 98.813 m 157.847 156.321 l 98.597 156.063 l 39.347 155.805 l 39.089 98.555 l 38.831 41.305 l 98.339 41.305 l 157.847 41.305 l 157.847 98.813 l h \r\n"+"63.527 64.959 m 63.153 65.333 62.847 80.638 62.847 98.972 c 62.847 132.305 l 98.361 132.305 l 133.874 132.305 l 133.611 98.555 l 133.347 64.805 l \r\n"+"98.777 64.542 l 79.763 64.398 63.901 64.585 63.527 64.959 c h";break;case er.NoneCircle:t="83.5 29.406 m 61.222 34.493 42.346 49.67 32.355 70.529 c 23.554 88.903 23.832 112.576 33.071 131.5 c 42.034 149.857 61.02 165.402 81 170.743 c \r\n"+"91.235 173.479 112.265 173.17 121.965 170.142 c 148.151 161.968 168.034 141.215 173.585 116.263 c 176.022 105.311 175.152 88.205 171.605 77.285 c \r\n"+"164.948 56.798 145.957 38.334 124.278 31.271 c 117.887 29.189 114.092 28.675 103 28.387 c 93.966 28.152 87.515 28.49 83.5 29.406 c h \r\n"+"113.5 44.504 m 134.189 48.848 151.519 64.959 157.598 85.5 c 159.961 93.481 159.961 107.519 157.598 115.5 c 151.937 134.629 136.483 149.703 116.5 155.588 c \r\n"+"108.401 157.973 92.589 157.974 84.543 155.589 c 64.308 149.592 48.534 133.961 43.453 114.869 c 41.504 107.547 41.588 91.753 43.612 84.932 c \r\n"+"52.342 55.507 82.583 38.013 113.5 44.504 c h";break;case er.NoneRectangle:t="24.153 97.958 m 24.153 170.458 l 98.653 170.458 l 173.153 170.458 l 173.153 97.958 l 173.153 25.458 l 98.653 25.458 l 24.153 25.458 l 24.153 97.958 l h \r\n"+"157.911 97.708 m 157.653 154.958 l 98.653 154.958 l 39.653 154.958 l 39.393 98.958 l 39.25 68.158 39.348 42.395 39.611 41.708 c \r\n"+"39.987 40.727 52.819 40.458 99.129 40.458 c 158.169 40.458 l 157.911 97.708 l h";break}n.service.pageStream.writeLine("q"),n.service.pushColorToStack();let e=lt.toColor(o.textBrush);if(0!=e.a&&n.service.setNonStrokeColor(e),(o.textBrush.is(Ft)||o.textBrush.is(Ee)||o.textBrush.is(be))&&(s&&n.service.storeShadingData2(n.X,n.Y,n.Width,n.Height,o.textBrush),n.service.pageStream.writeLine1("/Pattern cs /P{0} scn",1+n.service.shadingCurrent)),o.textBrush.is(ve)){let t=o.textBrush;n.service.pageStream.writeLine1("/Cs1 cs /PH{0} scn",n.service.getHatchNumber(t)+1)}n.service.setStrokeColor(o.contourColor),n.service.pageStream.writeLine1("{0} w",n.service.convertToString(o.size)),n.service.pageStream.writeLine1("1 0 0 1 {0} {1} cm",n.service.convertToString(n.X+n.Width/2),n.service.convertToString(n.Y+n.Height/2));let i=Math.min(n.Width,n.Height),r=i/200;n.service.pageStream.writeLine1("{0} 0 0 {0} 0 0 cm",n.service.convertToString(r)),n.service.pageStream.writeLine("1 0 0 1 -98 -98 cm"),n.service.pageStream.writeLine(t),n.service.pageStream.writeLine("B"),n.service.pageStream.writeLine("Q"),n.service.popColorFromStack()}}static getCheckBoxValue(t){let r=null;if(null!=t&&null!=t.checkedValue){r=!1;let e=t.checkedValue.toString().trim().toLowerCase(),i=t.values.split("/");if(null!=(i=1==(i=1==i.length?t.values.split(";"):i).length?t.values.split(","):i)&&0<i.length){let t=i[0].trim().toLowerCase();r=e==t}}return r}};{class _r{static renderText(H,t=null,b=!0){if(H.service.pdfFont.UseUnicode)return void this.renderText3(H,null);let W=H.Component.as(wt),E=H.Component.as(bt),z=H.Component.as(ht),U=H.Component.as(ut),X=H.Component.as(St),G=H.Component.as(et),j=null!=z&&z.textOptions.wordWrap,V=null!=U&&U.horAlignment==at.Width,v=(0<H.service.annotsCounter||0<H.service.annots2Counter)&&G.editable,Y=null!=z&&null!=z.textOptions&&z.textOptions.rightToLeft,y=null,q=0,_=0,K=G.textQuality==J.a.Components.StiTextQuality.Wysiwyg,Q=(V&&(j=!0),H.service.pdfFont.UseUnicode);if(null!=E){let t=G.margins,e=this.hiToTwips*t.left,i=this.hiToTwips*t.right,r=this.hiToTwips*t.top,n=this.hiToTwips*t.bottom,A=H.X+e,T=H.Y+n,F=H.Width-e-i,s=H.Height-r-n,a=0,o=0,l=0,h=0;if(G.border.style!=ot.None){let t=G.border.getSizeOffset();G.border.isLeftBorderSidePresent&&(a=t),G.border.isRightBorderSidePresent&&(o=t),G.border.isTopBorderSidePresent&&(l=t),G.border.isBottomBorderSidePresent&&(h=t)}let c=G.border.as(ft),m=(null!=c&&(a=c.leftSide.getSizeOffset(),o=c.rightSide.getSizeOffset(),l=c.topSide.getSizeOffset(),h=c.bottomSide.getSizeOffset()),.94),g=(A+=this.hiToTwips*m*a,T+=this.hiToTwips*m*h,F-=this.hiToTwips*m*(a+o),s-=this.hiToTwips*m*(l+h),v||(H.service.pageStream.writeLine("q"),H.service.pushColorToStack(),b?H.service.pageStream.writeLine1("{0} {1} {2} {3} re W n",H.service.convertToString(A),H.service.convertToString(T),H.service.convertToString(F),H.service.convertToString(s)):H.service.pageStream.writeLine1("{0} {1} {2} {3} re W n",H.service.convertToString(H.X),H.service.convertToString(H.Y),H.service.convertToString(H.Width),H.service.convertToString(H.Height))),rt.transparent);if(null!=W){if(g=lt.toColor(W.textBrush),H.service.setNonStrokeColor(g),H.service.storeShadingData2(H.X,H.Y,H.Width,H.Height,W.textBrush),(W.textBrush.is(Ft)||W.textBrush.is(Ee)||W.textBrush.is(be))&&H.service.pageStream.writeLine1("/Pattern cs /P{0} scn",1+H.service.shadingCurrent),W.textBrush.is(ve)){let t=W.textBrush.as(ve);H.service.pageStream.writeLine1("/Cs1 cs /PH{0} scn",H.service.getHatchNumber(t)+1)}if(v){let t=H.service.annotsArray[H.service.annotsCurrent];t.FontColor=g}}let C=1,P=H.Component.as(dt),p=1,d=(C=null!=P?P.font.sizeInPoints:C)*this.fontCorrectValue*H.service.pdfFont.tmASC/1e3*p,w=C*this.fontCorrectValue*H.service.pdfFont.tmDESC/1e3*-1*p,u=C*this.fontCorrectValue*H.service.pdfFont.tmExternal/1e3*p,S=C*this.fontCorrectValue*H.service.pdfFont.UnderscoreSize/1e3*p,f=C*this.fontCorrectValue*H.service.pdfFont.UnderscorePosition/1e3*p,L=C*this.fontCorrectValue*H.service.pdfFont.StrikeoutSize/1e3*p,k=C*this.fontCorrectValue*H.service.pdfFont.StrikeoutPosition/1e3*p,B=d-w+u,D=B*G.lineSpacing,I=d,R=w,N=!1,M=(null!=z&&(_=z.textOptions.angle,N=45<_&&_<135||225<_&&_<315),v&&(A-=H.X,T-=H.Y),0);if(null==H.service.report||H.service.report.renderedWith==J.a.StiRenderedWith.JS){let t=H.service.pdfFont.Widths[0]/2048*C/11;N?(T+=t,s-=2*t):(A+=t,F-=2*t)}else{if(G.textQuality==J.a.Components.StiTextQuality.Standard){let t=.35-.04*(14-C),e=(M=137.61)*(C*this.fontCorrectValue)/1e3;N?(T+=t+e,s-=2*(t+e)):(A+=t+e,F-=2*(t+e))}if(G.textQuality==J.a.Components.StiTextQuality.Typographic){let t=.05+.009*(8-C);N?(T+=t,s-=2*t):(A+=t,F-=2*t)}}let O=E.text;if(null==O&&(O=""),O=H.service.stringReplace(O,"\r",""),O=H.service.stringReplace(O,"",""),V&&(O=O.trimEnd()).endsWith("\n")&&(O=O.substr(0,O.length-1)),v&&(y=H.service.stringReplace(E.text,"\n","")),0<F&&0<O.length){let i=A,r=T,n=F,a=s;if(null!=z&&0!=(_=z.textOptions.angle)){if(N){let t=F;F=s,s=t}A=-F/2,T=-s/2}let b=J.c.StiExportUtils.splitString(O,!1);if(j)for(let c=0;c<b.length;c++){let r=b[c];if(r.length<2)continue;let n=new ct,a=0;while(a<r.length)if(tt.isWhitespace(r,a))n.append(r.charAt(a)),a++;else{let t=new ct;while(a<r.length&&!tt.isWhitespace(r,a))t.append(r.charAt(a)),a++;let e=new ct(J.c.StiBidirectionalConvert2.convertString(t.toString(),!1)),i=(n.append(e),t.length-e.length);0<i&&n.append(nt.repeat(String.fromCharCode(0),i))}let e=[],s=n.toString();for(let t=0;t<r.length;t++)e[t]=H.service.pdfFont.UnicodeMap[s.charCodeAt(t)];let o=it.create(Number,r.length),l=it.create(Number,r.length),i=0,h=0;for(let t=0;t<e.length;t++)32<=e[t]&&(h+=H.service.pdfFont.Widths[e[t]-32]),9==e[t]&&(h+=this.getTabsSize(z,C,h+M)+M),o[t]=$.trunc(h),this.isWordWrapSymbol(s,t)&&0<t&&i++,l[t]=i;let t=h*(C*this.fontCorrectValue)/1e3;if(t>F){let t=r.length-1,e=$.trunc(1e3*F/(C*this.fontCorrectValue));while(o[t]>e&&0<t)t--;let i=t;if(0<l[t]){if(l[t]!=l[t+1])i=t++;else{while(!this.isWordWrapSymbol(s,t))t--;i=t-1;while(tt.isWhitespace(s,i)&&0<i)i--}while(tt.isWhitespace(s,t)&&"\t"!=s.charAt(t))t++}else t++;b[c]=V?r.substr(0,i+1)+this.charCode07:r.substr(0,i+1),b.splice(c+1,0,r.substr(t,r.length-t).trimStart())}}q=b.length;let t=-1;for(let r=0;r<b.length;r++){let t=b[r],e=(0!=H.service.pdfFont.UnicodeMap[160]&&65535==H.service.pdfFont.GlyphList[H.service.pdfFont.UnicodeMap[160]]&&(t=H.service.stringReplace(t," "," ")),J.c.StiBidirectionalConvert2.convertString(t,Y)),i="";for(let t=0;t<e.length;t++)i+=String.fromCharCode(H.service.pdfFont.UnicodeMap[e.charCodeAt(t)]);b[r]=i}if(null!=X){let t=(q-1)*D+B,e=X.vertAlignment;(e=0!=_&&90!=_&&180!=_&&270!=_?st.Center:e)==st.Top&&(T+=s-t+(B-I)),e==st.Center&&(G.textQuality==J.a.Components.StiTextQuality.Typographic?T+=(s-t)/2-R:T+=(s-t)/2+1.2*(B-I)),e==st.Bottom&&(G.textQuality==J.a.Components.StiTextQuality.Typographic?T+=-R:T+=1.4*(B-I))}H.service.pageStream.writeLine("BT");let E=0,v=0,y=it.create2(Number,b.length,3),x=null;if(0!=_){let t=_*Math.PI/180;x=new Fe(Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),i+n/2,r+a/2),H.service.pdfFont.NeedSyntItalic&&null!=P&&P.font.italic||H.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} Tm",H.service.convertToString(x.elements[0]),H.service.convertToString(x.elements[1]),H.service.convertToString(x.elements[2]),H.service.convertToString(x.elements[3]),H.service.convertToString(x.elements[4]),H.service.convertToString(x.elements[5]))}H.service.pdfFont.NeedSyntBold&&null!=P&&P.font.bold&&(H.service.pageStream.writeLine1("{0} w 2 Tr",H.service.convertToString(this.boldFontStrokeWidthValue*C,3)),H.service.setStrokeColor(g));for(let f=0;f<q;f++){let a=b[f],r=it.create(Number,a.length),n=0,s=0,i=0,o=1e3*F/(C*this.fontCorrectValue),l=H.service.pdfFont.Widths[H.service.pdfFont.UnicodeMap["…".charCodeAt(0)]],h=0;for(let e=0;e<a.length;e++){let t=a.charCodeAt(e);if(32<=t&&(s+=H.service.pdfFont.Widths[t-32]),9==t){let t=this.getTabsSize(z,C,s);s+=t,r[n++]=t}s+l<o&&(i=s,h=e)}if(s=s*(C*this.fontCorrectValue)/1e3,-1!=t&&(f==q-1&&t<b.length||s>F)&&(a=a.substr(0,h)+String.fromCharCode(H.service.pdfFont.UnicodeMap["…".charCodeAt(0)]),s=(i+l)*(C*this.fontCorrectValue)/1e3),Q){let i=new ct;for(let t=0;t<a.length;t++){t%121==120&&i.appendLine("\r");let e=a.charCodeAt(t);if(32==e||9==e||7==e)i.append(a.charAt(t));else{let t=H.service.pdfFont.GlyphList[e];65535==t&&(t=0),i.appendFormat("{0:X4}",t)}}a=i.toString()}else a=J.c.StiPdfExportService.convertToEscapeSequence(a);let e=A,c=T+D*(q-f-1),m=!1,g=!1;if(null!=U){let t=U.horAlignment;if(V&&(0<a.length&&7===a.charCodeAt(a.length-1)?a=a.substr(0,a.length-1):t=at.Left),0!=_&&90!=_&&180!=_&&270!=_&&(t=at.Center),null!=z&&null!=z.textOptions&&z.textOptions.rightToLeft&&(t==at.Left?t=at.Right:t==at.Right&&(t=at.Left)),t==at.Center&&(e+=(F-s)/2),t==at.Right&&(e+=F-s),t==at.Width){let e=0;for(let t=0;t<a.length;t++)32===a.charCodeAt(t)&&e++;if(0<e&&(f!=b.length-1||K&&s>F)){g=!0;let i=(F-s)/e*1e3/(C*this.fontCorrectValue);if(0<i||K){m=!0,(i+=H.service.pdfFont.Widths[0])<.5*H.service.pdfFont.Widths[0]&&(i=.5*H.service.pdfFont.Widths[0]);let e=Q?"<":"(";for(let t=0;t<a.length;t++)32===a.charCodeAt(t)?e+=Q?">-"+H.service.convertToString(i)+"<":")-"+H.service.convertToString(i)+"(":e+=a[t];e+=Q?">":")",a=e}}}}if(0<n){let e=0,i="";0==g&&(i+=Q?"<":"(");for(let t=0;t<a.length;t++)if("\t"==a[t]){let t=r[e++];i+=Q?">-"+H.service.convertToString(t)+"<":")-"+H.service.convertToString(t)+"("}else i+=a[t];0==g&&(i+=Q?">":")"),a=i}Q&&(a=H.service.stringReplace(a," ",H.service.pdfFont.GlyphList[32].toString(16).toUpperCase()[Z.System.StiObject.stimulsoft]().padLeft(4,"0"))[Z.System.StiObject.stimulsoft]().replaceAll(this.charCode07,"0000"));let p=null!=H.service.pdfFont.ChildFontsMap,d=0,w=it.create(Number,a.length),u=new Array;for(let n=0;n<a.length;n++){let i=a.charCodeAt(n),r=!1;if(13==(w[n]=i)&&(u.push(n),r=!0),p){let t=H.service.pdfFont.UnicodeMapBack[i],e=(92==i&&(t=H.service.pdfFont.UnicodeMapBack[a.charCodeAt(n+1)]),H.service.pdfFont.ChildFontsMap[t]);t<64&&(0<n?e=d:1<a.length&&(e=H.service.pdfFont.ChildFontsMap[H.service.pdfFont.UnicodeMapBack[a.charCodeAt(1)]])),92!=i&&(w[n]=H.service.pdfFont.fonts[e].UnicodeMap[t]),e==d||r||0==n||u.push(n),d=e}}if(u.push(a.length),y[f][0]=e,y[f][1]=c,y[f][2]=s,H.service.pdfFont.NeedSyntItalic&&null!=P&&P.font.italic){let t=new Fe(1,0,this.italicAngleTanValue,1,e,c);null!=x&&t.multiplyAppend(t),H.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} Tm",H.service.convertToString(t.elements[0]),H.service.convertToString(t.elements[1]),H.service.convertToString(t.elements[2]),H.service.convertToString(t.elements[3]),H.service.convertToString(t.elements[4]),H.service.convertToString(t.elements[5]))}else H.service.pageStream.writeLine1("{0} {1} Td",H.service.convertToString(e-E),H.service.convertToString(c-v)),E=e,v=c;let S=0;for(let i=0;i<u.length;i++){if(p&&0<a.length){let t=a.charCodeAt(S)<64&&a.length>S+1?S+1:S,e=H.service.pdfFont.ChildFontsMap[H.service.pdfFont.UnicodeMapBack[a.charCodeAt(t)]];H.service.pageStream.writeLine1("/F{0} {1} Tf",e,H.service.convertToString(C*this.fontCorrectValue,this.precision_digits_font))}let t=u[i],e=t-S;0<e&&(m||0<n?(H.service.pageStream.writeString("["),0<i&&H.service.pageStream.writeString(Q?"<":"("),H.service.pageStream.write(w,S,e),i<u.length-1&&H.service.pageStream.writeString(Q?">":")"),H.service.pageStream.writeLine("] TJ")):(H.service.pageStream.writeString(Q?"<":"("),H.service.pageStream.write(w,S,e),H.service.pageStream.writeLine1("{0} Tj",Q?">":")"))),(S=t)<w.length-1&&13==w[t]&&S++}}if(H.service.pdfFont.NeedSyntBold&&null!=P&&P.font.bold&&H.service.pageStream.writeLine("0 Tr"),H.service.pageStream.writeLine("ET"),null!=P&&P.font.underline){H.service.pageStream.writeLine("q"),H.service.pushColorToStack();let t=.07*C,e=.1*-C;if(0!=H.service.pdfFont.UnderscoreSize&&(t=S,e=f),t<.1&&(t=.1),H.service.pageStream.writeLine1("{0} w",H.service.convertToString(t)),0!=_){let t=_*Math.PI/180;H.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} cm",H.service.convertToString(Math.cos(t)),H.service.convertToString(Math.sin(t)),H.service.convertToString(-Math.sin(t)),H.service.convertToString(Math.cos(t)),H.service.convertToString(i+n/2),H.service.convertToString(r+a/2))}null!=W&&H.service.setStrokeColor(g);for(let t=0;t<b.length;t++)0!=y[t][2]&&(H.service.pageStream.writeLine1("{0} {1} m",H.service.convertToString(y[t][0]),H.service.convertToString(y[t][1]+e)),H.service.pageStream.writeLine1("{0} {1} l S",H.service.convertToString(y[t][0]+y[t][2]),H.service.convertToString(y[t][1]+e)));H.service.pageStream.writeLine("Q"),H.service.popColorFromStack()}if(null!=P&&P.font.strikeout){H.service.pageStream.writeLine("q"),H.service.pushColorToStack();let t=.045*C,e=.25*C;if(0!=H.service.pdfFont.StrikeoutSize&&(t=L,e=k),t<.1&&(t=.1),H.service.pageStream.writeLine1("{0} w",H.service.convertToString(t)),0!=_){let t=_*Math.PI/180;H.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} cm",H.service.convertToString(Math.cos(t)),H.service.convertToString(Math.sin(t)),H.service.convertToString(-Math.sin(t)),H.service.convertToString(Math.cos(t)),H.service.convertToString(i+n/2),H.service.convertToString(r+a/2))}null!=W&&H.service.setStrokeColor(g);for(let t=0;t<b.length;t++)0!=y[t][2]&&(H.service.pageStream.writeLine1("{0} {1} m",H.service.convertToString(y[t][0]),H.service.convertToString(y[t][1]+e)),H.service.pageStream.writeLine1("{0} {1} l S",H.service.convertToString(y[t][0]+y[t][2]),H.service.convertToString(y[t][1]+e)));H.service.pageStream.writeLine("Q"),H.service.popColorFromStack()}}if(v){let e=H.service.annotsArray[H.service.annotsCurrent];if(e.Multiline=j,e.X=H.X,e.Y=H.Y,e.Width=H.Width,e.Height=H.Height,e.Text=y,e.Component=H.Component,e.Alignment=at.Left,null!=U){let t=U.horAlignment;null!=z&&null!=z.textOptions&&z.textOptions.rightToLeft&&(t==at.Left?t=at.Right:t==at.Right&&(t=at.Left)),e.Alignment=t}}v||(H.service.pageStream.writeLine("Q"),H.service.popColorFromStack())}}static isWordWrapSymbol(i,r){let t=i.charCodeAt(r),e=i.charAt(r);if(12288<=t&&t<=55215||tt.isWhitespace(i,r)&&160!=t||6016<=t&&t<=6050||"("==e||"{"==e)return!0;if(0<r){let t=i.charCodeAt(r-1);if(12288<=t&&t<=55215)return!0;let e=i.charAt(r-1);if("!"==e||"%"==e||")"==e||"}"==e||"-"==e||"?"==e)return!0}return!1}static getTabsSize(n,a,s){if(null!=n&&null!=n.textOptions){let e=s,t=750/a,i=t*n.textOptions.distanceBetweenTabs,r=t*n.textOptions.firstTabOffset+i;if(s<r)e=r;else if(0<n.textOptions.distanceBetweenTabs){let t=$.trunc((s-r)/i);t++,e=r+t*i}return e-s}return 0}static renderTextFont(r){let t=r.Component.as(dt);if(null!=t){let e=r.service.pdfFont.getFontNumber(t.font),i=t.font.sizeInPoints*this.fontCorrectValue;if(r.service.pageStream.writeLine1("/F{0} {1} Tf",e,r.service.convertToString(i,this.precision_digits_font)),r.service.pdfFont.currentFont=e,(0<r.service.annotsCounter||0<r.service.annots2Counter)&&r.Component.as(et).editable){let t=r.service.annotsArray[r.service.annotsCurrent];t.FontNumber=e,t.FontSize=i}}}static renderText2(A,T=-1){let t=A.Component.as(bt),e=A.Component.as(ht),F=A.Component.as(et);if(null==t||A.Width<=0)return;if(nt.isNullOrWhiteSpace(t.text))return;let i=(0<A.service.annotsCounter||0<A.service.annots2Counter)&&F.editable,r=null!=e&&null!=e.textOptions&&e.textOptions.rightToLeft,C=0,n=F.margins,a=0,s=a*n.left,o=a*n.right,l=a*n.top,h=a*n.bottom,P=A.X+s,L=A.Y+h,c=A.Width-s-o,k=A.Height-l-h;if(c<=0)return;i||(A.service.pageStream.writeLine("q"),A.service.pushColorToStack(),A.service.pageStream.writeLine1("{0} {1} {2} {3} re W n",A.service.convertToString(A.X),A.service.convertToString(A.Y),A.service.convertToString(A.Width),A.service.convertToString(A.Height)));let B=!1,D=(null!=e&&(C=e.textOptions.angle,B=45<C&&C<135||225<C&&C<315),i&&(P-=A.X,L-=A.Y),P),I=L,R=c,N=k;if(null!=e&&0!=C){if(B){let t=c;c=k,k=t}P=-c/2,L=-k/2}let M=null;if(0!=C){let t=C*Math.PI/180;M=new Fe(Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),D+R/2,I+N/2)}let m=[],O=[];le.drawTextForOutput(F,m,O);for(let e=0;e<m.length;e++){let t=m[e];t.text=J.c.StiBidirectionalConvert2.convertString(t.text,r,!0,!0)}if(Z.StiOptions.Export.Pdf.useProperCaseFontNamesFromHtml)for(let r of O){let e=r.fontName,i=!1;for(let t=0;t<e.length;t++)if(tt.isUpper(e,t)){i=!0;break}if(!i){let t=Z.System.Globalization.CultureInfo.ivariantCulture.textInfo.toTitleCase(e),i=null;if(-1!=t.indexOf(",")){let e=t.split(",");for(let t of e)if((i=new X(t,r.fontBase.size,r.fontBase.style)).name.toLowerCase()==t.toLowerCase())break}else i=new X(t,r.fontBase.size,r.fontBase.style);r.fontBase=i,r.fontName=i.name}}let H=lt.toColor(F.brush),W=!1,z=F.page.unit.convertRectangleToHInches(A.Component.componentToPage(A.Component.clientRectangle)),U=F.convertTextMargins(z,!1);U=F.convertTextBorders(U,!1);for(let x of m){let r=P+this.hiToTwips*(U.left+x.xPos-z.left),n=L+this.hiToTwips*(z.bottom-(U.top+x.yPos)),o=(B&&(r=P+this.hiToTwips*(z.bottom-U.bottom+x.xPos),n=L+this.hiToTwips*(z.right-(U.left+x.yPos))),A.service.pageStream.writeLine("q"),A.service.pushColorToStack(),O[x.fontIndex].fontBase),t=A.service.pdfFont.getFontNumber(o),e=o.sizeInPoints*this.fontCorrectValue,l=(A.service.pageStream.writeLine1("/F{0} {1} Tf",t,A.service.convertToString(e,this.precision_digits_font)),A.service.pdfFont.currentFont=t,A.service.pdfFont.UseUnicode),h=o.sizeInPoints,i=1,a=h*this.fontCorrectValue*A.service.pdfFont.tmASC/1e3*i,s=h*this.fontCorrectValue*A.service.pdfFont.tmDESC/1e3*-1*i,c=h*this.fontCorrectValue*A.service.pdfFont.tmExternal/1e3*i,m=h*this.fontCorrectValue*A.service.pdfFont.UnderscoreSize/1e3*i,g=h*this.fontCorrectValue*A.service.pdfFont.UnderscorePosition/1e3*i,p=h*this.fontCorrectValue*A.service.pdfFont.StrikeoutSize/1e3*i,d=h*this.fontCorrectValue*A.service.pdfFont.StrikeoutPosition/1e3*i,w=(a-s+c)*F.lineSpacing,u=a,S=s,f=!0;if(l&&-1==x.glyphIndexList[0]){f=!1;for(let t=0;t<x.text.length;t++)x.glyphIndexList[t]=A.service.pdfFont.GlyphList[A.service.pdfFont.UnicodeMap[x.text.charCodeAt(t)]]}n-=u;let b=0,E=0;for(let r=0;r<x.glyphIndexList.length;r++){let t=x.text.charCodeAt(r),e=(l&&f&&(t=x.glyphIndexList[r],t=A.service.pdfFont.GlyphBackList[t]),A.service.pdfFont.UnicodeMap[t]),i=1e3;32<=e&&(i=A.service.pdfFont.Widths[e-32]),0==t&&null!=A.service.pdfFont.GlyphWidths&&(i=A.service.pdfFont.GlyphWidths[x.glyphIndexList[r]]),i*=x.scaleList[r],l?0<x.glyphWidths[r]&&(b+=x.glyphWidths[r],E+=i):(b+=x.widths[r],E+=i)}let v=b*this.hiToTwips,y=v/(h*this.fontCorrectValue/1e3)/E;if((W=W||x.backColor.equals(H)?W:!0)&&0!=x.backColor.a&&(A.service.setNonStrokeColor(x.backColor),A.service.pageStream.writeLine1("{0} {1} {2} {3} re f",A.service.convertToString(r),A.service.convertToString(n- -s),A.service.convertToString(v),A.service.convertToString(w))),A.service.setNonStrokeColor(x.textColor),l){let t=new mt(r,n,v,k),e=Kt.getCustomFont(o.name,o.style);this.renderTextLine(A,x.text,t,o,e,F.horAlignment==at.Width?at.Width:F.rightToLeft?at.Right:at.Left,F.rightToLeft,M,x.textColor)}else{let a=new ct,s=(b=0,E=0);a.append(l?"<":"(");for(let n=0;n<x.glyphIndexList.length;n++){let t=x.text.charCodeAt(n),e=(l&&f&&(t=x.glyphIndexList[n],t=A.service.pdfFont.GlyphBackList[t]),A.service.pdfFont.UnicodeMap[t]),i=1e3,r=(32<=e&&(i=A.service.pdfFont.Widths[e-32]),0);if(0<(l?x.glyphWidths:x.widths)[n]?(E+=i*x.scaleList[n],s+=i,r=-(E*y-s),s+=-r):r=i,l){let t=x.glyphIndexList[n];65535==t&&(t=0),a.appendFormat("{0:X4}",t),n<x.glyphIndexList.length-1&&a.append(">"+A.service.convertToString(r)+"<")}else a.append(J.c.StiPdfExportService.convertToEscapeSequencePlusTabs(String.fromCharCode(e))),n<x.glyphIndexList.length-1&&a.append(")"+A.service.convertToString(r)+"(")}a.append(l?">":")");let e=it.create(Number,a.length);for(let t=0;t<a.length;t++)e[t]=a.charCodeAt(t);A.service.pageStream.writeLine("BT");let i=null;if(0!=C){let t=C*Math.PI/180,e=(i=new Fe(Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),D+R/2,I+N/2),new Fe(1,0,0,1,r,n));i.multiplyPrepend(e)}if(A.service.pdfFont.NeedSyntItalic&&o.italic)if(null!=i){let t=new Fe(1,0,this.italicAngleTanValue,1,0,0);i.multiplyPrepend(t)}else{let t=new Fe(1,0,this.italicAngleTanValue,1,r,n);i=t}if(null!=i?A.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} Tm",A.service.convertToString(i.elements[0],7),A.service.convertToString(i.elements[1],7),A.service.convertToString(i.elements[2],7),A.service.convertToString(i.elements[3],7),A.service.convertToString(i.elements[4],6),A.service.convertToString(i.elements[5],6)):A.service.pageStream.writeLine1("{0} {1} Td",A.service.convertToString(r),A.service.convertToString(n)),A.service.pdfFont.NeedSyntBold&&o.bold&&(A.service.pageStream.writeLine1("{0} w 2 Tr",A.service.convertToString(this.boldFontStrokeWidthValue*h*this.fontCorrectValue,this.precision_digits_font)),A.service.setStrokeColor(x.textColor)),A.service.pageStream.writeString("["),A.service.pageStream.flush(),A.service.pageStream.write(e,0,e.length),A.service.pageStream.writeLine("] TJ"),A.service.pageStream.writeLine("ET"),A.service.pdfFont.NeedSyntBold&&o.bold&&A.service.pageStream.writeLine("0 Tr"),o.underline){A.service.pageStream.writeLine("q"),A.service.pushColorToStack();let t=.09*h,e=.115*-h;if(0!=A.service.pdfFont.UnderscoreSize&&(t=m,e=g),t<.1&&(t=.1),A.service.pageStream.writeLine1("{0} w",A.service.convertToString(t)),0!=C){let t=C*Math.PI/180;A.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} cm",A.service.convertToString(Math.cos(t),7),A.service.convertToString(Math.sin(t),7),A.service.convertToString(-Math.sin(t),7),A.service.convertToString(Math.cos(t),7),A.service.convertToString(D+R/2,6),A.service.convertToString(I+N/2,6))}A.service.setStrokeColor(x.textColor),A.service.pageStream.writeLine1("{0} {1} m",A.service.convertToString(r),A.service.convertToString(n+e)),A.service.pageStream.writeLine1("{0} {1} l S",A.service.convertToString(r+v),A.service.convertToString(n+e)),A.service.pageStream.writeLine("Q"),A.service.popColorFromStack()}if(o.strikeout){A.service.pageStream.writeLine("q"),A.service.pushColorToStack();let t=.09*h,e=.4*h;if(0!=A.service.pdfFont.StrikeoutSize&&(t=p,e=d),t<.1&&(t=.1),A.service.pageStream.writeLine1("{0} w",A.service.convertToString(t)),0!=C){let t=C*Math.PI/180;A.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} cm",A.service.convertToString(Math.cos(t),7),A.service.convertToString(Math.sin(t),7),A.service.convertToString(-Math.sin(t),7),A.service.convertToString(Math.cos(t),7),A.service.convertToString(D+R/2,6),A.service.convertToString(I+N/2,6))}A.service.setStrokeColor(x.textColor),A.service.pageStream.writeLine1("{0} {1} m",A.service.convertToString(r),A.service.convertToString(n+e)),A.service.pageStream.writeLine1("{0} {1} l S",A.service.convertToString(r+v),A.service.convertToString(n+e)),A.service.pageStream.writeLine("Q"),A.service.popColorFromStack()}}if(A.service.pageStream.writeLine("Q"),A.service.popColorFromStack(),-1!=T&&!nt.isNullOrWhiteSpace(x.href)&&!x.href.trim().startsWith("javascript:")&&!A.service.usePdfA){let t=new J.c.StiLinkObject;t.Link=x.href,t.X=r,t.Y=n+S,t.Width=v,t.Height=w,t.Page=T,t.DestPage=-1,t.DestY=-1,A.service.linksArray.push(t)}}t.linesOfUnderline,ot.None,i||(A.service.pageStream.writeLine("Q"),A.service.popColorFromStack())}static renderText3(i,M=-1){let t=i.Component.as(bt),r=i.Component.as(ht),n=i.Component.as(et);if(null==t||i.Width<=0)return;let e=(0<i.service.annotsCounter||0<i.service.annots2Counter)&&n.editable,a=0,s=null,o=n.margins,l=this.hiToTwips*o.left,O=this.hiToTwips*o.right,H=this.hiToTwips*o.top,h=this.hiToTwips*o.bottom,c=i.X+l,m=i.Y+h,g=i.Width-l-O,p=i.Height-H-h,d=0,w=0,u=0,S=0;if(n.border.style!=ot.None){let t=n.border.getSizeOffset();n.border.isLeftBorderSidePresent&&(d=t),n.border.isRightBorderSidePresent&&(w=t),n.border.isTopBorderSidePresent&&(u=t),n.border.isBottomBorderSidePresent&&(S=t)}let f=n.border.as(ft),b=(null!=f&&(d=f.leftSide.getSizeOffset(),w=f.rightSide.getSizeOffset(),u=f.topSide.getSizeOffset(),S=f.bottomSide.getSizeOffset()),.94);if(c+=this.hiToTwips*b*d,m+=this.hiToTwips*b*S,g-=this.hiToTwips*b*(d+w),p-=this.hiToTwips*b*(u+S),g<=0)return;e||(i.service.pageStream.writeLine("q"),i.service.pushColorToStack(),i.service.pageStream.writeLine1("{0} {1} {2} {3} re W n",i.service.convertToString(i.X),i.service.convertToString(i.Y),i.service.convertToString(i.Width),i.service.convertToString(i.Height)));let W=c,z=m,U=g,X=p,E=(e&&(c-=i.X,m-=i.Y),!1);if(null!=r&&(a=r.textOptions.angle,E=45<a&&a<135||225<a&&a<315,0!=a)){if(E){let t=g;g=p,p=t}c=-g/2,m=-p/2}let v=null;if(0!=a){let t=a*Math.PI/180;v=new Fe(Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),W+U/2,z+X/2)}let G=40,y=G*(n.font.sizeInPoints*this.fontCorrectValue)/1e3,x=(E?(m+=y,p-=2*y):(c+=y,g-=2*y),rt.transparent),A=i.Component.as(wt);if(null!=A){if(x=lt.toColor(A.textBrush),i.service.setNonStrokeColor(x),i.service.storeShadingData2(i.X,i.Y,i.Width,i.Height,A.textBrush),(A.textBrush.is(Ft)||A.textBrush.is(Ee)||A.textBrush.is(be))&&i.service.pageStream.writeLine1("/Pattern cs /P{0} scn",1+i.service.shadingCurrent),A.textBrush.is(ve)){let t=A.textBrush.as(ve);i.service.pageStream.writeLine1("/Cs1 cs /PH{0} scn",i.service.getHatchNumber(t)+1)}if(e){let t=i.service.annotsArray[i.service.annotsCurrent];t.FontColor=x}}let T=n.font.sizeInPoints,F=1,C=T*this.fontCorrectValue*i.service.pdfFont.tmASC/1e3*F,j=T*this.fontCorrectValue*i.service.pdfFont.tmDESC/1e3*-1*F,V=T*this.fontCorrectValue*i.service.pdfFont.tmExternal/1e3*F,P=C-j+V,L=P*n.lineSpacing,k=Kt.getCustomFont(n.font.name,n.font.style),Y=T*this.fontCorrectValue/1e3,q=1e3/k.unitsPerEm,_=g/(Y*q),B=null!=r&&r.textOptions.wordWrap,D=(n.horAlignment==at.Width&&(B=!0),t.text),K=(null==D&&(D=""),e&&(s=i.service.stringReplace(D,"\n","")),J.c.StiExportUtils.splitString(D,!0)),I=[],R=[];for(let e=0;e<K.length;e++){let t=K[e];if(B){let s=[],o=0,i=0;while(o<=t.length){while(o<t.length&&tt.isWhitespace(t,o))o++;while(o<t.length&&!this.isWordWrapSymbol(t,o))o++;o>i&&(s.push(t.substring(i,o)),i=o),o++}let l=[];for(o=0;o<s.length;o++){let t=s[o],e=k.layout(t),i=0;for(let t of e.glyphs)i+=t.advanceWidth;l.push(i)}i=0,o=0;while(o<s.length){let t=0;while(o<s.length&&t+l[o]<_)t+=l[o],o++;if(o==i){let r=s[o].trimStart(),i=!1;for(let e=0;e<r.length;e++){let t=r.charCodeAt(e);if(6016<=t&&t<=6143){i=!0;break}}let t=s[o],e=k.layout(t),n=0,a=0;for(;a<e.glyphs.length;a++)if((n+=e.glyphs[a].advanceWidth)*Y*q>=g)break;if(i){let e=a;for(;0<e;e--){let t=r.charCodeAt(e);if(6016<=t&&t<=6050)break}0<e&&(a=e)}if(!(a>=r.length)){I.push(r.substring(0,a)),R.push(!1);let t=r.substring(a),e=t,i=k.layout(e);s[o]=t,l[o]=i.advanceWidth;continue}o++}let e="";for(let t=i;t<o;t++)e+=s[t];0<i&&(e=e.trimStart()),I.push(e.trimEnd()),R.push(o<s.length),i=o}}else I.push(t.trimEnd()),R.push(!1)}let Q=(I.length-1)*L+P,N=n.vertAlignment,Z=((N=0!=a&&90!=a&&180!=a&&270!=a?st.Center:N)==st.Top&&(m+=p),N==st.Center&&(m+=p-(p-Q)/2),N==st.Bottom&&(m+=Q),m+=-C,new mt(c,m,g,p));for(let e=0;e<I.length;e++){let t=n.horAlignment!=at.Width||R[e]?n.horAlignment:at.Left;this.renderTextLine(i,I[e],Z,n.font,k,t,n.rightToLeft,v,x),Z.y-=L}if(e){let t=i.service.annotsArray[i.service.annotsCurrent],e=(t.Multiline=B,t.X=i.X,t.Y=i.Y,t.Width=i.Width,t.Height=i.Height,t.Text=s,t.Component=i.Component,t.Alignment=at.Left,n.horAlignment);null!=r&&null!=r.textOptions&&r.textOptions.rightToLeft&&(e==at.Left?e=at.Right:e==at.Right&&(e=at.Left)),t.Alignment=e}e||(i.service.pageStream.writeLine("Q"),i.service.popColorFromStack())}static renderTextLine(h,t,e,i,r,n,a,s,o){let l=i.sizeInPoints,c=1,m=l*this.fontCorrectValue*h.service.pdfFont.UnderscoreSize/1e3*c,g=l*this.fontCorrectValue*h.service.pdfFont.UnderscorePosition/1e3*c,p=l*this.fontCorrectValue*h.service.pdfFont.StrikeoutSize/1e3*c,d=l*this.fontCorrectValue*h.service.pdfFont.StrikeoutPosition/1e3*c,w=l*this.fontCorrectValue/1e3,u=1e3/r.unitsPerEm,S=[],f=(J.c.StiBidirectionalConvert2.logicalToVisual(t,a,null,S),0==S.length&&S.push(t),0),b=0,E=[];for(let i of S){let e=r.layout(i);for(let t of e.glyphs)f+=t.advanceWidth;E.push(e);for(let t=0;t<i.length;t++)tt.isWhitespace(i,t)&&b++}let v=f*u*w,y=0;if((!a&&n==at.Right||a&&n==at.Left)&&(y=e.width-v),n==at.Center&&(y=(e.width-v)/2),n==at.Width&&0<b){let r=(e.width-v)/b/(u*w);for(let i=0;i<E.length;i++){let e=S[i];for(let t=0;t<e.length;t++)tt.isWhitespace(e,t)&&(E[i].positions[t].xAdvance+=r)}v=e.width}let x=e.left+y,A=e.y,T=(h.service.pageStream.writeLine("BT"),null);if(null!=s){T=s.clone();let t=new Fe(1,0,0,1,x,A);T.multiplyPrepend(t)}if(h.service.pdfFont.NeedSyntItalic&&i.italic)if(null!=T){let t=new Fe(1,0,this.italicAngleTanValue,1,0,0);T.multiplyPrepend(t)}else{let t=new Fe(1,0,this.italicAngleTanValue,1,x,A);T=t}null!=T?h.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} Tm",h.service.convertToString(T.elements[0],7),h.service.convertToString(T.elements[1],7),h.service.convertToString(T.elements[2],7),h.service.convertToString(T.elements[3],7),h.service.convertToString(T.elements[4],6),h.service.convertToString(T.elements[5],6)):h.service.pageStream.writeLine1("{0} {1} Td",h.service.convertToString(x),h.service.convertToString(A)),h.service.pdfFont.NeedSyntBold&&i.bold&&(h.service.pageStream.writeLine1("{0} w 2 Tr",h.service.convertToString(this.boldFontStrokeWidthValue*l*this.fontCorrectValue,this.precision_digits_font)),h.service.setStrokeColor(o));let F=0,C=0,P=0;for(let l of E){let s=0,o=0;while(o<l.glyphs.length){let t=F*u*w,e=0;while(o<l.glyphs.length&&0==l.positions[o].xOffset&&0==l.positions[o].yOffset)F+=l.positions[o].xAdvance,o++;o==s&&(F+=l.positions[o].xAdvance,t+=l.positions[o].xOffset*u*w,e+=l.positions[o].yOffset*u*w,o++);let i=t-C,r=e-P,n=(0==i&&0==r||h.service.pageStream.writeLine1("{0} {1} Td",h.service.convertToString(i),h.service.convertToString(r)),new ct);n.append("<");for(let i=s;i<o;i++){let t=l.glyphs[i],e=-Math.round(l.positions[i].xAdvance*u-h.service.pdfFont.GlyphWidths[t.id]);n.appendFormat("{0:X4}",t.id),0!=e&&i<o-1&&n.append(">"+h.service.convertToString(e)+"<")}n.append(">");let a=it.create(Number,n.length);for(let t=0;t<n.length;t++)a[t]=n.charCodeAt(t);h.service.pageStream.writeString("["),h.service.pageStream.flush(),h.service.pageStream.write(a,0,a.length),h.service.pageStream.writeLine("] TJ"),s=o,C=t,P=e}}if(h.service.pageStream.writeLine("ET"),h.service.pdfFont.NeedSyntBold&&i.bold&&h.service.pageStream.writeLine("0 Tr"),i.underline){h.service.pageStream.writeLine("q"),h.service.pushColorToStack(),h.service.setStrokeColor(o);let t=.09*l,e=.115*-l;0!=h.service.pdfFont.UnderscoreSize&&(t=m,e=g),t<.1&&(t=.1),h.service.pageStream.writeLine1("{0} w",h.service.convertToString(t)),null!=s&&h.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} Tm",h.service.convertToString(s.elements[0],7),h.service.convertToString(s.elements[1],7),h.service.convertToString(s.elements[2],7),h.service.convertToString(s.elements[3],7),h.service.convertToString(s.elements[4],6),h.service.convertToString(s.elements[5],6)),h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(x),h.service.convertToString(A+e)),h.service.pageStream.writeLine1("{0} {1} l S",h.service.convertToString(x+v),h.service.convertToString(A+e)),h.service.pageStream.writeLine("Q"),h.service.popColorFromStack()}if(i.strikeout){h.service.pageStream.writeLine("q"),h.service.pushColorToStack(),h.service.setStrokeColor(o);let t=.09*l,e=.4*l;0!=h.service.pdfFont.StrikeoutSize&&(t=p,e=d),t<.1&&(t=.1),h.service.pageStream.writeLine1("{0} w",h.service.convertToString(t)),null!=s&&h.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} Tm",h.service.convertToString(s.elements[0],7),h.service.convertToString(s.elements[1],7),h.service.convertToString(s.elements[2],7),h.service.convertToString(s.elements[3],7),h.service.convertToString(s.elements[4],6),h.service.convertToString(s.elements[5],6)),h.service.pageStream.writeLine1("{0} {1} m",h.service.convertToString(x),h.service.convertToString(A+e)),h.service.pageStream.writeLine1("{0} {1} l S",h.service.convertToString(x+v),h.service.convertToString(A+e)),h.service.pageStream.writeLine("Q"),h.service.popColorFromStack()}}}_r.hiToTwips=.72,_r.precision_digits_font=3,_r.fontCorrectValue=1,_r.boldFontStrokeWidthValue=.031,_r.italicAngleTanValue=.325,_r.charCode07=String.fromCharCode(7),J.c.StiPdfRenderText=_r}{class Kr{static get standardFontCharsNames(){if(null==this._standardFontCharsNames){let i=["0020space","0021exclam","0022quotedbl","0023numbersign","0024dollar","0025percent","0026ampersand","0027quotesingle","0028parenleft","0029parenright","002Aasterisk","002Bplus","002Ccomma","002Dhyphen","002Eperiod","002Fslash","0030zero","0031one","0032two","0033three","0034four","0035five","0036six","0037seven","0038eight","0039nine","003Acolon","003Bsemicolon","003Cless","003Dequal","003Egreater","003Fquestion","0040at","0041A","0042B","0043C","0044D","0045E","0046F","0047G","0048H","0049I","004AJ","004BK","004CL","004DM","004EN","004FO","0050P","0051Q","0052R","0053S","0054T","0055U","0056V","0057W","0058X","0059Y","005AZ","005Bbracketleft","005Cbackslash","005Dbracketright","005Easciicircum","005Funderscore","0060grave","0061a","0062b","0063c","0064d","0065e","0066f","0067g","0068h","0069i","006Aj","006Bk","006Cl","006Dm","006En","006Fo","0070p","0071q","0072r","0073s","0074t","0075u","0076v","0077w","0078x","0079y","007Az","007Bbraceleft","007Cbar","007Dbraceright","007Easciitilde","007FcontrolDEL","00A0nbspace","00A1exclamdown","00A2cent","00A3sterling","00A4currency","00A5yen","00A6brokenbar","00A7section","00A8dieresis","00A9copyright","00AAordfeminine","00ABguillemotleft","00AClogicalnot","00ADsofthyphen","00AEregistered","00AFmacron","00B0degree","00B1plusminus","00B2twosuperior","00B3threesuperior","00B4acute","00B5mu","00B6paragraph","00B7periodcentered","00B8cedilla","00B9onesuperior","00BAordmasculine","00BBguillemotright","00BConequarter","00BDonehalf","00BEthreequarters","00BFquestiondown","00C0Agrave","00C1Aacute","00C2Acircumflex","00C3Atilde","00C4Adieresis","00C5Aring","00C6AE","00C7Ccedilla","00C8Egrave","00C9Eacute","00CAEcircumflex","00CBEdieresis","00CCIgrave","00CDIacute","00CEIcircumflex","00CFIdieresis","00D0Eth","00D1Ntilde","00D2Ograve","00D3Oacute","00D4Ocircumflex","00D5Otilde","00D6Odieresis","00D7multiply","00D8Oslash","00D9Ugrave","00DAUacute","00DBUcircumflex","00DCUdieresis","00DDYacute","00DEThorn","00DFgermandbls","00E0agrave","00E1aacute","00E2acircumflex","00E3atilde","00E4adieresis","00E5aring","00E6ae","00E7ccedilla","00E8egrave","00E9eacute","00EAecircumflex","00EBedieresis","00ECigrave","00EDiacute","00EEicircumflex","00EFidieresis","00F0eth","00F1ntilde","00F2ograve","00F3oacute","00F4ocircumflex","00F5otilde","00F6odieresis","00F7divide","00F8oslash","00F9ugrave","00FAuacute","00FBucircumflex","00FCudieresis","00FDyacute","00FEthorn","00FFydieresis","0100Amacron","0101amacron","0102Abreve","0103abreve","0104Aogonek","0105aogonek","0106Cacute","0107cacute","0108Ccircumflex","0109ccircumflex","010ACdotaccent","010Bcdotaccent","010CCcaron","010Dccaron","010EDcaron","010Fdcaron","0110Dcroat","0111dcroat","0112Emacron","0113emacron","0114Ebreve","0115ebreve","0116Edotaccent","0117edotaccent","0118Eogonek","0119eogonek","011AEcaron","011Becaron","011CGcircumflex","011Dgcircumflex","011EGbreve","011Fgbreve","0120Gdotaccent","0121gdotaccent","0122Gcommaaccent","0123gcommaaccent","0124Hcircumflex","0125hcircumflex","0126Hbar","0127hbar","0128Itilde","0129itilde","012AImacron","012Bimacron","012CIbreve","012Dibreve","012EIogonek","012Fiogonek","0130Idotaccent","0131dotlessi","0132IJ","0133ij","0134Jcircumflex","0135jcircumflex","0136Kcommaaccent","0137kcommaaccent","0138kgreenlandic","0139Lacute","013Alacute","013BLcommaaccent","013Clcommaaccent","013DLcaron","013Elcaron","013FLdot","0140ldot","0141Lslash","0142lslash","0143Nacute","0144nacute","0145Ncommaaccent","0146ncommaaccent","0147Ncaron","0148ncaron","0149napostrophe","014AEng","014Beng","014COmacron","014Domacron","014EObreve","014Fobreve","0150Ohungarumlaut","0151ohungarumlaut","0152OE","0153oe","0154Racute","0155racute","0156Rcommaaccent","0157rcommaaccent","0158Rcaron","0159rcaron","015ASacute","015Bsacute","015CScircumflex","015Dscircumflex","015EScedilla","015Fscedilla","0160Scaron","0161scaron","0162Tcommaaccent","0163tcommaaccent","0164Tcaron","0165tcaron","0166Tbar","0167tbar","0168Utilde","0169utilde","016AUmacron","016Bumacron","016CUbreve","016Dubreve","016EUring","016Furing","0170Uhungarumlaut","0171uhungarumlaut","0172Uogonek","0173uogonek","0174Wcircumflex","0175wcircumflex","0176Ycircumflex","0177ycircumflex","0178Ydieresis","0179Zacute","017Azacute","017BZdotaccent","017Czdotaccent","017DZcaron","017Ezcaron","017Flongs","0180bstroke","0181Bhook","0182Btopbar","0183btopbar","0184Tonesix","0185tonesix","0186Oopen","0187Chook","0188chook","0189Dafrican","018ADhook","018BDtopbar","018Cdtopbar","018Ddeltaturned","018EEreversed","018FSchwa","0190Eopen","0191Fhook","0192florin","0193Ghook","0194Gammaafrican","0195hv","0196Iotaafrican","0197Istroke","0198Khook","0199khook","019Albar","019Blambdastroke","019CMturned","019DNhookleft","019Enlegrightlong","019FOcenteredtilde","01A0Ohorn","01A1ohorn","01A2Oi","01A3oi","01A4Phook","01A5phook","01A6yr","01A7Tonetwo","01A8tonetwo","01A9Esh","01AAeshreversedloop","01ABtpalatalhook","01ACThook","01ADthook","01AETretroflexhook","01AFUhorn","01B0uhorn","01B1Upsilonafrican","01B2Vhook","01B3Yhook","01B4yhook","01B5Zstroke","01B6zstroke","01B7Ezh","01B8Ezhreversed","01B9ezhreversed","01BAezhtail","01BBtwostroke","01BCTonefive","01BDtonefive","01BEglottalinvertedstroke","01BFwynn","01C0clickdental","01C1clicklateral","01C2clickalveolar","01C3clickretroflex","01C4DZcaron","01C5Dzcaron","01C6dzcaron","01C7LJ","01C8Lj","01C9lj","01CANJ","01CBNj","01CCnj","01CDAcaron","01CEacaron","01CFIcaron","01D0icaron","01D1Ocaron","01D2ocaron","01D3Ucaron","01D4ucaron","01D5Udieresismacron","01D6udieresismacron","01D7Udieresisacute","01D8udieresisacute","01D9Udieresiscaron","01DAudieresiscaron","01DBUdieresisgrave","01DCudieresisgrave","01DDeturned","01DEAdieresismacron","01DFadieresismacron","01E0Adotmacron","01E1adotmacron","01E2AEmacron","01E3aemacron","01E4Gstroke","01E5gstroke","01E6Gcaron","01E7gcaron","01E8Kcaron","01E9kcaron","01EAOogonek","01EBoogonek","01ECOogonekmacron","01EDoogonekmacron","01EEEzhcaron","01EFezhcaron","01F0jcaron","01F1DZ","01F2Dz","01F3dz","01F4Gacute","01F5gacute","01FAAringacute","01FBaringacute","01FCAEacute","01FDaeacute","01FEOslashacute","01FFoslashacute","0200Adblgrave","0201adblgrave","0202Ainvertedbreve","0203ainvertedbreve","0204Edblgrave","0205edblgrave","0206Einvertedbreve","0207einvertedbreve","0208Idblgrave","0209idblgrave","020AIinvertedbreve","020Biinvertedbreve","020COdblgrave","020Dodblgrave","020EOinvertedbreve","020Foinvertedbreve","0210Rdblgrave","0211rdblgrave","0212Rinvertedbreve","0213rinvertedbreve","0214Udblgrave","0215udblgrave","0216Uinvertedbreve","0217uinvertedbreve","0218Scommaaccent","0219scommaaccent","0250aturned","0251ascript","0252ascriptturned","0253bhook","0254oopen","0255ccurl","0256dtail","0257dhook","0258ereversed","0259schwa","025Aschwahook","025Beopen","025Ceopenreversed","025Deopenreversedhook","025Eeopenreversedclosed","025Fjdotlessstroke","0260ghook","0261gscript","0263gammalatinsmall","0264ramshorn","0265hturned","0266hhook","0267henghook","0268istroke","0269iotalatin","026Blmiddletilde","026Clbelt","026Dlhookretroflex","026Elezh","026Fmturned","0270mlonglegturned","0271mhook","0272nhookleft","0273nhookretroflex","0275obarred","0277omegalatinclosed","0278philatin","0279rturned","027Arlonglegturned","027Brhookturned","027Crlongleg","027Drhook","027Erfishhook","027Frfishhookreversed","0281Rsmallinverted","0282shook","0283esh","0284dotlessjstrokehook","0285eshsquatreversed","0286eshcurl","0287tturned","0288tretroflexhook","0289ubar","028Aupsilonlatin","028Bvhook","028Cvturned","028Dwturned","028Eyturned","0290zretroflexhook","0291zcurl","0292ezh","0293ezhcurl","0294glottalstop","0295glottalstopreversed","0296glottalstopinverted","0297cstretched","0298bilabialclick","029Aeopenclosed","029BGsmallhook","029Djcrossedtail","029Ekturned","02A0qhook","02A1glottalstopstroke","02A2glottalstopstrokereversed","02A3dzaltone","02A4dezh","02A5dzcurl","02A6ts","02A7tesh","02A8tccurl","02B0hsuperior","02B1hhooksuperior","02B2jsuperior","02B4rturnedsuperior","02B5rhookturnedsuperior","02B6Rsmallinvertedsuperior","02B7wsuperior","02B8ysuperior","02B9primemod","02BAdblprimemod","02BBcommaturnedmod","02BCafii57929","02BDafii64937","02BEringhalfright","02BFringhalfleft","02C0glottalstopmod","02C1glottalstopreversedmod","02C2arrowheadleftmod","02C3arrowheadrightmod","02C4arrowheadupmod","02C5arrowheaddownmod","02C6circumflex","02C7caron","02C8verticallinemod","02C9firsttonechinese","02CAsecondtonechinese","02CBfourthtonechinese","02CCverticallinelowmod","02CDmacronlowmod","02CEgravelowmod","02CFacutelowmod","02D0colontriangularmod","02D1colontriangularhalfmod","02D2ringhalfrightcentered","02D3ringhalfleftcentered","02D4uptackmod","02D5downtackmod","02D6plusmod","02D7minusmod","02D8breve","02D9dotaccent","02DAring","02DBogonek","02DCtilde","02DDhungarumlaut","02DErhotichookmod","02E0gammasuperior","02E3xsuperior","02E4glottalstopreversedsuperior","02E5tonebarextrahighmod","02E6tonebarhighmod","02E7tonebarmidmod","02E8tonebarlowmod","02E9tonebarextralowmod","0300gravecomb","0301acutecomb","0302circumflexcmb","0303tildecomb","0304macroncmb","0305overlinecmb","0306brevecmb","0307dotaccentcmb","0308dieresiscmb","0309hookabovecomb","030Aringcmb","030Bhungarumlautcmb","030Ccaroncmb","030Dverticallineabovecmb","030Edblverticallineabovecmb","030Fdblgravecmb","0310candrabinducmb","0311breveinvertedcmb","0312commaturnedabovecmb","0313commaabovecmb","0314commareversedabovecmb","0315commaaboverightcmb","0316gravebelowcmb","0317acutebelowcmb","0318lefttackbelowcmb","0319righttackbelowcmb","031Aleftangleabovecmb","031Bhorncmb","031Cringhalfleftbelowcmb","031Duptackbelowcmb","031Edowntackbelowcmb","031Fplusbelowcmb","0320minusbelowcmb","0321hookpalatalizedbelowcmb","0322hookretroflexbelowcmb","0323dotbelowcomb","0324dieresisbelowcmb","0325ringbelowcmb","0327cedillacmb","0328ogonekcmb","0329verticallinebelowcmb","032Abridgebelowcmb","032Bdblarchinvertedbelowcmb","032Ccaronbelowcmb","032Dcircumflexbelowcmb","032Ebrevebelowcmb","032Fbreveinvertedbelowcmb","0330tildebelowcmb","0331macronbelowcmb","0332lowlinecmb","0333dbllowlinecmb","0334tildeoverlaycmb","0335strokeshortoverlaycmb","0336strokelongoverlaycmb","0337solidusshortoverlaycmb","0338soliduslongoverlaycmb","0339ringhalfrightbelowcmb","033Abridgeinvertedbelowcmb","033Bsquarebelowcmb","033Cseagullbelowcmb","033Dxabovecmb","033Etildeverticalcmb","033Fdbloverlinecmb","0340gravetonecmb","0341acutetonecmb","0342perispomenigreekcmb","0343koroniscmb","0344dialytikatonoscmb","0345ypogegrammenigreekcmb","0360tildedoublecmb","0361breveinverteddoublecmb","0374numeralsigngreek","0375numeralsignlowergreek","037Aypogegrammeni","037Equestiongreek","0384tonos","0385dieresistonos","0386Alphatonos","0387anoteleia","0388Epsilontonos","0389Etatonos","038AIotatonos","038COmicrontonos","038EUpsilontonos","038FOmegatonos","0390iotadieresistonos","0391Alpha","0392Beta","0393Gamma","0394Deltagreek","0395Epsilon","0396Zeta","0397Eta","0398Theta","0399Iota","039AKappa","039BLambda","039CMu","039DNu","039EXi","039FOmicron","03A0Pi","03A1Rho","03A3Sigma","03A4Tau","03A5Upsilon","03A6Phi","03A7Chi","03A8Psi","03A9Omegagreek","03AAIotadieresis","03ABUpsilondieresis","03ACalphatonos","03ADepsilontonos","03AEetatonos","03AFiotatonos","03B0upsilondieresistonos","03B1alpha","03B2beta","03B3gamma","03B4delta","03B5epsilon","03B6zeta","03B7eta","03B8theta","03B9iota","03BAkappa","03BBlambda","03BCmu","03BDnu","03BExi","03BFomicron","03C0pi","03C1rho","03C2sigma1","03C3sigma","03C4tau","03C5upsilon","03C6phi","03C7chi","03C8psi","03C9omega","03CAiotadieresis","03CBupsilondieresis","03CComicrontonos","03CDupsilontonos","03CEomegatonos","03D0betasymbolgreek","03D1theta1","03D2Upsilon1","03D3Upsilonacutehooksymbolgreek","03D4Upsilondieresishooksymbolgreek","03D5phi1","03D6omega1","03DAStigmagreek","03DCDigammagreek","03DEKoppagreek","03E0Sampigreek","03E2Sheicoptic","03E3sheicoptic","03E4Feicoptic","03E5feicoptic","03E6Kheicoptic","03E7kheicoptic","03E8Horicoptic","03E9horicoptic","03EAGangiacoptic","03EBgangiacoptic","03ECShimacoptic","03EDshimacoptic","03EEDeicoptic","03EFdeicoptic","03F0kappasymbolgreek","03F1rhosymbolgreek","03F2sigmalunatesymbolgreek","03F3yotgreek","0401afii10023","0402afii10051","0403afii10052","0404afii10053","0405afii10054","0406afii10055","0407afii10056","0408afii10057","0409afii10058","040Aafii10059","040Bafii10060","040Cafii10061","040Eafii10062","040Fafii10145","0410afii10017","0411afii10018","0412afii10019","0413afii10020","0414afii10021","0415afii10022","0416afii10024","0417afii10025","0418afii10026","0419afii10027","041Aafii10028","041Bafii10029","041Cafii10030","041Dafii10031","041Eafii10032","041Fafii10033","0420afii10034","0421afii10035","0422afii10036","0423afii10037","0424afii10038","0425afii10039","0426afii10040","0427afii10041","0428afii10042","0429afii10043","042Aafii10044","042Bafii10045","042Cafii10046","042Dafii10047","042Eafii10048","042Fafii10049","0430afii10065","0431afii10066","0432afii10067","0433afii10068","0434afii10069","0435afii10070","0436afii10072","0437afii10073","0438afii10074","0439afii10075","043Aafii10076","043Bafii10077","043Cafii10078","043Dafii10079","043Eafii10080","043Fafii10081","0440afii10082","0441afii10083","0442afii10084","0443afii10085","0444afii10086","0445afii10087","0446afii10088","0447afii10089","0448afii10090","0449afii10091","044Aafii10092","044Bafii10093","044Cafii10094","044Dafii10095","044Eafii10096","044Fafii10097","0451afii10071","0452afii10099","0453afii10100","0454afii10101","0455afii10102","0456afii10103","0457afii10104","0458afii10105","0459afii10106","045Aafii10107","045Bafii10108","045Cafii10109","045Eafii10110","045Fafii10193","0460Omegacyrillic","0461omegacyrillic","0462afii10146","0463afii10194","0464Eiotifiedcyrillic","0465eiotifiedcyrillic","0466Yuslittlecyrillic","0467yuslittlecyrillic","0468Yuslittleiotifiedcyrillic","0469yuslittleiotifiedcyrillic","046AYusbigcyrillic","046Byusbigcyrillic","046CYusbigiotifiedcyrillic","046Dyusbigiotifiedcyrillic","046EKsicyrillic","046Fksicyrillic","0470Psicyrillic","0471psicyrillic","0472afii10147","0473afii10195","0474afii10148","0475afii10196","0476Izhitsadblgravecyrillic","0477izhitsadblgravecyrillic","0478Ukcyrillic","0479ukcyrillic","047AOmegaroundcyrillic","047Bomegaroundcyrillic","047COmegatitlocyrillic","047Domegatitlocyrillic","047EOtcyrillic","047Fotcyrillic","0480Koppacyrillic","0481koppacyrillic","0482thousandcyrillic","0483titlocyrilliccmb","0484palatalizationcyrilliccmb","0485dasiapneumatacyrilliccmb","0486psilipneumatacyrilliccmb","0490afii10050","0491afii10098","0492Ghestrokecyrillic","0493ghestrokecyrillic","0494Ghemiddlehookcyrillic","0495ghemiddlehookcyrillic","0496Zhedescendercyrillic","0497zhedescendercyrillic","0498Zedescendercyrillic","0499zedescendercyrillic","049AKadescendercyrillic","049Bkadescendercyrillic","049CKaverticalstrokecyrillic","049Dkaverticalstrokecyrillic","049EKastrokecyrillic","049Fkastrokecyrillic","04A0Kabashkircyrillic","04A1kabashkircyrillic","04A2Endescendercyrillic","04A3endescendercyrillic","04A4Enghecyrillic","04A5enghecyrillic","04A6Pemiddlehookcyrillic","04A7pemiddlehookcyrillic","04A8Haabkhasiancyrillic","04A9haabkhasiancyrillic","04AAEsdescendercyrillic","04ABesdescendercyrillic","04ACTedescendercyrillic","04ADtedescendercyrillic","04AEUstraightcyrillic","04AFustraightcyrillic","04B0Ustraightstrokecyrillic","04B1ustraightstrokecyrillic","04B2Hadescendercyrillic","04B3hadescendercyrillic","04B4Tetsecyrillic","04B5tetsecyrillic","04B6Chedescendercyrillic","04B7chedescendercyrillic","04B8Cheverticalstrokecyrillic","04B9cheverticalstrokecyrillic","04BAShhacyrillic","04BBshhacyrillic","04BCCheabkhasiancyrillic","04BDcheabkhasiancyrillic","04BEChedescenderabkhasiancyrillic","04BFchedescenderabkhasiancyrillic","04C0palochkacyrillic","04C1Zhebrevecyrillic","04C2zhebrevecyrillic","04C3Kahookcyrillic","04C4kahookcyrillic","04C7Enhookcyrillic","04C8enhookcyrillic","04CBChekhakassiancyrillic","04CCchekhakassiancyrillic","04D0Abrevecyrillic","04D1abrevecyrillic","04D2Adieresiscyrillic","04D3adieresiscyrillic","04D4Aiecyrillic","04D5aiecyrillic","04D6Iebrevecyrillic","04D7iebrevecyrillic","04D8Schwacyrillic","04D9afii10846","04DASchwadieresiscyrillic","04DBschwadieresiscyrillic","04DCZhedieresiscyrillic","04DDzhedieresiscyrillic","04DEZedieresiscyrillic","04DFzedieresiscyrillic","04E0Dzeabkhasiancyrillic","04E1dzeabkhasiancyrillic","04E2Imacroncyrillic","04E3imacroncyrillic","04E4Idieresiscyrillic","04E5idieresiscyrillic","04E6Odieresiscyrillic","04E7odieresiscyrillic","04E8Obarredcyrillic","04E9obarredcyrillic","04EAObarreddieresiscyrillic","04EBobarreddieresiscyrillic","04EEUmacroncyrillic","04EFumacroncyrillic","04F0Udieresiscyrillic","04F1udieresiscyrillic","04F2Uhungarumlautcyrillic","04F3uhungarumlautcyrillic","04F4Chedieresiscyrillic","04F5chedieresiscyrillic","04F8Yerudieresiscyrillic","04F9yerudieresiscyrillic","0531Aybarmenian","0532Benarmenian","0533Gimarmenian","0534Daarmenian","0535Echarmenian","0536Zaarmenian","0537Eharmenian","0538Etarmenian","0539Toarmenian","053AZhearmenian","053BIniarmenian","053CLiwnarmenian","053DXeharmenian","053ECaarmenian","053FKenarmenian","0540Hoarmenian","0541Jaarmenian","0542Ghadarmenian","0543Cheharmenian","0544Menarmenian","0545Yiarmenian","0546Nowarmenian","0547Shaarmenian","0548Voarmenian","0549Chaarmenian","054APeharmenian","054BJheharmenian","054CRaarmenian","054DSeharmenian","054EVewarmenian","054FTiwnarmenian","0550Reharmenian","0551Coarmenian","0552Yiwnarmenian","0553Piwrarmenian","0554Keharmenian","0555Oharmenian","0556Feharmenian","0559ringhalfleftarmenian","055Aapostrophearmenian","055Bemphasismarkarmenian","055Cexclamarmenian","055Dcommaarmenian","055Equestionarmenian","055Fabbreviationmarkarmenian","0561aybarmenian","0562benarmenian","0563gimarmenian","0564daarmenian","0565echarmenian","0566zaarmenian","0567eharmenian","0568etarmenian","0569toarmenian","056Azhearmenian","056Biniarmenian","056Cliwnarmenian","056Dxeharmenian","056Ecaarmenian","056Fkenarmenian","0570hoarmenian","0571jaarmenian","0572ghadarmenian","0573cheharmenian","0574menarmenian","0575yiarmenian","0576nowarmenian","0577shaarmenian","0578voarmenian","0579chaarmenian","057Apeharmenian","057Bjheharmenian","057Craarmenian","057Dseharmenian","057Evewarmenian","057Ftiwnarmenian","0580reharmenian","0581coarmenian","0582yiwnarmenian","0583piwrarmenian","0584keharmenian","0585oharmenian","0586feharmenian","0587echyiwnarmenian","0589periodarmenian","0591etnahtahebrew","0592segoltahebrew","0593shalshelethebrew","0594zaqefqatanhebrew","0595zaqefgadolhebrew","0596tipehahebrew","0597reviahebrew","0598zarqahebrew","0599pashtahebrew","059Ayetivhebrew","059Btevirhebrew","059Cgereshaccenthebrew","059Dgereshmuqdamhebrew","059Egershayimaccenthebrew","059Fqarneyparahebrew","05A0telishagedolahebrew","05A1pazerhebrew","05A3munahhebrew","05A4mahapakhhebrew","05A5merkhahebrew","05A6merkhakefulahebrew","05A7dargahebrew","05A8qadmahebrew","05A9telishaqetanahebrew","05AAyerahbenyomohebrew","05ABolehebrew","05ACiluyhebrew","05ADdehihebrew","05AEzinorhebrew","05AFmasoracirclehebrew","05B0afii57799","05B1afii57801","05B2afii57800","05B3afii57802","05B4afii57793","05B5afii57794","05B6afii57795","05B7afii57798","05B8afii57797","05B9afii57806","05BBafii57796","05BCafii57807","05BDafii57839","05BEafii57645","05BFafii57841","05C0afii57842","05C1afii57804","05C2afii57803","05C3afii57658","05C4upperdothebrew","05D0afii57664","05D1afii57665","05D2afii57666","05D3afii57667","05D4afii57668","05D5afii57669","05D6afii57670","05D7afii57671","05D8afii57672","05D9afii57673","05DAafii57674","05DBafii57675","05DCafii57676","05DDafii57677","05DEafii57678","05DFafii57679","05E0afii57680","05E1afii57681","05E2afii57682","05E3afii57683","05E4afii57684","05E5afii57685","05E6afii57686","05E7afii57687","05E8afii57688","05E9afii57689","05EAafii57690","05F0afii57716","05F1afii57717","05F2afii57718","05F3gereshhebrew","05F4gershayimhebrew","060Cafii57388","061Bafii57403","061Fafii57407","0621afii57409","0622afii57410","0623afii57411","0624afii57412","0625afii57413","0626afii57414","0627afii57415","0628afii57416","0629afii57417","062Aafii57418","062Bafii57419","062Cafii57420","062Dafii57421","062Eafii57422","062Fafii57423","0630afii57424","0631afii57425","0632afii57426","0633afii57427","0634afii57428","0635afii57429","0636afii57430","0637afii57431","0638afii57432","0639afii57433","063Aafii57434","0640afii57440","0641afii57441","0642afii57442","0643afii57443","0644afii57444","0645afii57445","0646afii57446","0647afii57470","0648afii57448","0649afii57449","064Aafii57450","064Bafii57451","064Cafii57452","064Dafii57453","064Eafii57454","064Fafii57455","0650afii57456","0651afii57457","0652afii57458","0660afii57392","0661afii57393","0662afii57394","0663afii57395","0664afii57396","0665afii57397","0666afii57398","0667afii57399","0668afii57400","0669afii57401","066Aafii57381","066Bdecimalseparatorarabic","066Cthousandsseparatorarabic","066Dafii63167","0679afii57511","067Eafii57506","0686afii57507","0688afii57512","0691afii57513","0698afii57508","06A4afii57505","06AFafii57509","06BAafii57514","06C1hehaltonearabic","06D1yehthreedotsbelowarabic","06D2afii57519","06D5afii57534","06F0zeropersian","06F1onepersian","06F2twopersian","06F3threepersian","06F4fourpersian","06F5fivepersian","06F6sixpersian","06F7sevenpersian","06F8eightpersian","06F9ninepersian","0901candrabindudeva","0902anusvaradeva","0903visargadeva","0905adeva","0906aadeva","0907ideva","0908iideva","0909udeva","090Auudeva","090Brvocalicdeva","090Clvocalicdeva","090Decandradeva","090Eeshortdeva","090Fedeva","0910aideva","0911ocandradeva","0912oshortdeva","0913odeva","0914audeva","0915kadeva","0916khadeva","0917gadeva","0918ghadeva","0919ngadeva","091Acadeva","091Bchadeva","091Cjadeva","091Djhadeva","091Enyadeva","091Fttadeva","0920tthadeva","0921ddadeva","0922ddhadeva","0923nnadeva","0924tadeva","0925thadeva","0926dadeva","0927dhadeva","0928nadeva","0929nnnadeva","092Apadeva","092Bphadeva","092Cbadeva","092Dbhadeva","092Emadeva","092Fyadeva","0930radeva","0931rradeva","0932ladeva","0933lladeva","0934llladeva","0935vadeva","0936shadeva","0937ssadeva","0938sadeva","0939hadeva","093Cnuktadeva","093Davagrahadeva","093Eaavowelsigndeva","093Fivowelsigndeva","0940iivowelsigndeva","0941uvowelsigndeva","0942uuvowelsigndeva","0943rvocalicvowelsigndeva","0944rrvocalicvowelsigndeva","0945ecandravowelsigndeva","0946eshortvowelsigndeva","0947evowelsigndeva","0948aivowelsigndeva","0949ocandravowelsigndeva","094Aoshortvowelsigndeva","094Bovowelsigndeva","094Cauvowelsigndeva","094Dviramadeva","0950omdeva","0951udattadeva","0952anudattadeva","0953gravedeva","0954acutedeva","0958qadeva","0959khhadeva","095Aghhadeva","095Bzadeva","095Cdddhadeva","095Drhadeva","095Efadeva","095Fyyadeva","0960rrvocalicdeva","0961llvocalicdeva","0962lvocalicvowelsigndeva","0963llvocalicvowelsigndeva","0964danda","0965dbldanda","0966zerodeva","0967onedeva","0968twodeva","0969threedeva","096Afourdeva","096Bfivedeva","096Csixdeva","096Dsevendeva","096Eeightdeva","096Fninedeva","0970abbreviationsigndeva","0981candrabindubengali","0982anusvarabengali","0983visargabengali","0985abengali","0986aabengali","0987ibengali","0988iibengali","0989ubengali","098Auubengali","098Brvocalicbengali","098Clvocalicbengali","098Febengali","0990aibengali","0993obengali","0994aubengali","0995kabengali","0996khabengali","0997gabengali","0998ghabengali","0999ngabengali","099Acabengali","099Bchabengali","099Cjabengali","099Djhabengali","099Enyabengali","099Fttabengali","09A0tthabengali","09A1ddabengali","09A2ddhabengali","09A3nnabengali","09A4tabengali","09A5thabengali","09A6dabengali","09A7dhabengali","09A8nabengali","09AApabengali","09ABphabengali","09ACbabengali","09ADbhabengali","09AEmabengali","09AFyabengali","09B0rabengali","09B2labengali","09B6shabengali","09B7ssabengali","09B8sabengali","09B9habengali","09BCnuktabengali","09BEaavowelsignbengali","09BFivowelsignbengali","09C0iivowelsignbengali","09C1uvowelsignbengali","09C2uuvowelsignbengali","09C3rvocalicvowelsignbengali","09C4rrvocalicvowelsignbengali","09C7evowelsignbengali","09C8aivowelsignbengali","09CBovowelsignbengali","09CCauvowelsignbengali","09CDviramabengali","09D7aulengthmarkbengali","09DCrrabengali","09DDrhabengali","09DFyyabengali","09E0rrvocalicbengali","09E1llvocalicbengali","09E2lvocalicvowelsignbengali","09E3llvocalicvowelsignbengali","09E6zerobengali","09E7onebengali","09E8twobengali","09E9threebengali","09EAfourbengali","09EBfivebengali","09ECsixbengali","09EDsevenbengali","09EEeightbengali","09EFninebengali","09F0ramiddlediagonalbengali","09F1ralowerdiagonalbengali","09F2rupeemarkbengali","09F3rupeesignbengali","09F4onenumeratorbengali","09F5twonumeratorbengali","09F6threenumeratorbengali","09F7fournumeratorbengali","09F8denominatorminusonenumeratorbengali","09F9sixteencurrencydenominatorbengali","09FAissharbengali","0A02bindigurmukhi","0A05agurmukhi","0A06aagurmukhi","0A07igurmukhi","0A08iigurmukhi","0A09ugurmukhi","0A0Auugurmukhi","0A0Feegurmukhi","0A10aigurmukhi","0A13oogurmukhi","0A14augurmukhi","0A15kagurmukhi","0A16khagurmukhi","0A17gagurmukhi","0A18ghagurmukhi","0A19ngagurmukhi","0A1Acagurmukhi","0A1Bchagurmukhi","0A1Cjagurmukhi","0A1Djhagurmukhi","0A1Enyagurmukhi","0A1Fttagurmukhi","0A20tthagurmukhi","0A21ddagurmukhi","0A22ddhagurmukhi","0A23nnagurmukhi","0A24tagurmukhi","0A25thagurmukhi","0A26dagurmukhi","0A27dhagurmukhi","0A28nagurmukhi","0A2Apagurmukhi","0A2Bphagurmukhi","0A2Cbagurmukhi","0A2Dbhagurmukhi","0A2Emagurmukhi","0A2Fyagurmukhi","0A30ragurmukhi","0A32lagurmukhi","0A35vagurmukhi","0A36shagurmukhi","0A38sagurmukhi","0A39hagurmukhi","0A3Cnuktagurmukhi","0A3Eaamatragurmukhi","0A3Fimatragurmukhi","0A40iimatragurmukhi","0A41umatragurmukhi","0A42uumatragurmukhi","0A47eematragurmukhi","0A48aimatragurmukhi","0A4Boomatragurmukhi","0A4Caumatragurmukhi","0A4Dhalantgurmukhi","0A59khhagurmukhi","0A5Aghhagurmukhi","0A5Bzagurmukhi","0A5Crragurmukhi","0A5Efagurmukhi","0A66zerogurmukhi","0A67onegurmukhi","0A68twogurmukhi","0A69threegurmukhi","0A6Afourgurmukhi","0A6Bfivegurmukhi","0A6Csixgurmukhi","0A6Dsevengurmukhi","0A6Eeightgurmukhi","0A6Fninegurmukhi","0A70tippigurmukhi","0A71addakgurmukhi","0A72irigurmukhi","0A73uragurmukhi","0A74ekonkargurmukhi","0A81candrabindugujarati","0A82anusvaragujarati","0A83visargagujarati","0A85agujarati","0A86aagujarati","0A87igujarati","0A88iigujarati","0A89ugujarati","0A8Auugujarati","0A8Brvocalicgujarati","0A8Decandragujarati","0A8Fegujarati","0A90aigujarati","0A91ocandragujarati","0A93ogujarati","0A94augujarati","0A95kagujarati","0A96khagujarati","0A97gagujarati","0A98ghagujarati","0A99ngagujarati","0A9Acagujarati","0A9Bchagujarati","0A9Cjagujarati","0A9Djhagujarati","0A9Enyagujarati","0A9Fttagujarati","0AA0tthagujarati","0AA1ddagujarati","0AA2ddhagujarati","0AA3nnagujarati","0AA4tagujarati","0AA5thagujarati","0AA6dagujarati","0AA7dhagujarati","0AA8nagujarati","0AAApagujarati","0AABphagujarati","0AACbagujarati","0AADbhagujarati","0AAEmagujarati","0AAFyagujarati","0AB0ragujarati","0AB2lagujarati","0AB3llagujarati","0AB5vagujarati","0AB6shagujarati","0AB7ssagujarati","0AB8sagujarati","0AB9hagujarati","0ABCnuktagujarati","0ABEaavowelsigngujarati","0ABFivowelsigngujarati","0AC0iivowelsigngujarati","0AC1uvowelsigngujarati","0AC2uuvowelsigngujarati","0AC3rvocalicvowelsigngujarati","0AC4rrvocalicvowelsigngujarati","0AC5ecandravowelsigngujarati","0AC7evowelsigngujarati","0AC8aivowelsigngujarati","0AC9ocandravowelsigngujarati","0ACBovowelsigngujarati","0ACCauvowelsigngujarati","0ACDviramagujarati","0AD0omgujarati","0AE0rrvocalicgujarati","0AE6zerogujarati","0AE7onegujarati","0AE8twogujarati","0AE9threegujarati","0AEAfourgujarati","0AEBfivegujarati","0AECsixgujarati","0AEDsevengujarati","0AEEeightgujarati","0AEFninegujarati","0E01kokaithai","0E02khokhaithai","0E03khokhuatthai","0E04khokhwaithai","0E05khokhonthai","0E06khorakhangthai","0E07ngonguthai","0E08chochanthai","0E09chochingthai","0E0Achochangthai","0E0Bsosothai","0E0Cchochoethai","0E0Dyoyingthai","0E0Edochadathai","0E0Ftopatakthai","0E10thothanthai","0E11thonangmonthothai","0E12thophuthaothai","0E13nonenthai","0E14dodekthai","0E15totaothai","0E16thothungthai","0E17thothahanthai","0E18thothongthai","0E19nonuthai","0E1Abobaimaithai","0E1Bpoplathai","0E1Cphophungthai","0E1Dfofathai","0E1Ephophanthai","0E1Ffofanthai","0E20phosamphaothai","0E21momathai","0E22yoyakthai","0E23roruathai","0E24ruthai","0E25lolingthai","0E26luthai","0E27wowaenthai","0E28sosalathai","0E29sorusithai","0E2Asosuathai","0E2Bhohipthai","0E2Clochulathai","0E2Doangthai","0E2Ehonokhukthai","0E2Fpaiyannoithai","0E30saraathai","0E31maihanakatthai","0E32saraaathai","0E33saraamthai","0E34saraithai","0E35saraiithai","0E36sarauethai","0E37saraueethai","0E38sarauthai","0E39sarauuthai","0E3Aphinthuthai","0E3Fbahtthai","0E40saraethai","0E41saraaethai","0E42saraothai","0E43saraaimaimuanthai","0E44saraaimaimalaithai","0E45lakkhangyaothai","0E46maiyamokthai","0E47maitaikhuthai","0E48maiekthai","0E49maithothai","0E4Amaitrithai","0E4Bmaichattawathai","0E4Cthanthakhatthai","0E4Dnikhahitthai","0E4Eyamakkanthai","0E4Ffongmanthai","0E50zerothai","0E51onethai","0E52twothai","0E53threethai","0E54fourthai","0E55fivethai","0E56sixthai","0E57seventhai","0E58eightthai","0E59ninethai","0E5Aangkhankhuthai","0E5Bkhomutthai","1E00Aringbelow","1E01aringbelow","1E02Bdotaccent","1E03bdotaccent","1E04Bdotbelow","1E05bdotbelow","1E06Blinebelow","1E07blinebelow","1E08Ccedillaacute","1E09ccedillaacute","1E0ADdotaccent","1E0Bddotaccent","1E0CDdotbelow","1E0Dddotbelow","1E0EDlinebelow","1E0Fdlinebelow","1E10Dcedilla","1E11dcedilla","1E12Dcircumflexbelow","1E13dcircumflexbelow","1E14Emacrongrave","1E15emacrongrave","1E16Emacronacute","1E17emacronacute","1E18Ecircumflexbelow","1E19ecircumflexbelow","1E1AEtildebelow","1E1Betildebelow","1E1CEcedillabreve","1E1Decedillabreve","1E1EFdotaccent","1E1Ffdotaccent","1E20Gmacron","1E21gmacron","1E22Hdotaccent","1E23hdotaccent","1E24Hdotbelow","1E25hdotbelow","1E26Hdieresis","1E27hdieresis","1E28Hcedilla","1E29hcedilla","1E2AHbrevebelow","1E2Bhbrevebelow","1E2CItildebelow","1E2Ditildebelow","1E2EIdieresisacute","1E2Fidieresisacute","1E30Kacute","1E31kacute","1E32Kdotbelow","1E33kdotbelow","1E34Klinebelow","1E35klinebelow","1E36Ldotbelow","1E37ldotbelow","1E38Ldotbelowmacron","1E39ldotbelowmacron","1E3ALlinebelow","1E3Bllinebelow","1E3CLcircumflexbelow","1E3Dlcircumflexbelow","1E3EMacute","1E3Fmacute","1E40Mdotaccent","1E41mdotaccent","1E42Mdotbelow","1E43mdotbelow","1E44Ndotaccent","1E45ndotaccent","1E46Ndotbelow","1E47ndotbelow","1E48Nlinebelow","1E49nlinebelow","1E4ANcircumflexbelow","1E4Bncircumflexbelow","1E4COtildeacute","1E4Dotildeacute","1E4EOtildedieresis","1E4Fotildedieresis","1E50Omacrongrave","1E51omacrongrave","1E52Omacronacute","1E53omacronacute","1E54Pacute","1E55pacute","1E56Pdotaccent","1E57pdotaccent","1E58Rdotaccent","1E59rdotaccent","1E5ARdotbelow","1E5Brdotbelow","1E5CRdotbelowmacron","1E5Drdotbelowmacron","1E5ERlinebelow","1E5Frlinebelow","1E60Sdotaccent","1E61sdotaccent","1E62Sdotbelow","1E63sdotbelow","1E64Sacutedotaccent","1E65sacutedotaccent","1E66Scarondotaccent","1E67scarondotaccent","1E68Sdotbelowdotaccent","1E69sdotbelowdotaccent","1E6ATdotaccent","1E6Btdotaccent","1E6CTdotbelow","1E6Dtdotbelow","1E6ETlinebelow","1E6Ftlinebelow","1E70Tcircumflexbelow","1E71tcircumflexbelow","1E72Udieresisbelow","1E73udieresisbelow","1E74Utildebelow","1E75utildebelow","1E76Ucircumflexbelow","1E77ucircumflexbelow","1E78Utildeacute","1E79utildeacute","1E7AUmacrondieresis","1E7Bumacrondieresis","1E7CVtilde","1E7Dvtilde","1E7EVdotbelow","1E7Fvdotbelow","1E80Wgrave","1E81wgrave","1E82Wacute","1E83wacute","1E84Wdieresis","1E85wdieresis","1E86Wdotaccent","1E87wdotaccent","1E88Wdotbelow","1E89wdotbelow","1E8AXdotaccent","1E8Bxdotaccent","1E8CXdieresis","1E8Dxdieresis","1E8EYdotaccent","1E8Fydotaccent","1E90Zcircumflex","1E91zcircumflex","1E92Zdotbelow","1E93zdotbelow","1E94Zlinebelow","1E95zlinebelow","1E96hlinebelow","1E97tdieresis","1E98wring","1E99yring","1E9Aarighthalfring","1E9Bslongdotaccent","1EA0Adotbelow","1EA1adotbelow","1EA2Ahookabove","1EA3ahookabove","1EA4Acircumflexacute","1EA5acircumflexacute","1EA6Acircumflexgrave","1EA7acircumflexgrave","1EA8Acircumflexhookabove","1EA9acircumflexhookabove","1EAAAcircumflextilde","1EABacircumflextilde","1EACAcircumflexdotbelow","1EADacircumflexdotbelow","1EAEAbreveacute","1EAFabreveacute","1EB0Abrevegrave","1EB1abrevegrave","1EB2Abrevehookabove","1EB3abrevehookabove","1EB4Abrevetilde","1EB5abrevetilde","1EB6Abrevedotbelow","1EB7abrevedotbelow","1EB8Edotbelow","1EB9edotbelow","1EBAEhookabove","1EBBehookabove","1EBCEtilde","1EBDetilde","1EBEEcircumflexacute","1EBFecircumflexacute","1EC0Ecircumflexgrave","1EC1ecircumflexgrave","1EC2Ecircumflexhookabove","1EC3ecircumflexhookabove","1EC4Ecircumflextilde","1EC5ecircumflextilde","1EC6Ecircumflexdotbelow","1EC7ecircumflexdotbelow","1EC8Ihookabove","1EC9ihookabove","1ECAIdotbelow","1ECBidotbelow","1ECCOdotbelow","1ECDodotbelow","1ECEOhookabove","1ECFohookabove","1ED0Ocircumflexacute","1ED1ocircumflexacute","1ED2Ocircumflexgrave","1ED3ocircumflexgrave","1ED4Ocircumflexhookabove","1ED5ocircumflexhookabove","1ED6Ocircumflextilde","1ED7ocircumflextilde","1ED8Ocircumflexdotbelow","1ED9ocircumflexdotbelow","1EDAOhornacute","1EDBohornacute","1EDCOhorngrave","1EDDohorngrave","1EDEOhornhookabove","1EDFohornhookabove","1EE0Ohorntilde","1EE1ohorntilde","1EE2Ohorndotbelow","1EE3ohorndotbelow","1EE4Udotbelow","1EE5udotbelow","1EE6Uhookabove","1EE7uhookabove","1EE8Uhornacute","1EE9uhornacute","1EEAUhorngrave","1EEBuhorngrave","1EECUhornhookabove","1EEDuhornhookabove","1EEEUhorntilde","1EEFuhorntilde","1EF0Uhorndotbelow","1EF1uhorndotbelow","1EF2Ygrave","1EF3ygrave","1EF4Ydotbelow","1EF5ydotbelow","1EF6Yhookabove","1EF7yhookabove","1EF8Ytilde","1EF9ytilde","2002enspace","200Bzerowidthspace","200Cafii61664","200Dafii301","200Eafii299","200Fafii300","2010hyphentwo","2012figuredash","2013endash","2014emdash","2015afii00208","2016dblverticalbar","2017underscoredbl","2018quoteleft","2019quoteright","201Aquotesinglbase","201Bquotereversed","201Cquotedblleft","201Dquotedblright","201Equotedblbase","2020dagger","2021daggerdbl","2022bullet","2024onedotenleader","2025twodotenleader","2026ellipsis","202Cafii61573","202Dafii61574","202Eafii61575","2030perthousand","2032minute","2033second","2035primereversed","2039guilsinglleft","203Aguilsinglright","203Breferencemark","203Cexclamdbl","203Eoverline","2042asterism","2044fraction","2070zerosuperior","2074foursuperior","2075fivesuperior","2076sixsuperior","2077sevensuperior","2078eightsuperior","2079ninesuperior","207Aplussuperior","207Cequalsuperior","207Dparenleftsuperior","207Eparenrightsuperior","207Fnsuperior","2080zeroinferior","2081oneinferior","2082twoinferior","2083threeinferior","2084fourinferior","2085fiveinferior","2086sixinferior","2087seveninferior","2088eightinferior","2089nineinferior","208Dparenleftinferior","208Eparenrightinferior","20A1colonmonetary","20A2cruzeiro","20A3franc","20A4afii08941","20A7peseta","20A9won","20AAafii57636","20ABdong","20ACEuro","2103centigrade","2105afii61248","2109fahrenheit","2111Ifraktur","2113afii61289","2116afii61352","2118weierstrass","211CRfraktur","211Eprescription","2121telephone","2122trademark","2126Omega","212Bangstrom","212Eestimated","2135aleph","2153onethird","2154twothirds","215Boneeighth","215Cthreeeighths","215Dfiveeighths","215Eseveneighths","2160Oneroman","2161Tworoman","2162Threeroman","2163Fourroman","2164Fiveroman","2165Sixroman","2166Sevenroman","2167Eightroman","2168Nineroman","2169Tenroman","216AElevenroman","216BTwelveroman","2170oneroman","2171tworoman","2172threeroman","2173fourroman","2174fiveroman","2175sixroman","2176sevenroman","2177eightroman","2178nineroman","2179tenroman","217Aelevenroman","217Btwelveroman","2190arrowleft","2191arrowup","2192arrowright","2193arrowdown","2194arrowboth","2195arrowupdn","2196arrowupleft","2197arrowupright","2198arrowdownright","2199arrowdownleft","21A8arrowupdnbse","21B5carriagereturn","21BCharpoonleftbarbup","21C0harpoonrightbarbup","21C4arrowrightoverleft","21C5arrowupleftofdown","21C6arrowleftoverright","21CDarrowleftdblstroke","21CFarrowrightdblstroke","21D0arrowdblleft","21D1arrowdblup","21D2arrowdblright","21D3arrowdbldown","21D4arrowdblboth","21DEpageup","21DFpagedown","21E0arrowdashleft","21E1arrowdashup","21E2arrowdashright","21E3arrowdashdown","21E4arrowtableft","21E5arrowtabright","21E6arrowleftwhite","21E7arrowupwhite","21E8arrowrightwhite","21E9arrowdownwhite","21EAcapslock","2200universal","2202partialdiff","2203existential","2205emptyset","2206Delta","2207gradient","2208element","2209notelement","220Bsuchthat","220Cnotcontains","220Fproduct","2211summation","2212minus","2213minusplus","2215divisionslash","2217asteriskmath","2219bulletoperator","221Aradical","221Dproportional","221Einfinity","221Forthogonal","2220angle","2223divides","2225parallel","2226notparallel","2227logicaland","2228logicalor","2229intersection","222Aunion","222Bintegral","222Cdblintegral","222Econtourintegral","2234therefore","2235because","2236ratio","2237proportion","223Csimilar","223Dreversedtilde","2243asymptoticallyequal","2245congruent","2248approxequal","224Callequal","2250approaches","2251geometricallyequal","2252approxequalorimage","2253imageorapproximatelyequal","2260notequal","2261equivalence","2262notidentical","2264lessequal","2265greaterequal","2266lessoverequal","2267greateroverequal","226Amuchless","226Bmuchgreater","226Enotless","226Fnotgreater","2270notlessnorequal","2271notgreaternorequal","2272lessorequivalent","2273greaterorequivalent","2276lessorgreater","2277greaterorless","2279notgreaternorless","227Aprecedes","227Bsucceeds","2280notprecedes","2281notsucceeds","2282propersubset","2283propersuperset","2284notsubset","2285notsuperset","2286reflexsubset","2287reflexsuperset","228Asubsetnotequal","228Bsupersetnotequal","2295circleplus","2296minuscircle","2297circlemultiply","2299circleot","22A3tackleft","22A4tackdown","22A5perpendicular","22BFrighttriangle","22C5dotmath","22CEcurlyor","22CFcurlyand","22DAlessequalorgreater","22DBgreaterequalorless","22EEellipsisvertical","2302house","2303control","2305projective","2310revlogicalnot","2312arc","2318propellor","2320integraltp","2321integralbt","2325option","2326deleteright","2327clear","2329angleleft","232Aangleright","232Bdeleteleft","2423blank","2460onecircle","2461twocircle","2462threecircle","2463fourcircle","2464fivecircle","2465sixcircle","2466sevencircle","2467eightcircle","2468ninecircle","2469tencircle","246Aelevencircle","246Btwelvecircle","246Cthirteencircle","246Dfourteencircle","246Efifteencircle","246Fsixteencircle","2470seventeencircle","2471eighteencircle","2472nineteencircle","2473twentycircle","2474oneparen","2475twoparen","2476threeparen","2477fourparen","2478fiveparen","2479sixparen","247Asevenparen","247Beightparen","247Cnineparen","247Dtenparen","247Eelevenparen","247Ftwelveparen","2480thirteenparen","2481fourteenparen","2482fifteenparen","2483sixteenparen","2484seventeenparen","2485eighteenparen","2486nineteenparen","2487twentyparen","2488oneperiod","2489twoperiod","248Athreeperiod","248Bfourperiod","248Cfiveperiod","248Dsixperiod","248Esevenperiod","248Feightperiod","2490nineperiod","2491tenperiod","2492elevenperiod","2493twelveperiod","2494thirteenperiod","2495fourteenperiod","2496fifteenperiod","2497sixteenperiod","2498seventeenperiod","2499eighteenperiod","249Anineteenperiod","249Btwentyperiod","249Caparen","249Dbparen","249Ecparen","249Fdparen","24A0eparen","24A1fparen","24A2gparen","24A3hparen","24A4iparen","24A5jparen","24A6kparen","24A7lparen","24A8mparen","24A9nparen","24AAoparen","24ABpparen","24ACqparen","24ADrparen","24AEsparen","24AFtparen","24B0uparen","24B1vparen","24B2wparen","24B3xparen","24B4yparen","24B5zparen","24B6Acircle","24B7Bcircle","24B8Ccircle","24B9Dcircle","24BAEcircle","24BBFcircle","24BCGcircle","24BDHcircle","24BEIcircle","24BFJcircle","24C0Kcircle","24C1Lcircle","24C2Mcircle","24C3Ncircle","24C4Ocircle","24C5Pcircle","24C6Qcircle","24C7Rcircle","24C8Scircle","24C9Tcircle","24CAUcircle","24CBVcircle","24CCWcircle","24CDXcircle","24CEYcircle","24CFZcircle","24D0acircle","24D1bcircle","24D2ccircle","24D3dcircle","24D4ecircle","24D5fcircle","24D6gcircle","24D7hcircle","24D8icircle","24D9jcircle","24DAkcircle","24DBlcircle","24DCmcircle","24DDncircle","24DEocircle","24DFpcircle","24E0qcircle","24E1rcircle","24E2scircle","24E3tcircle","24E4ucircle","24E5vcircle","24E6wcircle","24E7xcircle","24E8ycircle","24E9zcircle","2500SF100000","2502SF110000","250CSF010000","2510SF030000","2514SF020000","2518SF040000","251CSF080000","2524SF090000","252CSF060000","2534SF070000","253CSF050000","2550SF430000","2551SF240000","2552SF510000","2553SF520000","2554SF390000","2555SF220000","2556SF210000","2557SF250000","2558SF500000","2559SF490000","255ASF380000","255BSF280000","255CSF270000","255DSF260000","255ESF360000","255FSF370000","2560SF420000","2561SF190000","2562SF200000","2563SF230000","2564SF470000","2565SF480000","2566SF410000","2567SF450000","2568SF460000","2569SF400000","256ASF540000","256BSF530000","256CSF440000","2580upblock","2584dnblock","2588block","258Clfblock","2590rtblock","2591ltshade","2592shade","2593dkshade","25A0filledbox","25A1H22073","25A3squarewhitewithsmallblack","25A4squarehorizontalfill","25A5squareverticalfill","25A6squareorthogonalcrosshatchfill","25A7squareupperlefttolowerrightfill","25A8squareupperrighttolowerleftfill","25A9squarediagonalcrosshatchfill","25AAH18543","25ABH18551","25ACfilledrect","25B2triagup","25B3whiteuppointingtriangle","25B4blackuppointingsmalltriangle","25B5whiteuppointingsmalltriangle","25B6blackrightpointingtriangle","25B7whiterightpointingtriangle","25B9whiterightpointingsmalltriangle","25BAtriagrt","25BCtriagdn","25BDwhitedownpointingtriangle","25BFwhitedownpointingsmalltriangle","25C0blackleftpointingtriangle","25C1whiteleftpointingtriangle","25C3whiteleftpointingsmalltriangle","25C4triaglf","25C6blackdiamond","25C7whitediamond","25C8whitediamondcontainingblacksmalldiamond","25C9fisheye","25CAlozenge","25CBcircle","25CCdottedcircle","25CEbullseye","25CFH18533","25D0circlewithlefthalfblack","25D1circlewithrighthalfblack","25D8invbullet","25D9invcircle","25E2blacklowerrighttriangle","25E3blacklowerlefttriangle","25E4blackupperlefttriangle","25E5blackupperrighttriangle","25E6openbullet","25EFlargecircle","2605blackstar","2606whitestar","260Etelephoneblack","260Fwhitetelephone","261Cpointingindexleftwhite","261Dpointingindexupwhite","261Epointingindexrightwhite","261Fpointingindexdownwhite","262Fyinyang","263Asmileface","263Binvsmileface","263Csun","2640female","2641earth","2642male","2660spade","2661heartsuitwhite","2662diamondsuitwhite","2663club","2664spadesuitwhite","2665heart","2666diamond","2667clubsuitwhite","2668hotsprings","2669quarternote","266Amusicalnote","266Bmusicalnotedbl","266Cbeamedsixteenthnotes","266Dmusicflatsign","266Fmusicsharpsign","2713checkmark","278Aonecircleinversesansserif","278Btwocircleinversesansserif","278Cthreecircleinversesansserif","278Dfourcircleinversesansserif","278Efivecircleinversesansserif","278Fsixcircleinversesansserif","2790sevencircleinversesansserif","2791eightcircleinversesansserif","2792ninecircleinversesansserif","279Earrowrightheavy","3000ideographicspace","3001ideographiccomma","3002ideographicperiod","3003dittomark","3004jis","3005ideographiciterationmark","3006ideographicclose","3007ideographiczero","3008anglebracketleft","3009anglebracketright","300Adblanglebracketleft","300Bdblanglebracketright","300Ccornerbracketleft","300Dcornerbracketright","300Ewhitecornerbracketleft","300Fwhitecornerbracketright","3010blacklenticularbracketleft","3011blacklenticularbracketright","3012postalmark","3013getamark","3014tortoiseshellbracketleft","3015tortoiseshellbracketright","3016whitelenticularbracketleft","3017whitelenticularbracketright","3018whitetortoiseshellbracketleft","3019whitetortoiseshellbracketright","301Cwavedash","301Dquotedblprimereversed","301Equotedblprime","3020postalmarkface","3021onehangzhou","3022twohangzhou","3023threehangzhou","3024fourhangzhou","3025fivehangzhou","3026sixhangzhou","3027sevenhangzhou","3028eighthangzhou","3029ninehangzhou","3036circlepostalmark","3041asmallhiragana","3042ahiragana","3043ismallhiragana","3044ihiragana","3045usmallhiragana","3046uhiragana","3047esmallhiragana","3048ehiragana","3049osmallhiragana","304Aohiragana","304Bkahiragana","304Cgahiragana","304Dkihiragana","304Egihiragana","304Fkuhiragana","3050guhiragana","3051kehiragana","3052gehiragana","3053kohiragana","3054gohiragana","3055sahiragana","3056zahiragana","3057sihiragana","3058zihiragana","3059suhiragana","305Azuhiragana","305Bsehiragana","305Czehiragana","305Dsohiragana","305Ezohiragana","305Ftahiragana","3060dahiragana","3061tihiragana","3062dihiragana","3063tusmallhiragana","3064tuhiragana","3065duhiragana","3066tehiragana","3067dehiragana","3068tohiragana","3069dohiragana","306Anahiragana","306Bnihiragana","306Cnuhiragana","306Dnehiragana","306Enohiragana","306Fhahiragana","3070bahiragana","3071pahiragana","3072hihiragana","3073bihiragana","3074pihiragana","3075huhiragana","3076buhiragana","3077puhiragana","3078hehiragana","3079behiragana","307Apehiragana","307Bhohiragana","307Cbohiragana","307Dpohiragana","307Emahiragana","307Fmihiragana","3080muhiragana","3081mehiragana","3082mohiragana","3083yasmallhiragana","3084yahiragana","3085yusmallhiragana","3086yuhiragana","3087yosmallhiragana","3088yohiragana","3089rahiragana","308Arihiragana","308Bruhiragana","308Crehiragana","308Drohiragana","308Ewasmallhiragana","308Fwahiragana","3090wihiragana","3091wehiragana","3092wohiragana","3093nhiragana","3094vuhiragana","309Bvoicedmarkkana","309Csemivoicedmarkkana","309Diterationhiragana","309Evoicediterationhiragana","30A1asmallkatakana","30A2akatakana","30A3ismallkatakana","30A4ikatakana","30A5usmallkatakana","30A6ukatakana","30A7esmallkatakana","30A8ekatakana","30A9osmallkatakana","30AAokatakana","30ABkakatakana","30ACgakatakana","30ADkikatakana","30AEgikatakana","30AFkukatakana","30B0gukatakana","30B1kekatakana","30B2gekatakana","30B3kokatakana","30B4gokatakana","30B5sakatakana","30B6zakatakana","30B7sikatakana","30B8zikatakana","30B9sukatakana","30BAzukatakana","30BBsekatakana","30BCzekatakana","30BDsokatakana","30BEzokatakana","30BFtakatakana","30C0dakatakana","30C1tikatakana","30C2dikatakana","30C3tusmallkatakana","30C4tukatakana","30C5dukatakana","30C6tekatakana","30C7dekatakana","30C8tokatakana","30C9dokatakana","30CAnakatakana","30CBnikatakana","30CCnukatakana","30CDnekatakana","30CEnokatakana","30CFhakatakana","30D0bakatakana","30D1pakatakana","30D2hikatakana","30D3bikatakana","30D4pikatakana","30D5hukatakana","30D6bukatakana","30D7pukatakana","30D8hekatakana","30D9bekatakana","30DApekatakana","30DBhokatakana","30DCbokatakana","30DDpokatakana","30DEmakatakana","30DFmikatakana","30E0mukatakana","30E1mekatakana","30E2mokatakana","30E3yasmallkatakana","30E4yakatakana","30E5yusmallkatakana","30E6yukatakana","30E7yosmallkatakana","30E8yokatakana","30E9rakatakana","30EArikatakana","30EBrukatakana","30ECrekatakana","30EDrokatakana","30EEwasmallkatakana","30EFwakatakana","30F0wikatakana","30F1wekatakana","30F2wokatakana","30F3nkatakana","30F4vukatakana","30F5kasmallkatakana","30F6kesmallkatakana","30F7vakatakana","30F8vikatakana","30F9vekatakana","30FAvokatakana","30FBdotkatakana","30FCprolongedkana","30FDiterationkatakana","30FEvoicediterationkatakana","3105bbopomofo","3106pbopomofo","3107mbopomofo","3108fbopomofo","3109dbopomofo","310Atbopomofo","310Bnbopomofo","310Clbopomofo","310Dgbopomofo","310Ekbopomofo","310Fhbopomofo","3110jbopomofo","3111qbopomofo","3112xbopomofo","3113zhbopomofo","3114chbopomofo","3115shbopomofo","3116rbopomofo","3117zbopomofo","3118cbopomofo","3119sbopomofo","311Aabopomofo","311Bobopomofo","311Cebopomofo","311Dehbopomofo","311Eaibopomofo","311Feibopomofo","3120aubopomofo","3121oubopomofo","3122anbopomofo","3123enbopomofo","3124angbopomofo","3125engbopomofo","3126erbopomofo","3127ibopomofo","3128ubopomofo","3129iubopomofo","3131kiyeokkorean","3132ssangkiyeokkorean","3133kiyeoksioskorean","3134nieunkorean","3135nieuncieuckorean","3136nieunhieuhkorean","3137tikeutkorean","3138ssangtikeutkorean","3139rieulkorean","313Arieulkiyeokkorean","313Brieulmieumkorean","313Crieulpieupkorean","313Drieulsioskorean","313Erieulthieuthkorean","313Frieulphieuphkorean","3140rieulhieuhkorean","3141mieumkorean","3142pieupkorean","3143ssangpieupkorean","3144pieupsioskorean","3145sioskorean","3146ssangsioskorean","3147ieungkorean","3148cieuckorean","3149ssangcieuckorean","314Achieuchkorean","314Bkhieukhkorean","314Cthieuthkorean","314Dphieuphkorean","314Ehieuhkorean","314Fakorean","3150aekorean","3151yakorean","3152yaekorean","3153eokorean","3154ekorean","3155yeokorean","3156yekorean","3157okorean","3158wakorean","3159waekorean","315Aoekorean","315Byokorean","315Cukorean","315Dweokorean","315Ewekorean","315Fwikorean","3160yukorean","3161eukorean","3162yikorean","3163ikorean","3164hangulfiller","3165ssangnieunkorean","3166nieuntikeutkorean","3167nieunsioskorean","3168nieunpansioskorean","3169rieulkiyeoksioskorean","316Arieultikeutkorean","316Brieulpieupsioskorean","316Crieulpansioskorean","316Drieulyeorinhieuhkorean","316Emieumpieupkorean","316Fmieumsioskorean","3170mieumpansioskorean","3171kapyeounmieumkorean","3172pieupkiyeokkorean","3173pieuptikeutkorean","3174pieupsioskiyeokkorean","3175pieupsiostikeutkorean","3176pieupcieuckorean","3177pieupthieuthkorean","3178kapyeounpieupkorean","3179kapyeounssangpieupkorean","317Asioskiyeokkorean","317Bsiosnieunkorean","317Csiostikeutkorean","317Dsiospieupkorean","317Esioscieuckorean","317Fpansioskorean","3180ssangieungkorean","3181yesieungkorean","3182yesieungsioskorean","3183yesieungpansioskorean","3184kapyeounphieuphkorean","3185ssanghieuhkorean","3186yeorinhieuhkorean","3187yoyakorean","3188yoyaekorean","3189yoikorean","318Ayuyeokorean","318Byuyekorean","318Cyuikorean","318Daraeakorean","318Earaeaekorean","3200kiyeokparenkorean","3201nieunparenkorean","3202tikeutparenkorean","3203rieulparenkorean","3204mieumparenkorean","3205pieupparenkorean","3206siosparenkorean","3207ieungparenkorean","3208cieucparenkorean","3209chieuchparenkorean","320Akhieukhparenkorean","320Bthieuthparenkorean","320Cphieuphparenkorean","320Dhieuhparenkorean","320Ekiyeokaparenkorean","320Fnieunaparenkorean","3210tikeutaparenkorean","3211rieulaparenkorean","3212mieumaparenkorean","3213pieupaparenkorean","3214siosaparenkorean","3215ieungaparenkorean","3216cieucaparenkorean","3217chieuchaparenkorean","3218khieukhaparenkorean","3219thieuthaparenkorean","321Aphieuphaparenkorean","321Bhieuhaparenkorean","321Ccieucuparenkorean","3220oneideographicparen","3221twoideographicparen","3222threeideographicparen","3223fourideographicparen","3224fiveideographicparen","3225sixideographicparen","3226sevenideographicparen","3227eightideographicparen","3228nineideographicparen","3229tenideographicparen","322Aideographicmoonparen","322Bideographicfireparen","322Cideographicwaterparen","322Dideographicwoodparen","322Eideographicmetalparen","322Fideographicearthparen","3230ideographicsunparen","3231ideographicstockparen","3232ideographichaveparen","3233ideographicsocietyparen","3234ideographicnameparen","3235ideographicspecialparen","3236ideographicfinancialparen","3237ideographiccongratulationparen","3238ideographiclaborparen","3239ideographicrepresentparen","323Aideographiccallparen","323Bideographicstudyparen","323Cideographicsuperviseparen","323Dideographicenterpriseparen","323Eideographicresourceparen","323Fideographicallianceparen","3240ideographicfestivalparen","3242ideographicselfparen","3243ideographicreachparen","3260kiyeokcirclekorean","3261nieuncirclekorean","3262tikeutcirclekorean","3263rieulcirclekorean","3264mieumcirclekorean","3265pieupcirclekorean","3266sioscirclekorean","3267ieungcirclekorean","3268cieuccirclekorean","3269chieuchcirclekorean","326Akhieukhcirclekorean","326Bthieuthcirclekorean","326Cphieuphcirclekorean","326Dhieuhcirclekorean","326Ekiyeokacirclekorean","326Fnieunacirclekorean","3270tikeutacirclekorean","3271rieulacirclekorean","3272mieumacirclekorean","3273pieupacirclekorean","3274siosacirclekorean","3275ieungacirclekorean","3276cieucacirclekorean","3277chieuchacirclekorean","3278khieukhacirclekorean","3279thieuthacirclekorean","327Aphieuphacirclekorean","327Bhieuhacirclekorean","327Fkoreanstandardsymbol","328Aideographmooncircle","328Bideographfirecircle","328Cideographwatercircle","328Dideographwoodcircle","328Eideographmetalcircle","328Fideographearthcircle","3290ideographsuncircle","3294ideographnamecircle","3296ideographicfinancialcircle","3298ideographiclaborcircle","3299ideographicsecretcircle","329Dideographicexcellentcircle","329Eideographicprintcircle","32A3ideographiccorrectcircle","32A4ideographichighcircle","32A5ideographiccentrecircle","32A6ideographiclowcircle","32A7ideographicleftcircle","32A8ideographicrightcircle","32A9ideographicmedicinecircle","3300apaatosquare","3303aarusquare","3305intisquare","330Dkaroriisquare","3314kirosquare","3315kiroguramusquare","3316kiromeetorusquare","3318guramusquare","331Ekooposquare","3322sentisquare","3323sentosquare","3326dorusquare","3327tonsquare","332Ahaitusquare","332Bpaasentosquare","3331birusquare","3333huiitosquare","3336hekutaarusquare","3339herutusquare","333Bpeezisquare","3342hoonsquare","3347mansyonsquare","3349mirisquare","334Amiribaarusquare","334Dmeetorusquare","334Eyaadosquare","3351rittorusquare","3357wattosquare","337Bheiseierasquare","337Csyouwaerasquare","337Dtaisyouerasquare","337Emeizierasquare","337Fcorporationsquare","3380paampssquare","3381nasquare","3382muasquare","3383masquare","3384kasquare","3385KBsquare","3386MBsquare","3387GBsquare","3388calsquare","3389kcalsquare","338Apfsquare","338Bnfsquare","338Cmufsquare","338Dmugsquare","338Esquaremg","338Fsquarekg","3390Hzsquare","3391khzsquare","3392mhzsquare","3393ghzsquare","3394thzsquare","3395mulsquare","3396mlsquare","3397dlsquare","3398klsquare","3399fmsquare","339Anmsquare","339Bmumsquare","339Csquaremm","339Dsquarecm","339Esquarekm","339Fmmsquaredsquare","33A0cmsquaredsquare","33A1squaremsquared","33A2kmsquaredsquare","33A3mmcubedsquare","33A4cmcubedsquare","33A5mcubedsquare","33A6kmcubedsquare","33A7moverssquare","33A8moverssquaredsquare","33A9pasquare","33AAkpasquare","33ABmpasquare","33ACgpasquare","33ADradsquare","33AEradoverssquare","33AFradoverssquaredsquare","33B0pssquare","33B1nssquare","33B2mussquare","33B3mssquare","33B4pvsquare","33B5nvsquare","33B6muvsquare","33B7mvsquare","33B8kvsquare","33B9mvmegasquare","33BApwsquare","33BBnwsquare","33BCmuwsquare","33BDmwsquare","33BEkwsquare","33BFmwmegasquare","33C0kohmsquare","33C1mohmsquare","33C2amsquare","33C3bqsquare","33C4squarecc","33C5cdsquare","33C6coverkgsquare","33C7cosquare","33C8dbsquare","33C9gysquare","33CAhasquare","33CBHPsquare","33CDKKsquare","33CEsquarekmcapital","33CFktsquare","33D0lmsquare","33D1squareln","33D2squarelog","33D3lxsquare","33D4mbsquare","33D5squaremil","33D6molsquare","33D8pmsquare","33DBsrsquare","33DCsvsquare","33DDwbsquare","5344twentyhangzhou","F6BEdotlessj","F6BFLL","F6C0ll","F6C3commaaccent","F6C4afii10063","F6C5afii10064","F6C6afii10192","F6C7afii10831","F6C8afii10832","F6C9Acute","F6CACaron","F6CBDieresis","F6CCDieresisAcute","F6CDDieresisGrave","F6CEGrave","F6CFHungarumlaut","F6D0Macron","F6D1cyrBreve","F6D2cyrFlex","F6D3dblGrave","F6D4cyrbreve","F6D5cyrflex","F6D6dblgrave","F6D7dieresisacute","F6D8dieresisgrave","F6D9copyrightserif","F6DAregisterserif","F6DBtrademarkserif","F6DConefitted","F6DDrupiah","F6DEthreequartersemdash","F6DFcentinferior","F6E0centsuperior","F6E1commainferior","F6E2commasuperior","F6E3dollarinferior","F6E4dollarsuperior","F6E5hypheninferior","F6E6hyphensuperior","F6E7periodinferior","F6E8periodsuperior","F6E9asuperior","F6EAbsuperior","F6EBdsuperior","F6ECesuperior","F6EDisuperior","F6EElsuperior","F6EFmsuperior","F6F0osuperior","F6F1rsuperior","F6F2ssuperior","F6F3tsuperior","F6F4Brevesmall","F6F5Caronsmall","F6F6Circumflexsmall","F6F7Dotaccentsmall","F6F8Hungarumlautsmall","F6F9Lslashsmall","F6FAOEsmall","F6FBOgoneksmall","F6FCRingsmall","F6FDScaronsmall","F6FETildesmall","F6FFZcaronsmall","F721exclamsmall","F724dollaroldstyle","F726ampersandsmall","F730zerooldstyle","F731oneoldstyle","F732twooldstyle","F733threeoldstyle","F734fouroldstyle","F735fiveoldstyle","F736sixoldstyle","F737sevenoldstyle","F738eightoldstyle","F739nineoldstyle","F73Fquestionsmall","F760Gravesmall","F761Asmall","F762Bsmall","F763Csmall","F764Dsmall","F765Esmall","F766Fsmall","F767Gsmall","F768Hsmall","F769Ismall","F76AJsmall","F76BKsmall","F76CLsmall","F76DMsmall","F76ENsmall","F76FOsmall","F770Psmall","F771Qsmall","F772Rsmall","F773Ssmall","F774Tsmall","F775Usmall","F776Vsmall","F777Wsmall","F778Xsmall","F779Ysmall","F77AZsmall","F7A1exclamdownsmall","F7A2centoldstyle","F7A8Dieresissmall","F7AFMacronsmall","F7B4Acutesmall","F7B8Cedillasmall","F7BFquestiondownsmall","F7E0Agravesmall","F7E1Aacutesmall","F7E2Acircumflexsmall","F7E3Atildesmall","F7E4Adieresissmall","F7E5Aringsmall","F7E6AEsmall","F7E7Ccedillasmall","F7E8Egravesmall","F7E9Eacutesmall","F7EAEcircumflexsmall","F7EBEdieresissmall","F7ECIgravesmall","F7EDIacutesmall","F7EEIcircumflexsmall","F7EFIdieresissmall","F7F0Ethsmall","F7F1Ntildesmall","F7F2Ogravesmall","F7F3Oacutesmall","F7F4Ocircumflexsmall","F7F5Otildesmall","F7F6Odieresissmall","F7F8Oslashsmall","F7F9Ugravesmall","F7FAUacutesmall","F7FBUcircumflexsmall","F7FCUdieresissmall","F7FDYacutesmall","F7FEThornsmall","F7FFYdieresissmall","F884maihanakatleftthai","F885saraileftthai","F886saraiileftthai","F887saraueleftthai","F888saraueeleftthai","F889maitaikhuleftthai","F88Amaiekupperleftthai","F88Bmaieklowrightthai","F88Cmaieklowleftthai","F88Dmaithoupperleftthai","F88Emaitholowrightthai","F88Fmaitholowleftthai","F890maitriupperleftthai","F891maitrilowrightthai","F892maitrilowleftthai","F893maichattawaupperleftthai","F894maichattawalowrightthai","F895maichattawalowleftthai","F896thanthakhatupperleftthai","F897thanthakhatlowrightthai","F898thanthakhatlowleftthai","F899nikhahitleftthai","F8E5radicalex","F8E6arrowvertex","F8E7arrowhorizex","F8E8registersans","F8E9copyrightsans","F8EAtrademarksans","F8EBparenlefttp","F8ECparenleftex","F8EDparenleftbt","F8EEbracketlefttp","F8EFbracketleftex","F8F0bracketleftbt","F8F1bracelefttp","F8F2braceleftmid","F8F3braceleftbt","F8F4braceex","F8F5integralex","F8F6parenrighttp","F8F7parenrightex","F8F8parenrightbt","F8F9bracketrighttp","F8FAbracketrightex","F8FBbracketrightbt","F8FCbracerighttp","F8FDbracerightmid","F8FEbracerightbt","F8FFapple","FB00ff","FB01fi","FB02fl","FB03ffi","FB04ffl","FB1Fafii57705","FB20ayinaltonehebrew","FB2Aafii57694","FB2Bafii57695","FB2Cshindageshshindot","FB2Dshindageshsindot","FB2Ealefpatahhebrew","FB2Falefqamatshebrew","FB30alefdageshhebrew","FB31betdagesh","FB32gimeldagesh","FB33daletdagesh","FB34hedagesh","FB35afii57723","FB36zayindagesh","FB38tetdagesh","FB39yoddagesh","FB3Afinalkafdagesh","FB3Bkafdagesh","FB3Clameddagesh","FB3Ememdagesh","FB40nundagesh","FB41samekhdagesh","FB43pefinaldageshhebrew","FB44pedagesh","FB46tsadidagesh","FB47qofdagesh","FB48reshdageshhebrew","FB49shindagesh","FB4Atavdagesh","FB4Bafii57700","FB4Cbetrafehebrew","FB4Dkafrafehebrew","FB4Eperafehebrew","FB4Faleflamedhebrew","FB57pehfinalarabic","FB58pehinitialarabic","FB59pehmedialarabic","FB67ttehfinalarabic","FB68ttehinitialarabic","FB69ttehmedialarabic","FB6Bvehfinalarabic","FB6Cvehinitialarabic","FB6Dvehmedialarabic","FB7Btchehfinalarabic","FB7Ctchehinitialarabic","FB7Dtchehmedialarabic","FB89ddalfinalarabic","FB8Bjehfinalarabic","FB8Drrehfinalarabic","FB93gaffinalarabic","FB94gafinitialarabic","FB95gafmedialarabic","FB9Fnoonghunnafinalarabic","FBA4hehhamzaaboveisolatedarabic","FBA5hehhamzaabovefinalarabic","FBA7hehfinalaltonearabic","FBA8hehinitialaltonearabic","FBA9hehmedialaltonearabic","FBAFyehbarreefinalarabic","FC08behmeemisolatedarabic","FC0Btehjeemisolatedarabic","FC0Ctehhahisolatedarabic","FC0Etehmeemisolatedarabic","FC48meemmeemisolatedarabic","FC4Bnoonjeemisolatedarabic","FC4Enoonmeemisolatedarabic","FC58yehmeemisolatedarabic","FC5Eshaddadammatanarabic","FC5Fshaddakasratanarabic","FC60shaddafathaarabic","FC61shaddadammaarabic","FC62shaddakasraarabic","FC6Dbehnoonfinalarabic","FC73tehnoonfinalarabic","FC8Dnoonnoonfinalarabic","FC94yehnoonfinalarabic","FC9Fbehmeeminitialarabic","FCA1tehjeeminitialarabic","FCA2tehhahinitialarabic","FCA4tehmeeminitialarabic","FCC9lamjeeminitialarabic","FCCAlamhahinitialarabic","FCCBlamkhahinitialarabic","FCCClammeeminitialarabic","FCD1meemmeeminitialarabic","FCD2noonjeeminitialarabic","FCD5noonmeeminitialarabic","FCDDyehmeeminitialarabic","FD3Eparenleftaltonearabic","FD3Fparenrightaltonearabic","FD88lammeemhahinitialarabic","FDF2lamlamhehisolatedarabic","FDFAsallallahoualayhewasallamarabic","FE30twodotleadervertical","FE31emdashvertical","FE32endashvertical","FE33underscorevertical","FE34wavyunderscorevertical","FE35parenleftvertical","FE36parenrightvertical","FE37braceleftvertical","FE38bracerightvertical","FE39tortoiseshellbracketleftvertical","FE3Atortoiseshellbracketrightvertical","FE3Bblacklenticularbracketleftvertical","FE3Cblacklenticularbracketrightvertical","FE3Ddblanglebracketleftvertical","FE3Edblanglebracketrightvertical","FE3Fanglebracketleftvertical","FE40anglebracketrightvertical","FE41cornerbracketleftvertical","FE42cornerbracketrightvertical","FE43whitecornerbracketleftvertical","FE44whitecornerbracketrightvertical","FE49overlinedashed","FE4Aoverlinecenterline","FE4Boverlinewavy","FE4Coverlinedblwavy","FE4Dlowlinedashed","FE4Elowlinecenterline","FE4Funderscorewavy","FE50commasmall","FE52periodsmall","FE54semicolonsmall","FE55colonsmall","FE59parenleftsmall","FE5Aparenrightsmall","FE5Bbraceleftsmall","FE5Cbracerightsmall","FE5Dtortoiseshellbracketleftsmall","FE5Etortoiseshellbracketrightsmall","FE5Fnumbersignsmall","FE61asterisksmall","FE62plussmall","FE63hyphensmall","FE64lesssmall","FE65greatersmall","FE66equalsmall","FE69dollarsmall","FE6Apercentsmall","FE6Batsmall","FE82alefmaddaabovefinalarabic","FE84alefhamzaabovefinalarabic","FE86wawhamzaabovefinalarabic","FE88alefhamzabelowfinalarabic","FE8Ayehhamzaabovefinalarabic","FE8Byehhamzaaboveinitialarabic","FE8Cyehhamzaabovemedialarabic","FE8Ealeffinalarabic","FE90behfinalarabic","FE91behinitialarabic","FE92behmedialarabic","FE94tehmarbutafinalarabic","FE96tehfinalarabic","FE97tehinitialarabic","FE98tehmedialarabic","FE9Athehfinalarabic","FE9Bthehinitialarabic","FE9Cthehmedialarabic","FE9Ejeemfinalarabic","FE9Fjeeminitialarabic","FEA0jeemmedialarabic","FEA2hahfinalarabic","FEA3hahinitialarabic","FEA4hahmedialarabic","FEA6khahfinalarabic","FEA7khahinitialarabic","FEA8khahmedialarabic","FEAAdalfinalarabic","FEACthalfinalarabic","FEAErehfinalarabic","FEB0zainfinalarabic","FEB2seenfinalarabic","FEB3seeninitialarabic","FEB4seenmedialarabic","FEB6sheenfinalarabic","FEB7sheeninitialarabic","FEB8sheenmedialarabic","FEBAsadfinalarabic","FEBBsadinitialarabic","FEBCsadmedialarabic","FEBEdadfinalarabic","FEBFdadinitialarabic","FEC0dadmedialarabic","FEC2tahfinalarabic","FEC3tahinitialarabic","FEC4tahmedialarabic","FEC6zahfinalarabic","FEC7zahinitialarabic","FEC8zahmedialarabic","FECAainfinalarabic","FECBaininitialarabic","FECCainmedialarabic","FECEghainfinalarabic","FECFghaininitialarabic","FED0ghainmedialarabic","FED2fehfinalarabic","FED3fehinitialarabic","FED4fehmedialarabic","FED6qaffinalarabic","FED7qafinitialarabic","FED8qafmedialarabic","FEDAkaffinalarabic","FEDBkafinitialarabic","FEDCkafmedialarabic","FEDElamfinalarabic","FEDFlaminitialarabic","FEE0lammedialarabic","FEE2meemfinalarabic","FEE3meeminitialarabic","FEE4meemmedialarabic","FEE6noonfinalarabic","FEE7nooninitialarabic","FEE8noonmedialarabic","FEEAhehfinalarabic","FEEBhehinitialarabic","FEEChehmedialarabic","FEEEwawfinalarabic","FEF0alefmaksurafinalarabic","FEF2yehfinalarabic","FEF3yehinitialarabic","FEF4yehmedialarabic","FEF5lamalefmaddaaboveisolatedarabic","FEF6lamalefmaddaabovefinalarabic","FEF7lamalefhamzaaboveisolatedarabic","FEF8lamalefhamzaabovefinalarabic","FEF9lamalefhamzabelowisolatedarabic","FEFAlamalefhamzabelowfinalarabic","FEFBlamalefisolatedarabic","FEFClamaleffinalarabic","FEFFzerowidthjoiner","FF01exclammonospace","FF02quotedblmonospace","FF03numbersignmonospace","FF04dollarmonospace","FF05percentmonospace","FF06ampersandmonospace","FF07quotesinglemonospace","FF08parenleftmonospace","FF09parenrightmonospace","FF0Aasteriskmonospace","FF0Bplusmonospace","FF0Ccommamonospace","FF0Dhyphenmonospace","FF0Eperiodmonospace","FF0Fslashmonospace","FF10zeromonospace","FF11onemonospace","FF12twomonospace","FF13threemonospace","FF14fourmonospace","FF15fivemonospace","FF16sixmonospace","FF17sevenmonospace","FF18eightmonospace","FF19ninemonospace","FF1Acolonmonospace","FF1Bsemicolonmonospace","FF1Clessmonospace","FF1Dequalmonospace","FF1Egreatermonospace","FF1Fquestionmonospace","FF20atmonospace","FF21Amonospace","FF22Bmonospace","FF23Cmonospace","FF24Dmonospace","FF25Emonospace","FF26Fmonospace","FF27Gmonospace","FF28Hmonospace","FF29Imonospace","FF2AJmonospace","FF2BKmonospace","FF2CLmonospace","FF2DMmonospace","FF2ENmonospace","FF2FOmonospace","FF30Pmonospace","FF31Qmonospace","FF32Rmonospace","FF33Smonospace","FF34Tmonospace","FF35Umonospace","FF36Vmonospace","FF37Wmonospace","FF38Xmonospace","FF39Ymonospace","FF3AZmonospace","FF3Bbracketleftmonospace","FF3Cbackslashmonospace","FF3Dbracketrightmonospace","FF3Easciicircummonospace","FF3Funderscoremonospace","FF40gravemonospace","FF41amonospace","FF42bmonospace","FF43cmonospace","FF44dmonospace","FF45emonospace","FF46fmonospace","FF47gmonospace","FF48hmonospace","FF49imonospace","FF4Ajmonospace","FF4Bkmonospace","FF4Clmonospace","FF4Dmmonospace","FF4Enmonospace","FF4Fomonospace","FF50pmonospace","FF51qmonospace","FF52rmonospace","FF53smonospace","FF54tmonospace","FF55umonospace","FF56vmonospace","FF57wmonospace","FF58xmonospace","FF59ymonospace","FF5Azmonospace","FF5Bbraceleftmonospace","FF5Cbarmonospace","FF5Dbracerightmonospace","FF5Easciitildemonospace","FF61periodhalfwidth","FF62cornerbracketlefthalfwidth","FF63cornerbracketrighthalfwidth","FF64ideographiccommaleft","FF65middledotkatakanahalfwidth","FF66wokatakanahalfwidth","FF67asmallkatakanahalfwidth","FF68ismallkatakanahalfwidth","FF69usmallkatakanahalfwidth","FF6Aesmallkatakanahalfwidth","FF6Bosmallkatakanahalfwidth","FF6Cyasmallkatakanahalfwidth","FF6Dyusmallkatakanahalfwidth","FF6Eyosmallkatakanahalfwidth","FF6Ftusmallkatakanahalfwidth","FF70katahiraprolongmarkhalfwidth","FF71akatakanahalfwidth","FF72ikatakanahalfwidth","FF73ukatakanahalfwidth","FF74ekatakanahalfwidth","FF75okatakanahalfwidth","FF76kakatakanahalfwidth","FF77kikatakanahalfwidth","FF78kukatakanahalfwidth","FF79kekatakanahalfwidth","FF7Akokatakanahalfwidth","FF7Bsakatakanahalfwidth","FF7Csikatakanahalfwidth","FF7Dsukatakanahalfwidth","FF7Esekatakanahalfwidth","FF7Fsokatakanahalfwidth","FF80takatakanahalfwidth","FF81tikatakanahalfwidth","FF82tukatakanahalfwidth","FF83tekatakanahalfwidth","FF84tokatakanahalfwidth","FF85nakatakanahalfwidth","FF86nikatakanahalfwidth","FF87nukatakanahalfwidth","FF88nekatakanahalfwidth","FF89nokatakanahalfwidth","FF8Ahakatakanahalfwidth","FF8Bhikatakanahalfwidth","FF8Chukatakanahalfwidth","FF8Dhekatakanahalfwidth","FF8Ehokatakanahalfwidth","FF8Fmakatakanahalfwidth","FF90mikatakanahalfwidth","FF91mukatakanahalfwidth","FF92mekatakanahalfwidth","FF93mokatakanahalfwidth","FF94yakatakanahalfwidth","FF95yukatakanahalfwidth","FF96yokatakanahalfwidth","FF97rakatakanahalfwidth","FF98rikatakanahalfwidth","FF99rukatakanahalfwidth","FF9Arekatakanahalfwidth","FF9Brokatakanahalfwidth","FF9Cwakatakanahalfwidth","FF9Dnkatakanahalfwidth","FF9Evoicedmarkkanahalfwidth","FF9Fsemivoicedmarkkanahalfwidth","FFE0centmonospace","FFE1sterlingmonospace","FFE3macronmonospace","FFE5yenmonospace","FFE6wonmonospace"];this._standardFontCharsNames=[];for(let e=0;e<i.length;e++){let t=parseInt(i[e].substr(0,4),16);this._standardFontCharsNames[t]=i[e].substr(4)}}return this._standardFontCharsNames}}Kr.sRGBprofile=[0,0,12,72,76,105,110,111,2,16,0,0,109,110,116,114,82,71,66,32,88,89,90,32,7,206,0,2,0,9,0,6,0,49,0,0,97,99,115,112,77,83,70,84,0,0,0,0,73,69,67,32,115,82,71,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,246,214,0,1,0,0,0,0,211,45,72,80,32,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,99,112,114,116,0,0,1,80,0,0,0,51,100,101,115,99,0,0,1,132,0,0,0,108,119,116,112,116,0,0,1,240,0,0,0,20,98,107,112,116,0,0,2,4,0,0,0,20,114,88,89,90,0,0,2,24,0,0,0,20,103,88,89,90,0,0,2,44,0,0,0,20,98,88,89,90,0,0,2,64,0,0,0,20,100,109,110,100,0,0,2,84,0,0,0,112,100,109,100,100,0,0,2,196,0,0,0,136,118,117,101,100,0,0,3,76,0,0,0,134,118,105,101,119,0,0,3,212,0,0,0,36,108,117,109,105,0,0,3,248,0,0,0,20,109,101,97,115,0,0,4,12,0,0,0,36,116,101,99,104,0,0,4,48,0,0,0,12,114,84,82,67,0,0,4,60,0,0,8,12,103,84,82,67,0,0,4,60,0,0,8,12,98,84,82,67,0,0,4,60,0,0,8,12,116,101,120,116,0,0,0,0,67,111,112,121,114,105,103,104,116,32,40,99,41,32,49,57,57,56,32,72,101,119,108,101,116,116,45,80,97,99,107,97,114,100,32,67,111,109,112,97,110,121,0,0,100,101,115,99,0,0,0,0,0,0,0,18,115,82,71,66,32,73,69,67,54,49,57,54,54,45,50,46,49,0,0,0,0,0,0,0,0,0,0,0,18,115,82,71,66,32,73,69,67,54,49,57,54,54,45,50,46,49,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,88,89,90,32,0,0,0,0,0,0,243,81,0,1,0,0,0,1,22,204,88,89,90,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,88,89,90,32,0,0,0,0,0,0,111,162,0,0,56,245,0,0,3,144,88,89,90,32,0,0,0,0,0,0,98,153,0,0,183,133,0,0,24,218,88,89,90,32,0,0,0,0,0,0,36,160,0,0,15,132,0,0,182,207,100,101,115,99,0,0,0,0,0,0,0,22,73,69,67,32,104,116,116,112,58,47,47,119,119,119,46,105,101,99,46,99,104,0,0,0,0,0,0,0,0,0,0,0,22,73,69,67,32,104,116,116,112,58,47,47,119,119,119,46,105,101,99,46,99,104,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,100,101,115,99,0,0,0,0,0,0,0,46,73,69,67,32,54,49,57,54,54,45,50,46,49,32,68,101,102,97,117,108,116,32,82,71,66,32,99,111,108,111,117,114,32,115,112,97,99,101,32,45,32,115,82,71,66,0,0,0,0,0,0,0,0,0,0,0,46,73,69,67,32,54,49,57,54,54,45,50,46,49,32,68,101,102,97,117,108,116,32,82,71,66,32,99,111,108,111,117,114,32,115,112,97,99,101,32,45,32,115,82,71,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,100,101,115,99,0,0,0,0,0,0,0,44,82,101,102,101,114,101,110,99,101,32,86,105,101,119,105,110,103,32,67,111,110,100,105,116,105,111,110,32,105,110,32,73,69,67,54,49,57,54,54,45,50,46,49,0,0,0,0,0,0,0,0,0,0,0,44,82,101,102,101,114,101,110,99,101,32,86,105,101,119,105,110,103,32,67,111,110,100,105,116,105,111,110,32,105,110,32,73,69,67,54,49,57,54,54,45,50,46,49,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,118,105,101,119,0,0,0,0,0,19,164,254,0,20,95,46,0,16,207,20,0,3,237,204,0,4,19,11,0,3,92,158,0,0,0,1,88,89,90,32,0,0,0,0,0,76,9,86,0,80,0,0,0,87,31,231,109,101,97,115,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,143,0,0,0,2,115,105,103,32,0,0,0,0,67,82,84,32,99,117,114,118,0,0,0,0,0,0,4,0,0,0,0,5,0,10,0,15,0,20,0,25,0,30,0,35,0,40,0,45,0,50,0,55,0,59,0,64,0,69,0,74,0,79,0,84,0,89,0,94,0,99,0,104,0,109,0,114,0,119,0,124,0,129,0,134,0,139,0,144,0,149,0,154,0,159,0,164,0,169,0,174,0,178,0,183,0,188,0,193,0,198,0,203,0,208,0,213,0,219,0,224,0,229,0,235,0,240,0,246,0,251,1,1,1,7,1,13,1,19,1,25,1,31,1,37,1,43,1,50,1,56,1,62,1,69,1,76,1,82,1,89,1,96,1,103,1,110,1,117,1,124,1,131,1,139,1,146,1,154,1,161,1,169,1,177,1,185,1,193,1,201,1,209,1,217,1,225,1,233,1,242,1,250,2,3,2,12,2,20,2,29,2,38,2,47,2,56,2,65,2,75,2,84,2,93,2,103,2,113,2,122,2,132,2,142,2,152,2,162,2,172,2,182,2,193,2,203,2,213,2,224,2,235,2,245,3,0,3,11,3,22,3,33,3,45,3,56,3,67,3,79,3,90,3,102,3,114,3,126,3,138,3,150,3,162,3,174,3,186,3,199,3,211,3,224,3,236,3,249,4,6,4,19,4,32,4,45,4,59,4,72,4,85,4,99,4,113,4,126,4,140,4,154,4,168,4,182,4,196,4,211,4,225,4,240,4,254,5,13,5,28,5,43,5,58,5,73,5,88,5,103,5,119,5,134,5,150,5,166,5,181,5,197,5,213,5,229,5,246,6,6,6,22,6,39,6,55,6,72,6,89,6,106,6,123,6,140,6,157,6,175,6,192,6,209,6,227,6,245,7,7,7,25,7,43,7,61,7,79,7,97,7,116,7,134,7,153,7,172,7,191,7,210,7,229,7,248,8,11,8,31,8,50,8,70,8,90,8,110,8,130,8,150,8,170,8,190,8,210,8,231,8,251,9,16,9,37,9,58,9,79,9,100,9,121,9,143,9,164,9,186,9,207,9,229,9,251,10,17,10,39,10,61,10,84,10,106,10,129,10,152,10,174,10,197,10,220,10,243,11,11,11,34,11,57,11,81,11,105,11,128,11,152,11,176,11,200,11,225,11,249,12,18,12,42,12,67,12,92,12,117,12,142,12,167,12,192,12,217,12,243,13,13,13,38,13,64,13,90,13,116,13,142,13,169,13,195,13,222,13,248,14,19,14,46,14,73,14,100,14,127,14,155,14,182,14,210,14,238,15,9,15,37,15,65,15,94,15,122,15,150,15,179,15,207,15,236,16,9,16,38,16,67,16,97,16,126,16,155,16,185,16,215,16,245,17,19,17,49,17,79,17,109,17,140,17,170,17,201,17,232,18,7,18,38,18,69,18,100,18,132,18,163,18,195,18,227,19,3,19,35,19,67,19,99,19,131,19,164,19,197,19,229,20,6,20,39,20,73,20,106,20,139,20,173,20,206,20,240,21,18,21,52,21,86,21,120,21,155,21,189,21,224,22,3,22,38,22,73,22,108,22,143,22,178,22,214,22,250,23,29,23,65,23,101,23,137,23,174,23,210,23,247,24,27,24,64,24,101,24,138,24,175,24,213,24,250,25,32,25,69,25,107,25,145,25,183,25,221,26,4,26,42,26,81,26,119,26,158,26,197,26,236,27,20,27,59,27,99,27,138,27,178,27,218,28,2,28,42,28,82,28,123,28,163,28,204,28,245,29,30,29,71,29,112,29,153,29,195,29,236,30,22,30,64,30,106,30,148,30,190,30,233,31,19,31,62,31,105,31,148,31,191,31,234,32,21,32,65,32,108,32,152,32,196,32,240,33,28,33,72,33,117,33,161,33,206,33,251,34,39,34,85,34,130,34,175,34,221,35,10,35,56,35,102,35,148,35,194,35,240,36,31,36,77,36,124,36,171,36,218,37,9,37,56,37,104,37,151,37,199,37,247,38,39,38,87,38,135,38,183,38,232,39,24,39,73,39,122,39,171,39,220,40,13,40,63,40,113,40,162,40,212,41,6,41,56,41,107,41,157,41,208,42,2,42,53,42,104,42,155,42,207,43,2,43,54,43,105,43,157,43,209,44,5,44,57,44,110,44,162,44,215,45,12,45,65,45,118,45,171,45,225,46,22,46,76,46,130,46,183,46,238,47,36,47,90,47,145,47,199,47,254,48,53,48,108,48,164,48,219,49,18,49,74,49,130,49,186,49,242,50,42,50,99,50,155,50,212,51,13,51,70,51,127,51,184,51,241,52,43,52,101,52,158,52,216,53,19,53,77,53,135,53,194,53,253,54,55,54,114,54,174,54,233,55,36,55,96,55,156,55,215,56,20,56,80,56,140,56,200,57,5,57,66,57,127,57,188,57,249,58,54,58,116,58,178,58,239,59,45,59,107,59,170,59,232,60,39,60,101,60,164,60,227,61,34,61,97,61,161,61,224,62,32,62,96,62,160,62,224,63,33,63,97,63,162,63,226,64,35,64,100,64,166,64,231,65,41,65,106,65,172,65,238,66,48,66,114,66,181,66,247,67,58,67,125,67,192,68,3,68,71,68,138,68,206,69,18,69,85,69,154,69,222,70,34,70,103,70,171,70,240,71,53,71,123,71,192,72,5,72,75,72,145,72,215,73,29,73,99,73,169,73,240,74,55,74,125,74,196,75,12,75,83,75,154,75,226,76,42,76,114,76,186,77,2,77,74,77,147,77,220,78,37,78,110,78,183,79,0,79,73,79,147,79,221,80,39,80,113,80,187,81,6,81,80,81,155,81,230,82,49,82,124,82,199,83,19,83,95,83,170,83,246,84,66,84,143,84,219,85,40,85,117,85,194,86,15,86,92,86,169,86,247,87,68,87,146,87,224,88,47,88,125,88,203,89,26,89,105,89,184,90,7,90,86,90,166,90,245,91,69,91,149,91,229,92,53,92,134,92,214,93,39,93,120,93,201,94,26,94,108,94,189,95,15,95,97,95,179,96,5,96,87,96,170,96,252,97,79,97,162,97,245,98,73,98,156,98,240,99,67,99,151,99,235,100,64,100,148,100,233,101,61,101,146,101,231,102,61,102,146,102,232,103,61,103,147,103,233,104,63,104,150,104,236,105,67,105,154,105,241,106,72,106,159,106,247,107,79,107,167,107,255,108,87,108,175,109,8,109,96,109,185,110,18,110,107,110,196,111,30,111,120,111,209,112,43,112,134,112,224,113,58,113,149,113,240,114,75,114,166,115,1,115,93,115,184,116,20,116,112,116,204,117,40,117,133,117,225,118,62,118,155,118,248,119,86,119,179,120,17,120,110,120,204,121,42,121,137,121,231,122,70,122,165,123,4,123,99,123,194,124,33,124,129,124,225,125,65,125,161,126,1,126,98,126,194,127,35,127,132,127,229,128,71,128,168,129,10,129,107,129,205,130,48,130,146,130,244,131,87,131,186,132,29,132,128,132,227,133,71,133,171,134,14,134,114,134,215,135,59,135,159,136,4,136,105,136,206,137,51,137,153,137,254,138,100,138,202,139,48,139,150,139,252,140,99,140,202,141,49,141,152,141,255,142,102,142,206,143,54,143,158,144,6,144,110,144,214,145,63,145,168,146,17,146,122,146,227,147,77,147,182,148,32,148,138,148,244,149,95,149,201,150,52,150,159,151,10,151,117,151,224,152,76,152,184,153,36,153,144,153,252,154,104,154,213,155,66,155,175,156,28,156,137,156,247,157,100,157,210,158,64,158,174,159,29,159,139,159,250,160,105,160,216,161,71,161,182,162,38,162,150,163,6,163,118,163,230,164,86,164,199,165,56,165,169,166,26,166,139,166,253,167,110,167,224,168,82,168,196,169,55,169,169,170,28,170,143,171,2,171,117,171,233,172,92,172,208,173,68,173,184,174,45,174,161,175,22,175,139,176,0,176,117,176,234,177,96,177,214,178,75,178,194,179,56,179,174,180,37,180,156,181,19,181,138,182,1,182,121,182,240,183,104,183,224,184,89,184,209,185,74,185,194,186,59,186,181,187,46,187,167,188,33,188,155,189,21,189,143,190,10,190,132,190,255,191,122,191,245,192,112,192,236,193,103,193,227,194,95,194,219,195,88,195,212,196,81,196,206,197,75,197,200,198,70,198,195,199,65,199,191,200,61,200,188,201,58,201,185,202,56,202,183,203,54,203,182,204,53,204,181,205,53,205,181,206,54,206,182,207,55,207,184,208,57,208,186,209,60,209,190,210,63,210,193,211,68,211,198,212,73,212,203,213,78,213,
209,214,85,214,216,215,92,215,224,216,100,216,232,217,108,217,241,218,118,218,251,219,128,220,5,220,138,221,16,221,150,222,28,222,162,223,41,223,175,224,54,224,189,225,68,225,204,226,83,226,219,227,99,227,235,228,115,228,252,229,132,230,13,230,150,231,31,231,169,232,50,232,188,233,70,233,208,234,91,234,229,235,112,235,251,236,134,237,17,237,156,238,40,238,180,239,64,239,204,240,88,240,229,241,114,241,255,242,140,243,25,243,167,244,52,244,194,245,80,245,222,246,109,246,251,247,138,248,25,248,168,249,56,249,199,250,87,250,231,251,119,252,7,252,152,253,41,253,186,254,75,254,220,255,109,255,255],Kr.hatchData=["000000FF00000000","1010101010101010","8040201008040201","0102040810204080","101010FF10101010","8142241818244281","8000000008000000","0010000100100001","2200880022008800","2288228822882288","2255885522558855","AA558A55AA55A855","AA55AA55AA55AA55","BB55EE55BB55EE55","DD77DD77DD77DD77","FFDDFF77FFDDFF77","FF7FFFF7FF7FFFF7","FF7FFFFFFFF7FFFF","8844221188442211","1122448811224488","CC663399CC663399","993366CC993366CC","E070381C0E0783C1","C183070E1C3870E0","4040404040404040","00FF000000FF0000","AAAAAAAAAAAAAAAA","FF00FF00FF00FF00","CCCCCCCCCCCCCCCC","FFFF0000FFFF0000","8844221100000000","1122448800000000","F00000000F000000","8080808008080808","0240088004200110","0C8DB130031BD8C0","8403304884033048","00304A8100304A81","0102040818244281","202020FF020202FF","1422518854224588","F0F0F0F0AA55AA55","0100201020000102","AA00800080008000","0020008800020088","8448300C02010103","33FFCCFF33FFCCFF","98F8F877898F8F77","111111FF111111FF","3333CCCC3333CCCC","0F0F0F0FF0F0F0F0","0502058850205088","10387CFE7C381000","0000000000000000"],Kr.standardFontWidths=null,Kr.standardFontInfo=null,Kr._standardFontCharsNames=null,J.c.StiPdfResources=Kr}{class Qr{padPassword(t){let e=[],i=0;for(;i<t.length;i++)e[i]=t.charCodeAt(i);for(let t=0;t<Qr.paddingString.length;t++)e[i++]=Qr.paddingString[t];let r=[];for(i=0;i<32;i++)r[i]=e[i];return r}computingCryptoValues(t,e,i,r,n){this.securityFlags=4294967232;let a=0,s=(0!=(t&J.c.StiUserAccessPrivileges.PrintDocument)&&(a|=1<<2),0!=(t&J.c.StiUserAccessPrivileges.ModifyContents)&&(a|=1<<3),0!=(t&J.c.StiUserAccessPrivileges.CopyTextAndGraphics)&&(a|=1<<4),0!=(t&J.c.StiUserAccessPrivileges.AddOrModifyTextAnnotations)&&(a|=1<<5),this.securityFlags|=a,null==i&&(i=""),this.passwordOwner=e=null==e?"":e,this.passwordUser=i,this.keyLength=r,this.IDValue=n,!1);if(0<this.passwordOwner.length||0<this.passwordUser.length||t!=J.c.StiUserAccessPrivileges.All){s=!0;let t=this.computingCryptoValues2();t||(s=!1,this.throwEncryptionError(0,"Encryption not work!"))}return s}computingCryptoValues2(){if(this.keyLength==J.c.StiPdfEncryptionKeyLength.Bit128_r4)return this.computingCryptoValuesV4();if(this.keyLength==J.c.StiPdfEncryptionKeyLength.Bit256_r5||this.keyLength==J.c.StiPdfEncryptionKeyLength.Bit256_r6)return this.computingCryptoValuesV5();let t=this.passwordOwner,e=(nt.isNullOrEmpty(this.passwordOwner)&&(t=this.passwordUser),this.padPassword(t)),r=this.computeHashMD5(e);if(this.keyLength==J.c.StiPdfEncryptionKeyLength.Bit128)for(let t=0;t<50;t++)r=this.computeHashMD5(r);if(this.keyLength==J.c.StiPdfEncryptionKeyLength.Bit40){let t=[];t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],r=t}let i=this.padPassword(this.passwordUser);if(i=this.rc4(i,r),this.keyLength==J.c.StiPdfEncryptionKeyLength.Bit128)for(let e=1;e<=19;e++){for(let t=0;t<16;t++)r[t]^=e-1,r[t]^=e;i=this.rc4(i,r)}i[Z.System.StiObject.stimulsoft]().copyTo(this.ownerValue,0);let n=this.passwordUser,a=this.padPassword(n),s=this.getBytesUInt32(this.securityFlags),o=[];if(o.push(...a),o.push(...i),o.push(...s),o.push(...this.IDValue),r=this.computeHashMD5(o),this.keyLength==J.c.StiPdfEncryptionKeyLength.Bit128)for(let t=0;t<50;t++)r=this.computeHashMD5(r);this.encryptionKey=[],this.encryptionKeyLength=this.keyLength==J.c.StiPdfEncryptionKeyLength.Bit128?16:5;for(let t=0;t<this.encryptionKeyLength;t++)this.encryptionKey[t]=r[t];let l=[];if(this.keyLength==J.c.StiPdfEncryptionKeyLength.Bit128){(o=[]).push(...Qr.paddingString),o.push(...this.IDValue),r=this.computeHashMD5(o),r=this.rc4(r,this.encryptionKey);let i=[];for(let e=1;e<=19;e++){for(let t=0;t<16;t++)i[t]=this.encryptionKey[t]^e;r=this.rc4(r,i)}Qr.paddingString[Z.System.StiObject.stimulsoft]().copyTo(l,0),r[Z.System.StiObject.stimulsoft]().copyTo(l,0)}else Qr.paddingString[Z.System.StiObject.stimulsoft]().copyTo(l,0),l=this.rc4(l,this.encryptionKey);return l[Z.System.StiObject.stimulsoft]().copyTo(this.userValue,0),!0}computingCryptoValuesV4(){let t=this.passwordOwner,e=(nt.isNullOrEmpty(this.passwordOwner)&&(t=this.passwordUser),this.padPassword(t)),i=this.computeHashMD5(e);for(let t=0;t<50;t++)i=this.computeHashMD5(i);let r=this.padPassword(this.passwordUser);r=this.rc4(r,i);for(let e=1;e<=19;e++){for(let t=0;t<16;t++)i[t]^=e-1,i[t]^=e;r=this.rc4(r,i)}r[Z.System.StiObject.stimulsoft]().copyTo(this.ownerValue,0);let n=this.passwordUser,a=this.padPassword(n),s=this.getBytesUInt32(this.securityFlags),o=[];o.push(...a),o.push(...r),o.push(...s),o.push(...this.IDValue),i=this.computeHashMD5(o);for(let t=0;t<50;t++)i=this.computeHashMD5(i);this.encryptionKey=[],this.encryptionKeyLength=16;for(let t=0;t<this.encryptionKeyLength;t++)this.encryptionKey[t]=i[t];let l=[],h=((o=[]).push(...Qr.paddingString),o.push(...this.IDValue),i=this.computeHashMD5(o),i=this.rc4(i,this.encryptionKey),[]);for(let e=1;e<=19;e++){for(let t=0;t<16;t++)h[t]=this.encryptionKey[t]^e;i=this.rc4(i,h)}return Qr.paddingString[Z.System.StiObject.stimulsoft]().copyTo(l,0),i[Z.System.StiObject.stimulsoft]().copyTo(l,0),l[Z.System.StiObject.stimulsoft]().copyTo(this.userValue,0),!0}computingCryptoValuesV5(){let t=new Z.System.Crypt.SecureRandom,e=null,i=null,r=t.createNextBytes(32),n=t.createNextBytes(8),a=t.createNextBytes(8),s=t.createNextBytes(8),o=t.createNextBytes(8),l=Z.System.Text.Encoding.UTF8.getBytes(this.passwordUser);if(127<l.length){let t=[];it.copy2(l,0,t,0,127),l=t}(i=this.getHashV5(l,n,null))[Z.System.StiObject.stimulsoft]().copyTo(this.userValue,0),n[Z.System.StiObject.stimulsoft]().copyTo(this.userValue,32),a[Z.System.StiObject.stimulsoft]().copyTo(this.userValue,40),i=this.getHashV5(l,a,null),this.encodeKeyDataV5(i,r,!0)[Z.System.StiObject.stimulsoft]().copyTo(this.userExtendedValue,0);let h=this.passwordOwner,c=(nt.isNullOrEmpty(this.passwordOwner)&&(h=this.passwordUser),Z.System.Text.Encoding.UTF8.getBytes(h));if(127<c.length){let t=[];it.copy2(c,0,t,0,127),c=t}return(i=this.getHashV5(c,s,this.userValue))[Z.System.StiObject.stimulsoft]().copyTo(this.ownerValue,0),s[Z.System.StiObject.stimulsoft]().copyTo(this.ownerValue,32),o[Z.System.StiObject.stimulsoft]().copyTo(this.ownerValue,40),i=this.getHashV5(c,o,this.userValue),this.encodeKeyDataV5(i,r,!0)[Z.System.StiObject.stimulsoft]().copyTo(this.ownerExtendedValue,0),e=t.createNextBytes(16),this.getBytesUInt32(this.securityFlags)[Z.System.StiObject.stimulsoft]().copyTo(e,0),e[4]=255,e[5]=255,e[6]=255,e[7]=255,e[8]=84,e[9]=97,e[10]=100,e[11]=98,this.permsValue=this.encodeKeyDataV5(r,e,!1),i=this.getHashV5(l,a,null),this.encryptionKey=this.decodeKeyDataV5(i,this.userExtendedValue,!0),97==(e=this.decodeKeyDataV5(this.encryptionKey,this.permsValue,!1))[9]&&100==e[10]&&98==e[11]||this.throwEncryptionError(102,"Verifying key calculation failed"),!0}encodeKeyDataV5(i,r,t){let n=null;if(t){let t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=new Z.ExternalLibrary.aesjs.ModeOfOperation.cbc(i,t);n=e.encrypt(r)}else{let t=new Z.ExternalLibrary.aesjs.ModeOfOperation.ecb(i);n=t.encrypt(r)}let e=[];for(let t=0;t<n.length;t++)e[t]=n[t];return e}decodeKeyDataV5(i,r,t){let n=null;if(t){let t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=new Z.ExternalLibrary.aesjs.ModeOfOperation.cbc(i,t);n=e.decrypt(r)}else{let t=new Z.ExternalLibrary.aesjs.ModeOfOperation.ecb(i);n=t.decrypt(r)}let e=[];for(let t=0;t<n.length;t++)e[t]=n[t];return e}getHashV5(t,e,i){return this.keyLength==J.c.StiPdfEncryptionKeyLength.Bit256_r5?Qr.calculate_hash_r5(t,e,i):Qr.calculate_hash_r6(t,e,i)}static calculate_hash_r5(t,e,i){let r=[];return r.push(...t),r.push(...e),null!=i&&r.push(...i),Z.System.Crypt.SHA2.SHA256(r)}static calculate_hash_r6(r,t,n){let a=[],s=[],o=32,l=0,h=null,c=[],m=[],g=new Z.System.Crypt.SHA2;(h=[]).push(...r),h.push(...t),null!=n&&h.push(...n),g.SHA2_256(h)[Z.System.StiObject.stimulsoft]().copyTo(s,0);for(let t=0;t<64||t<a[64*l-1]+32;t++){h[Z.System.StiObject.stimulsoft]().clear(),h.push(...r);for(let t=0;t<o;t++)h.push(s[t]);l=r.length+o,null!=n&&(h.push(...n),l+=48);for(let t=0;t<64;t++)h[Z.System.StiObject.stimulsoft]().copyTo(a,t*l);it.copy2(s,0,c,0,16),it.copy2(s,16,m,0,16);let t=new Z.ExternalLibrary.aesjs.ModeOfOperation.cbc(c,m),e=t.encrypt(a.slice(0,64*l));for(let t=0;t<e.length;t++)a[t]=e[t];let i=0;for(let t=0;t<16;t++)i+=a[t];switch(o=32+i%3*16){case 32:g.SHA2_256(a.slice(0,64*l))[Z.System.StiObject.stimulsoft]().copyTo(s,0);break;case 48:g.SHA2_384(a.slice(0,64*l))[Z.System.StiObject.stimulsoft]().copyTo(s,0);break;case 64:g.SHA2_512(a.slice(0,64*l))[Z.System.StiObject.stimulsoft]().copyTo(s,0);break}}let e=[];return it.copy2(s,0,e,0,32),e}encryptData(o,l,h){if(this.keyLength==J.c.StiPdfEncryptionKeyLength.Bit40||this.keyLength==J.c.StiPdfEncryptionKeyLength.Bit128){let t=l,e=h,i=[],r=(this.encryptionKey[Z.System.StiObject.stimulsoft]().copyTo(i,0),this.getBytesUInt32(t)[Z.System.StiObject.stimulsoft]().copyTo(i,this.encryptionKeyLength),this.getBytesUint16(e)[Z.System.StiObject.stimulsoft]().copyTo(i,this.encryptionKeyLength+3),this.computeHashMD5(i));this.keyLength==J.c.StiPdfEncryptionKeyLength.Bit40&&(r=r.slice(0,10)),o=this.rc4(o,r)}else if(this.keyLength==J.c.StiPdfEncryptionKeyLength.Bit128_r4){let t=l,e=h,i=[],r=(this.encryptionKey[Z.System.StiObject.stimulsoft]().copyTo(i,0),this.getBytesUInt32(t)[Z.System.StiObject.stimulsoft]().copyTo(i,16),this.getBytesUint16(e)[Z.System.StiObject.stimulsoft]().copyTo(i,19),i[21]=115,i[22]=65,i[23]=108,i[24]=84,this.computeHashMD5(i)),n=(new Z.System.Crypt.SecureRandom).createNextBytes(16),a=[],s=(a.push(...n),a.push(...o),a=new Z.ExternalLibrary.aesjs.padding.pkcs7.pad(a),new Z.ExternalLibrary.aesjs.ModeOfOperation.cbc(r,n));o=s.encrypt(a)}else{let t=(new Z.System.Crypt.SecureRandom).createNextBytes(16),e=[],i=(e.push(...t),e.push(...o),e=new Z.ExternalLibrary.aesjs.padding.pkcs7.pad(e),new Z.ExternalLibrary.aesjs.ModeOfOperation.cbc(this.encryptionKey,t));o=i.encrypt(e)}return o}throwEncryptionError(t,e){throw new Error(nt.format("EncryptionError at step {0} : {1}",t,e))}renderEncodeRecord(r,n){let t="",e="",i=32,a=(this.keyLength!=J.c.StiPdfEncryptionKeyLength.Bit256_r5&&this.keyLength!=J.c.StiPdfEncryptionKeyLength.Bit256_r6||(i=48),0);for(a=0;a<i;a++)t+=String.fromCharCode(this.ownerValue[a]),e+=String.fromCharCode(this.userValue[a]);if(r.writeLine("/Filter /Standard"),this.keyLength==J.c.StiPdfEncryptionKeyLength.Bit128)r.writeLine("/CF<</StdCF<</AuthEvent/DocOpen/CFM/V2/Length 16>>>>"),r.writeLine("/StmF /StdCF"),r.writeLine("/StrF /StdCF"),r.writeLine("/R 3"),r.writeLine("/V 2"),r.writeLine("/Length 128");else if(this.keyLength==J.c.StiPdfEncryptionKeyLength.Bit128_r4)r.writeLine("/CF<</StdCF<</AuthEvent/DocOpen/CFM/AESV2/Length 16>>>>"),r.writeLine("/StmF /StdCF"),r.writeLine("/StrF /StdCF"),r.writeLine("/R 4"),r.writeLine("/V 4"),r.writeLine("/Length 128");else if(this.keyLength==J.c.StiPdfEncryptionKeyLength.Bit256_r5||this.keyLength==J.c.StiPdfEncryptionKeyLength.Bit256_r6){r.writeLine("/CF<</StdCF<</AuthEvent/DocOpen/CFM/AESV3/Length 32>>>>"),r.writeLine("/StmF /StdCF"),r.writeLine("/StrF /StdCF"),r.writeLine1("/R {0}",this.keyLength==J.c.StiPdfEncryptionKeyLength.Bit256_r5?5:6),r.writeLine("/V 5"),r.writeLine("/Length 256");let t="",e="";for(a=0;a<32;a++)t+=String.fromCharCode(this.ownerExtendedValue[a]),e+=String.fromCharCode(this.userExtendedValue[a]);let i="";for(a=0;a<16;a++)i+=String.fromCharCode(this.permsValue[a]);n.storeString(nt.format("/OE ({0})",J.c.StiPdfExportService.convertToEscapeSequencePlusTabs(t))),n.storeString(nt.format("/UE ({0})",J.c.StiPdfExportService.convertToEscapeSequencePlusTabs(e))),n.storeString(nt.format("/Perms ({0})",J.c.StiPdfExportService.convertToEscapeSequencePlusTabs(i)))}else r.writeLine("/R 2"),r.writeLine("/V 1"),r.writeLine("/Length 40");n.storeString(nt.format("/O ({0})",J.c.StiPdfExportService.convertToEscapeSequencePlusTabs(t))),n.storeString(nt.format("/U ({0})",J.c.StiPdfExportService.convertToEscapeSequencePlusTabs(e))),r.writeLine1("/P {0}",this.securityFlags)}getBytesUInt32(t){let e=[];return e.push(255&t),e.push(t>>8&255),e.push(t>>16&255),e.push(t>>24&255),e}getBytesUint16(t){let e=[];return e.push(255&t),e.push(t>>8&255),e}rc4(e,t){let i=[],r=0,n=0,a,s=[],o=t.length,l=e.length;for(r=0;r<256;r++)i[r]=r;for(r=0;r<256;r++)n=(n+i[r]+t[r%o])%256,a=i[r],i[r]=i[n],i[n]=a;r=0;for(let t=n=0;t<l;t++)r=(r+1)%256,n=(n+i[r])%256,a=i[r],i[r]=i[n],i[n]=a,s.push(e[t]^i[(i[r]+i[n])%256]);return s}computeHashMD5(e){let i="";for(let t=0;t<e.length;t++)i+=String.fromCharCode(e[t]);return Z.Base.StiMD5Helper.MD5(i,!1)}constructor(t){this.ownerValue=[],this.userValue=[],this.ownerExtendedValue=[],this.userExtendedValue=[],this.permsValue=[],this.IDValue=null,this.encryptionKey=null,this.encryptionKeyLength=0,this.passwordOwner="",this.passwordUser="",this.securityFlags=0,this.keyLength=J.c.StiPdfEncryptionKeyLength.Bit40,this.pdfService=null,this.pdfService=t}}Qr.paddingString=[40,191,78,94,78,117,138,65,100,0,78,86,255,250,1,8,46,46,0,182,208,104,62,128,47,12,169,254,100,83,105,122],J.c.StiPdfSecurity=Qr}{class Zr{constructor(){this.ref=-1,this.info=null}get isUsed(){return!(-1==this.ref)}addRef(){this.info.addRef(this)}toString(){if(-1==this.ref)return"-";return nt.format("ref = {0}",this.ref)}}J.c.StiPdfObjInfo=Zr;class Jr extends Zr{}J.c.StiPdfContentObjInfo=Jr;class $r extends Zr{}J.c.StiPdfXObjectObjInfo=$r;class tn extends Zr{}J.c.StiPdfFontObjInfo=tn;class en extends Zr{}J.c.StiPdfOutlinesObjInfo=en;class rn extends Zr{}J.c.StiPdfPatternsObjInfo=rn;class nn extends Zr{}J.c.StiPdfAnnotObjInfo=nn;class an{}J.c.StiPdfCheckBoxObjInfo=an;class sn extends Zr{}J.c.StiPdfAcroFormObjInfo=sn,J.c.StiPdfStructure=class{addRef(t){this.objectsCounter++,t.ref=this.objectsCounter}createObject(t=!1){let e=new Zr;return e.info=this,t&&this.addRef(e),e}createContentObject(t=!1){let e=new Jr;return e.info=this,t&&this.addRef(e),e.content=this.createObject(t),e}createXObject(t=!1,e=!1){let i=new $r;return i.info=this,t&&this.addRef(i),i.mask=this.createObject(t&&e),i}createFontObject(t=!1,e=!0,i=!1,r=!0,n=!1){let a=new tn;return a.info=this,t&&this.addRef(a),a.descendantFont=this.createObject(t&&e),a.toUnicode=this.createObject(t&&e),a.cIDSet=this.createObject(t&&e),a.encoding=this.createObject(t&&!e&&!n),a.fontDescriptor=this.createObject(t&&!i),a.fontFile2=this.createObject(t&&r),a}createOutlinesObject(t=!1){let e=new en;return e.info=this,t&&this.addRef(e),e.items=[],e}createPatternsObject(t=!1){let e=new rn;return e.info=this,e.resources=this.createObject(t),e.first=this.createObject(t),e.hatchItems=[],e.shadingItems=[],e.shadingFunctionItems=[],e}createAcroFormObject(t=!1){let e=new sn;return e.info=this,t&&this.addRef(e),e.annots=[],e.checkBoxes=[],e.unsignedSignatures=[],e.signatures=[],e.tooltips=[],e.annotFontItems=[],e.fontHelvetica=this.createObject(t),e}createAnnotObject(e=!1,t=!1,i=0){let r=new nn;r.info=this,e&&this.addRef(r),r.aP=this.createObject(e&&t),r.aA=[];for(let t=0;t<i;t++)r.aA.push(this.createObject(e));return r}constructor(){this.objectsCounter=0,this.objects=null,this.objectsCounter=0,this.objects=[],this.root=this.createObject(!0),this.info=this.createObject(!0),this.colorSpace=this.createObject(!0),this.pages=this.createObject(!0),this.structTreeRoot=this.createObject(!0),this.optionalContentGroup=this.createObject(!0),this.pageList=[],this.xObjectList=[],this.fontList=[],this.linkList=[],this.embeddedFilesList=[]}}}{class on{static encode(n,a){let s="";for(let r=0;r<n.length;r++){let t=n.charCodeAt(r),e=63,i=this.unicodeToCodePageArray[t];(i==a&&1!=i||0==i)&&(e=this.unicodeToAnsiArray[t]),s+=String.fromCharCode(e)}return s}static StiEncode(){this.codePagesTable=[[1033,1252,1],[1049,1251,204],[1045,1250,238],[1025,1256,178]],this.codePagesDataTable=[[8364,1026,8364,8364,8364,8364,8364,8364,8364],[0,1027,0,0,0,0,1662,0,0],[8218,8218,8218,8218,8218,8218,8218,8218,8218],[402,1107,0,402,402,402,402,0,402],[8222,8222,8222,8222,8222,8222,8222,8222,8222],[8230,8230,8230,8230,8230,8230,8230,8230,8230],[8224,8224,8224,8224,8224,8224,8224,8224,8224],[8225,8225,8225,8225,8225,8225,8225,8225,8225],[710,8364,0,0,710,710,710,0,710],[8240,8240,8240,8240,8240,8240,8240,8240,8240],[352,1033,352,0,352,0,1657,0,0],[8249,8249,8249,8249,8249,8249,8249,8249,8249],[338,1034,346,0,338,0,338,0,338],[0,1036,356,0,0,0,1670,168,0],[381,1035,381,0,0,0,1688,711,0],[0,1039,377,0,0,0,1672,184,0],[0,1106,0,0,0,0,1711,0,0],[8216,8216,8216,8216,8216,8216,8216,8216,8216],[8217,8217,8217,8217,8217,8217,8217,8217,8217],[8220,8220,8220,8220,8220,8220,8220,8220,8220],[8221,8221,8221,8221,8221,8221,8221,8221,8221],[8226,8226,8226,8226,8226,8226,8226,8226,8226],[8211,8211,8211,8211,8211,8211,8211,8211,8211],[8212,8212,8212,8212,8212,8212,8212,8212,8212],[732,0,0,0,732,732,1705,0,732],[8482,8482,8482,8482,8482,8482,8482,8482,8482],[353,1113,353,0,353,0,1681,0,0],[8250,8250,8250,8250,8250,8250,8250,8250,8250],[339,1114,347,0,339,0,339,0,339],[0,1116,357,0,0,0,8204,175,0],[382,1115,382,0,0,0,8205,731,0],[376,1119,378,0,376,0,1722,0,376],[160,160,160,160,160,160,160,160,160],[161,1038,711,901,161,161,1548,0,161],[162,1118,728,902,162,162,162,162,162],[163,1032,321,163,163,163,163,163,163],[164,164,164,164,164,8362,164,164,164],[165,1168,260,165,165,165,165,0,165],[166,166,166,166,166,166,166,166,166],[167,167,167,167,167,167,167,167,167],[168,1025,168,168,168,168,168,216,168],[169,169,169,169,169,169,169,169,169],[170,1028,350,0,170,215,1726,342,170],[171,171,171,171,171,171,171,171,171],[172,172,172,172,172,172,172,172,172],[173,173,173,173,173,173,173,173,173],[174,174,174,174,174,174,174,174,174],[175,1031,379,8213,175,175,175,198,175],[176,176,176,176,176,176,176,176,176],[177,177,177,177,177,177,177,177,177],[178,1030,731,178,178,178,178,178,178],[179,1110,322,179,179,179,179,179,179],[180,1169,180,900,180,180,180,180,180],[181,181,181,181,181,181,181,181,181],[182,182,182,182,182,182,182,182,182],[183,183,183,183,183,183,183,183,183],[184,1105,184,904,184,184,184,248,184],[185,8470,261,905,185,185,185,185,185],[186,1108,351,906,186,247,1563,343,186],[187,187,187,187,187,187,187,187,187],[188,1112,317,908,188,188,188,188,188],[189,1029,733,189,189,189,189,189,189],[190,1109,318,910,190,190,190,190,190],[191,1111,380,911,191,191,1567,230,191],[192,1040,340,912,192,1456,1729,260,192],[193,1041,193,913,193,1457,1569,302,193],[194,1042,194,914,194,1458,1570,256,194],[195,1043,258,915,195,1459,1571,262,258],[196,1044,196,916,196,1460,1572,196,196],[197,1045,313,917,197,1461,1573,197,197],[198,1046,262,918,198,1462,1574,280,198],[199,1047,199,919,199,1463,1575,274,199],[200,1048,268,920,200,1464,1576,268,200],[201,1049,201,921,201,1465,1577,201,201],[202,1050,280,922,202,0,1578,377,202],[203,1051,203,923,203,1467,1579,278,203],[204,1052,282,924,204,1468,1580,290,768],[205,1053,205,925,205,1469,1581,310,205],[206,1054,206,926,206,1470,1582,298,206],[207,1055,270,927,207,1471,1583,315,207],[208,1056,272,928,286,1472,1584,352,272],[209,1057,323,929,209,1473,1585,323,209],[210,1058,327,0,210,1474,1586,325,777],[211,1059,211,931,211,1475,1587,211,211],[212,1060,212,932,212,1520,1588,332,212],[213,1061,336,933,213,1521,1589,213,416],[214,1062,214,934,214,1522,1590,214,214],[215,1063,215,935,215,1523,215,215,215],[216,1064,344,936,216,1524,1591,370,216],[217,1065,366,937,217,0,1592,321,217],[218,1066,218,938,218,0,1593,346,218],[219,1067,368,939,219,0,1594,362,219],[220,1068,220,940,220,0,1600,220,220],[221,1069,221,941,304,0,1601,379,431],[222,1070,354,942,350,0,1602,381,771],[223,1071,223,943,223,0,1603,223,223],[224,1072,341,944,224,1488,224,261,224],[225,1073,225,945,225,1489,1604,303,225],[226,1074,226,946,226,1490,226,257,226],[227,1075,259,947,227,1491,1605,263,259],[228,1076,228,948,228,1492,1606,228,228],[229,1077,314,949,229,1493,1607,229,229],[230,1078,263,950,230,1494,1608,281,230],[231,1079,231,951,231,1495,231,275,231],[232,1080,269,952,232,1496,232,269,232],[233,1081,233,953,233,1497,233,233,233],[234,1082,281,954,234,1498,234,378,234],[235,1083,235,955,235,1499,235,279,235],[236,1084,283,956,236,1500,1609,291,769],[237,1085,237,957,237,1501,1610,311,237],[238,1086,238,958,238,1502,238,299,238],[239,1087,271,959,239,1503,239,316,239],[240,1088,273,960,287,1504,1611,353,273],[241,1089,324,961,241,1505,1612,324,241],[242,1090,328,962,242,1506,1613,326,803],[243,1091,243,963,243,1507,1614,243,243],[244,1092,244,964,244,1508,244,333,244],[245,1093,337,965,245,1509,1615,245,417],[246,1094,246,966,246,1510,1616,246,246],[247,1095,247,967,247,1511,247,247,247],[248,1096,345,968,248,1512,1617,371,248],[249,1097,367,969,249,1513,249,322,249],[250,1098,250,970,250,1514,1618,347,250],[251,1099,369,971,251,0,251,363,251],[252,1100,252,972,252,0,252,252,252],[253,1101,253,973,305,8206,8206,380,432],[254,1102,355,974,351,8207,8207,382,8363],[255,1103,729,0,255,0,1746,729,255]];for(let t=0;t<128;t++)this.unicodeToCodePageArray[t]=0,this.unicodeToAnsiArray[t]=t;for(let t=128;t<65536;t++)this.unicodeToCodePageArray[t]=0,this.unicodeToAnsiArray[t]=63;let t,r="";for(let t=0;t<65536;t++)r+=String.fromCharCode(t);for(let i=this.codePagesTableSize;0<i;i--){let e=(t=u.getEncoding(this.codePagesTable[i-1][1])).getBytes(r);for(let t=128;t<65536;t++)127<e[t]?(this.unicodeToCodePageArray[t]=i,this.unicodeToAnsiArray[t]=e[t]):63!=e[t]&&(0==this.unicodeToCodePageArray[t]||127<this.unicodeToCodePageArray[t])&&(this.unicodeToCodePageArray[t]=i+128,this.unicodeToAnsiArray[t]=e[t])}for(let t=128;t<65536;t++)127<this.unicodeToCodePageArray[t]&&(this.unicodeToCodePageArray[t]-=128);for(let i=this.codePagesCount;0<i;i--)for(let e=0;e<128;e++){let t=this.codePagesDataTable[e][i-1];this.unicodeToCodePageArray[t]=i,this.unicodeToAnsiArray[t]=e+128}for(let t=0;t<10;t++)this.unicodeToCodePageArray[t+1632]=0,this.unicodeToAnsiArray[t+1632]=63,this.unicodeToCodePageArray[t+1776]=0,this.unicodeToAnsiArray[t+1776]=63}}on.unicodeToCodePageArray=[],on.unicodeToAnsiArray=[],on.codePagesCount=9,on.codePagesTableSize=4,(J.c.StiEncode=on).StiEncode()}{class ln{static run(r,n){if(void 0===r)return void ln.run(Z,"Stimulsoft");if("Stimulsoft.ExternalLibrary"==n||"Stimulsoft.Blockly"==n||"Stimulsoft.Report.StiOptions"==n||"Stimulsoft.StiOptions"==n)return;n=n.replace("Stimulsoft.System","System");for(let i in r){let t=r[i],e=typeof t;"function"==e?(t.ssTypeName=i,t.ssNamespace=n):"object"==e&&ln.run(t,n+`.`+i)}}}J.b.StiTypesHelper=ln}return J.b.StiTypesHelper.run(),{Stimulsoft:Z}});